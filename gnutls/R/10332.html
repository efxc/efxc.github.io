<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>session</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.6.3' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/1409.html#L17'>session</a>            17 doc/examples/ex-alert.c void check_alert(gnutls_session_t session, int ret)</span>
<span class='curline'><a href='../S/1409.html#L23'>session</a>            23 doc/examples/ex-alert.c                 last_alert = gnutls_alert_get(session);</span>
<span class='curline'><a href='../S/1413.html#L79'>session</a>            79 doc/examples/ex-cert-select-pkcs11.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1413.html#L114'>session</a>           114 doc/examples/ex-cert-select-pkcs11.c         CHECK(gnutls_init(&amp;session, GNUTLS_CLIENT));</span>
<span class='curline'><a href='../S/1413.html#L117'>session</a>           117 doc/examples/ex-cert-select-pkcs11.c         CHECK(gnutls_set_default_priority(session));</span>
<span class='curline'><a href='../S/1413.html#L121'>session</a>           121 doc/examples/ex-cert-select-pkcs11.c         CHECK(gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred));</span>
<span class='curline'><a href='../S/1413.html#L127'>session</a>           127 doc/examples/ex-cert-select-pkcs11.c         gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1413.html#L131'>session</a>           131 doc/examples/ex-cert-select-pkcs11.c         ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1413.html#L140'>session</a>           140 doc/examples/ex-cert-select-pkcs11.c                 desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1413.html#L145'>session</a>           145 doc/examples/ex-cert-select-pkcs11.c         CHECK(gnutls_record_send(session, MSG, strlen(MSG)));</span>
<span class='curline'><a href='../S/1413.html#L147'>session</a>           147 doc/examples/ex-cert-select-pkcs11.c         ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/1413.html#L162'>session</a>           162 doc/examples/ex-cert-select-pkcs11.c         CHECK(gnutls_bye(session, GNUTLS_SHUT_RDWR));</span>
<span class='curline'><a href='../S/1413.html#L168'>session</a>           168 doc/examples/ex-cert-select-pkcs11.c         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1441.html#L38'>session</a>            38 doc/examples/ex-cert-select.c cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/1441.html#L73'>session</a>            73 doc/examples/ex-cert-select.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1441.html#L99'>session</a>            99 doc/examples/ex-cert-select.c         CHECK(gnutls_init(&amp;session, GNUTLS_CLIENT));</span>
<span class='curline'><a href='../S/1441.html#L102'>session</a>           102 doc/examples/ex-cert-select.c         CHECK(gnutls_set_default_priority(session));</span>
<span class='curline'><a href='../S/1441.html#L106'>session</a>           106 doc/examples/ex-cert-select.c         CHECK(gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred));</span>
<span class='curline'><a href='../S/1441.html#L112'>session</a>           112 doc/examples/ex-cert-select.c         gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1441.html#L116'>session</a>           116 doc/examples/ex-cert-select.c         ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1441.html#L125'>session</a>           125 doc/examples/ex-cert-select.c                 desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1441.html#L130'>session</a>           130 doc/examples/ex-cert-select.c         CHECK(gnutls_record_send(session, MSG, strlen(MSG)));</span>
<span class='curline'><a href='../S/1441.html#L132'>session</a>           132 doc/examples/ex-cert-select.c         ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/1441.html#L147'>session</a>           147 doc/examples/ex-cert-select.c         CHECK(gnutls_bye(session, GNUTLS_SHUT_RDWR));</span>
<span class='curline'><a href='../S/1441.html#L153'>session</a>           153 doc/examples/ex-cert-select.c         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1441.html#L170'>session</a>           170 doc/examples/ex-cert-select.c cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/1441.html#L203'>session</a>           203 doc/examples/ex-cert-select.c         type = gnutls_certificate_type_get(session);</span>
<span class='curline'><a href='../S/1434.html#L35'>session</a>            35 doc/examples/ex-client-anon.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1434.html#L46'>session</a>            46 doc/examples/ex-client-anon.c         gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/1434.html#L49'>session</a>            49 doc/examples/ex-client-anon.c         gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/1434.html#L55'>session</a>            55 doc/examples/ex-client-anon.c         gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/1434.html#L61'>session</a>            61 doc/examples/ex-client-anon.c         gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1434.html#L62'>session</a>            62 doc/examples/ex-client-anon.c         gnutls_handshake_set_timeout(session,</span>
<span class='curline'><a href='../S/1434.html#L68'>session</a>            68 doc/examples/ex-client-anon.c                 ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1434.html#L79'>session</a>            79 doc/examples/ex-client-anon.c                 desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1434.html#L84'>session</a>            84 doc/examples/ex-client-anon.c         LOOP_CHECK(ret, gnutls_record_send(session, MSG, strlen(MSG)));</span>
<span class='curline'><a href='../S/1434.html#L86'>session</a>            86 doc/examples/ex-client-anon.c         LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1434.html#L105'>session</a>           105 doc/examples/ex-client-anon.c         LOOP_CHECK(ret, gnutls_bye(session, GNUTLS_SHUT_RDWR));</span>
<span class='curline'><a href='../S/1434.html#L111'>session</a>           111 doc/examples/ex-client-anon.c         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1436.html#L33'>session</a>            33 doc/examples/ex-client-dtls.c extern int verify_certificate_callback(gnutls_session_t session);</span>
<span class='curline'><a href='../S/1436.html#L38'>session</a>            38 doc/examples/ex-client-dtls.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1436.html#L57'>session</a>            57 doc/examples/ex-client-dtls.c         CHECK(gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM));</span>
<span class='curline'><a href='../S/1436.html#L60'>session</a>            60 doc/examples/ex-client-dtls.c         CHECK(gnutls_set_default_priority(session));</span>
<span class='curline'><a href='../S/1436.html#L63'>session</a>            63 doc/examples/ex-client-dtls.c         CHECK(gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred));</span>
<span class='curline'><a href='../S/1436.html#L64'>session</a>            64 doc/examples/ex-client-dtls.c         CHECK(gnutls_server_name_set(session, GNUTLS_NAME_DNS, "www.example.com",</span>
<span class='curline'><a href='../S/1436.html#L67'>session</a>            67 doc/examples/ex-client-dtls.c         gnutls_session_set_verify_cert(session, "www.example.com", 0);</span>
<span class='curline'><a href='../S/1436.html#L72'>session</a>            72 doc/examples/ex-client-dtls.c         gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1436.html#L75'>session</a>            75 doc/examples/ex-client-dtls.c         gnutls_dtls_set_mtu(session, 1000);</span>
<span class='curline'><a href='../S/1436.html#L80'>session</a>            80 doc/examples/ex-client-dtls.c                 ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1436.html#L92'>session</a>            92 doc/examples/ex-client-dtls.c                 desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1436.html#L97'>session</a>            97 doc/examples/ex-client-dtls.c         LOOP_CHECK(ret, gnutls_record_send(session, MSG, strlen(MSG)));</span>
<span class='curline'><a href='../S/1436.html#L99'>session</a>            99 doc/examples/ex-client-dtls.c         LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1436.html#L121'>session</a>           121 doc/examples/ex-client-dtls.c         CHECK(gnutls_bye(session, GNUTLS_SHUT_WR));</span>
<span class='curline'><a href='../S/1436.html#L127'>session</a>           127 doc/examples/ex-client-dtls.c         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1421.html#L36'>session</a>            36 doc/examples/ex-client-psk.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1421.html#L55'>session</a>            55 doc/examples/ex-client-psk.c         CHECK(gnutls_init(&amp;session, GNUTLS_CLIENT));</span>
<span class='curline'><a href='../S/1421.html#L58'>session</a>            58 doc/examples/ex-client-psk.c             gnutls_set_default_priority_append(session,</span>
<span class='curline'><a href='../S/1421.html#L74'>session</a>            74 doc/examples/ex-client-psk.c         CHECK(gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred));</span>
<span class='curline'><a href='../S/1421.html#L80'>session</a>            80 doc/examples/ex-client-psk.c         gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1421.html#L81'>session</a>            81 doc/examples/ex-client-psk.c         gnutls_handshake_set_timeout(session,</span>
<span class='curline'><a href='../S/1421.html#L87'>session</a>            87 doc/examples/ex-client-psk.c                 ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1421.html#L98'>session</a>            98 doc/examples/ex-client-psk.c                 desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1421.html#L103'>session</a>           103 doc/examples/ex-client-psk.c         LOOP_CHECK(ret, gnutls_record_send(session, MSG, strlen(MSG)));</span>
<span class='curline'><a href='../S/1421.html#L105'>session</a>           105 doc/examples/ex-client-psk.c         LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1421.html#L124'>session</a>           124 doc/examples/ex-client-psk.c         CHECK(gnutls_bye(session, GNUTLS_SHUT_RDWR));</span>
<span class='curline'><a href='../S/1421.html#L130'>session</a>           130 doc/examples/ex-client-psk.c         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1411.html#L13'>session</a>            13 doc/examples/ex-client-resume.c extern void check_alert(gnutls_session_t session, int ret);</span>
<span class='curline'><a href='../S/1411.html#L37'>session</a>            37 doc/examples/ex-client-resume.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1411.html#L56'>session</a>            56 doc/examples/ex-client-resume.c                 CHECK(gnutls_init(&amp;session, GNUTLS_CLIENT));</span>
<span class='curline'><a href='../S/1411.html#L58'>session</a>            58 doc/examples/ex-client-resume.c                 CHECK(gnutls_server_name_set(session, GNUTLS_NAME_DNS,</span>
<span class='curline'><a href='../S/1411.html#L61'>session</a>            61 doc/examples/ex-client-resume.c                 gnutls_session_set_verify_cert(session, "www.example.com", 0);</span>
<span class='curline'><a href='../S/1411.html#L63'>session</a>            63 doc/examples/ex-client-resume.c                 CHECK(gnutls_set_default_priority(session));</span>
<span class='curline'><a href='../S/1411.html#L65'>session</a>            65 doc/examples/ex-client-resume.c                 gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1411.html#L66'>session</a>            66 doc/examples/ex-client-resume.c                 gnutls_handshake_set_timeout(session,</span>
<span class='curline'><a href='../S/1411.html#L69'>session</a>            69 doc/examples/ex-client-resume.c                 gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/1411.html#L74'>session</a>            74 doc/examples/ex-client-resume.c                         CHECK(gnutls_session_set_data(session, sdata.data,</span>
<span class='curline'><a href='../S/1411.html#L82'>session</a>            82 doc/examples/ex-client-resume.c                         ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1411.html#L96'>session</a>            96 doc/examples/ex-client-resume.c                         CHECK(gnutls_session_get_data2(session, &amp;sdata));</span>
<span class='curline'><a href='../S/1411.html#L100'>session</a>           100 doc/examples/ex-client-resume.c                         if (gnutls_session_is_resumed(session) != 0) {</span>
<span class='curline'><a href='../S/1411.html#L108'>session</a>           108 doc/examples/ex-client-resume.c                 LOOP_CHECK(ret, gnutls_record_send(session, MSG, strlen(MSG)));</span>
<span class='curline'><a href='../S/1411.html#L110'>session</a>           110 doc/examples/ex-client-resume.c                 LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1411.html#L131'>session</a>           131 doc/examples/ex-client-resume.c                 gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/1411.html#L137'>session</a>           137 doc/examples/ex-client-resume.c                 gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1406.html#L14'>session</a>            14 doc/examples/ex-client-srp.c extern void check_alert(gnutls_session_t session, int ret);</span>
<span class='curline'><a href='../S/1406.html#L28'>session</a>            28 doc/examples/ex-client-srp.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1406.html#L54'>session</a>            54 doc/examples/ex-client-srp.c         gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/1406.html#L59'>session</a>            59 doc/examples/ex-client-srp.c         gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/1406.html#L65'>session</a>            65 doc/examples/ex-client-srp.c         gnutls_credentials_set(session, GNUTLS_CRD_SRP, srp_cred);</span>
<span class='curline'><a href='../S/1406.html#L66'>session</a>            66 doc/examples/ex-client-srp.c         gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, cert_cred);</span>
<span class='curline'><a href='../S/1406.html#L68'>session</a>            68 doc/examples/ex-client-srp.c         gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1406.html#L69'>session</a>            69 doc/examples/ex-client-srp.c         gnutls_handshake_set_timeout(session,</span>
<span class='curline'><a href='../S/1406.html#L75'>session</a>            75 doc/examples/ex-client-srp.c                 ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1406.html#L86'>session</a>            86 doc/examples/ex-client-srp.c                 desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1406.html#L91'>session</a>            91 doc/examples/ex-client-srp.c         gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/1406.html#L93'>session</a>            93 doc/examples/ex-client-srp.c         ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/1406.html#L105'>session</a>           105 doc/examples/ex-client-srp.c                 check_alert(session, ret);</span>
<span class='curline'><a href='../S/1406.html#L114'>session</a>           114 doc/examples/ex-client-srp.c         gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/1406.html#L120'>session</a>           120 doc/examples/ex-client-srp.c         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1407.html#L33'>session</a>            33 doc/examples/ex-client-x509-3.1.c static int _verify_certificate_callback(gnutls_session_t session);</span>
<span class='curline'><a href='../S/1407.html#L38'>session</a>            38 doc/examples/ex-client-x509-3.1.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1407.html#L68'>session</a>            68 doc/examples/ex-client-x509-3.1.c         CHECK(gnutls_init(&amp;session, GNUTLS_CLIENT));</span>
<span class='curline'><a href='../S/1407.html#L70'>session</a>            70 doc/examples/ex-client-x509-3.1.c         gnutls_session_set_ptr(session, (void *) "www.example.com");</span>
<span class='curline'><a href='../S/1407.html#L72'>session</a>            72 doc/examples/ex-client-x509-3.1.c         gnutls_server_name_set(session, GNUTLS_NAME_DNS, "www.example.com",</span>
<span class='curline'><a href='../S/1407.html#L76'>session</a>            76 doc/examples/ex-client-x509-3.1.c         CHECK(gnutls_set_default_priority(session));</span>
<span class='curline'><a href='../S/1407.html#L79'>session</a>            79 doc/examples/ex-client-x509-3.1.c         ret = gnutls_priority_set_direct(session, </span>
<span class='curline'><a href='../S/1407.html#L91'>session</a>            91 doc/examples/ex-client-x509-3.1.c         CHECK(gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred));</span>
<span class='curline'><a href='../S/1407.html#L97'>session</a>            97 doc/examples/ex-client-x509-3.1.c         gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1407.html#L98'>session</a>            98 doc/examples/ex-client-x509-3.1.c         gnutls_handshake_set_timeout(session,</span>
<span class='curline'><a href='../S/1407.html#L104'>session</a>           104 doc/examples/ex-client-x509-3.1.c                 ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1407.html#L115'>session</a>           115 doc/examples/ex-client-x509-3.1.c                 desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1407.html#L120'>session</a>           120 doc/examples/ex-client-x509-3.1.c         LOOP_CHECK(ret, gnutls_record_send(session, MSG, strlen(MSG)));</span>
<span class='curline'><a href='../S/1407.html#L122'>session</a>           122 doc/examples/ex-client-x509-3.1.c         LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1407.html#L141'>session</a>           141 doc/examples/ex-client-x509-3.1.c         CHECK(gnutls_bye(session, GNUTLS_SHUT_RDWR));</span>
<span class='curline'><a href='../S/1407.html#L147'>session</a>           147 doc/examples/ex-client-x509-3.1.c         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1407.html#L159'>session</a>           159 doc/examples/ex-client-x509-3.1.c static int _verify_certificate_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/1407.html#L167'>session</a>           167 doc/examples/ex-client-x509-3.1.c         hostname = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/1407.html#L173'>session</a>           173 doc/examples/ex-client-x509-3.1.c         CHECK(gnutls_certificate_verify_peers3(session, hostname,</span>
<span class='curline'><a href='../S/1407.html#L176'>session</a>           176 doc/examples/ex-client-x509-3.1.c         type = gnutls_certificate_type_get(session);</span>
<span class='curline'><a href='../S/1412.html#L35'>session</a>            35 doc/examples/ex-client-x509.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1412.html#L63'>session</a>            63 doc/examples/ex-client-x509.c         CHECK(gnutls_init(&amp;session, GNUTLS_CLIENT));</span>
<span class='curline'><a href='../S/1412.html#L65'>session</a>            65 doc/examples/ex-client-x509.c         CHECK(gnutls_server_name_set(session, GNUTLS_NAME_DNS, "www.example.com",</span>
<span class='curline'><a href='../S/1412.html#L69'>session</a>            69 doc/examples/ex-client-x509.c         CHECK(gnutls_set_default_priority(session));</span>
<span class='curline'><a href='../S/1412.html#L73'>session</a>            73 doc/examples/ex-client-x509.c         CHECK(gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred));</span>
<span class='curline'><a href='../S/1412.html#L74'>session</a>            74 doc/examples/ex-client-x509.c         gnutls_session_set_verify_cert(session, "www.example.com", 0);</span>
<span class='curline'><a href='../S/1412.html#L80'>session</a>            80 doc/examples/ex-client-x509.c         gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1412.html#L81'>session</a>            81 doc/examples/ex-client-x509.c         gnutls_handshake_set_timeout(session,</span>
<span class='curline'><a href='../S/1412.html#L87'>session</a>            87 doc/examples/ex-client-x509.c                 ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1412.html#L93'>session</a>            93 doc/examples/ex-client-x509.c                         type = gnutls_certificate_type_get(session);</span>
<span class='curline'><a href='../S/1412.html#L94'>session</a>            94 doc/examples/ex-client-x509.c                         status = gnutls_session_get_verify_cert_status(session);</span>
<span class='curline'><a href='../S/1412.html#L103'>session</a>           103 doc/examples/ex-client-x509.c                 desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1412.html#L109'>session</a>           109 doc/examples/ex-client-x509.c         LOOP_CHECK(ret, gnutls_record_send(session, MSG, strlen(MSG)));</span>
<span class='curline'><a href='../S/1412.html#L111'>session</a>           111 doc/examples/ex-client-x509.c         LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1412.html#L130'>session</a>           130 doc/examples/ex-client-x509.c         CHECK(gnutls_bye(session, GNUTLS_SHUT_RDWR));</span>
<span class='curline'><a href='../S/1412.html#L136'>session</a>           136 doc/examples/ex-client-x509.c         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1417.html#L35'>session</a>            35 doc/examples/ex-cxx.cpp         gnutls::client_session session;</span>
<span class='curline'><a href='../S/1417.html#L46'>session</a>            46 doc/examples/ex-cxx.cpp         session.set_credentials(credentials);</span>
<span class='curline'><a href='../S/1417.html#L49'>session</a>            49 doc/examples/ex-cxx.cpp         session.set_priority ("NORMAL", NULL);</span>
<span class='curline'><a href='../S/1417.html#L54'>session</a>            54 doc/examples/ex-cxx.cpp         session.set_transport_ptr((gnutls_transport_ptr_t) (ptrdiff_t)sd);</span>
<span class='curline'><a href='../S/1417.html#L58'>session</a>            58 doc/examples/ex-cxx.cpp         int ret = session.handshake();</span>
<span class='curline'><a href='../S/1417.html#L68'>session</a>            68 doc/examples/ex-cxx.cpp         session.send(MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/1417.html#L70'>session</a>            70 doc/examples/ex-cxx.cpp         ret = session.recv(buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/1417.html#L84'>session</a>            84 doc/examples/ex-cxx.cpp         session.bye(GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/1443.html#L34'>session</a>            34 doc/examples/ex-serv-anon.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1443.html#L74'>session</a>            74 doc/examples/ex-serv-anon.c                 gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/1443.html#L75'>session</a>            75 doc/examples/ex-serv-anon.c                 gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/1443.html#L78'>session</a>            78 doc/examples/ex-serv-anon.c                 gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/1443.html#L87'>session</a>            87 doc/examples/ex-serv-anon.c                 gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1443.html#L90'>session</a>            90 doc/examples/ex-serv-anon.c                         ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/1443.html#L96'>session</a>            96 doc/examples/ex-serv-anon.c                         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1443.html#L108'>session</a>           108 doc/examples/ex-serv-anon.c                         ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/1443.html#L126'>session</a>           126 doc/examples/ex-serv-anon.c                                 gnutls_record_send(session, buffer, ret);</span>
<span class='curline'><a href='../S/1443.html#L132'>session</a>           132 doc/examples/ex-serv-anon.c                 gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/1443.html#L135'>session</a>           135 doc/examples/ex-serv-anon.c                 gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1414.html#L39'>session</a>            39 doc/examples/ex-serv-dtls.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1414.html#L66'>session</a>            66 doc/examples/ex-serv-dtls.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1414.html#L186'>session</a>           186 doc/examples/ex-serv-dtls.c                 gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/1414.html#L187'>session</a>           187 doc/examples/ex-serv-dtls.c                 gnutls_priority_set(session, priority_cache);</span>
<span class='curline'><a href='../S/1414.html#L188'>session</a>           188 doc/examples/ex-serv-dtls.c                 gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/1414.html#L191'>session</a>           191 doc/examples/ex-serv-dtls.c                 gnutls_dtls_prestate_set(session, &amp;prestate);</span>
<span class='curline'><a href='../S/1414.html#L192'>session</a>           192 doc/examples/ex-serv-dtls.c                 gnutls_dtls_set_mtu(session, mtu);</span>
<span class='curline'><a href='../S/1414.html#L194'>session</a>           194 doc/examples/ex-serv-dtls.c                 priv.session = session;</span>
<span class='curline'><a href='../S/1414.html#L199'>session</a>           199 doc/examples/ex-serv-dtls.c                 gnutls_transport_set_ptr(session, &amp;priv);</span>
<span class='curline'><a href='../S/1414.html#L200'>session</a>           200 doc/examples/ex-serv-dtls.c                 gnutls_transport_set_push_function(session, push_func);</span>
<span class='curline'><a href='../S/1414.html#L201'>session</a>           201 doc/examples/ex-serv-dtls.c                 gnutls_transport_set_pull_function(session, pull_func);</span>
<span class='curline'><a href='../S/1414.html#L202'>session</a>           202 doc/examples/ex-serv-dtls.c                 gnutls_transport_set_pull_timeout_function(session,</span>
<span class='curline'><a href='../S/1414.html#L205'>session</a>           205 doc/examples/ex-serv-dtls.c                 LOOP_CHECK(ret, gnutls_handshake(session));</span>
<span class='curline'><a href='../S/1414.html#L213'>session</a>           213 doc/examples/ex-serv-dtls.c                         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1414.html#L221'>session</a>           221 doc/examples/ex-serv-dtls.c                                     gnutls_record_recv_seq(session, buffer,</span>
<span class='curline'><a href='../S/1414.html#L248'>session</a>           248 doc/examples/ex-serv-dtls.c                         LOOP_CHECK(ret, gnutls_record_send(session, buffer, ret));</span>
<span class='curline'><a href='../S/1414.html#L256'>session</a>           256 doc/examples/ex-serv-dtls.c                 LOOP_CHECK(ret, gnutls_bye(session, GNUTLS_SHUT_WR));</span>
<span class='curline'><a href='../S/1414.html#L257'>session</a>           257 doc/examples/ex-serv-dtls.c                 gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1414.html#L366'>session</a>           366 doc/examples/ex-serv-dtls.c         gnutls_transport_set_errno(priv-&gt;session, EAGAIN);</span>
<span class='curline'><a href='../S/1432.html#L37'>session</a>            37 doc/examples/ex-serv-psk.c pskfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/1432.html#L58'>session</a>            58 doc/examples/ex-serv-psk.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1432.html#L121'>session</a>           121 doc/examples/ex-serv-psk.c                 gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/1432.html#L122'>session</a>           122 doc/examples/ex-serv-psk.c                 gnutls_priority_set(session, priority_cache);</span>
<span class='curline'><a href='../S/1432.html#L123'>session</a>           123 doc/examples/ex-serv-psk.c                 gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/1432.html#L125'>session</a>           125 doc/examples/ex-serv-psk.c                 gnutls_credentials_set(session, GNUTLS_CRD_PSK, psk_cred);</span>
<span class='curline'><a href='../S/1432.html#L129'>session</a>           129 doc/examples/ex-serv-psk.c                 gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/1432.html#L139'>session</a>           139 doc/examples/ex-serv-psk.c                 gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1432.html#L140'>session</a>           140 doc/examples/ex-serv-psk.c                 LOOP_CHECK(ret, gnutls_handshake(session));</span>
<span class='curline'><a href='../S/1432.html#L143'>session</a>           143 doc/examples/ex-serv-psk.c                         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1432.html#L151'>session</a>           151 doc/examples/ex-serv-psk.c                 kx = gnutls_kx_get(session);</span>
<span class='curline'><a href='../S/1432.html#L155'>session</a>           155 doc/examples/ex-serv-psk.c                                gnutls_psk_server_get_username(session));</span>
<span class='curline'><a href='../S/1432.html#L162'>session</a>           162 doc/examples/ex-serv-psk.c                         LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1432.html#L180'>session</a>           180 doc/examples/ex-serv-psk.c                                 gnutls_record_send(session, buffer, ret);</span>
<span class='curline'><a href='../S/1432.html#L186'>session</a>           186 doc/examples/ex-serv-psk.c                 LOOP_CHECK(ret, gnutls_bye(session, GNUTLS_SHUT_WR));</span>
<span class='curline'><a href='../S/1432.html#L189'>session</a>           189 doc/examples/ex-serv-psk.c                 gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1439.html#L45'>session</a>            45 doc/examples/ex-serv-srp.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1439.html#L97'>session</a>            97 doc/examples/ex-serv-srp.c                 gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/1439.html#L98'>session</a>            98 doc/examples/ex-serv-srp.c                 gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/1439.html#L102'>session</a>           102 doc/examples/ex-serv-srp.c                 gnutls_credentials_set(session, GNUTLS_CRD_SRP, srp_cred);</span>
<span class='curline'><a href='../S/1439.html#L105'>session</a>           105 doc/examples/ex-serv-srp.c                 gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/1439.html#L113'>session</a>           113 doc/examples/ex-serv-srp.c                 gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/1439.html#L123'>session</a>           123 doc/examples/ex-serv-srp.c                 gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1439.html#L125'>session</a>           125 doc/examples/ex-serv-srp.c                 LOOP_CHECK(ret, gnutls_handshake(session));</span>
<span class='curline'><a href='../S/1439.html#L128'>session</a>           128 doc/examples/ex-serv-srp.c                         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1439.html#L136'>session</a>           136 doc/examples/ex-serv-srp.c                        gnutls_srp_server_get_username(session));</span>
<span class='curline'><a href='../S/1439.html#L141'>session</a>           141 doc/examples/ex-serv-srp.c                         LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1439.html#L159'>session</a>           159 doc/examples/ex-serv-srp.c                                 gnutls_record_send(session, buffer, ret);</span>
<span class='curline'><a href='../S/1439.html#L164'>session</a>           164 doc/examples/ex-serv-srp.c                 LOOP_CHECK(ret, gnutls_bye(session, GNUTLS_SHUT_WR));</span>
<span class='curline'><a href='../S/1439.html#L167'>session</a>           167 doc/examples/ex-serv-srp.c                 gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1415.html#L55'>session</a>            55 doc/examples/ex-serv-x509.c         gnutls_session_t session;</span>
<span class='curline'><a href='../S/1415.html#L120'>session</a>           120 doc/examples/ex-serv-x509.c                 CHECK(gnutls_init(&amp;session, GNUTLS_SERVER));</span>
<span class='curline'><a href='../S/1415.html#L121'>session</a>           121 doc/examples/ex-serv-x509.c                 CHECK(gnutls_priority_set(session, priority_cache));</span>
<span class='curline'><a href='../S/1415.html#L122'>session</a>           122 doc/examples/ex-serv-x509.c                 CHECK(gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/1415.html#L130'>session</a>           130 doc/examples/ex-serv-x509.c                 gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/1415.html#L132'>session</a>           132 doc/examples/ex-serv-x509.c                 gnutls_handshake_set_timeout(session,</span>
<span class='curline'><a href='../S/1415.html#L142'>session</a>           142 doc/examples/ex-serv-x509.c                 gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/1415.html#L144'>session</a>           144 doc/examples/ex-serv-x509.c                 LOOP_CHECK(ret, gnutls_handshake(session));</span>
<span class='curline'><a href='../S/1415.html#L147'>session</a>           147 doc/examples/ex-serv-x509.c                         gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1415.html#L159'>session</a>           159 doc/examples/ex-serv-x509.c                         LOOP_CHECK(ret, gnutls_record_recv(session, buffer, MAX_BUF));</span>
<span class='curline'><a href='../S/1415.html#L177'>session</a>           177 doc/examples/ex-serv-x509.c                                 CHECK(gnutls_record_send(session, buffer, ret));</span>
<span class='curline'><a href='../S/1415.html#L183'>session</a>           183 doc/examples/ex-serv-x509.c                 LOOP_CHECK(ret, gnutls_bye(session, GNUTLS_SHUT_WR));</span>
<span class='curline'><a href='../S/1415.html#L186'>session</a>           186 doc/examples/ex-serv-x509.c                 gnutls_deinit(session);</span>
<span class='curline'><a href='../S/1410.html#L17'>session</a>            17 doc/examples/ex-session-info.c int print_info(gnutls_session_t session)</span>
<span class='curline'><a href='../S/1410.html#L26'>session</a>            26 doc/examples/ex-session-info.c         desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/1410.html#L33'>session</a>            33 doc/examples/ex-session-info.c         kx = gnutls_kx_get(session);</span>
<span class='curline'><a href='../S/1410.html#L38'>session</a>            38 doc/examples/ex-session-info.c         cred = gnutls_auth_get_type(session);</span>
<span class='curline'><a href='../S/1410.html#L43'>session</a>            43 doc/examples/ex-session-info.c                        gnutls_srp_server_get_username(session));</span>
<span class='curline'><a href='../S/1410.html#L50'>session</a>            50 doc/examples/ex-session-info.c                 if (gnutls_psk_client_get_hint(session) != NULL)</span>
<span class='curline'><a href='../S/1410.html#L52'>session</a>            52 doc/examples/ex-session-info.c                                gnutls_psk_client_get_hint(session));</span>
<span class='curline'><a href='../S/1410.html#L55'>session</a>            55 doc/examples/ex-session-info.c                 if (gnutls_psk_server_get_username(session) != NULL)</span>
<span class='curline'><a href='../S/1410.html#L57'>session</a>            57 doc/examples/ex-session-info.c                                gnutls_psk_server_get_username(session));</span>
<span class='curline'><a href='../S/1410.html#L87'>session</a>            87 doc/examples/ex-session-info.c                 print_x509_certificate_info(session);</span>
<span class='curline'><a href='../S/1410.html#L94'>session</a>            94 doc/examples/ex-session-info.c         group = gnutls_group_get(session);</span>
<span class='curline'><a href='../S/1410.html#L102'>session</a>           102 doc/examples/ex-session-info.c                                                          (session)));</span>
<span class='curline'><a href='../S/1410.html#L105'>session</a>           105 doc/examples/ex-session-info.c                                gnutls_dh_get_prime_bits(session));</span>
<span class='curline'><a href='../S/1431.html#L22'>session</a>            22 doc/examples/ex-verify-ssh.c int _ssh_verify_certificate_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/1431.html#L32'>session</a>            32 doc/examples/ex-verify-ssh.c         hostname = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/1431.html#L37'>session</a>            37 doc/examples/ex-verify-ssh.c         CHECK(gnutls_certificate_verify_peers3(session, hostname, &amp;status));</span>
<span class='curline'><a href='../S/1431.html#L39'>session</a>            39 doc/examples/ex-verify-ssh.c         type = gnutls_certificate_type_get(session);</span>
<span class='curline'><a href='../S/1431.html#L51'>session</a>            51 doc/examples/ex-verify-ssh.c         cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/1408.html#L36'>session</a>            36 doc/examples/ex-x509-info.c void print_x509_certificate_info(gnutls_session_t session)</span>
<span class='curline'><a href='../S/1408.html#L50'>session</a>            50 doc/examples/ex-x509-info.c         if (gnutls_certificate_type_get(session) != GNUTLS_CRT_X509)</span>
<span class='curline'><a href='../S/1408.html#L53'>session</a>            53 doc/examples/ex-x509-info.c         cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/1440.html#L4'>session</a>             4 doc/examples/examples.h void check_alert(gnutls_session_t session, int ret);</span>
<span class='curline'><a href='../S/1440.html#L9'>session</a>             9 doc/examples/examples.h void verify_certificate(gnutls_session_t session, const char *hostname);</span>
<span class='curline'><a href='../S/1440.html#L11'>session</a>            11 doc/examples/examples.h int print_info(gnutls_session_t session);</span>
<span class='curline'><a href='../S/1440.html#L13'>session</a>            13 doc/examples/examples.h void print_x509_certificate_info(gnutls_session_t session);</span>
<span class='curline'><a href='../S/1440.html#L15'>session</a>            15 doc/examples/examples.h int _ssh_verify_certificate_callback(gnutls_session_t session);</span>
<span class='curline'><a href='../S/1440.html#L22'>session</a>            22 doc/examples/examples.h int verify_certificate_callback(gnutls_session_t session);</span>
<span class='curline'><a href='../S/1424.html#L55'>session</a>            55 doc/examples/tlsproxy/crypto-gnutls.c   gnutls_session_t session;</span>
<span class='curline'><a href='../S/1424.html#L125'>session</a>           125 doc/examples/tlsproxy/crypto-gnutls.c verify_certificate_callback (gnutls_session_t session)</span>
<span class='curline'><a href='../S/1424.html#L132'>session</a>           132 doc/examples/tlsproxy/crypto-gnutls.c   s = (tlssession_t *) gnutls_session_get_ptr (session);</span>
<span class='curline'><a href='../S/1424.html#L134'>session</a>           134 doc/examples/tlsproxy/crypto-gnutls.c   if (gnutls_certificate_type_get (session) != GNUTLS_CRT_X509)</span>
<span class='curline'><a href='../S/1424.html#L141'>session</a>           141 doc/examples/tlsproxy/crypto-gnutls.c     ret = gnutls_certificate_verify_peers3 (session, s-&gt;hostname, &amp;status);</span>
<span class='curline'><a href='../S/1424.html#L143'>session</a>           143 doc/examples/tlsproxy/crypto-gnutls.c     ret = gnutls_certificate_verify_peers2 (session, &amp;status);</span>
<span class='curline'><a href='../S/1424.html#L245'>session</a>           245 doc/examples/tlsproxy/crypto-gnutls.c     ret = gnutls_init (&amp;s-&gt;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/1424.html#L247'>session</a>           247 doc/examples/tlsproxy/crypto-gnutls.c     ret = gnutls_init (&amp;s-&gt;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/1424.html#L256'>session</a>           256 doc/examples/tlsproxy/crypto-gnutls.c   gnutls_session_set_ptr (s-&gt;session, (void *) s);</span>
<span class='curline'><a href='../S/1424.html#L260'>session</a>           260 doc/examples/tlsproxy/crypto-gnutls.c       ret = gnutls_server_name_set (s-&gt;session, GNUTLS_NAME_DNS, s-&gt;hostname,</span>
<span class='curline'><a href='../S/1424.html#L270'>session</a>           270 doc/examples/tlsproxy/crypto-gnutls.c   ret = gnutls_set_default_priority (s-&gt;session);</span>
<span class='curline'><a href='../S/1424.html#L278'>session</a>           278 doc/examples/tlsproxy/crypto-gnutls.c   ret = gnutls_credentials_set (s-&gt;session, GNUTLS_CRD_CERTIFICATE, s-&gt;creds);</span>
<span class='curline'><a href='../S/1424.html#L289'>session</a>           289 doc/examples/tlsproxy/crypto-gnutls.c       gnutls_certificate_server_set_request (s-&gt;session, GNUTLS_CERT_REQUEST);</span>
<span class='curline'><a href='../S/1424.html#L296'>session</a>           296 doc/examples/tlsproxy/crypto-gnutls.c   if (s-&gt;session)</span>
<span class='curline'><a href='../S/1424.html#L297'>session</a>           297 doc/examples/tlsproxy/crypto-gnutls.c     gnutls_deinit (s-&gt;session);</span>
<span class='curline'><a href='../S/1424.html#L305'>session</a>           305 doc/examples/tlsproxy/crypto-gnutls.c   if (s-&gt;session)</span>
<span class='curline'><a href='../S/1424.html#L306'>session</a>           306 doc/examples/tlsproxy/crypto-gnutls.c     gnutls_deinit (s-&gt;session);</span>
<span class='curline'><a href='../S/1424.html#L339'>session</a>           339 doc/examples/tlsproxy/crypto-gnutls.c   gnutls_transport_set_ptr (s-&gt;session,</span>
<span class='curline'><a href='../S/1424.html#L344'>session</a>           344 doc/examples/tlsproxy/crypto-gnutls.c   ret = gnutls_handshake (s-&gt;session);</span>
<span class='curline'><a href='../S/1424.html#L375'>session</a>           375 doc/examples/tlsproxy/crypto-gnutls.c       size_t buffered = gnutls_record_check_pending (s-&gt;session);</span>
<span class='curline'><a href='../S/1424.html#L502'>session</a>           502 doc/examples/tlsproxy/crypto-gnutls.c 		  ret = gnutls_record_recv (s-&gt;session, addr, (size_t) len);</span>
<span class='curline'><a href='../S/1424.html#L542'>session</a>           542 doc/examples/tlsproxy/crypto-gnutls.c 		      ret = gnutls_record_send (s-&gt;session, NULL, 0);</span>
<span class='curline'><a href='../S/1424.html#L546'>session</a>           546 doc/examples/tlsproxy/crypto-gnutls.c 		      ret = gnutls_record_send (s-&gt;session, addr, len);</span>
<span class='curline'><a href='../S/1424.html#L580'>session</a>           580 doc/examples/tlsproxy/crypto-gnutls.c   gnutls_bye (s-&gt;session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/1425.html#L41'>session</a>            41 doc/examples/tlsproxy/crypto-gnutls.h int tlssession_mainloop (int cryptfd, int plainfd, tlssession_t * session);</span>
<span class='curline'><a href='../S/1427.html#L200'>session</a>           200 doc/examples/tlsproxy/tlsproxy.c   tlssession_t *session =</span>
<span class='curline'><a href='../S/1427.html#L203'>session</a>           203 doc/examples/tlsproxy/tlsproxy.c   if (!session)</span>
<span class='curline'><a href='../S/1427.html#L213'>session</a>           213 doc/examples/tlsproxy/tlsproxy.c     ret = tlssession_mainloop (acceptfd, connectfd, session);</span>
<span class='curline'><a href='../S/1427.html#L215'>session</a>           215 doc/examples/tlsproxy/tlsproxy.c     ret = tlssession_mainloop (connectfd, acceptfd, session);</span>
<span class='curline'><a href='../S/1427.html#L217'>session</a>           217 doc/examples/tlsproxy/tlsproxy.c   tlssession_close (session);</span>
<span class='curline'><a href='../S/1418.html#L17'>session</a>            17 doc/examples/verify.c int verify_certificate_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/1418.html#L26'>session</a>            26 doc/examples/verify.c         hostname = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/1418.html#L38'>session</a>            38 doc/examples/verify.c         ret = gnutls_certificate_verify_peers(session, data, 2,</span>
<span class='curline'><a href='../S/1418.html#L45'>session</a>            45 doc/examples/verify.c         type = gnutls_certificate_type_get(session);</span>
<span class='curline'><a href='../S/4291.html#L36'>session</a>            36 fuzz/gnutls_client_fuzzer.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4291.html#L40'>session</a>            40 fuzz/gnutls_client_fuzzer.c 	res = gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4291.html#L45'>session</a>            45 fuzz/gnutls_client_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4291.html#L49'>session</a>            49 fuzz/gnutls_client_fuzzer.c 	res = gnutls_priority_set_direct(session, "NORMAL:+SIGN-EDDSA-ED448:"VERS_STR, NULL);</span>
<span class='curline'><a href='../S/4291.html#L55'>session</a>            55 fuzz/gnutls_client_fuzzer.c 	gnutls_transport_set_push_function(session, mem_push);</span>
<span class='curline'><a href='../S/4291.html#L56'>session</a>            56 fuzz/gnutls_client_fuzzer.c 	gnutls_transport_set_pull_function(session, mem_pull);</span>
<span class='curline'><a href='../S/4291.html#L57'>session</a>            57 fuzz/gnutls_client_fuzzer.c 	gnutls_transport_set_pull_timeout_function(session, mem_pull_timeout);</span>
<span class='curline'><a href='../S/4291.html#L58'>session</a>            58 fuzz/gnutls_client_fuzzer.c 	gnutls_transport_set_ptr(session, &amp;memdata);</span>
<span class='curline'><a href='../S/4291.html#L61'>session</a>            61 fuzz/gnutls_client_fuzzer.c 		res = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4291.html#L66'>session</a>            66 fuzz/gnutls_client_fuzzer.c 			res = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4291.html#L73'>session</a>            73 fuzz/gnutls_client_fuzzer.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4270.html#L59'>session</a>            59 fuzz/gnutls_client_rawpk_fuzzer.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4270.html#L63'>session</a>            63 fuzz/gnutls_client_rawpk_fuzzer.c 	res = gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_ENABLE_RAWPK);</span>
<span class='curline'><a href='../S/4270.html#L79'>session</a>            79 fuzz/gnutls_client_rawpk_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, rawpk_cred);</span>
<span class='curline'><a href='../S/4270.html#L82'>session</a>            82 fuzz/gnutls_client_rawpk_fuzzer.c 	res = gnutls_priority_set_direct(session, "NORMAL:"VERS_STR":-CTYPE-ALL:+CTYPE-CLI-RAWPK:+CTYPE-SRV-RAWPK", NULL);</span>
<span class='curline'><a href='../S/4270.html#L88'>session</a>            88 fuzz/gnutls_client_rawpk_fuzzer.c 	gnutls_transport_set_push_function(session, mem_push);</span>
<span class='curline'><a href='../S/4270.html#L89'>session</a>            89 fuzz/gnutls_client_rawpk_fuzzer.c 	gnutls_transport_set_pull_function(session, mem_pull);</span>
<span class='curline'><a href='../S/4270.html#L90'>session</a>            90 fuzz/gnutls_client_rawpk_fuzzer.c 	gnutls_transport_set_pull_timeout_function(session, mem_pull_timeout);</span>
<span class='curline'><a href='../S/4270.html#L91'>session</a>            91 fuzz/gnutls_client_rawpk_fuzzer.c 	gnutls_transport_set_ptr(session, &amp;memdata);</span>
<span class='curline'><a href='../S/4270.html#L94'>session</a>            94 fuzz/gnutls_client_rawpk_fuzzer.c 		res = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4270.html#L99'>session</a>            99 fuzz/gnutls_client_rawpk_fuzzer.c 			res = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4270.html#L106'>session</a>           106 fuzz/gnutls_client_rawpk_fuzzer.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4264.html#L41'>session</a>            41 fuzz/gnutls_psk_client_fuzzer.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4264.html#L49'>session</a>            49 fuzz/gnutls_psk_client_fuzzer.c 	res = gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4264.html#L58'>session</a>            58 fuzz/gnutls_psk_client_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_PSK, pcred);</span>
<span class='curline'><a href='../S/4264.html#L61'>session</a>            61 fuzz/gnutls_psk_client_fuzzer.c 	res = gnutls_priority_set_direct(session, "NORMAL:-KX-ALL:+ECDHE-PSK:+DHE-PSK:+PSK:"VERS_STR, NULL);</span>
<span class='curline'><a href='../S/4264.html#L67'>session</a>            67 fuzz/gnutls_psk_client_fuzzer.c 	gnutls_transport_set_push_function(session, mem_push);</span>
<span class='curline'><a href='../S/4264.html#L68'>session</a>            68 fuzz/gnutls_psk_client_fuzzer.c 	gnutls_transport_set_pull_function(session, mem_pull);</span>
<span class='curline'><a href='../S/4264.html#L69'>session</a>            69 fuzz/gnutls_psk_client_fuzzer.c 	gnutls_transport_set_pull_timeout_function(session,</span>
<span class='curline'><a href='../S/4264.html#L71'>session</a>            71 fuzz/gnutls_psk_client_fuzzer.c 	gnutls_transport_set_ptr(session, &amp;memdata);</span>
<span class='curline'><a href='../S/4264.html#L74'>session</a>            74 fuzz/gnutls_psk_client_fuzzer.c 		res = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4264.html#L79'>session</a>            79 fuzz/gnutls_psk_client_fuzzer.c 			res = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4264.html#L86'>session</a>            86 fuzz/gnutls_psk_client_fuzzer.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4266.html#L37'>session</a>            37 fuzz/gnutls_psk_server_fuzzer.c static int psk_cb(gnutls_session_t session, const char *username, gnutls_datum_t * key)</span>
<span class='curline'><a href='../S/4266.html#L55'>session</a>            55 fuzz/gnutls_psk_server_fuzzer.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4266.html#L60'>session</a>            60 fuzz/gnutls_psk_server_fuzzer.c 	res = gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4266.html#L114'>session</a>           114 fuzz/gnutls_psk_server_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4266.html#L117'>session</a>           117 fuzz/gnutls_psk_server_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_PSK, pcred);</span>
<span class='curline'><a href='../S/4266.html#L120'>session</a>           120 fuzz/gnutls_psk_server_fuzzer.c 	res = gnutls_priority_set_direct(session, "NORMAL:-KX-ALL:+ECDHE-PSK:+DHE-PSK:+PSK:+RSA-PSK:"VERS_STR, NULL);</span>
<span class='curline'><a href='../S/4266.html#L126'>session</a>           126 fuzz/gnutls_psk_server_fuzzer.c 	gnutls_transport_set_push_function(session, mem_push);</span>
<span class='curline'><a href='../S/4266.html#L127'>session</a>           127 fuzz/gnutls_psk_server_fuzzer.c 	gnutls_transport_set_pull_function(session, mem_pull);</span>
<span class='curline'><a href='../S/4266.html#L128'>session</a>           128 fuzz/gnutls_psk_server_fuzzer.c 	gnutls_transport_set_pull_timeout_function(session, mem_pull_timeout);</span>
<span class='curline'><a href='../S/4266.html#L129'>session</a>           129 fuzz/gnutls_psk_server_fuzzer.c 	gnutls_transport_set_ptr(session, &amp;memdata);</span>
<span class='curline'><a href='../S/4266.html#L132'>session</a>           132 fuzz/gnutls_psk_server_fuzzer.c 		res = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4266.html#L137'>session</a>           137 fuzz/gnutls_psk_server_fuzzer.c 			res = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4266.html#L144'>session</a>           144 fuzz/gnutls_psk_server_fuzzer.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4289.html#L38'>session</a>            38 fuzz/gnutls_server_fuzzer.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4289.html#L42'>session</a>            42 fuzz/gnutls_server_fuzzer.c 	res = gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4289.html#L90'>session</a>            90 fuzz/gnutls_server_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4289.html#L94'>session</a>            94 fuzz/gnutls_server_fuzzer.c 	res = gnutls_priority_set_direct(session, "NORMAL:+SIGN-EDDSA-ED448:"VERS_STR, NULL);</span>
<span class='curline'><a href='../S/4289.html#L100'>session</a>           100 fuzz/gnutls_server_fuzzer.c 	gnutls_transport_set_push_function(session, mem_push);</span>
<span class='curline'><a href='../S/4289.html#L101'>session</a>           101 fuzz/gnutls_server_fuzzer.c 	gnutls_transport_set_pull_function(session, mem_pull);</span>
<span class='curline'><a href='../S/4289.html#L102'>session</a>           102 fuzz/gnutls_server_fuzzer.c 	gnutls_transport_set_pull_timeout_function(session, mem_pull_timeout);</span>
<span class='curline'><a href='../S/4289.html#L103'>session</a>           103 fuzz/gnutls_server_fuzzer.c 	gnutls_transport_set_ptr(session, &amp;memdata);</span>
<span class='curline'><a href='../S/4289.html#L106'>session</a>           106 fuzz/gnutls_server_fuzzer.c 		res = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4289.html#L111'>session</a>           111 fuzz/gnutls_server_fuzzer.c 			res = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4289.html#L118'>session</a>           118 fuzz/gnutls_server_fuzzer.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4293.html#L55'>session</a>            55 fuzz/gnutls_server_rawpk_fuzzer.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4293.html#L59'>session</a>            59 fuzz/gnutls_server_rawpk_fuzzer.c 	res = gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_ENABLE_RAWPK);</span>
<span class='curline'><a href='../S/4293.html#L75'>session</a>            75 fuzz/gnutls_server_rawpk_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, rawpk_cred);</span>
<span class='curline'><a href='../S/4293.html#L78'>session</a>            78 fuzz/gnutls_server_rawpk_fuzzer.c 	res = gnutls_priority_set_direct(session, "NORMAL:"VERS_STR":-CTYPE-ALL:+CTYPE-CLI-RAWPK:+CTYPE-SRV-RAWPK", NULL);</span>
<span class='curline'><a href='../S/4293.html#L84'>session</a>            84 fuzz/gnutls_server_rawpk_fuzzer.c 	gnutls_transport_set_push_function(session, mem_push);</span>
<span class='curline'><a href='../S/4293.html#L85'>session</a>            85 fuzz/gnutls_server_rawpk_fuzzer.c 	gnutls_transport_set_pull_function(session, mem_pull);</span>
<span class='curline'><a href='../S/4293.html#L86'>session</a>            86 fuzz/gnutls_server_rawpk_fuzzer.c 	gnutls_transport_set_pull_timeout_function(session, mem_pull_timeout);</span>
<span class='curline'><a href='../S/4293.html#L87'>session</a>            87 fuzz/gnutls_server_rawpk_fuzzer.c 	gnutls_transport_set_ptr(session, &amp;memdata);</span>
<span class='curline'><a href='../S/4293.html#L90'>session</a>            90 fuzz/gnutls_server_rawpk_fuzzer.c 		res = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4293.html#L95'>session</a>            95 fuzz/gnutls_server_rawpk_fuzzer.c 			res = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4293.html#L102'>session</a>           102 fuzz/gnutls_server_rawpk_fuzzer.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4290.html#L41'>session</a>            41 fuzz/gnutls_srp_client_fuzzer.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4290.html#L45'>session</a>            45 fuzz/gnutls_srp_client_fuzzer.c 	res = gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4290.html#L54'>session</a>            54 fuzz/gnutls_srp_client_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_SRP, pcred);</span>
<span class='curline'><a href='../S/4290.html#L57'>session</a>            57 fuzz/gnutls_srp_client_fuzzer.c 	res = gnutls_priority_set_direct(session, "NORMAL:-KX-ALL:+SRP:+SRP-RSA:+SRP-DSS", NULL);</span>
<span class='curline'><a href='../S/4290.html#L63'>session</a>            63 fuzz/gnutls_srp_client_fuzzer.c 	gnutls_transport_set_push_function(session, mem_push);</span>
<span class='curline'><a href='../S/4290.html#L64'>session</a>            64 fuzz/gnutls_srp_client_fuzzer.c 	gnutls_transport_set_pull_function(session, mem_pull);</span>
<span class='curline'><a href='../S/4290.html#L65'>session</a>            65 fuzz/gnutls_srp_client_fuzzer.c 	gnutls_transport_set_pull_timeout_function(session,</span>
<span class='curline'><a href='../S/4290.html#L67'>session</a>            67 fuzz/gnutls_srp_client_fuzzer.c 	gnutls_transport_set_ptr(session, &amp;memdata);</span>
<span class='curline'><a href='../S/4290.html#L68'>session</a>            68 fuzz/gnutls_srp_client_fuzzer.c 	gnutls_srp_set_prime_bits(session, 1024);</span>
<span class='curline'><a href='../S/4290.html#L71'>session</a>            71 fuzz/gnutls_srp_client_fuzzer.c 		res = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4290.html#L76'>session</a>            76 fuzz/gnutls_srp_client_fuzzer.c 			res = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4290.html#L83'>session</a>            83 fuzz/gnutls_srp_client_fuzzer.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4285.html#L38'>session</a>            38 fuzz/gnutls_srp_server_fuzzer.c srp_cb(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/4285.html#L69'>session</a>            69 fuzz/gnutls_srp_server_fuzzer.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4285.html#L74'>session</a>            74 fuzz/gnutls_srp_server_fuzzer.c 	res = gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4285.html#L117'>session</a>           117 fuzz/gnutls_srp_server_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4285.html#L120'>session</a>           120 fuzz/gnutls_srp_server_fuzzer.c 	res = gnutls_credentials_set(session, GNUTLS_CRD_SRP, pcred);</span>
<span class='curline'><a href='../S/4285.html#L123'>session</a>           123 fuzz/gnutls_srp_server_fuzzer.c 	res = gnutls_priority_set_direct(session, "NORMAL:-KX-ALL:+SRP:+SRP-RSA:+SRP-DSS", NULL);</span>
<span class='curline'><a href='../S/4285.html#L129'>session</a>           129 fuzz/gnutls_srp_server_fuzzer.c 	gnutls_transport_set_push_function(session, mem_push);</span>
<span class='curline'><a href='../S/4285.html#L130'>session</a>           130 fuzz/gnutls_srp_server_fuzzer.c 	gnutls_transport_set_pull_function(session, mem_pull);</span>
<span class='curline'><a href='../S/4285.html#L131'>session</a>           131 fuzz/gnutls_srp_server_fuzzer.c 	gnutls_transport_set_pull_timeout_function(session, mem_pull_timeout);</span>
<span class='curline'><a href='../S/4285.html#L132'>session</a>           132 fuzz/gnutls_srp_server_fuzzer.c 	gnutls_transport_set_ptr(session, &amp;memdata);</span>
<span class='curline'><a href='../S/4285.html#L135'>session</a>           135 fuzz/gnutls_srp_server_fuzzer.c 		res = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4285.html#L140'>session</a>           140 fuzz/gnutls_srp_server_fuzzer.c 			res = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4285.html#L147'>session</a>           147 fuzz/gnutls_srp_server_fuzzer.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/199.html#L112'>session</a>           112 guile/src/core.c SCM_SMOB_MARK (scm_tc16_gnutls_session, mark_session, session)</span>
<span class='curline'><a href='../S/199.html#L116'>session</a>           116 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, "mark_session");</span>
<span class='curline'><a href='../S/199.html#L165'>session</a>           165 guile/src/core.c             (SCM session, SCM how),</span>
<span class='curline'><a href='../S/199.html#L173'>session</a>           173 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L186'>session</a>           186 guile/src/core.c             (SCM session), "Perform a handshake for @var{session}.")</span>
<span class='curline'><a href='../S/199.html#L192'>session</a>           192 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L204'>session</a>           204 guile/src/core.c             (SCM session), "Perform a re-handshaking for @var{session}.")</span>
<span class='curline'><a href='../S/199.html#L210'>session</a>           210 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L221'>session</a>           221 guile/src/core.c             (SCM session), "Perform a re-authentication step for @var{session}.")</span>
<span class='curline'><a href='../S/199.html#L227'>session</a>           227 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L239'>session</a>           239 guile/src/core.c             (SCM session), "Get an aleter from @var{session}.")</span>
<span class='curline'><a href='../S/199.html#L245'>session</a>           245 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L255'>session</a>           255 guile/src/core.c             (SCM session, SCM level, SCM alert),</span>
<span class='curline'><a href='../S/199.html#L264'>session</a>           264 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L283'>session</a>           283 guile/src/core.c             (SCM session), "Return @var{session}'s cipher.")</span>
<span class='curline'><a href='../S/199.html#L289'>session</a>           289 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L299'>session</a>           299 guile/src/core.c             (SCM session), "Return @var{session}'s kx.")</span>
<span class='curline'><a href='../S/199.html#L305'>session</a>           305 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L315'>session</a>           315 guile/src/core.c             (SCM session), "Return @var{session}'s MAC.")</span>
<span class='curline'><a href='../S/199.html#L321'>session</a>           321 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L332'>session</a>           332 guile/src/core.c             (SCM session), "Return @var{session}'s compression method.")</span>
<span class='curline'><a href='../S/199.html#L338'>session</a>           338 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L349'>session</a>           349 guile/src/core.c             (SCM session), "Return @var{session}'s certificate type.")</span>
<span class='curline'><a href='../S/199.html#L355'>session</a>           355 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L365'>session</a>           365 guile/src/core.c             (SCM session), "Return the protocol used by @var{session}.")</span>
<span class='curline'><a href='../S/199.html#L371'>session</a>           371 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L383'>session</a>           383 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L391'>session</a>           391 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L403'>session</a>           403 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L411'>session</a>           411 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L423'>session</a>           423 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L431'>session</a>           431 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L443'>session</a>           443 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L457'>session</a>           457 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L492'>session</a>           492 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L504'>session</a>           504 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L532'>session</a>           532 guile/src/core.c             (SCM session, SCM request),</span>
<span class='curline'><a href='../S/199.html#L542'>session</a>           542 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L557'>session</a>           557 guile/src/core.c             (SCM session), "Have @var{session} use the default priorities.")</span>
<span class='curline'><a href='../S/199.html#L562'>session</a>           562 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L572'>session</a>           572 guile/src/core.c 	    (SCM session, SCM priorities),</span>
<span class='curline'><a href='../S/199.html#L589'>session</a>           589 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L640'>session</a>           640 guile/src/core.c             (SCM session, SCM cred),</span>
<span class='curline'><a href='../S/199.html#L647'>session</a>           647 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L712'>session</a>           712 guile/src/core.c     register_weak_reference (session, cred);</span>
<span class='curline'><a href='../S/199.html#L721'>session</a>           721 guile/src/core.c 	    (SCM session, SCM type, SCM name),</span>
<span class='curline'><a href='../S/199.html#L734'>session</a>           734 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L755'>session</a>           755 guile/src/core.c             (SCM session, SCM array),</span>
<span class='curline'><a href='../S/199.html#L767'>session</a>           767 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L787'>session</a>           787 guile/src/core.c             (SCM session, SCM array),</span>
<span class='curline'><a href='../S/199.html#L800'>session</a>           800 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L859'>session</a>           859 guile/src/core.c   SCM session;</span>
<span class='curline'><a href='../S/199.html#L862'>session</a>           862 guile/src/core.c   session = SCM_GNUTLS_SESSION_RECORD_PORT_SESSION (port);</span>
<span class='curline'><a href='../S/199.html#L867'>session</a>           867 guile/src/core.c   if (SCM_SMOB_PREDICATE (scm_tc16_gnutls_session, session))</span>
<span class='curline'><a href='../S/199.html#L872'>session</a>           872 guile/src/core.c       c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L941'>session</a>           941 guile/src/core.c       SCM session;</span>
<span class='curline'><a href='../S/199.html#L945'>session</a>           945 guile/src/core.c       session = SCM_GNUTLS_SESSION_RECORD_PORT_SESSION (port);</span>
<span class='curline'><a href='../S/199.html#L946'>session</a>           946 guile/src/core.c       c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L973'>session</a>           973 guile/src/core.c   SCM session;</span>
<span class='curline'><a href='../S/199.html#L978'>session</a>           978 guile/src/core.c   session = SCM_GNUTLS_SESSION_RECORD_PORT_SESSION (port);</span>
<span class='curline'><a href='../S/199.html#L979'>session</a>           979 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L996'>session</a>           996 guile/src/core.c make_session_record_port (SCM session)</span>
<span class='curline'><a href='../S/199.html#L1015'>session</a>          1015 guile/src/core.c   SCM_SETSTREAM (port, SCM_UNPACK (session));</span>
<span class='curline'><a href='../S/199.html#L1032'>session</a>          1032 guile/src/core.c   SCM session;</span>
<span class='curline'><a href='../S/199.html#L1037'>session</a>          1037 guile/src/core.c   session = SCM_GNUTLS_SESSION_RECORD_PORT_SESSION (port);</span>
<span class='curline'><a href='../S/199.html#L1038'>session</a>          1038 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L1074'>session</a>          1074 guile/src/core.c   SCM session;</span>
<span class='curline'><a href='../S/199.html#L1077'>session</a>          1077 guile/src/core.c   session = SCM_GNUTLS_SESSION_RECORD_PORT_SESSION (port);</span>
<span class='curline'><a href='../S/199.html#L1078'>session</a>          1078 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, __func__);</span>
<span class='curline'><a href='../S/199.html#L1089'>session</a>          1089 guile/src/core.c   SCM session;</span>
<span class='curline'><a href='../S/199.html#L1094'>session</a>          1094 guile/src/core.c   session = SCM_GNUTLS_SESSION_RECORD_PORT_SESSION (port);</span>
<span class='curline'><a href='../S/199.html#L1095'>session</a>          1095 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L1109'>session</a>          1109 guile/src/core.c make_session_record_port (SCM session)</span>
<span class='curline'><a href='../S/199.html#L1113'>session</a>          1113 guile/src/core.c 			  SCM_UNPACK (session));</span>
<span class='curline'><a href='../S/199.html#L1120'>session</a>          1120 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L1130'>session</a>          1130 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L1136'>session</a>          1136 guile/src/core.c       port = make_session_record_port (session);</span>
<span class='curline'><a href='../S/199.html#L1176'>session</a>          1176 guile/src/core.c             "set-session-transport-fd!", 2, 0, 0, (SCM session, SCM fd),</span>
<span class='curline'><a href='../S/199.html#L1184'>session</a>          1184 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L1228'>session</a>          1228 guile/src/core.c             (SCM session, SCM port),</span>
<span class='curline'><a href='../S/199.html#L1234'>session</a>          1234 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L1408'>session</a>          1408 guile/src/core.c             (SCM session, SCM bits),</span>
<span class='curline'><a href='../S/199.html#L1415'>session</a>          1415 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L1867'>session</a>          1867 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L1879'>session</a>          1879 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L2041'>session</a>          2041 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L2050'>session</a>          2050 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/199.html#L2281'>session</a>          2281 guile/src/core.c             (SCM session),</span>
<span class='curline'><a href='../S/199.html#L2290'>session</a>          2290 guile/src/core.c   c_session = scm_to_gnutls_session (session, 1, FUNC_NAME);</span>
<span class='curline'><a href='../S/5630.html#L152'>session</a>           152 lib/alert.c    gnutls_alert_send(gnutls_session_t session, gnutls_alert_level_t level,</span>
<span class='curline'><a href='../S/5630.html#L169'>session</a>           169 lib/alert.c    	     _gnutls_send_int(session, GNUTLS_ALERT, -1,</span>
<span class='curline'><a href='../S/5630.html#L369'>session</a>           369 lib/alert.c    int gnutls_alert_send_appropriate(gnutls_session_t session, int err)</span>
<span class='curline'><a href='../S/5630.html#L380'>session</a>           380 lib/alert.c    	return gnutls_alert_send(session, (gnutls_alert_level_t)level, alert);</span>
<span class='curline'><a href='../S/5630.html#L396'>session</a>           396 lib/alert.c    gnutls_alert_description_t gnutls_alert_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5630.html#L398'>session</a>           398 lib/alert.c    	return (gnutls_alert_description_t)session-&gt;internals.last_alert;</span>
<span class='curline'><a href='../S/6029.html#L64'>session</a>            64 lib/algorithms.h const version_entry_st *_gnutls_version_lowest(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6029.html#L66'>session</a>            66 lib/algorithms.h const version_entry_st *_gnutls_legacy_version_max(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6029.html#L67'>session</a>            67 lib/algorithms.h const version_entry_st *_gnutls_version_max(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6029.html#L68'>session</a>            68 lib/algorithms.h int _gnutls_version_priority(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6029.html#L70'>session</a>            70 lib/algorithms.h int _gnutls_nversion_is_supported(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6029.html#L73'>session</a>            73 lib/algorithms.h unsigned _gnutls_version_is_too_high(gnutls_session_t session, uint8_t major, uint8_t minor);</span>
<span class='curline'><a href='../S/6029.html#L75'>session</a>            75 lib/algorithms.h int _gnutls_write_supported_versions(gnutls_session_t session, uint8_t *buffer, ssize_t buffer_size);</span>
<span class='curline'><a href='../S/6029.html#L79'>session</a>            79 lib/algorithms.h _gnutls_figure_common_ciphersuite(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6029.html#L205'>session</a>           205 lib/algorithms.h int _gnutls_get_client_ciphersuites(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6029.html#L209'>session</a>           209 lib/algorithms.h int _gnutls_supported_ciphersuites(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6029.html#L316'>session</a>           316 lib/algorithms.h bool _gnutls_kx_allows_false_start(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5251.html#L1250'>session</a>          1250 lib/algorithms/ciphersuites.c check_server_dh_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5251.html#L1260'>session</a>          1260 lib/algorithms/ciphersuites.c 	if (session-&gt;internals.hsk_flags &amp; HSK_HAVE_FFDHE) {</span>
<span class='curline'><a href='../S/5251.html#L1272'>session</a>          1272 lib/algorithms/ciphersuites.c 		    _gnutls_get_cred(session, cred_type);</span>
<span class='curline'><a href='../S/5251.html#L1282'>session</a>          1282 lib/algorithms/ciphersuites.c 		    _gnutls_get_cred(session, cred_type);</span>
<span class='curline'><a href='../S/5251.html#L1292'>session</a>          1292 lib/algorithms/ciphersuites.c 		    _gnutls_get_cred(session, cred_type);</span>
<span class='curline'><a href='../S/5251.html#L1425'>session</a>          1425 lib/algorithms/ciphersuites.c 			if (session-&gt;internals.priorities-&gt;force_etm &amp;&amp; !have_etm) { \</span>
<span class='curline'><a href='../S/5251.html#L1434'>session</a>          1434 lib/algorithms/ciphersuites.c 		if (!_gnutls_get_cred(session, GNUTLS_CRD_SRP)) { \</span>
<span class='curline'><a href='../S/5251.html#L1439'>session</a>          1439 lib/algorithms/ciphersuites.c static unsigned kx_is_ok(gnutls_session_t session, gnutls_kx_algorithm_t kx, unsigned cred_type,</span>
<span class='curline'><a href='../S/5251.html#L1443'>session</a>          1443 lib/algorithms/ciphersuites.c 		if (session-&gt;internals.cand_ec_group == NULL) {</span>
<span class='curline'><a href='../S/5251.html#L1446'>session</a>          1446 lib/algorithms/ciphersuites.c 			*sgroup = session-&gt;internals.cand_ec_group;</span>
<span class='curline'><a href='../S/5251.html#L1449'>session</a>          1449 lib/algorithms/ciphersuites.c 		if (session-&gt;internals.cand_dh_group == NULL) {</span>
<span class='curline'><a href='../S/5251.html#L1450'>session</a>          1450 lib/algorithms/ciphersuites.c 			if (!check_server_dh_params(session, cred_type, kx)) {</span>
<span class='curline'><a href='../S/5251.html#L1454'>session</a>          1454 lib/algorithms/ciphersuites.c 			*sgroup = session-&gt;internals.cand_dh_group;</span>
<span class='curline'><a href='../S/5251.html#L1464'>session</a>          1464 lib/algorithms/ciphersuites.c _gnutls_figure_common_ciphersuite(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5251.html#L1471'>session</a>          1471 lib/algorithms/ciphersuites.c 	const version_entry_st *version = get_version(session);</span>
<span class='curline'><a href='../S/5251.html#L1472'>session</a>          1472 lib/algorithms/ciphersuites.c 	unsigned int is_dtls = IS_DTLS(session);</span>
<span class='curline'><a href='../S/5251.html#L1486'>session</a>          1486 lib/algorithms/ciphersuites.c 	ret = _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_ETM, &amp;epriv);</span>
<span class='curline'><a href='../S/5251.html#L1494'>session</a>          1494 lib/algorithms/ciphersuites.c 	if (!version-&gt;tls13_sem &amp;&amp; session-&gt;internals.cand_ec_group == NULL &amp;&amp;</span>
<span class='curline'><a href='../S/5251.html#L1495'>session</a>          1495 lib/algorithms/ciphersuites.c 	    !_gnutls_hello_ext_is_present(session, GNUTLS_EXTENSION_SUPPORTED_GROUPS)) {</span>
<span class='curline'><a href='../S/5251.html#L1496'>session</a>          1496 lib/algorithms/ciphersuites.c 		session-&gt;internals.cand_ec_group = _gnutls_id_to_group(DEFAULT_EC_GROUP);</span>
<span class='curline'><a href='../S/5251.html#L1499'>session</a>          1499 lib/algorithms/ciphersuites.c 	if (session-&gt;internals.priorities-&gt;server_precedence == 0) {</span>
<span class='curline'><a href='../S/5251.html#L1514'>session</a>          1514 lib/algorithms/ciphersuites.c 			for (j = 0; j &lt; session-&gt;internals.priorities-&gt;cs.size; j++) {</span>
<span class='curline'><a href='../S/5251.html#L1515'>session</a>          1515 lib/algorithms/ciphersuites.c 				if (session-&gt;internals.priorities-&gt;cs.entry[j] == peer_clist-&gt;entry[i]) {</span>
<span class='curline'><a href='../S/5251.html#L1517'>session</a>          1517 lib/algorithms/ciphersuites.c 					if (!kx_is_ok(session, kx, cred_type, &amp;sgroup))</span>
<span class='curline'><a href='../S/5251.html#L1522'>session</a>          1522 lib/algorithms/ciphersuites.c 					if (session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED) {</span>
<span class='curline'><a href='../S/5251.html#L1523'>session</a>          1523 lib/algorithms/ciphersuites.c 						if (session-&gt;key.binders[0].prf-&gt;id != session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;prf)</span>
<span class='curline'><a href='../S/5251.html#L1526'>session</a>          1526 lib/algorithms/ciphersuites.c 						ret = _gnutls_select_server_cert(session, peer_clist-&gt;entry[i]);</span>
<span class='curline'><a href='../S/5251.html#L1536'>session</a>          1536 lib/algorithms/ciphersuites.c 						_gnutls_session_group_set(session, sgroup);</span>
<span class='curline'><a href='../S/5251.html#L1543'>session</a>          1543 lib/algorithms/ciphersuites.c 		for (j = 0; j &lt; session-&gt;internals.priorities-&gt;cs.size; j++) {</span>
<span class='curline'><a href='../S/5251.html#L1544'>session</a>          1544 lib/algorithms/ciphersuites.c 			VERSION_CHECK(session-&gt;internals.priorities-&gt;cs.entry[j]);</span>
<span class='curline'><a href='../S/5251.html#L1546'>session</a>          1546 lib/algorithms/ciphersuites.c 			CIPHER_CHECK(session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;block_algorithm);</span>
<span class='curline'><a href='../S/5251.html#L1554'>session</a>          1554 lib/algorithms/ciphersuites.c 				if (session-&gt;internals.priorities-&gt;cs.entry[j] == peer_clist-&gt;entry[i]) {</span>
<span class='curline'><a href='../S/5251.html#L1561'>session</a>          1561 lib/algorithms/ciphersuites.c 					if (!kx_is_ok(session, kx, cred_type, &amp;sgroup))</span>
<span class='curline'><a href='../S/5251.html#L1566'>session</a>          1566 lib/algorithms/ciphersuites.c 					if (session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED) {</span>
<span class='curline'><a href='../S/5251.html#L1567'>session</a>          1567 lib/algorithms/ciphersuites.c 						if (session-&gt;key.binders[0].prf-&gt;id != session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;prf)</span>
<span class='curline'><a href='../S/5251.html#L1570'>session</a>          1570 lib/algorithms/ciphersuites.c 						ret = _gnutls_select_server_cert(session, peer_clist-&gt;entry[i]);</span>
<span class='curline'><a href='../S/5251.html#L1580'>session</a>          1580 lib/algorithms/ciphersuites.c 						_gnutls_session_group_set(session, sgroup);</span>
<span class='curline'><a href='../S/5251.html#L1605'>session</a>          1605 lib/algorithms/ciphersuites.c _gnutls_get_client_ciphersuites(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5251.html#L1613'>session</a>          1613 lib/algorithms/ciphersuites.c 	unsigned int is_dtls = IS_DTLS(session);</span>
<span class='curline'><a href='../S/5251.html#L1621'>session</a>          1621 lib/algorithms/ciphersuites.c 	vmax = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5251.html#L1625'>session</a>          1625 lib/algorithms/ciphersuites.c 	for (j = 0; j &lt; session-&gt;internals.priorities-&gt;cs.size; j++) {</span>
<span class='curline'><a href='../S/5251.html#L1626'>session</a>          1626 lib/algorithms/ciphersuites.c 		CLIENT_VERSION_CHECK(vmin, vmax, session-&gt;internals.priorities-&gt;cs.entry[j]);</span>
<span class='curline'><a href='../S/5251.html#L1628'>session</a>          1628 lib/algorithms/ciphersuites.c 		kx = session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5251.html#L1632'>session</a>          1632 lib/algorithms/ciphersuites.c 			if (!session-&gt;internals.premaster_set &amp;&amp; _gnutls_get_cred(session, cred_type) == NULL)</span>
<span class='curline'><a href='../S/5251.html#L1639'>session</a>          1639 lib/algorithms/ciphersuites.c 				(unsigned)session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;id[0],</span>
<span class='curline'><a href='../S/5251.html#L1640'>session</a>          1640 lib/algorithms/ciphersuites.c 				(unsigned)session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;id[1],</span>
<span class='curline'><a href='../S/5251.html#L1641'>session</a>          1641 lib/algorithms/ciphersuites.c 				session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;name);</span>
<span class='curline'><a href='../S/5251.html#L1642'>session</a>          1642 lib/algorithms/ciphersuites.c 		cipher_suites[cipher_suites_size] = session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;id[0];</span>
<span class='curline'><a href='../S/5251.html#L1643'>session</a>          1643 lib/algorithms/ciphersuites.c 		cipher_suites[cipher_suites_size + 1] = session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;id[1];</span>
<span class='curline'><a href='../S/5251.html#L1655'>session</a>          1655 lib/algorithms/ciphersuites.c 		ret = _gnutls_ext_sr_send_cs(session);</span>
<span class='curline'><a href='../S/5251.html#L1659'>session</a>          1659 lib/algorithms/ciphersuites.c 		_gnutls_hello_ext_save_sr(session);</span>
<span class='curline'><a href='../S/5251.html#L1663'>session</a>          1663 lib/algorithms/ciphersuites.c 	if (session-&gt;internals.priorities-&gt;fallback) {</span>
<span class='curline'><a href='../S/5250.html#L251'>session</a>           251 lib/algorithms/kx.c bool _gnutls_kx_allows_false_start(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5250.html#L253'>session</a>           253 lib/algorithms/kx.c 	unsigned algorithm = session-&gt;security_parameters.cs-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5250.html#L263'>session</a>           263 lib/algorithms/kx.c 		e = get_group(session);</span>
<span class='curline'><a href='../S/5250.html#L272'>session</a>           272 lib/algorithms/kx.c 			} else if (gnutls_dh_get_prime_bits(session) &lt; bits)</span>
<span class='curline'><a href='../S/5246.html#L192'>session</a>           192 lib/algorithms/protocols.c version_is_valid_for_session(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5246.html#L195'>session</a>           195 lib/algorithms/protocols.c 	if (v-&gt;supported &amp;&amp; v-&gt;transport == session-&gt;internals.transport) {</span>
<span class='curline'><a href='../S/5246.html#L218'>session</a>           218 lib/algorithms/protocols.c _gnutls_version_priority(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5246.html#L223'>session</a>           223 lib/algorithms/protocols.c 	for (i = 0; i &lt; session-&gt;internals.priorities-&gt;protocol.num_priorities;</span>
<span class='curline'><a href='../S/5246.html#L225'>session</a>           225 lib/algorithms/protocols.c 		if (session-&gt;internals.priorities-&gt;protocol.priorities[i] ==</span>
<span class='curline'><a href='../S/5246.html#L234'>session</a>           234 lib/algorithms/protocols.c const version_entry_st *_gnutls_version_lowest(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5246.html#L241'>session</a>           241 lib/algorithms/protocols.c 	for (i=0;i &lt; session-&gt;internals.priorities-&gt;protocol.num_priorities;i++) {</span>
<span class='curline'><a href='../S/5246.html#L243'>session</a>           243 lib/algorithms/protocols.c 		    session-&gt;internals.priorities-&gt;protocol.priorities[i];</span>
<span class='curline'><a href='../S/5246.html#L246'>session</a>           246 lib/algorithms/protocols.c 		if (v != NULL &amp;&amp; version_is_valid_for_session(session, v)) {</span>
<span class='curline'><a href='../S/5246.html#L266'>session</a>           266 lib/algorithms/protocols.c const version_entry_st *_gnutls_version_max(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5246.html#L272'>session</a>           272 lib/algorithms/protocols.c 	for (i = 0; i &lt; session-&gt;internals.priorities-&gt;protocol.num_priorities;</span>
<span class='curline'><a href='../S/5246.html#L275'>session</a>           275 lib/algorithms/protocols.c 		    session-&gt;internals.priorities-&gt;protocol.priorities[i];</span>
<span class='curline'><a href='../S/5246.html#L283'>session</a>           283 lib/algorithms/protocols.c 				if (!p-&gt;supported || p-&gt;transport != session-&gt;internals.transport)</span>
<span class='curline'><a href='../S/5246.html#L286'>session</a>           286 lib/algorithms/protocols.c 				if (p-&gt;tls13_sem &amp;&amp; (session-&gt;internals.flags &amp; INT_FLAG_NO_TLS13))</span>
<span class='curline'><a href='../S/5246.html#L301'>session</a>           301 lib/algorithms/protocols.c const version_entry_st *_gnutls_legacy_version_max(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5246.html#L303'>session</a>           303 lib/algorithms/protocols.c 	const version_entry_st *max = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5246.html#L321'>session</a>           321 lib/algorithms/protocols.c int _gnutls_write_supported_versions(gnutls_session_t session, uint8_t *buffer, ssize_t buffer_size)</span>
<span class='curline'><a href='../S/5246.html#L329'>session</a>           329 lib/algorithms/protocols.c 	for (i = 0; i &lt; session-&gt;internals.priorities-&gt;protocol.num_priorities; i++) {</span>
<span class='curline'><a href='../S/5246.html#L331'>session</a>           331 lib/algorithms/protocols.c 		    session-&gt;internals.priorities-&gt;protocol.priorities[i];</span>
<span class='curline'><a href='../S/5246.html#L338'>session</a>           338 lib/algorithms/protocols.c 				if (!p-&gt;supported || p-&gt;transport != session-&gt;internals.transport)</span>
<span class='curline'><a href='../S/5246.html#L374'>session</a>           374 lib/algorithms/protocols.c unsigned _gnutls_version_is_too_high(gnutls_session_t session, uint8_t major, uint8_t minor)</span>
<span class='curline'><a href='../S/5246.html#L378'>session</a>           378 lib/algorithms/protocols.c 	e = _gnutls_legacy_version_max(session);</span>
<span class='curline'><a href='../S/5246.html#L488'>session</a>           488 lib/algorithms/protocols.c _gnutls_nversion_is_supported(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5246.html#L499'>session</a>           499 lib/algorithms/protocols.c 			if (p-&gt;tls13_sem &amp;&amp; (session-&gt;internals.flags &amp; INT_FLAG_NO_TLS13))</span>
<span class='curline'><a href='../S/5246.html#L502'>session</a>           502 lib/algorithms/protocols.c 			if (!p-&gt;supported || p-&gt;transport != session-&gt;internals.transport)</span>
<span class='curline'><a href='../S/5246.html#L513'>session</a>           513 lib/algorithms/protocols.c 	if (_gnutls_version_priority(session, version) &lt; 0)</span>
<span class='curline'><a href='../S/5749.html#L45'>session</a>            45 lib/auth.c     void gnutls_credentials_clear(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5749.html#L47'>session</a>            47 lib/auth.c     	if (session-&gt;key.cred) {	/* beginning of the list */</span>
<span class='curline'><a href='../S/5749.html#L49'>session</a>            49 lib/auth.c     		ccred = session-&gt;key.cred;</span>
<span class='curline'><a href='../S/5749.html#L55'>session</a>            55 lib/auth.c     		session-&gt;key.cred = NULL;</span>
<span class='curline'><a href='../S/5749.html#L94'>session</a>            94 lib/auth.c     gnutls_credentials_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5749.html#L100'>session</a>           100 lib/auth.c     	if (session-&gt;key.cred == NULL) {	/* beginning of the list */</span>
<span class='curline'><a href='../S/5749.html#L102'>session</a>           102 lib/auth.c     		session-&gt;key.cred = gnutls_malloc(sizeof(auth_cred_st));</span>
<span class='curline'><a href='../S/5749.html#L103'>session</a>           103 lib/auth.c     		if (session-&gt;key.cred == NULL)</span>
<span class='curline'><a href='../S/5749.html#L107'>session</a>           107 lib/auth.c     		session-&gt;key.cred-&gt;credentials = cred;</span>
<span class='curline'><a href='../S/5749.html#L109'>session</a>           109 lib/auth.c     		session-&gt;key.cred-&gt;next = NULL;</span>
<span class='curline'><a href='../S/5749.html#L110'>session</a>           110 lib/auth.c     		session-&gt;key.cred-&gt;algorithm = type;</span>
<span class='curline'><a href='../S/5749.html#L112'>session</a>           112 lib/auth.c     		ccred = session-&gt;key.cred;</span>
<span class='curline'><a href='../S/5749.html#L150'>session</a>           150 lib/auth.c     				key_usage = get_key_usage(session, c-&gt;certs[i].cert_list[0].pubkey);</span>
<span class='curline'><a href='../S/5749.html#L157'>session</a>           157 lib/auth.c     			if (session-&gt;security_parameters.entity == GNUTLS_SERVER &amp;&amp;</span>
<span class='curline'><a href='../S/5749.html#L163'>session</a>           163 lib/auth.c     				session-&gt;internals.flags |= INT_FLAG_NO_TLS13;</span>
<span class='curline'><a href='../S/5749.html#L196'>session</a>           196 lib/auth.c     gnutls_credentials_get(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5749.html#L201'>session</a>           201 lib/auth.c     	_cred = _gnutls_get_cred(session, type);</span>
<span class='curline'><a href='../S/5749.html#L229'>session</a>           229 lib/auth.c     gnutls_credentials_type_t gnutls_auth_get_type(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5749.html#L231'>session</a>           231 lib/auth.c     	if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5749.html#L232'>session</a>           232 lib/auth.c     		return gnutls_auth_client_get_type(session);</span>
<span class='curline'><a href='../S/5749.html#L234'>session</a>           234 lib/auth.c     		return gnutls_auth_server_get_type(session);</span>
<span class='curline'><a href='../S/5749.html#L252'>session</a>           252 lib/auth.c     gnutls_auth_server_get_type(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5749.html#L254'>session</a>           254 lib/auth.c     	return session-&gt;security_parameters.server_auth_type;</span>
<span class='curline'><a href='../S/5749.html#L272'>session</a>           272 lib/auth.c     gnutls_auth_client_get_type(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5749.html#L274'>session</a>           274 lib/auth.c     	return session-&gt;security_parameters.client_auth_type;</span>
<span class='curline'><a href='../S/5749.html#L282'>session</a>           282 lib/auth.c     const void *_gnutls_get_kx_cred(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5749.html#L286'>session</a>           286 lib/auth.c     	    session-&gt;security_parameters.entity == GNUTLS_SERVER ? 1 : 0;</span>
<span class='curline'><a href='../S/5749.html#L288'>session</a>           288 lib/auth.c     	return _gnutls_get_cred(session,</span>
<span class='curline'><a href='../S/5749.html#L292'>session</a>           292 lib/auth.c     const void *_gnutls_get_cred(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5749.html#L296'>session</a>           296 lib/auth.c     	gnutls_key_st *key = &amp;session-&gt;key;</span>
<span class='curline'><a href='../S/5749.html#L319'>session</a>           319 lib/auth.c     void _gnutls_free_auth_info(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5749.html#L323'>session</a>           323 lib/auth.c     	if (session == NULL) {</span>
<span class='curline'><a href='../S/5749.html#L328'>session</a>           328 lib/auth.c     	switch (session-&gt;key.auth_info_type) {</span>
<span class='curline'><a href='../S/5749.html#L335'>session</a>           335 lib/auth.c     			    _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5749.html#L348'>session</a>           348 lib/auth.c     			    _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5749.html#L363'>session</a>           363 lib/auth.c     			    _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5749.html#L394'>session</a>           394 lib/auth.c     	gnutls_free(session-&gt;key.auth_info);</span>
<span class='curline'><a href='../S/5749.html#L395'>session</a>           395 lib/auth.c     	session-&gt;key.auth_info_size = 0;</span>
<span class='curline'><a href='../S/5749.html#L396'>session</a>           396 lib/auth.c     	session-&gt;key.auth_info_type = 0;</span>
<span class='curline'><a href='../S/5749.html#L407'>session</a>           407 lib/auth.c     _gnutls_auth_info_init(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5749.html#L411'>session</a>           411 lib/auth.c     	if (session-&gt;key.auth_info == NULL) {</span>
<span class='curline'><a href='../S/5749.html#L412'>session</a>           412 lib/auth.c     		session-&gt;key.auth_info = gnutls_calloc(1, size);</span>
<span class='curline'><a href='../S/5749.html#L413'>session</a>           413 lib/auth.c     		if (session-&gt;key.auth_info == NULL) {</span>
<span class='curline'><a href='../S/5749.html#L417'>session</a>           417 lib/auth.c     		session-&gt;key.auth_info_type = type;</span>
<span class='curline'><a href='../S/5749.html#L418'>session</a>           418 lib/auth.c     		session-&gt;key.auth_info_size = size;</span>
<span class='curline'><a href='../S/5749.html#L427'>session</a>           427 lib/auth.c     			if (type != session-&gt;key.auth_info_type) {</span>
<span class='curline'><a href='../S/5749.html#L438'>session</a>           438 lib/auth.c     			if (type != session-&gt;key.auth_info_type) {</span>
<span class='curline'><a href='../S/5749.html#L440'>session</a>           440 lib/auth.c     				_gnutls_free_auth_info(session);</span>
<span class='curline'><a href='../S/5749.html#L442'>session</a>           442 lib/auth.c     				session-&gt;key.auth_info = calloc(1, size);</span>
<span class='curline'><a href='../S/5749.html#L443'>session</a>           443 lib/auth.c     				if (session-&gt;key.auth_info == NULL) {</span>
<span class='curline'><a href='../S/5749.html#L448'>session</a>           448 lib/auth.c     				session-&gt;key.auth_info_type = type;</span>
<span class='curline'><a href='../S/5749.html#L449'>session</a>           449 lib/auth.c     				session-&gt;key.auth_info_size = size;</span>
<span class='curline'><a href='../S/5289.html#L56'>session</a>            56 lib/auth.h     const void *_gnutls_get_cred(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5289.html#L58'>session</a>            58 lib/auth.h     const void *_gnutls_get_kx_cred(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5289.html#L60'>session</a>            60 lib/auth.h     int _gnutls_auth_info_init(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5289.html#L78'>session</a>            78 lib/auth.h     void *_gnutls_get_auth_info(gnutls_session_t session, gnutls_credentials_type_t type)</span>
<span class='curline'><a href='../S/5289.html#L80'>session</a>            80 lib/auth.h     	if (type == session-&gt;key.auth_info_type)</span>
<span class='curline'><a href='../S/5289.html#L81'>session</a>            81 lib/auth.h     		return session-&gt;key.auth_info;</span>
<span class='curline'><a href='../S/5318.html#L64'>session</a>            64 lib/auth/anon.c gen_anon_server_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5318.html#L70'>session</a>            70 lib/auth/anon.c 	    _gnutls_get_cred(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5318.html#L77'>session</a>            77 lib/auth/anon.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_ANON,</span>
<span class='curline'><a href='../S/5318.html#L83'>session</a>            83 lib/auth/anon.c 	ret = _gnutls_figure_dh_params(session, cred-&gt;dh_params, cred-&gt;params_func, cred-&gt;dh_sec_param);</span>
<span class='curline'><a href='../S/5318.html#L89'>session</a>            89 lib/auth/anon.c 	    _gnutls_dh_common_print_server_kx(session, data);</span>
<span class='curline'><a href='../S/5318.html#L99'>session</a>            99 lib/auth/anon.c proc_anon_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5318.html#L103'>session</a>           103 lib/auth/anon.c 	    _gnutls_proc_dh_common_client_kx(session, data, _data_size, NULL);</span>
<span class='curline'><a href='../S/5318.html#L108'>session</a>           108 lib/auth/anon.c proc_anon_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5318.html#L116'>session</a>           116 lib/auth/anon.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_ANON,</span>
<span class='curline'><a href='../S/5318.html#L122'>session</a>           122 lib/auth/anon.c 	ret = _gnutls_proc_dh_common_server_kx(session, data, _data_size);</span>
<span class='curline'><a href='../S/5310.html#L64'>session</a>            64 lib/auth/anon_ecdh.c gen_anon_ecdh_server_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5310.html#L70'>session</a>            70 lib/auth/anon_ecdh.c 	    _gnutls_get_cred(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5310.html#L77'>session</a>            77 lib/auth/anon_ecdh.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_ANON,</span>
<span class='curline'><a href='../S/5310.html#L84'>session</a>            84 lib/auth/anon_ecdh.c 	    _gnutls_ecdh_common_print_server_kx(session, data,</span>
<span class='curline'><a href='../S/5310.html#L86'>session</a>            86 lib/auth/anon_ecdh.c 						(session));</span>
<span class='curline'><a href='../S/5310.html#L96'>session</a>            96 lib/auth/anon_ecdh.c proc_anon_ecdh_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5310.html#L102'>session</a>           102 lib/auth/anon_ecdh.c 	    _gnutls_get_cred(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5310.html#L108'>session</a>           108 lib/auth/anon_ecdh.c 	return _gnutls_proc_ecdh_common_client_kx(session, data,</span>
<span class='curline'><a href='../S/5310.html#L111'>session</a>           111 lib/auth/anon_ecdh.c 						  (session), NULL);</span>
<span class='curline'><a href='../S/5310.html#L115'>session</a>           115 lib/auth/anon_ecdh.c proc_anon_ecdh_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5310.html#L123'>session</a>           123 lib/auth/anon_ecdh.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_ANON,</span>
<span class='curline'><a href='../S/5310.html#L130'>session</a>           130 lib/auth/anon_ecdh.c 	    _gnutls_proc_ecdh_common_server_kx(session, data, _data_size);</span>
<span class='curline'><a href='../S/5329.html#L51'>session</a>            51 lib/auth/cert.c selected_certs_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L176'>session</a>           176 lib/auth/cert.c find_x509_client_cert(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L197'>session</a>           197 lib/auth/cert.c 	     || (session-&gt;internals.flags &amp; GNUTLS_FORCE_CLIENT_CERT))) {</span>
<span class='curline'><a href='../S/5329.html#L200'>session</a>           200 lib/auth/cert.c 			key_usage = get_key_usage(session, cred-&gt;certs[0].cert_list[0].pubkey);</span>
<span class='curline'><a href='../S/5329.html#L203'>session</a>           203 lib/auth/cert.c 			result = _gnutls_check_key_usage_for_sig(session, key_usage, 1);</span>
<span class='curline'><a href='../S/5329.html#L237'>session</a>           237 lib/auth/cert.c 				key_usage = get_key_usage(session, cred-&gt;certs[i].cert_list[0].pubkey);</span>
<span class='curline'><a href='../S/5329.html#L240'>session</a>           240 lib/auth/cert.c 				if (_gnutls_check_key_usage_for_sig(session, key_usage, 1) &lt; 0) {</span>
<span class='curline'><a href='../S/5329.html#L286'>session</a>           286 lib/auth/cert.c find_rawpk_client_cert(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L305'>session</a>           305 lib/auth/cert.c 			ret = _gnutls_check_key_usage_for_sig(session, get_key_usage(session, cred-&gt;certs[i].cert_list[0].pubkey), 1);</span>
<span class='curline'><a href='../S/5329.html#L332'>session</a>           332 lib/auth/cert.c get_issuers_num(gnutls_session_t session, const uint8_t * data, ssize_t data_size)</span>
<span class='curline'><a href='../S/5329.html#L368'>session</a>           368 lib/auth/cert.c get_issuers(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L375'>session</a>           375 lib/auth/cert.c 	if (get_certificate_type(session, GNUTLS_CTYPE_CLIENT) != GNUTLS_CRT_X509)</span>
<span class='curline'><a href='../S/5329.html#L409'>session</a>           409 lib/auth/cert.c call_get_cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L424'>session</a>           424 lib/auth/cert.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L431'>session</a>           431 lib/auth/cert.c 	type = get_certificate_type(session, GNUTLS_CTYPE_OURS);</span>
<span class='curline'><a href='../S/5329.html#L447'>session</a>           447 lib/auth/cert.c 		    cred-&gt;get_cert_callback3(session, &amp;info,</span>
<span class='curline'><a href='../S/5329.html#L462'>session</a>           462 lib/auth/cert.c 		selected_certs_set(session, pcert, pcert_length,</span>
<span class='curline'><a href='../S/5329.html#L481'>session</a>           481 lib/auth/cert.c _gnutls_select_client_cert(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L495'>session</a>           495 lib/auth/cert.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L501'>session</a>           501 lib/auth/cert.c 	cert_type = get_certificate_type(session, GNUTLS_CTYPE_CLIENT);</span>
<span class='curline'><a href='../S/5329.html#L509'>session</a>           509 lib/auth/cert.c 			    get_issuers_num(session, data, data_size);</span>
<span class='curline'><a href='../S/5329.html#L525'>session</a>           525 lib/auth/cert.c 				    get_issuers(session, issuers_dn,</span>
<span class='curline'><a href='../S/5329.html#L538'>session</a>           538 lib/auth/cert.c 		    call_get_cert_callback(session, issuers_dn,</span>
<span class='curline'><a href='../S/5329.html#L548'>session</a>           548 lib/auth/cert.c 				result = find_x509_client_cert(session, cred, _data,</span>
<span class='curline'><a href='../S/5329.html#L553'>session</a>           553 lib/auth/cert.c 				result = find_rawpk_client_cert(session, cred,</span>
<span class='curline'><a href='../S/5329.html#L566'>session</a>           566 lib/auth/cert.c 			selected_certs_set(session,</span>
<span class='curline'><a href='../S/5329.html#L576'>session</a>           576 lib/auth/cert.c 			selected_certs_set(session, NULL, 0, NULL, 0,</span>
<span class='curline'><a href='../S/5329.html#L591'>session</a>           591 lib/auth/cert.c static int gen_x509_crt(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5329.html#L602'>session</a>           602 lib/auth/cert.c 	     _gnutls_get_selected_cert(session, &amp;apr_cert_list,</span>
<span class='curline'><a href='../S/5329.html#L649'>session</a>           649 lib/auth/cert.c _gnutls_gen_rawpk_crt(gnutls_session_t session, gnutls_buffer_st* data)</span>
<span class='curline'><a href='../S/5329.html#L656'>session</a>           656 lib/auth/cert.c 	if((ret = _gnutls_get_selected_cert(session, &amp;apr_cert_list,</span>
<span class='curline'><a href='../S/5329.html#L690'>session</a>           690 lib/auth/cert.c _gnutls_gen_cert_client_crt(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5329.html#L695'>session</a>           695 lib/auth/cert.c 	cert_type = get_certificate_type(session, GNUTLS_CTYPE_CLIENT);</span>
<span class='curline'><a href='../S/5329.html#L699'>session</a>           699 lib/auth/cert.c 			return gen_x509_crt(session, data);</span>
<span class='curline'><a href='../S/5329.html#L701'>session</a>           701 lib/auth/cert.c 			return _gnutls_gen_rawpk_crt(session, data);</span>
<span class='curline'><a href='../S/5329.html#L708'>session</a>           708 lib/auth/cert.c _gnutls_gen_cert_server_crt(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5329.html#L713'>session</a>           713 lib/auth/cert.c 	cert_type = get_certificate_type(session, GNUTLS_CTYPE_SERVER);</span>
<span class='curline'><a href='../S/5329.html#L717'>session</a>           717 lib/auth/cert.c 			return gen_x509_crt(session, data);</span>
<span class='curline'><a href='../S/5329.html#L719'>session</a>           719 lib/auth/cert.c 			return _gnutls_gen_rawpk_crt(session, data);</span>
<span class='curline'><a href='../S/5329.html#L726'>session</a>           726 lib/auth/cert.c int check_pk_compat(gnutls_session_t session, gnutls_pubkey_t pubkey)</span>
<span class='curline'><a href='../S/5329.html#L731'>session</a>           731 lib/auth/cert.c 	if (session-&gt;security_parameters.entity != GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5329.html#L740'>session</a>           740 lib/auth/cert.c 	kx = session-&gt;security_parameters.cs-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5329.html#L755'>session</a>           755 lib/auth/cert.c _gnutls_proc_x509_crt(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L769'>session</a>           769 lib/auth/cert.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L776'>session</a>           776 lib/auth/cert.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5329.html#L782'>session</a>           782 lib/auth/cert.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L867'>session</a>           867 lib/auth/cert.c 	ret = check_pk_compat(session, peer_certificate_list[0].pubkey);</span>
<span class='curline'><a href='../S/5329.html#L892'>session</a>           892 lib/auth/cert.c int _gnutls_proc_rawpk_crt(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L948'>session</a>           948 lib/auth/cert.c 	ret = check_pk_compat(session, peer_certificate-&gt;pubkey);</span>
<span class='curline'><a href='../S/5329.html#L954'>session</a>           954 lib/auth/cert.c 	ret = _gnutls_auth_info_init(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5329.html#L961'>session</a>           961 lib/auth/cert.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L984'>session</a>           984 lib/auth/cert.c int _gnutls_proc_crt(gnutls_session_t session, uint8_t * data, size_t data_size)</span>
<span class='curline'><a href='../S/5329.html#L990'>session</a>           990 lib/auth/cert.c 	    (gnutls_certificate_credentials_t) _gnutls_get_cred(session,</span>
<span class='curline'><a href='../S/5329.html#L999'>session</a>           999 lib/auth/cert.c 	cert_type = get_certificate_type(session, GNUTLS_CTYPE_PEERS);</span>
<span class='curline'><a href='../S/5329.html#L1003'>session</a>          1003 lib/auth/cert.c 			return _gnutls_proc_x509_crt(session, data, data_size);</span>
<span class='curline'><a href='../S/5329.html#L1005'>session</a>          1005 lib/auth/cert.c 			return _gnutls_proc_rawpk_crt(session, data, data_size);</span>
<span class='curline'><a href='../S/5329.html#L1036'>session</a>          1036 lib/auth/cert.c _gnutls_proc_cert_cert_req(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5329.html#L1046'>session</a>          1046 lib/auth/cert.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5329.html#L1052'>session</a>          1052 lib/auth/cert.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L1059'>session</a>          1059 lib/auth/cert.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5329.html#L1096'>session</a>          1096 lib/auth/cert.c 		ret = _gnutls_sign_algorithm_parse_data(session, p, hash_num);</span>
<span class='curline'><a href='../S/5329.html#L1115'>session</a>          1115 lib/auth/cert.c 	session-&gt;internals.hsk_flags |= HSK_CRT_ASKED;</span>
<span class='curline'><a href='../S/5329.html#L1121'>session</a>          1121 lib/auth/cert.c 	     _gnutls_select_client_cert(session, p, size, pk_algos,</span>
<span class='curline'><a href='../S/5329.html#L1131'>session</a>          1131 lib/auth/cert.c _gnutls_gen_cert_client_crt_vrfy(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L1140'>session</a>          1140 lib/auth/cert.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5329.html#L1148'>session</a>          1148 lib/auth/cert.c 	     _gnutls_get_selected_cert(session, &amp;apr_cert_list,</span>
<span class='curline'><a href='../S/5329.html#L1156'>session</a>          1156 lib/auth/cert.c 		     _gnutls_handshake_sign_crt_vrfy(session,</span>
<span class='curline'><a href='../S/5329.html#L1201'>session</a>          1201 lib/auth/cert.c _gnutls_proc_cert_client_crt_vrfy(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L1208'>session</a>          1208 lib/auth/cert.c 	cert_auth_info_t info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L1211'>session</a>          1211 lib/auth/cert.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5329.html#L1222'>session</a>          1222 lib/auth/cert.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L1228'>session</a>          1228 lib/auth/cert.c 	vflags = cred-&gt;verify_flags | session-&gt;internals.additional_verify_flags;</span>
<span class='curline'><a href='../S/5329.html#L1241'>session</a>          1241 lib/auth/cert.c 	ret = _gnutls_session_sign_algo_enabled(session, sign_algo);</span>
<span class='curline'><a href='../S/5329.html#L1255'>session</a>          1255 lib/auth/cert.c 					  session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5329.html#L1264'>session</a>          1264 lib/auth/cert.c 	     _gnutls_handshake_verify_crt_vrfy(session, vflags, &amp;peer_cert, &amp;sig,</span>
<span class='curline'><a href='../S/5329.html#L1276'>session</a>          1276 lib/auth/cert.c _gnutls_gen_cert_server_cert_req(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L1282'>session</a>          1282 lib/auth/cert.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5329.html#L1294'>session</a>          1294 lib/auth/cert.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L1302'>session</a>          1302 lib/auth/cert.c 	if (_gnutls_kx_is_vko_gost(session-&gt;security_parameters.cs-&gt;kx_algorithm)) {</span>
<span class='curline'><a href='../S/5329.html#L1320'>session</a>          1320 lib/auth/cert.c 		    _gnutls_sign_algorithm_write_params(session, data);</span>
<span class='curline'><a href='../S/5329.html#L1327'>session</a>          1327 lib/auth/cert.c 	if (session-&gt;security_parameters.client_ctype == GNUTLS_CRT_X509 &amp;&amp;</span>
<span class='curline'><a href='../S/5329.html#L1328'>session</a>          1328 lib/auth/cert.c 	    session-&gt;internals.ignore_rdn_sequence == 0) {</span>
<span class='curline'><a href='../S/5329.html#L1357'>session</a>          1357 lib/auth/cert.c _gnutls_get_selected_cert(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L1362'>session</a>          1362 lib/auth/cert.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5329.html#L1364'>session</a>          1364 lib/auth/cert.c 		*apr_cert_list = session-&gt;internals.selected_cert_list;</span>
<span class='curline'><a href='../S/5329.html#L1365'>session</a>          1365 lib/auth/cert.c 		*apr_pkey = session-&gt;internals.selected_key;</span>
<span class='curline'><a href='../S/5329.html#L1367'>session</a>          1367 lib/auth/cert.c 		    session-&gt;internals.selected_cert_list_length;</span>
<span class='curline'><a href='../S/5329.html#L1377'>session</a>          1377 lib/auth/cert.c 		*apr_cert_list = session-&gt;internals.selected_cert_list;</span>
<span class='curline'><a href='../S/5329.html#L1379'>session</a>          1379 lib/auth/cert.c 		    session-&gt;internals.selected_cert_list_length;</span>
<span class='curline'><a href='../S/5329.html#L1380'>session</a>          1380 lib/auth/cert.c 		*apr_pkey = session-&gt;internals.selected_key;</span>
<span class='curline'><a href='../S/5329.html#L1388'>session</a>          1388 lib/auth/cert.c void _gnutls_selected_certs_deinit(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5329.html#L1390'>session</a>          1390 lib/auth/cert.c 	if (session-&gt;internals.selected_need_free != 0) {</span>
<span class='curline'><a href='../S/5329.html#L1394'>session</a>          1394 lib/auth/cert.c 		     i &lt; session-&gt;internals.selected_cert_list_length; i++) {</span>
<span class='curline'><a href='../S/5329.html#L1395'>session</a>          1395 lib/auth/cert.c 			gnutls_pcert_deinit(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5329.html#L1398'>session</a>          1398 lib/auth/cert.c 		gnutls_free(session-&gt;internals.selected_cert_list);</span>
<span class='curline'><a href='../S/5329.html#L1401'>session</a>          1401 lib/auth/cert.c 		     i &lt; session-&gt;internals.selected_ocsp_length; i++) {</span>
<span class='curline'><a href='../S/5329.html#L1402'>session</a>          1402 lib/auth/cert.c 			_gnutls_free_datum(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5329.html#L1405'>session</a>          1405 lib/auth/cert.c 		gnutls_free(session-&gt;internals.selected_ocsp);</span>
<span class='curline'><a href='../S/5329.html#L1407'>session</a>          1407 lib/auth/cert.c 		gnutls_privkey_deinit(session-&gt;internals.selected_key);</span>
<span class='curline'><a href='../S/5329.html#L1409'>session</a>          1409 lib/auth/cert.c 	session-&gt;internals.selected_ocsp_func = NULL;</span>
<span class='curline'><a href='../S/5329.html#L1411'>session</a>          1411 lib/auth/cert.c 	session-&gt;internals.selected_cert_list = NULL;</span>
<span class='curline'><a href='../S/5329.html#L1412'>session</a>          1412 lib/auth/cert.c 	session-&gt;internals.selected_cert_list_length = 0;</span>
<span class='curline'><a href='../S/5329.html#L1414'>session</a>          1414 lib/auth/cert.c 	session-&gt;internals.selected_key = NULL;</span>
<span class='curline'><a href='../S/5329.html#L1420'>session</a>          1420 lib/auth/cert.c selected_certs_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L1427'>session</a>          1427 lib/auth/cert.c 	_gnutls_selected_certs_deinit(session);</span>
<span class='curline'><a href='../S/5329.html#L1429'>session</a>          1429 lib/auth/cert.c 	session-&gt;internals.selected_cert_list = certs;</span>
<span class='curline'><a href='../S/5329.html#L1430'>session</a>          1430 lib/auth/cert.c 	session-&gt;internals.selected_cert_list_length = ncerts;</span>
<span class='curline'><a href='../S/5329.html#L1432'>session</a>          1432 lib/auth/cert.c 	session-&gt;internals.selected_ocsp = ocsp;</span>
<span class='curline'><a href='../S/5329.html#L1433'>session</a>          1433 lib/auth/cert.c 	session-&gt;internals.selected_ocsp_length = nocsp;</span>
<span class='curline'><a href='../S/5329.html#L1435'>session</a>          1435 lib/auth/cert.c 	session-&gt;internals.selected_key = key;</span>
<span class='curline'><a href='../S/5329.html#L1436'>session</a>          1436 lib/auth/cert.c 	session-&gt;internals.selected_need_free = need_free;</span>
<span class='curline'><a href='../S/5329.html#L1438'>session</a>          1438 lib/auth/cert.c 	session-&gt;internals.selected_ocsp_func = ocsp_func;</span>
<span class='curline'><a href='../S/5329.html#L1439'>session</a>          1439 lib/auth/cert.c 	session-&gt;internals.selected_ocsp_func_ptr = ocsp_func_ptr;</span>
<span class='curline'><a href='../S/5329.html#L1442'>session</a>          1442 lib/auth/cert.c static void get_server_name(gnutls_session_t session, uint8_t * name,</span>
<span class='curline'><a href='../S/5329.html#L1453'>session</a>          1453 lib/auth/cert.c 		    gnutls_server_name_get(session, name, &amp;max_name, &amp;type, i);</span>
<span class='curline'><a href='../S/5329.html#L1476'>session</a>          1476 lib/auth/cert.c int cert_select_sign_algorithm(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L1486'>session</a>          1486 lib/auth/cert.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5329.html#L1489'>session</a>          1489 lib/auth/cert.c 	assert(IS_SERVER(session));</span>
<span class='curline'><a href='../S/5329.html#L1492'>session</a>          1492 lib/auth/cert.c 	ctype = get_certificate_type(session, GNUTLS_CTYPE_SERVER);</span>
<span class='curline'><a href='../S/5329.html#L1498'>session</a>          1498 lib/auth/cert.c 	key_usage = get_key_usage(session, pubkey);</span>
<span class='curline'><a href='../S/5329.html#L1501'>session</a>          1501 lib/auth/cert.c 	if (ver-&gt;tls13_sem &amp;&amp; _gnutls_check_key_usage_for_sig(session, key_usage, 1) &lt; 0)</span>
<span class='curline'><a href='../S/5329.html#L1515'>session</a>          1515 lib/auth/cert.c 		gnutls_sign_algorithm_set_server(session, algo);</span>
<span class='curline'><a href='../S/5329.html#L1519'>session</a>          1519 lib/auth/cert.c 	algo = _gnutls_session_get_sign_algo(session, cert, pkey, 0, cs-&gt;kx_algorithm);</span>
<span class='curline'><a href='../S/5329.html#L1523'>session</a>          1523 lib/auth/cert.c 	gnutls_sign_algorithm_set_server(session, algo);</span>
<span class='curline'><a href='../S/5329.html#L1540'>session</a>          1540 lib/auth/cert.c _gnutls_select_server_cert(gnutls_session_t session, const gnutls_cipher_suite_entry_st *cs)</span>
<span class='curline'><a href='../S/5329.html#L1548'>session</a>          1548 lib/auth/cert.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L1559'>session</a>          1559 lib/auth/cert.c 		if (session-&gt;internals.selected_cert_list_length == 0) {</span>
<span class='curline'><a href='../S/5329.html#L1560'>session</a>          1560 lib/auth/cert.c 			ret = call_get_cert_callback(session, NULL, 0, NULL, 0);</span>
<span class='curline'><a href='../S/5329.html#L1564'>session</a>          1564 lib/auth/cert.c 			if (session-&gt;internals.selected_cert_list_length == 0)</span>
<span class='curline'><a href='../S/5329.html#L1568'>session</a>          1568 lib/auth/cert.c 					  gnutls_pk_get_name(session-&gt;internals.selected_cert_list[0].pubkey-&gt;params.algo));</span>
<span class='curline'><a href='../S/5329.html#L1571'>session</a>          1571 lib/auth/cert.c 		ret = cert_select_sign_algorithm(session,</span>
<span class='curline'><a href='../S/5329.html#L1572'>session</a>          1572 lib/auth/cert.c 						 &amp;session-&gt;internals.selected_cert_list[0],</span>
<span class='curline'><a href='../S/5329.html#L1573'>session</a>          1573 lib/auth/cert.c 						 session-&gt;internals.selected_key,</span>
<span class='curline'><a href='../S/5329.html#L1584'>session</a>          1584 lib/auth/cert.c 	get_server_name(session, (unsigned char *)server_name,</span>
<span class='curline'><a href='../S/5329.html#L1588'>session</a>          1588 lib/auth/cert.c 				     session, server_name);</span>
<span class='curline'><a href='../S/5329.html#L1603'>session</a>          1603 lib/auth/cert.c 				ret = cert_select_sign_algorithm(session,</span>
<span class='curline'><a href='../S/5329.html#L1627'>session</a>          1627 lib/auth/cert.c 		     session, cs-&gt;name, i,</span>
<span class='curline'><a href='../S/5329.html#L1633'>session</a>          1633 lib/auth/cert.c 		ret = cert_select_sign_algorithm(session,</span>
<span class='curline'><a href='../S/5329.html#L1670'>session</a>          1670 lib/auth/cert.c 		selected_certs_set(session,</span>
<span class='curline'><a href='../S/5329.html#L1685'>session</a>          1685 lib/auth/cert.c int _gnutls_gen_dhe_signature(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5329.html#L1694'>session</a>          1694 lib/auth/cert.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5329.html#L1705'>session</a>          1705 lib/auth/cert.c 	     _gnutls_get_selected_cert(session, &amp;apr_cert_list,</span>
<span class='curline'><a href='../S/5329.html#L1713'>session</a>          1713 lib/auth/cert.c 		     _gnutls_handshake_sign_data(session,</span>
<span class='curline'><a href='../S/5329.html#L1767'>session</a>          1767 lib/auth/cert.c _gnutls_proc_dhe_signature(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5329.html#L1773'>session</a>          1773 lib/auth/cert.c 	cert_auth_info_t info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L1777'>session</a>          1777 lib/auth/cert.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5329.html#L1789'>session</a>          1789 lib/auth/cert.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5329.html#L1795'>session</a>          1795 lib/auth/cert.c 	vflags = cred-&gt;verify_flags | session-&gt;internals.additional_verify_flags;</span>
<span class='curline'><a href='../S/5329.html#L1823'>session</a>          1823 lib/auth/cert.c 	cert_type = get_certificate_type(session, GNUTLS_CTYPE_SERVER);</span>
<span class='curline'><a href='../S/5329.html#L1832'>session</a>          1832 lib/auth/cert.c 	    _gnutls_handshake_verify_data(session, vflags, &amp;peer_cert, vparams,</span>
<span class='curline'><a href='../S/5326.html#L143'>session</a>           143 lib/auth/cert.h int _gnutls_get_selected_cert(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5326.html#L149'>session</a>           149 lib/auth/cert.h _gnutls_select_client_cert(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5326.html#L156'>session</a>           156 lib/auth/cert.h _gnutls_select_server_cert(gnutls_session_t session, const gnutls_cipher_suite_entry_st *cs);</span>
<span class='curline'><a href='../S/5326.html#L157'>session</a>           157 lib/auth/cert.h void _gnutls_selected_certs_deinit(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5326.html#L163'>session</a>           163 lib/auth/cert.h int _gnutls_selected_cert_supported_kx(struct gnutls_session_int *session,</span>
<span class='curline'><a href='../S/5326.html#L169'>session</a>           169 lib/auth/cert.h int _gnutls_gen_dhe_signature(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5326.html#L172'>session</a>           172 lib/auth/cert.h int _gnutls_proc_dhe_signature(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5326.html#L176'>session</a>           176 lib/auth/cert.h int _gnutls_gen_rawpk_crt(gnutls_session_t session, gnutls_buffer_st* data);</span>
<span class='curline'><a href='../S/5326.html#L177'>session</a>           177 lib/auth/cert.h int _gnutls_proc_rawpk_crt(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5326.html#L180'>session</a>           180 lib/auth/cert.h inline static unsigned get_key_usage(gnutls_session_t session, gnutls_pubkey_t pubkey)</span>
<span class='curline'><a href='../S/5326.html#L182'>session</a>           182 lib/auth/cert.h 	if (unlikely(session-&gt;internals.priorities &amp;&amp;</span>
<span class='curline'><a href='../S/5326.html#L183'>session</a>           183 lib/auth/cert.h 	    session-&gt;internals.priorities-&gt;allow_server_key_usage_violation))</span>
<span class='curline'><a href='../S/5320.html#L55'>session</a>            55 lib/auth/dh_common.c _gnutls_proc_dh_common_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5320.html#L77'>session</a>            77 lib/auth/dh_common.c 	if (_gnutls_mpi_init_scan_nz(&amp;session-&gt;key.proto.tls12.dh.client_Y, &amp;data[2], _n_Y)) {</span>
<span class='curline'><a href='../S/5320.html#L82'>session</a>            82 lib/auth/dh_common.c 	_gnutls_dh_set_peer_public(session, session-&gt;key.proto.tls12.dh.client_Y);</span>
<span class='curline'><a href='../S/5320.html#L84'>session</a>            84 lib/auth/dh_common.c 	peer_pub.params[DH_Y] = session-&gt;key.proto.tls12.dh.client_Y;</span>
<span class='curline'><a href='../S/5320.html#L87'>session</a>            87 lib/auth/dh_common.c 	ret = _gnutls_pk_derive(GNUTLS_PK_DH, &amp;tmp_dh_key, &amp;session-&gt;key.proto.tls12.dh.params, &amp;peer_pub);</span>
<span class='curline'><a href='../S/5320.html#L94'>session</a>            94 lib/auth/dh_common.c 		session-&gt;key.key.data = tmp_dh_key.data;</span>
<span class='curline'><a href='../S/5320.html#L95'>session</a>            95 lib/auth/dh_common.c 		session-&gt;key.key.size = tmp_dh_key.size;</span>
<span class='curline'><a href='../S/5320.html#L98'>session</a>            98 lib/auth/dh_common.c 		    _gnutls_set_psk_session_key(session, psk_key,</span>
<span class='curline'><a href='../S/5320.html#L110'>session</a>           110 lib/auth/dh_common.c 	_gnutls_mpi_release(&amp;session-&gt;key.proto.tls12.dh.client_Y);</span>
<span class='curline'><a href='../S/5320.html#L111'>session</a>           111 lib/auth/dh_common.c 	gnutls_pk_params_clear(&amp;session-&gt;key.proto.tls12.dh.params);</span>
<span class='curline'><a href='../S/5320.html#L116'>session</a>           116 lib/auth/dh_common.c int _gnutls_gen_dh_common_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5320.html#L119'>session</a>           119 lib/auth/dh_common.c 	return _gnutls_gen_dh_common_client_kx_int(session, data, NULL);</span>
<span class='curline'><a href='../S/5320.html#L123'>session</a>           123 lib/auth/dh_common.c _gnutls_gen_dh_common_client_kx_int(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5320.html#L136'>session</a>           136 lib/auth/dh_common.c 				     &amp;session-&gt;key.proto.tls12.dh.params, 1);</span>
<span class='curline'><a href='../S/5320.html#L140'>session</a>           140 lib/auth/dh_common.c 	_gnutls_dh_set_secret_bits(session, _gnutls_mpi_get_nbits(session-&gt;key.proto.tls12.dh.params.params[DH_X]));</span>
<span class='curline'><a href='../S/5320.html#L142'>session</a>           142 lib/auth/dh_common.c 	ret = _gnutls_buffer_append_mpi(data, 16, session-&gt;key.proto.tls12.dh.params.params[DH_Y], 0);</span>
<span class='curline'><a href='../S/5320.html#L148'>session</a>           148 lib/auth/dh_common.c 	peer_pub.params[DH_Y] = session-&gt;key.proto.tls12.dh.client_Y;</span>
<span class='curline'><a href='../S/5320.html#L151'>session</a>           151 lib/auth/dh_common.c 	ret = _gnutls_pk_derive(GNUTLS_PK_DH, &amp;tmp_dh_key, &amp;session-&gt;key.proto.tls12.dh.params, &amp;peer_pub);</span>
<span class='curline'><a href='../S/5320.html#L157'>session</a>           157 lib/auth/dh_common.c 	if (session-&gt;security_parameters.cs-&gt;kx_algorithm != GNUTLS_KX_DHE_PSK) {</span>
<span class='curline'><a href='../S/5320.html#L158'>session</a>           158 lib/auth/dh_common.c 		session-&gt;key.key.data = tmp_dh_key.data;</span>
<span class='curline'><a href='../S/5320.html#L159'>session</a>           159 lib/auth/dh_common.c 		session-&gt;key.key.size = tmp_dh_key.size;</span>
<span class='curline'><a href='../S/5320.html#L162'>session</a>           162 lib/auth/dh_common.c 		    _gnutls_set_psk_session_key(session, pskkey,</span>
<span class='curline'><a href='../S/5320.html#L175'>session</a>           175 lib/auth/dh_common.c 	gnutls_pk_params_clear(&amp;session-&gt;key.proto.tls12.dh.params);</span>
<span class='curline'><a href='../S/5320.html#L181'>session</a>           181 lib/auth/dh_common.c _gnutls_proc_dh_common_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5320.html#L195'>session</a>           195 lib/auth/dh_common.c 	gnutls_pk_params_release(&amp;session-&gt;key.proto.tls12.dh.params);</span>
<span class='curline'><a href='../S/5320.html#L197'>session</a>           197 lib/auth/dh_common.c 	gnutls_pk_params_init(&amp;session-&gt;key.proto.tls12.dh.params);</span>
<span class='curline'><a href='../S/5320.html#L228'>session</a>           228 lib/auth/dh_common.c 	if (_gnutls_mpi_init_scan_nz(&amp;session-&gt;key.proto.tls12.dh.client_Y, data_Y, _n_Y) != 0) {</span>
<span class='curline'><a href='../S/5320.html#L234'>session</a>           234 lib/auth/dh_common.c 	if (session-&gt;internals.priorities-&gt;groups.have_ffdhe != 0) {</span>
<span class='curline'><a href='../S/5320.html#L237'>session</a>           237 lib/auth/dh_common.c 		for (j=0;j&lt;session-&gt;internals.priorities-&gt;groups.size;j++) {</span>
<span class='curline'><a href='../S/5320.html#L238'>session</a>           238 lib/auth/dh_common.c 			if (session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;generator &amp;&amp;</span>
<span class='curline'><a href='../S/5320.html#L239'>session</a>           239 lib/auth/dh_common.c 			    session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;generator-&gt;size == n_g &amp;&amp;</span>
<span class='curline'><a href='../S/5320.html#L240'>session</a>           240 lib/auth/dh_common.c 			    session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;prime-&gt;size == n_p &amp;&amp;</span>
<span class='curline'><a href='../S/5320.html#L241'>session</a>           241 lib/auth/dh_common.c 			    memcmp(session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;generator-&gt;data,</span>
<span class='curline'><a href='../S/5320.html#L243'>session</a>           243 lib/auth/dh_common.c 			    memcmp(session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;prime-&gt;data,</span>
<span class='curline'><a href='../S/5320.html#L246'>session</a>           246 lib/auth/dh_common.c 				session-&gt;internals.hsk_flags |= HSK_USED_FFDHE;</span>
<span class='curline'><a href='../S/5320.html#L247'>session</a>           247 lib/auth/dh_common.c 				_gnutls_session_group_set(session, session-&gt;internals.priorities-&gt;groups.entry[j]);</span>
<span class='curline'><a href='../S/5320.html#L248'>session</a>           248 lib/auth/dh_common.c 				session-&gt;key.proto.tls12.dh.params.qbits = *session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;q_bits;</span>
<span class='curline'><a href='../S/5320.html#L249'>session</a>           249 lib/auth/dh_common.c 				data_q = session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;q-&gt;data;</span>
<span class='curline'><a href='../S/5320.html#L250'>session</a>           250 lib/auth/dh_common.c 				_n_q = session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;q-&gt;size;</span>
<span class='curline'><a href='../S/5320.html#L255'>session</a>           255 lib/auth/dh_common.c 		if (!(session-&gt;internals.hsk_flags &amp; HSK_USED_FFDHE)) {</span>
<span class='curline'><a href='../S/5320.html#L256'>session</a>           256 lib/auth/dh_common.c 			_gnutls_audit_log(session, "FFDHE groups advertised, but server didn't support it; falling back to server's choice\n");</span>
<span class='curline'><a href='../S/5320.html#L268'>session</a>           268 lib/auth/dh_common.c 	if (_gnutls_mpi_init_scan_nz(&amp;session-&gt;key.proto.tls12.dh.params.params[DH_G], data_g, _n_g) != 0) {</span>
<span class='curline'><a href='../S/5320.html#L273'>session</a>           273 lib/auth/dh_common.c 	if (_gnutls_mpi_init_scan_nz(&amp;session-&gt;key.proto.tls12.dh.params.params[DH_P], data_p, _n_p) != 0) {</span>
<span class='curline'><a href='../S/5320.html#L276'>session</a>           276 lib/auth/dh_common.c 		_gnutls_mpi_release(&amp;session-&gt;key.proto.tls12.dh.params.params[DH_G]);</span>
<span class='curline'><a href='../S/5320.html#L280'>session</a>           280 lib/auth/dh_common.c 			    &amp;session-&gt;key.proto.tls12.dh.params.params[DH_Q],</span>
<span class='curline'><a href='../S/5320.html#L284'>session</a>           284 lib/auth/dh_common.c 			&amp;session-&gt;key.proto.tls12.dh.params.params[DH_P]);</span>
<span class='curline'><a href='../S/5320.html#L286'>session</a>           286 lib/auth/dh_common.c 			&amp;session-&gt;key.proto.tls12.dh.params.params[DH_G]);</span>
<span class='curline'><a href='../S/5320.html#L291'>session</a>           291 lib/auth/dh_common.c 	session-&gt;key.proto.tls12.dh.params.params_nr = 3;</span>
<span class='curline'><a href='../S/5320.html#L292'>session</a>           292 lib/auth/dh_common.c 	session-&gt;key.proto.tls12.dh.params.algo = GNUTLS_PK_DH;</span>
<span class='curline'><a href='../S/5320.html#L294'>session</a>           294 lib/auth/dh_common.c 	if (!(session-&gt;internals.hsk_flags &amp; HSK_USED_FFDHE)) {</span>
<span class='curline'><a href='../S/5320.html#L295'>session</a>           295 lib/auth/dh_common.c 		bits = _gnutls_dh_get_min_prime_bits(session);</span>
<span class='curline'><a href='../S/5320.html#L301'>session</a>           301 lib/auth/dh_common.c 		p_bits = _gnutls_mpi_get_nbits(session-&gt;key.proto.tls12.dh.params.params[DH_P]);</span>
<span class='curline'><a href='../S/5320.html#L308'>session</a>           308 lib/auth/dh_common.c 			     (unsigned) _gnutls_mpi_get_nbits(session-&gt;key.proto.tls12.dh.params.params[DH_P]),</span>
<span class='curline'><a href='../S/5320.html#L323'>session</a>           323 lib/auth/dh_common.c 	_gnutls_dh_save_group(session, session-&gt;key.proto.tls12.dh.params.params[DH_G],</span>
<span class='curline'><a href='../S/5320.html#L324'>session</a>           324 lib/auth/dh_common.c 			     session-&gt;key.proto.tls12.dh.params.params[DH_P]);</span>
<span class='curline'><a href='../S/5320.html#L325'>session</a>           325 lib/auth/dh_common.c 	_gnutls_dh_set_peer_public(session, session-&gt;key.proto.tls12.dh.client_Y);</span>
<span class='curline'><a href='../S/5320.html#L333'>session</a>           333 lib/auth/dh_common.c _gnutls_dh_common_print_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5320.html#L337'>session</a>           337 lib/auth/dh_common.c 	unsigned q_bits = session-&gt;key.proto.tls12.dh.params.qbits;</span>
<span class='curline'><a href='../S/5320.html#L349'>session</a>           349 lib/auth/dh_common.c 				     &amp;session-&gt;key.proto.tls12.dh.params, 1);</span>
<span class='curline'><a href='../S/5320.html#L353'>session</a>           353 lib/auth/dh_common.c 	_gnutls_dh_set_secret_bits(session, _gnutls_mpi_get_nbits(session-&gt;key.proto.tls12.dh.params.params[DH_X]));</span>
<span class='curline'><a href='../S/5320.html#L355'>session</a>           355 lib/auth/dh_common.c 	ret = _gnutls_buffer_append_mpi(data, 16, session-&gt;key.proto.tls12.dh.params.params[DH_P], 0);</span>
<span class='curline'><a href='../S/5320.html#L361'>session</a>           361 lib/auth/dh_common.c 	ret = _gnutls_buffer_append_mpi(data, 16, session-&gt;key.proto.tls12.dh.params.params[DH_G], 0);</span>
<span class='curline'><a href='../S/5320.html#L367'>session</a>           367 lib/auth/dh_common.c 	ret = _gnutls_buffer_append_mpi(data, 16, session-&gt;key.proto.tls12.dh.params.params[DH_Y], 0);</span>
<span class='curline'><a href='../S/5311.html#L42'>session</a>            42 lib/auth/dh_common.h int _gnutls_proc_dh_common_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5311.html#L47'>session</a>            47 lib/auth/dh_common.h int _gnutls_proc_dh_common_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5321.html#L86'>session</a>            86 lib/auth/dhe.c gen_dhe_server_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5321.html#L93'>session</a>            93 lib/auth/dhe.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5321.html#L99'>session</a>            99 lib/auth/dhe.c 	if ((ret = _gnutls_auth_info_init(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5321.html#L107'>session</a>           107 lib/auth/dhe.c 	    _gnutls_figure_dh_params(session, cred-&gt;dh_params, cred-&gt;params_func, cred-&gt;dh_sec_param);</span>
<span class='curline'><a href='../S/5321.html#L115'>session</a>           115 lib/auth/dhe.c 	    _gnutls_dh_common_print_server_kx(session, data);</span>
<span class='curline'><a href='../S/5321.html#L122'>session</a>           122 lib/auth/dhe.c 	return _gnutls_gen_dhe_signature(session, data, &amp;data-&gt;data[sig_pos],</span>
<span class='curline'><a href='../S/5321.html#L128'>session</a>           128 lib/auth/dhe.c proc_dhe_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5321.html#L134'>session</a>           134 lib/auth/dhe.c 	ret = _gnutls_proc_dh_common_server_kx(session, data, _data_size);</span>
<span class='curline'><a href='../S/5321.html#L141'>session</a>           141 lib/auth/dhe.c 	return _gnutls_proc_dhe_signature(session, data + ret,</span>
<span class='curline'><a href='../S/5321.html#L147'>session</a>           147 lib/auth/dhe.c proc_dhe_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5321.html#L150'>session</a>           150 lib/auth/dhe.c 	return _gnutls_proc_dh_common_client_kx(session, data, _data_size,</span>
<span class='curline'><a href='../S/5306.html#L48'>session</a>            48 lib/auth/dhe_psk.c proc_ecdhe_psk_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5306.html#L55'>session</a>            55 lib/auth/dhe_psk.c static int gen_ecdhe_psk_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5306.html#L57'>session</a>            57 lib/auth/dhe_psk.c static int proc_dhe_psk_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5306.html#L98'>session</a>            98 lib/auth/dhe_psk.c gen_ecdhe_psk_client_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5306.html#L106'>session</a>           106 lib/auth/dhe_psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L112'>session</a>           112 lib/auth/dhe_psk.c 	ret = _gnutls_find_psk_key(session, cred, &amp;username, &amp;key, &amp;free);</span>
<span class='curline'><a href='../S/5306.html#L125'>session</a>           125 lib/auth/dhe_psk.c 	ret = _gnutls_gen_ecdh_common_client_kx_int(session, data, &amp;key);</span>
<span class='curline'><a href='../S/5306.html#L143'>session</a>           143 lib/auth/dhe_psk.c gen_dhe_psk_client_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5306.html#L151'>session</a>           151 lib/auth/dhe_psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L157'>session</a>           157 lib/auth/dhe_psk.c 	ret = _gnutls_find_psk_key(session, cred, &amp;username, &amp;key, &amp;free);</span>
<span class='curline'><a href='../S/5306.html#L170'>session</a>           170 lib/auth/dhe_psk.c 	ret = _gnutls_gen_dh_common_client_kx_int(session, data, &amp;key);</span>
<span class='curline'><a href='../S/5306.html#L188'>session</a>           188 lib/auth/dhe_psk.c gen_dhe_psk_server_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5306.html#L195'>session</a>           195 lib/auth/dhe_psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L202'>session</a>           202 lib/auth/dhe_psk.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5306.html#L209'>session</a>           209 lib/auth/dhe_psk.c 	    _gnutls_figure_dh_params(session, cred-&gt;dh_params, cred-&gt;params_func, cred-&gt;dh_sec_param);</span>
<span class='curline'><a href='../S/5306.html#L225'>session</a>           225 lib/auth/dhe_psk.c 	    _gnutls_dh_common_print_server_kx(session, data);</span>
<span class='curline'><a href='../S/5306.html#L233'>session</a>           233 lib/auth/dhe_psk.c gen_ecdhe_psk_server_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5306.html#L240'>session</a>           240 lib/auth/dhe_psk.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5306.html#L247'>session</a>           247 lib/auth/dhe_psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L263'>session</a>           263 lib/auth/dhe_psk.c 	ret = _gnutls_ecdh_common_print_server_kx(session, data,</span>
<span class='curline'><a href='../S/5306.html#L265'>session</a>           265 lib/auth/dhe_psk.c 						  (session));</span>
<span class='curline'><a href='../S/5306.html#L274'>session</a>           274 lib/auth/dhe_psk.c proc_dhe_psk_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5306.html#L285'>session</a>           285 lib/auth/dhe_psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L293'>session</a>           293 lib/auth/dhe_psk.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5306.html#L308'>session</a>           308 lib/auth/dhe_psk.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L325'>session</a>           325 lib/auth/dhe_psk.c 	    _gnutls_psk_pwd_find_entry(session, info-&gt;username, info-&gt;username_len, &amp;psk_key);</span>
<span class='curline'><a href='../S/5306.html#L329'>session</a>           329 lib/auth/dhe_psk.c 	ret = _gnutls_proc_dh_common_client_kx(session, data, data_size,</span>
<span class='curline'><a href='../S/5306.html#L339'>session</a>           339 lib/auth/dhe_psk.c proc_ecdhe_psk_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5306.html#L350'>session</a>           350 lib/auth/dhe_psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L358'>session</a>           358 lib/auth/dhe_psk.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5306.html#L373'>session</a>           373 lib/auth/dhe_psk.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L393'>session</a>           393 lib/auth/dhe_psk.c 	    _gnutls_psk_pwd_find_entry(session, info-&gt;username, info-&gt;username_len, &amp;psk_key);</span>
<span class='curline'><a href='../S/5306.html#L397'>session</a>           397 lib/auth/dhe_psk.c 	ret = _gnutls_proc_ecdh_common_client_kx(session, data, data_size,</span>
<span class='curline'><a href='../S/5306.html#L399'>session</a>           399 lib/auth/dhe_psk.c 						 (session), &amp;psk_key);</span>
<span class='curline'><a href='../S/5306.html#L406'>session</a>           406 lib/auth/dhe_psk.c static int copy_hint(gnutls_session_t session, gnutls_datum_t *hint)</span>
<span class='curline'><a href='../S/5306.html#L412'>session</a>           412 lib/auth/dhe_psk.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5306.html#L430'>session</a>           430 lib/auth/dhe_psk.c proc_dhe_psk_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5306.html#L440'>session</a>           440 lib/auth/dhe_psk.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5306.html#L454'>session</a>           454 lib/auth/dhe_psk.c 	ret = _gnutls_proc_dh_common_server_kx(session, data, data_size);</span>
<span class='curline'><a href='../S/5306.html#L460'>session</a>           460 lib/auth/dhe_psk.c 	ret = copy_hint(session, &amp;hint);</span>
<span class='curline'><a href='../S/5306.html#L470'>session</a>           470 lib/auth/dhe_psk.c proc_ecdhe_psk_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5306.html#L480'>session</a>           480 lib/auth/dhe_psk.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5306.html#L494'>session</a>           494 lib/auth/dhe_psk.c 	ret = _gnutls_proc_ecdh_common_server_kx(session, data, data_size);</span>
<span class='curline'><a href='../S/5306.html#L500'>session</a>           500 lib/auth/dhe_psk.c 	ret = copy_hint(session, &amp;hint);</span>
<span class='curline'><a href='../S/5324.html#L48'>session</a>            48 lib/auth/ecdhe.c proc_ecdhe_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L51'>session</a>            51 lib/auth/ecdhe.c proc_ecdhe_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L89'>session</a>            89 lib/auth/ecdhe.c static int calc_ecdh_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L98'>session</a>            98 lib/auth/ecdhe.c 	pub.params[ECC_X] = session-&gt;key.proto.tls12.ecdh.x;</span>
<span class='curline'><a href='../S/5324.html#L99'>session</a>            99 lib/auth/ecdhe.c 	pub.params[ECC_Y] = session-&gt;key.proto.tls12.ecdh.y;</span>
<span class='curline'><a href='../S/5324.html#L100'>session</a>           100 lib/auth/ecdhe.c 	pub.raw_pub.data = session-&gt;key.proto.tls12.ecdh.raw.data;</span>
<span class='curline'><a href='../S/5324.html#L101'>session</a>           101 lib/auth/ecdhe.c 	pub.raw_pub.size = session-&gt;key.proto.tls12.ecdh.raw.size;</span>
<span class='curline'><a href='../S/5324.html#L106'>session</a>           106 lib/auth/ecdhe.c 			      &amp;session-&gt;key.proto.tls12.ecdh.params, &amp;pub);</span>
<span class='curline'><a href='../S/5324.html#L113'>session</a>           113 lib/auth/ecdhe.c 		memcpy(&amp;session-&gt;key.key, &amp;tmp_dh_key, sizeof(gnutls_datum_t));</span>
<span class='curline'><a href='../S/5324.html#L117'>session</a>           117 lib/auth/ecdhe.c 		    _gnutls_set_psk_session_key(session, psk_key,</span>
<span class='curline'><a href='../S/5324.html#L131'>session</a>           131 lib/auth/ecdhe.c 	_gnutls_mpi_release(&amp;session-&gt;key.proto.tls12.ecdh.x);</span>
<span class='curline'><a href='../S/5324.html#L132'>session</a>           132 lib/auth/ecdhe.c 	_gnutls_mpi_release(&amp;session-&gt;key.proto.tls12.ecdh.y);</span>
<span class='curline'><a href='../S/5324.html#L133'>session</a>           133 lib/auth/ecdhe.c 	_gnutls_free_datum(&amp;session-&gt;key.proto.tls12.ecdh.raw);</span>
<span class='curline'><a href='../S/5324.html#L134'>session</a>           134 lib/auth/ecdhe.c 	gnutls_pk_params_release(&amp;session-&gt;key.proto.tls12.ecdh.params);</span>
<span class='curline'><a href='../S/5324.html#L138'>session</a>           138 lib/auth/ecdhe.c int _gnutls_proc_ecdh_common_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L169'>session</a>           169 lib/auth/ecdhe.c 					 &amp;session-&gt;key.proto.tls12.ecdh.x,</span>
<span class='curline'><a href='../S/5324.html#L170'>session</a>           170 lib/auth/ecdhe.c 					 &amp;session-&gt;key.proto.tls12.ecdh.y);</span>
<span class='curline'><a href='../S/5324.html#L180'>session</a>           180 lib/auth/ecdhe.c 		ret = _gnutls_set_datum(&amp;session-&gt;key.proto.tls12.ecdh.raw,</span>
<span class='curline'><a href='../S/5324.html#L190'>session</a>           190 lib/auth/ecdhe.c 			session-&gt;key.proto.tls12.ecdh.raw.data[point_size-1] &amp;= 0x7f;</span>
<span class='curline'><a href='../S/5324.html#L200'>session</a>           200 lib/auth/ecdhe.c 	ret = calc_ecdh_key(session, psk_key, ecurve);</span>
<span class='curline'><a href='../S/5324.html#L207'>session</a>           207 lib/auth/ecdhe.c 	gnutls_pk_params_clear(&amp;session-&gt;key.proto.tls12.ecdh.params);</span>
<span class='curline'><a href='../S/5324.html#L212'>session</a>           212 lib/auth/ecdhe.c proc_ecdhe_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L218'>session</a>           218 lib/auth/ecdhe.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5324.html#L224'>session</a>           224 lib/auth/ecdhe.c 	return _gnutls_proc_ecdh_common_client_kx(session, data,</span>
<span class='curline'><a href='../S/5324.html#L227'>session</a>           227 lib/auth/ecdhe.c 						  (session), NULL);</span>
<span class='curline'><a href='../S/5324.html#L231'>session</a>           231 lib/auth/ecdhe.c _gnutls_gen_ecdh_common_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L234'>session</a>           234 lib/auth/ecdhe.c 	return _gnutls_gen_ecdh_common_client_kx_int(session, data, NULL);</span>
<span class='curline'><a href='../S/5324.html#L238'>session</a>           238 lib/auth/ecdhe.c _gnutls_gen_ecdh_common_client_kx_int(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L244'>session</a>           244 lib/auth/ecdhe.c 	const gnutls_group_entry_st *group = get_group(session);</span>
<span class='curline'><a href='../S/5324.html#L261'>session</a>           261 lib/auth/ecdhe.c 				     &amp;session-&gt;key.proto.tls12.ecdh.params, 1);</span>
<span class='curline'><a href='../S/5324.html#L268'>session</a>           268 lib/auth/ecdhe.c 						 session-&gt;key.proto.tls12.ecdh.params.</span>
<span class='curline'><a href='../S/5324.html#L270'>session</a>           270 lib/auth/ecdhe.c 						 session-&gt;key.proto.tls12.ecdh.params.</span>
<span class='curline'><a href='../S/5324.html#L290'>session</a>           290 lib/auth/ecdhe.c 					session-&gt;key.proto.tls12.ecdh.params.raw_pub.data,</span>
<span class='curline'><a href='../S/5324.html#L291'>session</a>           291 lib/auth/ecdhe.c 					session-&gt;key.proto.tls12.ecdh.params.raw_pub.size);</span>
<span class='curline'><a href='../S/5324.html#L299'>session</a>           299 lib/auth/ecdhe.c 	ret = calc_ecdh_key(session, psk_key, ecurve);</span>
<span class='curline'><a href='../S/5324.html#L307'>session</a>           307 lib/auth/ecdhe.c 	gnutls_pk_params_clear(&amp;session-&gt;key.proto.tls12.ecdh.params);</span>
<span class='curline'><a href='../S/5324.html#L312'>session</a>           312 lib/auth/ecdhe.c proc_ecdhe_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L319'>session</a>           319 lib/auth/ecdhe.c 	    _gnutls_proc_ecdh_common_server_kx(session, data, _data_size);</span>
<span class='curline'><a href='../S/5324.html#L326'>session</a>           326 lib/auth/ecdhe.c 	return _gnutls_proc_dhe_signature(session, data + ret,</span>
<span class='curline'><a href='../S/5324.html#L331'>session</a>           331 lib/auth/ecdhe.c _gnutls_proc_ecdh_common_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L341'>session</a>           341 lib/auth/ecdhe.c 	gnutls_pk_params_release(&amp;session-&gt;key.proto.tls12.ecdh.params);</span>
<span class='curline'><a href='../S/5324.html#L343'>session</a>           343 lib/auth/ecdhe.c 	gnutls_pk_params_init(&amp;session-&gt;key.proto.tls12.ecdh.params);</span>
<span class='curline'><a href='../S/5324.html#L362'>session</a>           362 lib/auth/ecdhe.c 	ret = _gnutls_session_supports_group(session, group-&gt;id);</span>
<span class='curline'><a href='../S/5324.html#L371'>session</a>           371 lib/auth/ecdhe.c 	_gnutls_session_group_set(session, group);</span>
<span class='curline'><a href='../S/5324.html#L382'>session</a>           382 lib/auth/ecdhe.c 						 &amp;session-&gt;key.proto.tls12.ecdh.x,</span>
<span class='curline'><a href='../S/5324.html#L383'>session</a>           383 lib/auth/ecdhe.c 						 &amp;session-&gt;key.proto.tls12.ecdh.y);</span>
<span class='curline'><a href='../S/5324.html#L392'>session</a>           392 lib/auth/ecdhe.c 		ret = _gnutls_set_datum(&amp;session-&gt;key.proto.tls12.ecdh.raw,</span>
<span class='curline'><a href='../S/5324.html#L400'>session</a>           400 lib/auth/ecdhe.c 			session-&gt;key.proto.tls12.ecdh.raw.data[point_size-1] &amp;= 0x7f;</span>
<span class='curline'><a href='../S/5324.html#L413'>session</a>           413 lib/auth/ecdhe.c int _gnutls_ecdh_common_print_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5324.html#L426'>session</a>           426 lib/auth/ecdhe.c 	gnutls_pk_params_release(&amp;session-&gt;key.proto.tls12.ecdh.params);</span>
<span class='curline'><a href='../S/5324.html#L428'>session</a>           428 lib/auth/ecdhe.c 	gnutls_pk_params_init(&amp;session-&gt;key.proto.tls12.ecdh.params);</span>
<span class='curline'><a href='../S/5324.html#L447'>session</a>           447 lib/auth/ecdhe.c 				     &amp;session-&gt;key.proto.tls12.ecdh.params, 1);</span>
<span class='curline'><a href='../S/5324.html#L454'>session</a>           454 lib/auth/ecdhe.c 						 session-&gt;key.proto.tls12.ecdh.params.</span>
<span class='curline'><a href='../S/5324.html#L456'>session</a>           456 lib/auth/ecdhe.c 						 session-&gt;key.proto.tls12.ecdh.params.</span>
<span class='curline'><a href='../S/5324.html#L473'>session</a>           473 lib/auth/ecdhe.c 					session-&gt;key.proto.tls12.ecdh.params.raw_pub.data,</span>
<span class='curline'><a href='../S/5324.html#L474'>session</a>           474 lib/auth/ecdhe.c 					session-&gt;key.proto.tls12.ecdh.params.raw_pub.size);</span>
<span class='curline'><a href='../S/5324.html#L486'>session</a>           486 lib/auth/ecdhe.c gen_ecdhe_server_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5324.html#L493'>session</a>           493 lib/auth/ecdhe.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5324.html#L499'>session</a>           499 lib/auth/ecdhe.c 	if ((ret = _gnutls_auth_info_init(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5324.html#L509'>session</a>           509 lib/auth/ecdhe.c 	    _gnutls_ecdh_common_print_server_kx(session, data,</span>
<span class='curline'><a href='../S/5324.html#L511'>session</a>           511 lib/auth/ecdhe.c 						(session));</span>
<span class='curline'><a href='../S/5324.html#L518'>session</a>           518 lib/auth/ecdhe.c 	return _gnutls_gen_dhe_signature(session, data, &amp;data-&gt;data[sig_pos],</span>
<span class='curline'><a href='../S/5314.html#L30'>session</a>            30 lib/auth/ecdhe.h _gnutls_gen_ecdh_common_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5314.html#L34'>session</a>            34 lib/auth/ecdhe.h _gnutls_gen_ecdh_common_client_kx_int(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5314.html#L39'>session</a>            39 lib/auth/ecdhe.h _gnutls_proc_ecdh_common_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5314.html#L47'>session</a>            47 lib/auth/ecdhe.h int _gnutls_proc_ecdh_common_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5319.html#L39'>session</a>            39 lib/auth/psk.c _gnutls_proc_psk_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5319.html#L63'>session</a>            63 lib/auth/psk.c _gnutls_set_psk_session_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5319.html#L79'>session</a>            79 lib/auth/psk.c 	session-&gt;key.key.size = 4 + dh_secret_size + ppsk-&gt;size;</span>
<span class='curline'><a href='../S/5319.html#L80'>session</a>            80 lib/auth/psk.c 	session-&gt;key.key.data = gnutls_malloc(session-&gt;key.key.size);</span>
<span class='curline'><a href='../S/5319.html#L81'>session</a>            81 lib/auth/psk.c 	if (session-&gt;key.key.data == NULL) {</span>
<span class='curline'><a href='../S/5319.html#L93'>session</a>            93 lib/auth/psk.c 	p = session-&gt;key.key.data;</span>
<span class='curline'><a href='../S/5319.html#L125'>session</a>           125 lib/auth/psk.c _gnutls_gen_psk_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5319.html#L135'>session</a>           135 lib/auth/psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5319.html#L142'>session</a>           142 lib/auth/psk.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5319.html#L148'>session</a>           148 lib/auth/psk.c 	ret = _gnutls_find_psk_key(session, cred, &amp;username, &amp;key, &amp;free);</span>
<span class='curline'><a href='../S/5319.html#L152'>session</a>           152 lib/auth/psk.c 	ret = _gnutls_set_psk_session_key(session, &amp;key, NULL);</span>
<span class='curline'><a href='../S/5319.html#L188'>session</a>           188 lib/auth/psk.c _gnutls_proc_psk_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5319.html#L198'>session</a>           198 lib/auth/psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5319.html#L206'>session</a>           206 lib/auth/psk.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5319.html#L222'>session</a>           222 lib/auth/psk.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5319.html#L236'>session</a>           236 lib/auth/psk.c 	    _gnutls_psk_pwd_find_entry(session, info-&gt;username, info-&gt;username_len, &amp;psk_key);</span>
<span class='curline'><a href='../S/5319.html#L240'>session</a>           240 lib/auth/psk.c 	ret = _gnutls_set_psk_session_key(session, &amp;psk_key, NULL);</span>
<span class='curline'><a href='../S/5319.html#L267'>session</a>           267 lib/auth/psk.c _gnutls_gen_psk_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5319.html#L274'>session</a>           274 lib/auth/psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5319.html#L298'>session</a>           298 lib/auth/psk.c _gnutls_proc_psk_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5319.html#L308'>session</a>           308 lib/auth/psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5319.html#L316'>session</a>           316 lib/auth/psk.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5319.html#L331'>session</a>           331 lib/auth/psk.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5315.html#L83'>session</a>            83 lib/auth/psk.h _gnutls_set_psk_session_key(gnutls_session_t session, gnutls_datum_t * key,</span>
<span class='curline'><a href='../S/5315.html#L85'>session</a>            85 lib/auth/psk.h int _gnutls_gen_psk_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5332.html#L153'>session</a>           153 lib/auth/psk_passwd.c _gnutls_psk_pwd_find_entry(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5332.html#L168'>session</a>           168 lib/auth/psk_passwd.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5332.html#L178'>session</a>           178 lib/auth/psk_passwd.c 		ret = cred-&gt;pwd_callback(session, &amp;username_datum, psk);</span>
<span class='curline'><a href='../S/5332.html#L247'>session</a>           247 lib/auth/psk_passwd.c int _gnutls_find_psk_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5332.html#L262'>session</a>           262 lib/auth/psk_passwd.c 		ret = cred-&gt;get_function(session, username, key);</span>
<span class='curline'><a href='../S/5327.html#L31'>session</a>            31 lib/auth/psk_passwd.h int _gnutls_find_psk_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5316.html#L66'>session</a>            66 lib/auth/rsa.c int check_key_usage_for_enc(gnutls_session_t session, unsigned key_usage)</span>
<span class='curline'><a href='../S/5316.html#L71'>session</a>            71 lib/auth/rsa.c 			if (session-&gt;internals.allow_key_usage_violation == 0) {</span>
<span class='curline'><a href='../S/5316.html#L72'>session</a>            72 lib/auth/rsa.c 				_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5316.html#L76'>session</a>            76 lib/auth/rsa.c 				_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5316.html#L99'>session</a>            99 lib/auth/rsa.c _gnutls_get_public_rsa_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5316.html#L108'>session</a>           108 lib/auth/rsa.c 	assert(!IS_SERVER(session));</span>
<span class='curline'><a href='../S/5316.html#L112'>session</a>           112 lib/auth/rsa.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5316.html#L120'>session</a>           120 lib/auth/rsa.c 	cert_type = get_certificate_type(session, GNUTLS_CTYPE_SERVER);</span>
<span class='curline'><a href='../S/5316.html#L131'>session</a>           131 lib/auth/rsa.c 	ret = check_key_usage_for_enc(session, key_usage);</span>
<span class='curline'><a href='../S/5316.html#L155'>session</a>           155 lib/auth/rsa.c proc_rsa_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5316.html#L167'>session</a>           167 lib/auth/rsa.c 	if (get_num_version(session) == GNUTLS_SSL3) {</span>
<span class='curline'><a href='../S/5316.html#L188'>session</a>           188 lib/auth/rsa.c 	ver_maj = _gnutls_get_adv_version_major(session);</span>
<span class='curline'><a href='../S/5316.html#L189'>session</a>           189 lib/auth/rsa.c 	ver_min = _gnutls_get_adv_version_minor(session);</span>
<span class='curline'><a href='../S/5316.html#L190'>session</a>           190 lib/auth/rsa.c 	check_ver_min = (session-&gt;internals.allow_wrong_pms == 0);</span>
<span class='curline'><a href='../S/5316.html#L192'>session</a>           192 lib/auth/rsa.c 	session-&gt;key.key.data = gnutls_malloc(GNUTLS_MASTER_SIZE);</span>
<span class='curline'><a href='../S/5316.html#L193'>session</a>           193 lib/auth/rsa.c 	if (session-&gt;key.key.data == NULL) {</span>
<span class='curline'><a href='../S/5316.html#L197'>session</a>           197 lib/auth/rsa.c 	session-&gt;key.key.size = GNUTLS_MASTER_SIZE;</span>
<span class='curline'><a href='../S/5316.html#L200'>session</a>           200 lib/auth/rsa.c 	ret = gnutls_rnd(GNUTLS_RND_NONCE, session-&gt;key.key.data,</span>
<span class='curline'><a href='../S/5316.html#L203'>session</a>           203 lib/auth/rsa.c 		gnutls_free(session-&gt;key.key.data);</span>
<span class='curline'><a href='../S/5316.html#L204'>session</a>           204 lib/auth/rsa.c 		session-&gt;key.key.size = 0;</span>
<span class='curline'><a href='../S/5316.html#L210'>session</a>           210 lib/auth/rsa.c 	    gnutls_privkey_decrypt_data2(session-&gt;internals.selected_key,</span>
<span class='curline'><a href='../S/5316.html#L211'>session</a>           211 lib/auth/rsa.c 					 0, &amp;ciphertext, session-&gt;key.key.data,</span>
<span class='curline'><a href='../S/5316.html#L212'>session</a>           212 lib/auth/rsa.c 					 session-&gt;key.key.size);</span>
<span class='curline'><a href='../S/5316.html#L233'>session</a>           233 lib/auth/rsa.c 	ok &amp;= CONSTCHECK_EQUAL(session-&gt;key.key.data[0], ver_maj);</span>
<span class='curline'><a href='../S/5316.html#L236'>session</a>           236 lib/auth/rsa.c 	        CONSTCHECK_EQUAL(session-&gt;key.key.data[1], ver_min);</span>
<span class='curline'><a href='../S/5316.html#L250'>session</a>           250 lib/auth/rsa.c 	session-&gt;key.key.data[0] = ver_maj;</span>
<span class='curline'><a href='../S/5316.html#L251'>session</a>           251 lib/auth/rsa.c 	session-&gt;key.key.data[1] = ver_min;</span>
<span class='curline'><a href='../S/5316.html#L261'>session</a>           261 lib/auth/rsa.c _gnutls_gen_rsa_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5316.html#L264'>session</a>           264 lib/auth/rsa.c 	cert_auth_info_t auth = session-&gt;key.auth_info;</span>
<span class='curline'><a href='../S/5316.html#L277'>session</a>           277 lib/auth/rsa.c 	session-&gt;key.key.size = GNUTLS_MASTER_SIZE;</span>
<span class='curline'><a href='../S/5316.html#L278'>session</a>           278 lib/auth/rsa.c 	session-&gt;key.key.data = gnutls_malloc(session-&gt;key.key.size);</span>
<span class='curline'><a href='../S/5316.html#L280'>session</a>           280 lib/auth/rsa.c 	if (session-&gt;key.key.data == NULL) {</span>
<span class='curline'><a href='../S/5316.html#L285'>session</a>           285 lib/auth/rsa.c 	ret = gnutls_rnd(GNUTLS_RND_RANDOM, session-&gt;key.key.data,</span>
<span class='curline'><a href='../S/5316.html#L286'>session</a>           286 lib/auth/rsa.c 			  session-&gt;key.key.size);</span>
<span class='curline'><a href='../S/5316.html#L292'>session</a>           292 lib/auth/rsa.c 	if (session-&gt;internals.rsa_pms_version[0] == 0) {</span>
<span class='curline'><a href='../S/5316.html#L293'>session</a>           293 lib/auth/rsa.c 		session-&gt;key.key.data[0] =</span>
<span class='curline'><a href='../S/5316.html#L294'>session</a>           294 lib/auth/rsa.c 		    _gnutls_get_adv_version_major(session);</span>
<span class='curline'><a href='../S/5316.html#L295'>session</a>           295 lib/auth/rsa.c 		session-&gt;key.key.data[1] =</span>
<span class='curline'><a href='../S/5316.html#L296'>session</a>           296 lib/auth/rsa.c 		    _gnutls_get_adv_version_minor(session);</span>
<span class='curline'><a href='../S/5316.html#L298'>session</a>           298 lib/auth/rsa.c 		session-&gt;key.key.data[0] =</span>
<span class='curline'><a href='../S/5316.html#L299'>session</a>           299 lib/auth/rsa.c 		    session-&gt;internals.rsa_pms_version[0];</span>
<span class='curline'><a href='../S/5316.html#L300'>session</a>           300 lib/auth/rsa.c 		session-&gt;key.key.data[1] =</span>
<span class='curline'><a href='../S/5316.html#L301'>session</a>           301 lib/auth/rsa.c 		    session-&gt;internals.rsa_pms_version[1];</span>
<span class='curline'><a href='../S/5316.html#L306'>session</a>           306 lib/auth/rsa.c 	if ((ret = _gnutls_get_public_rsa_params(session, &amp;params)) &lt; 0) {</span>
<span class='curline'><a href='../S/5316.html#L312'>session</a>           312 lib/auth/rsa.c 	    _gnutls_pk_encrypt(GNUTLS_PK_RSA, &amp;sdata, &amp;session-&gt;key.key,</span>
<span class='curline'><a href='../S/5316.html#L322'>session</a>           322 lib/auth/rsa.c 	if (get_num_version(session) == GNUTLS_SSL3) {</span>
<span class='curline'><a href='../S/5313.html#L36'>session</a>            36 lib/auth/rsa_common.h _gnutls_get_public_rsa_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5330.html#L52'>session</a>            52 lib/auth/rsa_psk.c static int _gnutls_gen_rsa_psk_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5330.html#L57'>session</a>            57 lib/auth/rsa_psk.c _gnutls_proc_rsa_psk_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5330.html#L79'>session</a>            79 lib/auth/rsa_psk.c set_rsa_psk_session_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5330.html#L91'>session</a>            91 lib/auth/rsa_psk.c 	session-&gt;key.key.size = 2 + rsa_secret_size + 2 + ppsk-&gt;size;</span>
<span class='curline'><a href='../S/5330.html#L92'>session</a>            92 lib/auth/rsa_psk.c 	session-&gt;key.key.data = gnutls_malloc(session-&gt;key.key.size);</span>
<span class='curline'><a href='../S/5330.html#L93'>session</a>            93 lib/auth/rsa_psk.c 	if (session-&gt;key.key.data == NULL) {</span>
<span class='curline'><a href='../S/5330.html#L105'>session</a>           105 lib/auth/rsa_psk.c 	_gnutls_write_uint16(rsa_secret_size, session-&gt;key.key.data);</span>
<span class='curline'><a href='../S/5330.html#L106'>session</a>           106 lib/auth/rsa_psk.c 	memcpy(&amp;session-&gt;key.key.data[2], rsa_secret-&gt;data,</span>
<span class='curline'><a href='../S/5330.html#L108'>session</a>           108 lib/auth/rsa_psk.c 	p = &amp;session-&gt;key.key.data[rsa_secret_size + 2];</span>
<span class='curline'><a href='../S/5330.html#L130'>session</a>           130 lib/auth/rsa_psk.c _gnutls_gen_rsa_psk_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5330.html#L133'>session</a>           133 lib/auth/rsa_psk.c 	cert_auth_info_t auth = session-&gt;key.auth_info;</span>
<span class='curline'><a href='../S/5330.html#L168'>session</a>           168 lib/auth/rsa_psk.c 	if (session-&gt;internals.rsa_pms_version[0] == 0) {</span>
<span class='curline'><a href='../S/5330.html#L170'>session</a>           170 lib/auth/rsa_psk.c 		    _gnutls_get_adv_version_major(session);</span>
<span class='curline'><a href='../S/5330.html#L172'>session</a>           172 lib/auth/rsa_psk.c 		    _gnutls_get_adv_version_minor(session);</span>
<span class='curline'><a href='../S/5330.html#L175'>session</a>           175 lib/auth/rsa_psk.c 		    session-&gt;internals.rsa_pms_version[0];</span>
<span class='curline'><a href='../S/5330.html#L177'>session</a>           177 lib/auth/rsa_psk.c 		    session-&gt;internals.rsa_pms_version[1];</span>
<span class='curline'><a href='../S/5330.html#L182'>session</a>           182 lib/auth/rsa_psk.c 	if ((ret = _gnutls_get_public_rsa_params(session, &amp;params)) &lt; 0) {</span>
<span class='curline'><a href='../S/5330.html#L198'>session</a>           198 lib/auth/rsa_psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5330.html#L205'>session</a>           205 lib/auth/rsa_psk.c 	ret = _gnutls_find_psk_key(session, cred, &amp;username, &amp;key, &amp;free);</span>
<span class='curline'><a href='../S/5330.html#L210'>session</a>           210 lib/auth/rsa_psk.c 	ret = set_rsa_psk_session_key(session, &amp;key, &amp;premaster_secret);</span>
<span class='curline'><a href='../S/5330.html#L262'>session</a>           262 lib/auth/rsa_psk.c _gnutls_proc_rsa_psk_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5330.html#L277'>session</a>           277 lib/auth/rsa_psk.c 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5330.html#L284'>session</a>           284 lib/auth/rsa_psk.c 	ret = _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/5330.html#L302'>session</a>           302 lib/auth/rsa_psk.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5330.html#L331'>session</a>           331 lib/auth/rsa_psk.c 	    gnutls_privkey_decrypt_data(session-&gt;internals.selected_key, 0,</span>
<span class='curline'><a href='../S/5330.html#L349'>session</a>           349 lib/auth/rsa_psk.c 		if (_gnutls_get_adv_version_major(session) !=</span>
<span class='curline'><a href='../S/5330.html#L351'>session</a>           351 lib/auth/rsa_psk.c 		    || (session-&gt;internals.allow_wrong_pms == 0</span>
<span class='curline'><a href='../S/5330.html#L352'>session</a>           352 lib/auth/rsa_psk.c 			&amp;&amp; _gnutls_get_adv_version_minor(session) !=</span>
<span class='curline'><a href='../S/5330.html#L393'>session</a>           393 lib/auth/rsa_psk.c 	premaster_secret.data[0] = _gnutls_get_adv_version_major(session);</span>
<span class='curline'><a href='../S/5330.html#L394'>session</a>           394 lib/auth/rsa_psk.c 	premaster_secret.data[1] = _gnutls_get_adv_version_minor(session);</span>
<span class='curline'><a href='../S/5330.html#L399'>session</a>           399 lib/auth/rsa_psk.c 	    _gnutls_psk_pwd_find_entry(session, info-&gt;username, strlen(info-&gt;username), &amp;pwd_psk);</span>
<span class='curline'><a href='../S/5330.html#L406'>session</a>           406 lib/auth/rsa_psk.c 	    set_rsa_psk_session_key(session, &amp;pwd_psk, &amp;premaster_secret);</span>
<span class='curline'><a href='../S/5330.html#L421'>session</a>           421 lib/auth/rsa_psk.c _gnutls_proc_rsa_psk_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5331.html#L55'>session</a>            55 lib/auth/srp_kx.c #define _b session-&gt;key.proto.tls12.srp.b</span>
<span class='curline'><a href='../S/5331.html#L56'>session</a>            56 lib/auth/srp_kx.c #define B session-&gt;key.proto.tls12.srp.B</span>
<span class='curline'><a href='../S/5331.html#L57'>session</a>            57 lib/auth/srp_kx.c #define _a session-&gt;key.proto.tls12.srp.a</span>
<span class='curline'><a href='../S/5331.html#L58'>session</a>            58 lib/auth/srp_kx.c #define A session-&gt;key.proto.tls12.srp.A</span>
<span class='curline'><a href='../S/5331.html#L59'>session</a>            59 lib/auth/srp_kx.c #define N session-&gt;key.proto.tls12.srp.srp_p</span>
<span class='curline'><a href='../S/5331.html#L60'>session</a>            60 lib/auth/srp_kx.c #define G session-&gt;key.proto.tls12.srp.srp_g</span>
<span class='curline'><a href='../S/5331.html#L61'>session</a>            61 lib/auth/srp_kx.c #define V session-&gt;key.proto.tls12.srp.x</span>
<span class='curline'><a href='../S/5331.html#L62'>session</a>            62 lib/auth/srp_kx.c #define S session-&gt;key.proto.tls12.srp.srp_key</span>
<span class='curline'><a href='../S/5331.html#L118'>session</a>           118 lib/auth/srp_kx.c _gnutls_gen_srp_server_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5331.html#L131'>session</a>           131 lib/auth/srp_kx.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRP,</span>
<span class='curline'><a href='../S/5331.html#L140'>session</a>           140 lib/auth/srp_kx.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_SRP,</span>
<span class='curline'><a href='../S/5331.html#L147'>session</a>           147 lib/auth/srp_kx.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_SRP);</span>
<span class='curline'><a href='../S/5331.html#L155'>session</a>           155 lib/auth/srp_kx.c 	ret = _gnutls_srp_pwd_read_entry(session, username, &amp;pwd_entry);</span>
<span class='curline'><a href='../S/5331.html#L246'>session</a>           246 lib/auth/srp_kx.c _gnutls_gen_srp_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5331.html#L256'>session</a>           256 lib/auth/srp_kx.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRP,</span>
<span class='curline'><a href='../S/5331.html#L265'>session</a>           265 lib/auth/srp_kx.c 	    _gnutls_get_cred(session, GNUTLS_CRD_SRP);</span>
<span class='curline'><a href='../S/5331.html#L303'>session</a>           303 lib/auth/srp_kx.c 	session-&gt;key.proto.tls12.srp.u = _gnutls_calc_srp_u(A, B, N);</span>
<span class='curline'><a href='../S/5331.html#L304'>session</a>           304 lib/auth/srp_kx.c 	if (session-&gt;key.proto.tls12.srp.u == NULL) {</span>
<span class='curline'><a href='../S/5331.html#L309'>session</a>           309 lib/auth/srp_kx.c 	_gnutls_mpi_log("SRP U: ", session-&gt;key.proto.tls12.srp.u);</span>
<span class='curline'><a href='../S/5331.html#L312'>session</a>           312 lib/auth/srp_kx.c 	S = _gnutls_calc_srp_S2(B, G, session-&gt;key.proto.tls12.srp.x, _a, session-&gt;key.proto.tls12.srp.u,</span>
<span class='curline'><a href='../S/5331.html#L323'>session</a>           323 lib/auth/srp_kx.c 	zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.u);</span>
<span class='curline'><a href='../S/5331.html#L326'>session</a>           326 lib/auth/srp_kx.c 	ret = _gnutls_mpi_dprint(session-&gt;key.proto.tls12.srp.srp_key, &amp;session-&gt;key.key);</span>
<span class='curline'><a href='../S/5331.html#L348'>session</a>           348 lib/auth/srp_kx.c _gnutls_proc_srp_client_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5331.html#L377'>session</a>           377 lib/auth/srp_kx.c 	session-&gt;key.proto.tls12.srp.u = _gnutls_calc_srp_u(A, B, N);</span>
<span class='curline'><a href='../S/5331.html#L378'>session</a>           378 lib/auth/srp_kx.c 	if (session-&gt;key.proto.tls12.srp.u == NULL) {</span>
<span class='curline'><a href='../S/5331.html#L383'>session</a>           383 lib/auth/srp_kx.c 	_gnutls_mpi_log("SRP U: ", session-&gt;key.proto.tls12.srp.u);</span>
<span class='curline'><a href='../S/5331.html#L387'>session</a>           387 lib/auth/srp_kx.c 	S = _gnutls_calc_srp_S1(A, _b, session-&gt;key.proto.tls12.srp.u, V, N);</span>
<span class='curline'><a href='../S/5331.html#L398'>session</a>           398 lib/auth/srp_kx.c 	zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.u);</span>
<span class='curline'><a href='../S/5331.html#L401'>session</a>           401 lib/auth/srp_kx.c 	ret = _gnutls_mpi_dprint(session-&gt;key.proto.tls12.srp.srp_key, &amp;session-&gt;key.key);</span>
<span class='curline'><a href='../S/5331.html#L869'>session</a>           869 lib/auth/srp_kx.c _gnutls_proc_srp_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5331.html#L888'>session</a>           888 lib/auth/srp_kx.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRP,</span>
<span class='curline'><a href='../S/5331.html#L897'>session</a>           897 lib/auth/srp_kx.c 	    _gnutls_get_cred(session, GNUTLS_CRD_SRP);</span>
<span class='curline'><a href='../S/5331.html#L984'>session</a>           984 lib/auth/srp_kx.c 		_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5331.html#L1007'>session</a>          1007 lib/auth/srp_kx.c 	if (_gnutls_mpi_init_scan_nz(&amp;session-&gt;key.proto.tls12.srp.x, hd, _n_g) != 0) {</span>
<span class='curline'><a href='../S/5323.html#L80'>session</a>            80 lib/auth/srp_rsa.c gen_srp_cert_server_kx(gnutls_session_t session, gnutls_buffer_st * data)</span>
<span class='curline'><a href='../S/5323.html#L89'>session</a>            89 lib/auth/srp_rsa.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5323.html#L97'>session</a>            97 lib/auth/srp_rsa.c 	ret = _gnutls_gen_srp_server_kx(session, data);</span>
<span class='curline'><a href='../S/5323.html#L106'>session</a>           106 lib/auth/srp_rsa.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5323.html#L114'>session</a>           114 lib/auth/srp_rsa.c 	     _gnutls_get_selected_cert(session, &amp;apr_cert_list,</span>
<span class='curline'><a href='../S/5323.html#L122'>session</a>           122 lib/auth/srp_rsa.c 	     _gnutls_handshake_sign_data(session, &amp;apr_cert_list[0],</span>
<span class='curline'><a href='../S/5323.html#L172'>session</a>           172 lib/auth/srp_rsa.c proc_srp_cert_server_kx(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5323.html#L185'>session</a>           185 lib/auth/srp_rsa.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5323.html#L190'>session</a>           190 lib/auth/srp_rsa.c 	ret = _gnutls_proc_srp_server_kx(session, data, _data_size);</span>
<span class='curline'><a href='../S/5323.html#L197'>session</a>           197 lib/auth/srp_rsa.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5323.html#L203'>session</a>           203 lib/auth/srp_rsa.c 	vflags = cred-&gt;verify_flags | session-&gt;internals.additional_verify_flags;</span>
<span class='curline'><a href='../S/5323.html#L205'>session</a>           205 lib/auth/srp_rsa.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5323.html#L244'>session</a>           244 lib/auth/srp_rsa.c 					session-&gt;security_parameters.server_ctype, info);</span>
<span class='curline'><a href='../S/5323.html#L252'>session</a>           252 lib/auth/srp_rsa.c 	    _gnutls_handshake_verify_data(session, vflags, &amp;peer_cert, &amp;vparams,</span>
<span class='curline'><a href='../S/5325.html#L36'>session</a>            36 lib/auth/vko_gost.c static int proc_vko_gost_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5325.html#L74'>session</a>            74 lib/auth/vko_gost.c calc_ukm(gnutls_session_t session, uint8_t *ukm)</span>
<span class='curline'><a href='../S/5325.html#L84'>session</a>            84 lib/auth/vko_gost.c 	gnutls_hash(dig, session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5325.html#L85'>session</a>            85 lib/auth/vko_gost.c 		    sizeof(session-&gt;security_parameters.client_random));</span>
<span class='curline'><a href='../S/5325.html#L87'>session</a>            87 lib/auth/vko_gost.c 	gnutls_hash(dig, session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5325.html#L88'>session</a>            88 lib/auth/vko_gost.c 		    sizeof(session-&gt;security_parameters.server_random));</span>
<span class='curline'><a href='../S/5325.html#L120'>session</a>           120 lib/auth/vko_gost.c vko_prepare_client_keys(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5325.html#L130'>session</a>           130 lib/auth/vko_gost.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5325.html#L135'>session</a>           135 lib/auth/vko_gost.c 					  session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5325.html#L155'>session</a>           155 lib/auth/vko_gost.c 	ret = _gnutls_session_supports_group(session, group-&gt;id);</span>
<span class='curline'><a href='../S/5325.html#L160'>session</a>           160 lib/auth/vko_gost.c 		gnutls_sign_algorithm_set_server(session, GNUTLS_SIGN_GOST_512);</span>
<span class='curline'><a href='../S/5325.html#L162'>session</a>           162 lib/auth/vko_gost.c 		gnutls_sign_algorithm_set_server(session, GNUTLS_SIGN_GOST_256);</span>
<span class='curline'><a href='../S/5325.html#L165'>session</a>           165 lib/auth/vko_gost.c 	_gnutls_session_group_set(session, group);</span>
<span class='curline'><a href='../S/5325.html#L177'>session</a>           177 lib/auth/vko_gost.c 	session-&gt;key.key.size = 32; /* GOST key size */</span>
<span class='curline'><a href='../S/5325.html#L178'>session</a>           178 lib/auth/vko_gost.c 	session-&gt;key.key.data = gnutls_malloc(session-&gt;key.key.size);</span>
<span class='curline'><a href='../S/5325.html#L179'>session</a>           179 lib/auth/vko_gost.c 	if (session-&gt;key.key.data == NULL) {</span>
<span class='curline'><a href='../S/5325.html#L181'>session</a>           181 lib/auth/vko_gost.c 		session-&gt;key.key.size = 0;</span>
<span class='curline'><a href='../S/5325.html#L186'>session</a>           186 lib/auth/vko_gost.c 	ret = gnutls_rnd(GNUTLS_RND_RANDOM, session-&gt;key.key.data,</span>
<span class='curline'><a href='../S/5325.html#L187'>session</a>           187 lib/auth/vko_gost.c 			 session-&gt;key.key.size);</span>
<span class='curline'><a href='../S/5325.html#L190'>session</a>           190 lib/auth/vko_gost.c 		gnutls_free(session-&gt;key.key.data);</span>
<span class='curline'><a href='../S/5325.html#L191'>session</a>           191 lib/auth/vko_gost.c 		session-&gt;key.key.size = 0;</span>
<span class='curline'><a href='../S/5325.html#L213'>session</a>           213 lib/auth/vko_gost.c proc_vko_gost_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5325.html#L218'>session</a>           218 lib/auth/vko_gost.c 	gnutls_privkey_t privkey = session-&gt;internals.selected_key;</span>
<span class='curline'><a href='../S/5325.html#L254'>session</a>           254 lib/auth/vko_gost.c 	ret = calc_ukm(session, ukm_data);</span>
<span class='curline'><a href='../S/5325.html#L260'>session</a>           260 lib/auth/vko_gost.c 					    &amp;session-&gt;key.key);</span>
<span class='curline'><a href='../S/5325.html#L268'>session</a>           268 lib/auth/vko_gost.c gen_vko_gost_client_kx(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5325.html#L280'>session</a>           280 lib/auth/vko_gost.c 	ret = calc_ukm(session, ukm_data);</span>
<span class='curline'><a href='../S/5325.html#L286'>session</a>           286 lib/auth/vko_gost.c 	ret = vko_prepare_client_keys(session, &amp;pub, &amp;priv);</span>
<span class='curline'><a href='../S/5325.html#L292'>session</a>           292 lib/auth/vko_gost.c 					    &amp;session-&gt;key.key,</span>
<span class='curline'><a href='../S/5624.html#L32'>session</a>            32 lib/auto-verify.c static int auto_verify_cb(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5624.html#L37'>session</a>            37 lib/auto-verify.c 	if (session-&gt;internals.vc_elements == 0) {</span>
<span class='curline'><a href='../S/5624.html#L38'>session</a>            38 lib/auto-verify.c 		ret = gnutls_certificate_verify_peers2(session, &amp;status);</span>
<span class='curline'><a href='../S/5624.html#L40'>session</a>            40 lib/auto-verify.c 		ret = gnutls_certificate_verify_peers(session, session-&gt;internals.vc_data,</span>
<span class='curline'><a href='../S/5624.html#L41'>session</a>            41 lib/auto-verify.c 						      session-&gt;internals.vc_elements, &amp;status);</span>
<span class='curline'><a href='../S/5624.html#L47'>session</a>            47 lib/auto-verify.c 	session-&gt;internals.vc_status = status;</span>
<span class='curline'><a href='../S/5624.html#L81'>session</a>            81 lib/auto-verify.c void gnutls_session_set_verify_cert(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5624.html#L85'>session</a>            85 lib/auto-verify.c 		session-&gt;internals.vc_sdata.type = GNUTLS_DT_DNS_HOSTNAME;</span>
<span class='curline'><a href='../S/5624.html#L86'>session</a>            86 lib/auto-verify.c 		session-&gt;internals.vc_sdata.data = (void*)hostname;</span>
<span class='curline'><a href='../S/5624.html#L87'>session</a>            87 lib/auto-verify.c 		session-&gt;internals.vc_sdata.size = 0;</span>
<span class='curline'><a href='../S/5624.html#L88'>session</a>            88 lib/auto-verify.c 		session-&gt;internals.vc_elements = 1;</span>
<span class='curline'><a href='../S/5624.html#L89'>session</a>            89 lib/auto-verify.c 		session-&gt;internals.vc_data = &amp;session-&gt;internals.vc_sdata;</span>
<span class='curline'><a href='../S/5624.html#L91'>session</a>            91 lib/auto-verify.c 		session-&gt;internals.vc_elements = 0;</span>
<span class='curline'><a href='../S/5624.html#L95'>session</a>            95 lib/auto-verify.c 		ADD_PROFILE_VFLAGS(session, flags);</span>
<span class='curline'><a href='../S/5624.html#L98'>session</a>            98 lib/auto-verify.c 	gnutls_session_set_verify_function(session, auto_verify_cb);</span>
<span class='curline'><a href='../S/5624.html#L122'>session</a>           122 lib/auto-verify.c void gnutls_session_set_verify_cert2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5624.html#L127'>session</a>           127 lib/auto-verify.c 	session-&gt;internals.vc_data = data;</span>
<span class='curline'><a href='../S/5624.html#L128'>session</a>           128 lib/auto-verify.c 	session-&gt;internals.vc_elements = elements;</span>
<span class='curline'><a href='../S/5624.html#L131'>session</a>           131 lib/auto-verify.c 		session-&gt;internals.additional_verify_flags |= flags;</span>
<span class='curline'><a href='../S/5624.html#L133'>session</a>           133 lib/auto-verify.c 	gnutls_session_set_verify_function(session, auto_verify_cb);</span>
<span class='curline'><a href='../S/5624.html#L151'>session</a>           151 lib/auto-verify.c unsigned int gnutls_session_get_verify_cert_status(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5624.html#L153'>session</a>           153 lib/auto-verify.c 	return session-&gt;internals.vc_status;</span>
<span class='curline'><a href='../S/5984.html#L69'>session</a>            69 lib/buffers.c  _gnutls_record_buffer_put(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5984.html#L77'>session</a>            77 lib/buffers.c  	_mbuffer_enqueue(&amp;session-&gt;internals.record_buffer, bufel);</span>
<span class='curline'><a href='../S/5984.html#L95'>session</a>            95 lib/buffers.c  size_t gnutls_record_check_pending(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5984.html#L97'>session</a>            97 lib/buffers.c  	return _gnutls_record_buffer_get_size(session);</span>
<span class='curline'><a href='../S/5984.html#L111'>session</a>           111 lib/buffers.c  size_t gnutls_record_check_corked(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5984.html#L113'>session</a>           113 lib/buffers.c  	return session-&gt;internals.record_presend_buffer.length;</span>
<span class='curline'><a href='../S/5984.html#L118'>session</a>           118 lib/buffers.c  			  gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5984.html#L130'>session</a>           130 lib/buffers.c  	    _mbuffer_head_get_first(&amp;session-&gt;internals.record_buffer,</span>
<span class='curline'><a href='../S/5984.html#L138'>session</a>           138 lib/buffers.c  		if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5984.html#L139'>session</a>           139 lib/buffers.c  			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5984.html#L149'>session</a>           149 lib/buffers.c  		_mbuffer_head_remove_bytes(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L161'>session</a>           161 lib/buffers.c  	_mbuffer_head_remove_bytes(&amp;session-&gt;internals.record_buffer,</span>
<span class='curline'><a href='../S/5984.html#L168'>session</a>           168 lib/buffers.c  _gnutls_record_buffer_get_packet(content_type_t type, gnutls_session_t session, gnutls_packet_t *packet)</span>
<span class='curline'><a href='../S/5984.html#L173'>session</a>           173 lib/buffers.c  	    _mbuffer_head_pop_first(&amp;session-&gt;internals.record_buffer);</span>
<span class='curline'><a href='../S/5984.html#L180'>session</a>           180 lib/buffers.c  		if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5984.html#L181'>session</a>           181 lib/buffers.c  			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5984.html#L186'>session</a>           186 lib/buffers.c  		_mbuffer_head_remove_bytes(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L196'>session</a>           196 lib/buffers.c  inline static void reset_errno(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5984.html#L198'>session</a>           198 lib/buffers.c  	session-&gt;internals.errnum = 0;</span>
<span class='curline'><a href='../S/5984.html#L201'>session</a>           201 lib/buffers.c  inline static int get_errno(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5984.html#L205'>session</a>           205 lib/buffers.c  	if (session-&gt;internals.errnum != 0)</span>
<span class='curline'><a href='../S/5984.html#L206'>session</a>           206 lib/buffers.c  		ret = session-&gt;internals.errnum;</span>
<span class='curline'><a href='../S/5984.html#L209'>session</a>           209 lib/buffers.c  		    session-&gt;internals.errno_func(session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L236'>session</a>           236 lib/buffers.c  _gnutls_dgram_read(gnutls_session_t session, mbuffer_st ** bufel,</span>
<span class='curline'><a href='../S/5984.html#L243'>session</a>           243 lib/buffers.c  	gnutls_transport_ptr_t fd = session-&gt;internals.transport_recv_ptr;</span>
<span class='curline'><a href='../S/5984.html#L246'>session</a>           246 lib/buffers.c  	max_size = max_record_recv_size(session);</span>
<span class='curline'><a href='../S/5984.html#L249'>session</a>           249 lib/buffers.c  	session-&gt;internals.direction = 0;</span>
<span class='curline'><a href='../S/5984.html#L252'>session</a>           252 lib/buffers.c  		ret = _gnutls_io_check_recv(session, *ms);</span>
<span class='curline'><a href='../S/5984.html#L258'>session</a>           258 lib/buffers.c  	*bufel = _mbuffer_alloc_align16(max_size, get_total_headers(session));</span>
<span class='curline'><a href='../S/5984.html#L264'>session</a>           264 lib/buffers.c  	reset_errno(session);</span>
<span class='curline'><a href='../S/5984.html#L268'>session</a>           268 lib/buffers.c  		int err = get_errno(session);</span>
<span class='curline'><a href='../S/5984.html#L310'>session</a>           310 lib/buffers.c  _gnutls_stream_read(gnutls_session_t session, mbuffer_st ** bufel,</span>
<span class='curline'><a href='../S/5984.html#L316'>session</a>           316 lib/buffers.c  	size_t max_size = max_record_recv_size(session);</span>
<span class='curline'><a href='../S/5984.html#L318'>session</a>           318 lib/buffers.c  	gnutls_transport_ptr_t fd = session-&gt;internals.transport_recv_ptr;</span>
<span class='curline'><a href='../S/5984.html#L323'>session</a>           323 lib/buffers.c  	session-&gt;internals.direction = 0;</span>
<span class='curline'><a href='../S/5984.html#L325'>session</a>           325 lib/buffers.c  	*bufel = _mbuffer_alloc_align16(MAX(max_size, size), get_total_headers(session));</span>
<span class='curline'><a href='../S/5984.html#L335'>session</a>           335 lib/buffers.c  			ret = _gnutls_io_check_recv(session, *ms);</span>
<span class='curline'><a href='../S/5984.html#L344'>session</a>           344 lib/buffers.c  		reset_errno(session);</span>
<span class='curline'><a href='../S/5984.html#L349'>session</a>           349 lib/buffers.c  			int err = get_errno(session);</span>
<span class='curline'><a href='../S/5984.html#L354'>session</a>           354 lib/buffers.c  			     session-&gt;internals.errnum);</span>
<span class='curline'><a href='../S/5984.html#L419'>session</a>           419 lib/buffers.c  _gnutls_read(gnutls_session_t session, mbuffer_st ** bufel,</span>
<span class='curline'><a href='../S/5984.html#L422'>session</a>           422 lib/buffers.c  	if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5984.html#L424'>session</a>           424 lib/buffers.c  		return _gnutls_dgram_read(session, bufel, pull_func, ms);</span>
<span class='curline'><a href='../S/5984.html#L426'>session</a>           426 lib/buffers.c  		return _gnutls_stream_read(session, bufel, size, pull_func,</span>
<span class='curline'><a href='../S/5984.html#L434'>session</a>           434 lib/buffers.c  _gnutls_writev_emu(gnutls_session_t session, gnutls_transport_ptr_t fd,</span>
<span class='curline'><a href='../S/5984.html#L443'>session</a>           443 lib/buffers.c  			ret = session-&gt;internals.vec_push_func(fd, &amp;giovec[j], 1);</span>
<span class='curline'><a href='../S/5984.html#L450'>session</a>           450 lib/buffers.c  				    session-&gt;internals.push_func(fd, p,</span>
<span class='curline'><a href='../S/5984.html#L483'>session</a>           483 lib/buffers.c  _gnutls_writev(gnutls_session_t session, const giovec_t * giovec,</span>
<span class='curline'><a href='../S/5984.html#L487'>session</a>           487 lib/buffers.c  	bool is_dtls = IS_DTLS(session);</span>
<span class='curline'><a href='../S/5984.html#L489'>session</a>           489 lib/buffers.c  	gnutls_transport_ptr_t fd = session-&gt;internals.transport_send_ptr;</span>
<span class='curline'><a href='../S/5984.html#L491'>session</a>           491 lib/buffers.c  	reset_errno(session);</span>
<span class='curline'><a href='../S/5984.html#L493'>session</a>           493 lib/buffers.c  	if (session-&gt;internals.vec_push_func != NULL) {</span>
<span class='curline'><a href='../S/5984.html#L495'>session</a>           495 lib/buffers.c  			if (total &gt; session-&gt;internals.dtls.mtu) {</span>
<span class='curline'><a href='../S/5984.html#L501'>session</a>           501 lib/buffers.c  			i = session-&gt;internals.vec_push_func(fd, giovec, giovec_cnt);</span>
<span class='curline'><a href='../S/5984.html#L503'>session</a>           503 lib/buffers.c  			i = _gnutls_writev_emu(session, fd, giovec, giovec_cnt, 1);</span>
<span class='curline'><a href='../S/5984.html#L505'>session</a>           505 lib/buffers.c  	} else if (session-&gt;internals.push_func != NULL) {</span>
<span class='curline'><a href='../S/5984.html#L506'>session</a>           506 lib/buffers.c  		i = _gnutls_writev_emu(session, fd, giovec, giovec_cnt, 0);</span>
<span class='curline'><a href='../S/5984.html#L511'>session</a>           511 lib/buffers.c  		int err = get_errno(session);</span>
<span class='curline'><a href='../S/5984.html#L536'>session</a>           536 lib/buffers.c  _gnutls_io_read_buffered(gnutls_session_t session, size_t total,</span>
<span class='curline'><a href='../S/5984.html#L544'>session</a>           544 lib/buffers.c  	if (total &gt; max_record_recv_size(session) || total == 0) {</span>
<span class='curline'><a href='../S/5984.html#L553'>session</a>           553 lib/buffers.c  	    MIN(session-&gt;internals.record_recv_buffer.byte_length, total);</span>
<span class='curline'><a href='../S/5984.html#L572'>session</a>           572 lib/buffers.c  	if ((session-&gt;internals.record_recv_buffer.byte_length +</span>
<span class='curline'><a href='../S/5984.html#L573'>session</a>           573 lib/buffers.c  	     recvdata) &gt; max_record_recv_size(session)) {</span>
<span class='curline'><a href='../S/5984.html#L582'>session</a>           582 lib/buffers.c  		    _gnutls_read(session, &amp;bufel, readsize,</span>
<span class='curline'><a href='../S/5984.html#L583'>session</a>           583 lib/buffers.c  				 session-&gt;internals.pull_func, ms);</span>
<span class='curline'><a href='../S/5984.html#L599'>session</a>           599 lib/buffers.c  		     (int) session-&gt;internals.record_recv_buffer.</span>
<span class='curline'><a href='../S/5984.html#L603'>session</a>           603 lib/buffers.c  		_mbuffer_enqueue(&amp;session-&gt;internals.record_recv_buffer,</span>
<span class='curline'><a href='../S/5984.html#L606'>session</a>           606 lib/buffers.c  		if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5984.html#L609'>session</a>           609 lib/buffers.c  				session-&gt;internals.record_recv_buffer.</span>
<span class='curline'><a href='../S/5984.html#L613'>session</a>           613 lib/buffers.c  			    session-&gt;internals.record_recv_buffer.</span>
<span class='curline'><a href='../S/5984.html#L638'>session</a>           638 lib/buffers.c  _gnutls_io_write_buffered(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5984.html#L642'>session</a>           642 lib/buffers.c  	    &amp;session-&gt;internals.record_send_buffer;</span>
<span class='curline'><a href='../S/5984.html#L646'>session</a>           646 lib/buffers.c  	session-&gt;internals.direction = 1;</span>
<span class='curline'><a href='../S/5984.html#L652'>session</a>           652 lib/buffers.c  	     (int) bufel-&gt;msg.size, session-&gt;internals.transport_recv_ptr,</span>
<span class='curline'><a href='../S/5984.html#L656'>session</a>           656 lib/buffers.c  		return _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/5984.html#L667'>session</a>           667 lib/buffers.c  ssize_t _gnutls_io_write_flush(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5984.html#L671'>session</a>           671 lib/buffers.c  	    &amp;session-&gt;internals.record_send_buffer;</span>
<span class='curline'><a href='../S/5984.html#L678'>session</a>           678 lib/buffers.c  	session-&gt;internals.direction = 1;</span>
<span class='curline'><a href='../S/5984.html#L700'>session</a>           700 lib/buffers.c  	ret = _gnutls_writev(session, iovec, i, tosend);</span>
<span class='curline'><a href='../S/5984.html#L739'>session</a>           739 lib/buffers.c  int _gnutls_io_check_recv(gnutls_session_t session, unsigned int ms)</span>
<span class='curline'><a href='../S/5984.html#L741'>session</a>           741 lib/buffers.c  	gnutls_transport_ptr_t fd = session-&gt;internals.transport_recv_ptr;</span>
<span class='curline'><a href='../S/5984.html#L744'>session</a>           744 lib/buffers.c  	if (NO_TIMEOUT_FUNC_SET(session)) {</span>
<span class='curline'><a href='../S/5984.html#L749'>session</a>           749 lib/buffers.c  	reset_errno(session);</span>
<span class='curline'><a href='../S/5984.html#L751'>session</a>           751 lib/buffers.c  	ret = session-&gt;internals.pull_timeout_func(fd, ms);</span>
<span class='curline'><a href='../S/5984.html#L753'>session</a>           753 lib/buffers.c  		err = get_errno(session);</span>
<span class='curline'><a href='../S/5984.html#L757'>session</a>           757 lib/buffers.c  		return errno_to_gerr(err, IS_DTLS(session));</span>
<span class='curline'><a href='../S/5984.html#L774'>session</a>           774 lib/buffers.c  ssize_t _gnutls_handshake_io_write_flush(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5984.html#L777'>session</a>           777 lib/buffers.c  	    &amp;session-&gt;internals.handshake_send_buffer;</span>
<span class='curline'><a href='../S/5984.html#L787'>session</a>           787 lib/buffers.c  	if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5984.html#L788'>session</a>           788 lib/buffers.c  		return _dtls_transmit(session);</span>
<span class='curline'><a href='../S/5984.html#L795'>session</a>           795 lib/buffers.c  		ret = _gnutls_send_int(session, cur-&gt;type,</span>
<span class='curline'><a href='../S/5984.html#L806'>session</a>           806 lib/buffers.c  				_gnutls_epoch_refcount_dec(session, epoch);</span>
<span class='curline'><a href='../S/5984.html#L822'>session</a>           822 lib/buffers.c  	return _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/5984.html#L831'>session</a>           831 lib/buffers.c  _gnutls_handshake_io_cache_int(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5984.html#L837'>session</a>           837 lib/buffers.c  	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5984.html#L839'>session</a>           839 lib/buffers.c  		    session-&gt;internals.dtls.hsk_write_seq - 1;</span>
<span class='curline'><a href='../S/5984.html#L842'>session</a>           842 lib/buffers.c  	send_buffer = &amp;session-&gt;internals.handshake_send_buffer;</span>
<span class='curline'><a href='../S/5984.html#L847'>session</a>           847 lib/buffers.c  	    (uint16_t) _gnutls_epoch_refcount_inc(session,</span>
<span class='curline'><a href='../S/5984.html#L878'>session</a>           878 lib/buffers.c  parse_handshake_header(gnutls_session_t session, mbuffer_st * bufel,</span>
<span class='curline'><a href='../S/5984.html#L883'>session</a>           883 lib/buffers.c  	    HANDSHAKE_HEADER_SIZE(session), data_size, frag_size;</span>
<span class='curline'><a href='../S/5984.html#L895'>session</a>           895 lib/buffers.c  	    (!IS_DTLS(session)</span>
<span class='curline'><a href='../S/5984.html#L922'>session</a>           922 lib/buffers.c  		if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5984.html#L938'>session</a>           938 lib/buffers.c  		if (hsk-&gt;htype == GNUTLS_HANDSHAKE_SERVER_HELLO &amp;&amp; hsk-&gt;start_offset == 0 &amp;&amp; !IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5984.html#L954'>session</a>           954 lib/buffers.c  	     session, _gnutls_handshake2str(hsk-&gt;htype),</span>
<span class='curline'><a href='../S/5984.html#L989'>session</a>           989 lib/buffers.c  static int merge_handshake_packet(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5984.html#L995'>session</a>           995 lib/buffers.c  	for (i = 0; i &lt; session-&gt;internals.handshake_recv_buffer_size; i++) {</span>
<span class='curline'><a href='../S/5984.html#L996'>session</a>           996 lib/buffers.c  		if (session-&gt;internals.handshake_recv_buffer[i].htype ==</span>
<span class='curline'><a href='../S/5984.html#L1005'>session</a>          1005 lib/buffers.c  		pos = session-&gt;internals.handshake_recv_buffer_size;</span>
<span class='curline'><a href='../S/5984.html#L1027'>session</a>          1027 lib/buffers.c  		session-&gt;internals.handshake_recv_buffer_size++;</span>
<span class='curline'><a href='../S/5984.html#L1034'>session</a>          1034 lib/buffers.c  		_gnutls_handshake_buffer_move(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1040'>session</a>          1040 lib/buffers.c  		    session-&gt;internals.handshake_recv_buffer[pos].</span>
<span class='curline'><a href='../S/5984.html#L1043'>session</a>          1043 lib/buffers.c  		    session-&gt;internals.handshake_recv_buffer[pos].</span>
<span class='curline'><a href='../S/5984.html#L1045'>session</a>          1045 lib/buffers.c  			memcpy(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1049'>session</a>          1049 lib/buffers.c  			session-&gt;internals.handshake_recv_buffer[pos].</span>
<span class='curline'><a href='../S/5984.html#L1051'>session</a>          1051 lib/buffers.c  			session-&gt;internals.handshake_recv_buffer[pos].</span>
<span class='curline'><a href='../S/5984.html#L1054'>session</a>          1054 lib/buffers.c  				session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1057'>session</a>          1057 lib/buffers.c  			   session-&gt;internals.handshake_recv_buffer[pos].</span>
<span class='curline'><a href='../S/5984.html#L1060'>session</a>          1060 lib/buffers.c  			   session-&gt;internals.handshake_recv_buffer[pos].</span>
<span class='curline'><a href='../S/5984.html#L1062'>session</a>          1062 lib/buffers.c  			memcpy(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1067'>session</a>          1067 lib/buffers.c  			session-&gt;internals.handshake_recv_buffer[pos].</span>
<span class='curline'><a href='../S/5984.html#L1069'>session</a>          1069 lib/buffers.c  			session-&gt;internals.handshake_recv_buffer[pos].</span>
<span class='curline'><a href='../S/5984.html#L1072'>session</a>          1072 lib/buffers.c  				session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1100'>session</a>          1100 lib/buffers.c  #define LAST_ELEMENT (session-&gt;internals.handshake_recv_buffer_size-1)</span>
<span class='curline'><a href='../S/5984.html#L1104'>session</a>          1104 lib/buffers.c  static int get_last_packet(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5984.html#L1110'>session</a>          1110 lib/buffers.c  	    session-&gt;internals.handshake_recv_buffer;</span>
<span class='curline'><a href='../S/5984.html#L1112'>session</a>          1112 lib/buffers.c  	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5984.html#L1113'>session</a>          1113 lib/buffers.c  		if (session-&gt;internals.handshake_recv_buffer_size == 0 ||</span>
<span class='curline'><a href='../S/5984.html#L1114'>session</a>          1114 lib/buffers.c  		    (session-&gt;internals.dtls.hsk_read_seq !=</span>
<span class='curline'><a href='../S/5984.html#L1120'>session</a>          1120 lib/buffers.c  				_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5984.html#L1137'>session</a>          1137 lib/buffers.c  			session-&gt;internals.dtls.hsk_read_seq++;</span>
<span class='curline'><a href='../S/5984.html#L1141'>session</a>          1141 lib/buffers.c  			session-&gt;internals.handshake_recv_buffer_size--;</span>
<span class='curline'><a href='../S/5984.html#L1148'>session</a>          1148 lib/buffers.c  			    record_check_unprocessed(session) &gt; 0)</span>
<span class='curline'><a href='../S/5984.html#L1155'>session</a>          1155 lib/buffers.c  		if (session-&gt;internals.handshake_recv_buffer_size &gt; 0</span>
<span class='curline'><a href='../S/5984.html#L1164'>session</a>          1164 lib/buffers.c  			session-&gt;internals.handshake_recv_buffer_size--;</span>
<span class='curline'><a href='../S/5984.html#L1173'>session</a>          1173 lib/buffers.c  	RETURN_DTLS_EAGAIN_OR_TIMEOUT(session, 0);</span>
<span class='curline'><a href='../S/5984.html#L1181'>session</a>          1181 lib/buffers.c  int _gnutls_parse_record_buffered_msgs(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5984.html#L1188'>session</a>          1188 lib/buffers.c  	    session-&gt;internals.handshake_recv_buffer;</span>
<span class='curline'><a href='../S/5984.html#L1191'>session</a>          1191 lib/buffers.c  	    _mbuffer_head_get_first(&amp;session-&gt;internals.record_buffer,</span>
<span class='curline'><a href='../S/5984.html#L1196'>session</a>          1196 lib/buffers.c  	if (!IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5984.html#L1206'>session</a>          1206 lib/buffers.c  			    (session-&gt;internals.handshake_recv_buffer_size == 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5984.html#L1207'>session</a>          1207 lib/buffers.c  			     msg.size &lt; HANDSHAKE_HEADER_SIZE(session) &amp;&amp;</span>
<span class='curline'><a href='../S/5984.html#L1208'>session</a>          1208 lib/buffers.c  			     session-&gt;internals.handshake_header_recv_buffer.byte_length &lt;</span>
<span class='curline'><a href='../S/5984.html#L1209'>session</a>          1209 lib/buffers.c  			     HANDSHAKE_HEADER_SIZE(session) - msg.size)) {</span>
<span class='curline'><a href='../S/5984.html#L1210'>session</a>          1210 lib/buffers.c  				bufel = _mbuffer_head_pop_first(&amp;session-&gt;internals.record_buffer);</span>
<span class='curline'><a href='../S/5984.html#L1211'>session</a>          1211 lib/buffers.c  				_mbuffer_enqueue(&amp;session-&gt;internals.handshake_header_recv_buffer,</span>
<span class='curline'><a href='../S/5984.html#L1214'>session</a>          1214 lib/buffers.c  			} else if (session-&gt;internals.handshake_recv_buffer_size &gt;</span>
<span class='curline'><a href='../S/5984.html#L1229'>session</a>          1229 lib/buffers.c  				_mbuffer_head_remove_bytes(&amp;session-&gt;</span>
<span class='curline'><a href='../S/5984.html#L1235'>session</a>          1235 lib/buffers.c  				    (session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1237'>session</a>          1237 lib/buffers.c  					bufel = _mbuffer_head_pop_first(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1239'>session</a>          1239 lib/buffers.c  					_mbuffer_enqueue(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1242'>session</a>          1242 lib/buffers.c  					ret = _mbuffer_linearize_align16(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1244'>session</a>          1244 lib/buffers.c  									 get_total_headers(session));</span>
<span class='curline'><a href='../S/5984.html#L1247'>session</a>          1247 lib/buffers.c  					bufel = _mbuffer_head_pop_first(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1249'>session</a>          1249 lib/buffers.c  					_mbuffer_head_push_first(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1255'>session</a>          1255 lib/buffers.c  				    parse_handshake_header(session, bufel,</span>
<span class='curline'><a href='../S/5984.html#L1261'>session</a>          1261 lib/buffers.c  				session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1279'>session</a>          1279 lib/buffers.c  				_mbuffer_head_remove_bytes(&amp;session-&gt;</span>
<span class='curline'><a href='../S/5984.html#L1292'>session</a>          1292 lib/buffers.c  			    _mbuffer_head_get_first(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1321'>session</a>          1321 lib/buffers.c  				    parse_handshake_header(session, bufel,</span>
<span class='curline'><a href='../S/5984.html#L1325'>session</a>          1325 lib/buffers.c  					_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5984.html#L1330'>session</a>          1330 lib/buffers.c  				_mbuffer_consume(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1347'>session</a>          1347 lib/buffers.c  				_mbuffer_consume(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1352'>session</a>          1352 lib/buffers.c  				    merge_handshake_packet(session, &amp;tmp);</span>
<span class='curline'><a href='../S/5984.html#L1361'>session</a>          1361 lib/buffers.c  			    _mbuffer_dequeue(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1373'>session</a>          1373 lib/buffers.c  		if (session-&gt;internals.handshake_recv_buffer_size &gt; 1)</span>
<span class='curline'><a href='../S/5984.html#L1375'>session</a>          1375 lib/buffers.c  			      session-&gt;internals.</span>
<span class='curline'><a href='../S/5984.html#L1379'>session</a>          1379 lib/buffers.c  		while (session-&gt;internals.handshake_recv_buffer_size &gt; 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5984.html#L1381'>session</a>          1381 lib/buffers.c  		       session-&gt;internals.dtls.hsk_read_seq) {</span>
<span class='curline'><a href='../S/5984.html#L1382'>session</a>          1382 lib/buffers.c  			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5984.html#L1387'>session</a>          1387 lib/buffers.c  			session-&gt;internals.handshake_recv_buffer_size--;</span>
<span class='curline'><a href='../S/5984.html#L1398'>session</a>          1398 lib/buffers.c  _gnutls_handshake_io_recv_int(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5984.html#L1407'>session</a>          1407 lib/buffers.c  	ret = get_last_packet(session, htype, hsk, optional);</span>
<span class='curline'><a href='../S/5984.html#L1417'>session</a>          1417 lib/buffers.c  	ret = _gnutls_parse_record_buffered_msgs(session);</span>
<span class='curline'><a href='../S/5984.html#L1420'>session</a>          1420 lib/buffers.c  		ret = get_last_packet(session, htype, hsk, optional);</span>
<span class='curline'><a href='../S/5984.html#L1423'>session</a>          1423 lib/buffers.c  	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5984.html#L1433'>session</a>          1433 lib/buffers.c  		ret = handshake_remaining_time(session);</span>
<span class='curline'><a href='../S/5984.html#L1443'>session</a>          1443 lib/buffers.c  		    _gnutls_recv_in_buffers(session, GNUTLS_HANDSHAKE, htype,</span>
<span class='curline'><a href='../S/5984.html#L1448'>session</a>          1448 lib/buffers.c  		ret = _gnutls_parse_record_buffered_msgs(session);</span>
<span class='curline'><a href='../S/5984.html#L1450'>session</a>          1450 lib/buffers.c  			ret = get_last_packet(session, htype, hsk, optional);</span>
<span class='curline'><a href='../S/5984.html#L1454'>session</a>          1454 lib/buffers.c  	} while(IS_DTLS(session) &amp;&amp; ret == GNUTLS_E_INT_CHECK_AGAIN &amp;&amp; retries-- &gt; 0);</span>
<span class='curline'><a href='../S/5984.html#L1456'>session</a>          1456 lib/buffers.c  	if (unlikely(IS_DTLS(session) &amp;&amp; ret == GNUTLS_E_INT_CHECK_AGAIN)) {</span>
<span class='curline'><a href='../S/6033.html#L31'>session</a>            31 lib/buffers.h  _gnutls_record_buffer_put(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6033.html#L35'>session</a>            35 lib/buffers.h  inline static int _gnutls_record_buffer_get_size(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6033.html#L37'>session</a>            37 lib/buffers.h  	return session-&gt;internals.record_buffer.byte_length;</span>
<span class='curline'><a href='../S/6033.html#L40'>session</a>            40 lib/buffers.h  #define NO_TIMEOUT_FUNC_SET(session) unlikely(session-&gt;internals.pull_timeout_func == gnutls_system_recv_timeout \</span>
<span class='curline'><a href='../S/6033.html#L41'>session</a>            41 lib/buffers.h  	     &amp;&amp; session-&gt;internals.pull_func != system_read)</span>
<span class='curline'><a href='../S/6033.html#L53'>session</a>            53 lib/buffers.h  inline static size_t record_check_unprocessed(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6033.html#L55'>session</a>            55 lib/buffers.h  	return session-&gt;internals.record_recv_buffer.byte_length;</span>
<span class='curline'><a href='../S/6033.html#L59'>session</a>            59 lib/buffers.h  			      gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/6033.html#L62'>session</a>            62 lib/buffers.h  				     gnutls_session_t session,</span>
<span class='curline'><a href='../S/6033.html#L66'>session</a>            66 lib/buffers.h  int _gnutls_io_clear_peeked_data(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6033.html#L68'>session</a>            68 lib/buffers.h  ssize_t _gnutls_io_write_buffered(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6033.html#L76'>session</a>            76 lib/buffers.h  _gnutls_handshake_io_recv_int(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6033.html#L81'>session</a>            81 lib/buffers.h  ssize_t _gnutls_io_write_flush(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6033.html#L82'>session</a>            82 lib/buffers.h  int _gnutls_io_check_recv(gnutls_session_t session, unsigned int ms);</span>
<span class='curline'><a href='../S/6033.html#L83'>session</a>            83 lib/buffers.h  ssize_t _gnutls_handshake_io_write_flush(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6033.html#L100'>session</a>           100 lib/buffers.h  						       session)</span>
<span class='curline'><a href='../S/6033.html#L103'>session</a>           103 lib/buffers.h  	for (i = 0; i &lt; session-&gt;internals.handshake_recv_buffer_size; i++)</span>
<span class='curline'><a href='../S/6033.html#L104'>session</a>           104 lib/buffers.h  		_gnutls_handshake_buffer_clear(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/6033.html#L106'>session</a>           106 lib/buffers.h  	session-&gt;internals.handshake_recv_buffer_size = 0;</span>
<span class='curline'><a href='../S/6033.html#L107'>session</a>           107 lib/buffers.h  	_mbuffer_head_clear(&amp;session-&gt;internals.handshake_header_recv_buffer);</span>
<span class='curline'><a href='../S/6033.html#L111'>session</a>           111 lib/buffers.h  						      session)</span>
<span class='curline'><a href='../S/6033.html#L115'>session</a>           115 lib/buffers.h  		_gnutls_handshake_buffer_init(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/6033.html#L118'>session</a>           118 lib/buffers.h  	session-&gt;internals.handshake_recv_buffer_size = 0;</span>
<span class='curline'><a href='../S/6033.html#L119'>session</a>           119 lib/buffers.h  	_mbuffer_head_init(&amp;session-&gt;internals.handshake_header_recv_buffer);</span>
<span class='curline'><a href='../S/6033.html#L122'>session</a>           122 lib/buffers.h  int _gnutls_parse_record_buffered_msgs(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6033.html#L125'>session</a>           125 lib/buffers.h  _gnutls_recv_in_buffers(gnutls_session_t session, content_type_t type,</span>
<span class='curline'><a href='../S/6033.html#L129'>session</a>           129 lib/buffers.h  #define _gnutls_handshake_io_buffer_clear( session) \</span>
<span class='curline'><a href='../S/6033.html#L130'>session</a>           130 lib/buffers.h  	_mbuffer_head_clear( &amp;session-&gt;internals.handshake_send_buffer); \</span>
<span class='curline'><a href='../S/6033.html#L131'>session</a>           131 lib/buffers.h  	_gnutls_handshake_recv_buffer_clear( session);</span>
<span class='curline'><a href='../S/5463.html#L558'>session</a>           558 lib/cert-cred.c gnutls_certificate_server_set_request(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5463.html#L561'>session</a>           561 lib/cert-cred.c 	session-&gt;internals.send_cert_req = req;</span>
<span class='curline'><a href='../S/5463.html#L564'>session</a>           564 lib/cert-cred.c static int call_legacy_cert_cb1(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5463.html#L583'>session</a>           583 lib/cert-cred.c 	ret = info-&gt;cred-&gt;legacy_cert_cb1(session, info-&gt;req_ca_rdn, info-&gt;nreqs,</span>
<span class='curline'><a href='../S/5463.html#L718'>session</a>           718 lib/cert-cred.c static int call_legacy_cert_cb2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5463.html#L731'>session</a>           731 lib/cert-cred.c 	ret = info-&gt;cred-&gt;legacy_cert_cb2(session, info-&gt;req_ca_rdn, info-&gt;nreqs,</span>
<span class='curline'><a href='../S/5395.html#L60'>session</a>            60 lib/cert-session.c const gnutls_datum_t *gnutls_certificate_get_ours(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5395.html#L67'>session</a>            67 lib/cert-session.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5395.html#L73'>session</a>            73 lib/cert-session.c 	if (session-&gt;internals.selected_cert_list == NULL)</span>
<span class='curline'><a href='../S/5395.html#L76'>session</a>            76 lib/cert-session.c 	return &amp;session-&gt;internals.selected_cert_list[0].cert;</span>
<span class='curline'><a href='../S/5395.html#L101'>session</a>           101 lib/cert-session.c 						   session,</span>
<span class='curline'><a href='../S/5395.html#L108'>session</a>           108 lib/cert-session.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5395.html#L128'>session</a>           128 lib/cert-session.c gnutls_certificate_client_get_request_status(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5395.html#L130'>session</a>           130 lib/cert-session.c 	return (session-&gt;internals.hsk_flags &amp; HSK_CRT_ASKED)?1:0;</span>
<span class='curline'><a href='../S/5395.html#L233'>session</a>           233 lib/cert-session.c check_ocsp_response(gnutls_session_t session, gnutls_x509_crt_t cert,</span>
<span class='curline'><a href='../S/5395.html#L253'>session</a>           253 lib/cert-session.c 		_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5395.html#L266'>session</a>           266 lib/cert-session.c 		_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5395.html#L324'>session</a>           324 lib/cert-session.c 		_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5395.html#L335'>session</a>           335 lib/cert-session.c 		_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5395.html#L350'>session</a>           350 lib/cert-session.c 			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5395.html#L360'>session</a>           360 lib/cert-session.c 			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5395.html#L372'>session</a>           372 lib/cert-session.c 		session-&gt;internals.ocsp_check_ok = 1;</span>
<span class='curline'><a href='../S/5395.html#L380'>session</a>           380 lib/cert-session.c _gnutls_ocsp_verify_mandatory_stapling(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5395.html#L394'>session</a>           394 lib/cert-session.c 	if (!(session-&gt;internals.hsk_flags &amp; HSK_OCSP_REQUESTED))</span>
<span class='curline'><a href='../S/5395.html#L448'>session</a>           448 lib/cert-session.c _gnutls_x509_cert_verify_peers(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5395.html#L464'>session</a>           464 lib/cert-session.c 	session-&gt;internals.ocsp_check_ok = 0;</span>
<span class='curline'><a href='../S/5395.html#L468'>session</a>           468 lib/cert-session.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5395.html#L475'>session</a>           475 lib/cert-session.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5395.html#L490'>session</a>           490 lib/cert-session.c 	    cred-&gt;verify_flags | session-&gt;internals.additional_verify_flags;</span>
<span class='curline'><a href='../S/5395.html#L528'>session</a>           528 lib/cert-session.c 		ret = gnutls_ocsp_status_request_get2(session, i, &amp;resp);</span>
<span class='curline'><a href='../S/5395.html#L530'>session</a>           530 lib/cert-session.c 			ret = _gnutls_ocsp_verify_mandatory_stapling(session, peer_certificate_list[i], &amp;ocsp_status);</span>
<span class='curline'><a href='../S/5395.html#L548'>session</a>           548 lib/cert-session.c 			check_ocsp_response(session,</span>
<span class='curline'><a href='../S/5395.html#L618'>session</a>           618 lib/cert-session.c gnutls_certificate_verify_peers2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5395.html#L621'>session</a>           621 lib/cert-session.c 	return gnutls_certificate_verify_peers(session, NULL, 0, status);</span>
<span class='curline'><a href='../S/5395.html#L665'>session</a>           665 lib/cert-session.c gnutls_certificate_verify_peers3(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5395.html#L675'>session</a>           675 lib/cert-session.c 	return gnutls_certificate_verify_peers(session, &amp;data, 1, status);</span>
<span class='curline'><a href='../S/5395.html#L724'>session</a>           724 lib/cert-session.c gnutls_certificate_verify_peers(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5395.html#L733'>session</a>           733 lib/cert-session.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5395.html#L742'>session</a>           742 lib/cert-session.c 	switch (get_certificate_type(session, GNUTLS_CTYPE_PEERS)) {</span>
<span class='curline'><a href='../S/5395.html#L744'>session</a>           744 lib/cert-session.c 			return _gnutls_x509_cert_verify_peers(session, data, elements,</span>
<span class='curline'><a href='../S/5395.html#L827'>session</a>           827 lib/cert-session.c time_t gnutls_certificate_expiration_time_peers(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5395.html#L833'>session</a>           833 lib/cert-session.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5395.html#L843'>session</a>           843 lib/cert-session.c 	switch (get_certificate_type(session, GNUTLS_CTYPE_PEERS)) {</span>
<span class='curline'><a href='../S/5395.html#L863'>session</a>           863 lib/cert-session.c time_t gnutls_certificate_activation_time_peers(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5395.html#L869'>session</a>           869 lib/cert-session.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5395.html#L879'>session</a>           879 lib/cert-session.c 	switch (get_certificate_type(session, GNUTLS_CTYPE_PEERS)) {</span>
<span class='curline'><a href='../S/5988.html#L72'>session</a>            72 lib/cipher-cbc.c int cbc_mac_verify(gnutls_session_t session, record_parameters_st *params,</span>
<span class='curline'><a href='../S/5988.html#L80'>session</a>            80 lib/cipher-cbc.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5269.html#L45'>session</a>            45 lib/cipher.c   static int encrypt_packet(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L52'>session</a>            52 lib/cipher.c   static int decrypt_packet(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L60'>session</a>            60 lib/cipher.c   decrypt_packet_tls13(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L67'>session</a>            67 lib/cipher.c   encrypt_packet_tls13(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L79'>session</a>            79 lib/cipher.c   _gnutls_encrypt(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L86'>session</a>            86 lib/cipher.c   	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5269.html#L96'>session</a>            96 lib/cipher.c   		    encrypt_packet_tls13(session,</span>
<span class='curline'><a href='../S/5269.html#L105'>session</a>           105 lib/cipher.c   		    encrypt_packet(session,</span>
<span class='curline'><a href='../S/5269.html#L115'>session</a>           115 lib/cipher.c   	if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5269.html#L136'>session</a>           136 lib/cipher.c   _gnutls_decrypt(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L144'>session</a>           144 lib/cipher.c   	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5269.html#L151'>session</a>           151 lib/cipher.c   		    decrypt_packet_tls13(session, ciphertext,</span>
<span class='curline'><a href='../S/5269.html#L156'>session</a>           156 lib/cipher.c   		    decrypt_packet(session, ciphertext,</span>
<span class='curline'><a href='../S/5269.html#L167'>session</a>           167 lib/cipher.c   calc_enc_length_block(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L199'>session</a>           199 lib/cipher.c   calc_enc_length_stream(gnutls_session_t session, int data_size,</span>
<span class='curline'><a href='../S/5269.html#L248'>session</a>           248 lib/cipher.c   encrypt_packet(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L264'>session</a>           264 lib/cipher.c   	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5269.html#L279'>session</a>           279 lib/cipher.c   			 session, _gnutls_cipher_get_name(params-&gt;cipher),</span>
<span class='curline'><a href='../S/5269.html#L295'>session</a>           295 lib/cipher.c   		    calc_enc_length_block(session, ver, plain-&gt;size,</span>
<span class='curline'><a href='../S/5269.html#L304'>session</a>           304 lib/cipher.c   		    calc_enc_length_stream(session, plain-&gt;size,</span>
<span class='curline'><a href='../S/5269.html#L416'>session</a>           416 lib/cipher.c   encrypt_packet_tls13(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L425'>session</a>           425 lib/cipher.c   	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5269.html#L437'>session</a>           437 lib/cipher.c   			 session, _gnutls_cipher_get_name(params-&gt;cipher),</span>
<span class='curline'><a href='../S/5269.html#L457'>session</a>           457 lib/cipher.c   	max = MAX_RECORD_SEND_SIZE(session);</span>
<span class='curline'><a href='../S/5269.html#L483'>session</a>           483 lib/cipher.c   	if (pad_size || (session-&gt;internals.flags &amp; GNUTLS_SAFE_PADDING_CHECK)) {</span>
<span class='curline'><a href='../S/5269.html#L523'>session</a>           523 lib/cipher.c   decrypt_packet(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L538'>session</a>           538 lib/cipher.c   	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5269.html#L643'>session</a>           643 lib/cipher.c   			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5269.html#L689'>session</a>           689 lib/cipher.c   			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5269.html#L772'>session</a>           772 lib/cipher.c   			ret = cbc_mac_verify(session, params, preamble, type,</span>
<span class='curline'><a href='../S/5269.html#L805'>session</a>           805 lib/cipher.c   decrypt_packet_tls13(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5269.html#L814'>session</a>           814 lib/cipher.c   	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5269.html#L856'>session</a>           856 lib/cipher.c   			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5269.html#L879'>session</a>           879 lib/cipher.c   	if (length &gt; max_decrypted_size(session) + 1) {</span>
<span class='curline'><a href='../S/5269.html#L881'>session</a>           881 lib/cipher.c   		    (session, "Received packet with illegal length: %u\n",</span>
<span class='curline'><a href='../S/5269.html#L897'>session</a>           897 lib/cipher.c   			if (!(session-&gt;internals.flags &amp; GNUTLS_SAFE_PADDING_CHECK))</span>
<span class='curline'><a href='../S/5821.html#L26'>session</a>            26 lib/cipher.h   int _gnutls_encrypt(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5821.html#L32'>session</a>            32 lib/cipher.h   int _gnutls_decrypt(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5821.html#L43'>session</a>            43 lib/cipher.h   int cbc_mac_verify(gnutls_session_t session, record_parameters_st *params,</span>
<span class='curline'><a href='../S/5810.html#L56'>session</a>            56 lib/constate.c _gnutls_set_keys(gnutls_session_t session, record_parameters_st * params,</span>
<span class='curline'><a href='../S/5810.html#L69'>session</a>            69 lib/constate.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5810.html#L80'>session</a>            80 lib/constate.c 	memcpy(rnd, session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5810.html#L83'>session</a>            83 lib/constate.c 	       session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5810.html#L87'>session</a>            87 lib/constate.c 	if (get_num_version(session) == GNUTLS_SSL3) {	/* SSL 3 */</span>
<span class='curline'><a href='../S/5810.html#L90'>session</a>            90 lib/constate.c 		    (session-&gt;security_parameters.master_secret,</span>
<span class='curline'><a href='../S/5810.html#L96'>session</a>            96 lib/constate.c 		    _gnutls_PRF(session,</span>
<span class='curline'><a href='../S/5810.html#L97'>session</a>            97 lib/constate.c 				session-&gt;security_parameters.master_secret,</span>
<span class='curline'><a href='../S/5810.html#L191'>session</a>           191 lib/constate.c _tls13_update_keys(gnutls_session_t session, hs_stage_t stage,</span>
<span class='curline'><a href='../S/5810.html#L207'>session</a>           207 lib/constate.c 		ret = _gnutls_epoch_get(session, EPOCH_READ_CURRENT, &amp;prev);</span>
<span class='curline'><a href='../S/5810.html#L232'>session</a>           232 lib/constate.c 		ret = _gnutls_epoch_get(session, EPOCH_WRITE_CURRENT, &amp;prev);</span>
<span class='curline'><a href='../S/5810.html#L257'>session</a>           257 lib/constate.c 	if ((session-&gt;security_parameters.entity == GNUTLS_CLIENT &amp;&amp; stage == STAGE_UPD_OURS) ||</span>
<span class='curline'><a href='../S/5810.html#L258'>session</a>           258 lib/constate.c 	    (session-&gt;security_parameters.entity == GNUTLS_SERVER &amp;&amp; stage == STAGE_UPD_PEERS)) {</span>
<span class='curline'><a href='../S/5810.html#L261'>session</a>           261 lib/constate.c 		ret = _tls13_expand_secret(session, APPLICATION_TRAFFIC_UPDATE,</span>
<span class='curline'><a href='../S/5810.html#L264'>session</a>           264 lib/constate.c 					   session-&gt;key.proto.tls13.ap_ckey,</span>
<span class='curline'><a href='../S/5810.html#L265'>session</a>           265 lib/constate.c 					   session-&gt;security_parameters.prf-&gt;output_size,</span>
<span class='curline'><a href='../S/5810.html#L266'>session</a>           266 lib/constate.c 					   session-&gt;key.proto.tls13.ap_ckey);</span>
<span class='curline'><a href='../S/5810.html#L270'>session</a>           270 lib/constate.c 		ret = _tls13_expand_secret(session, "key", 3, NULL, 0, session-&gt;key.proto.tls13.ap_ckey, key_size, key_block);</span>
<span class='curline'><a href='../S/5810.html#L274'>session</a>           274 lib/constate.c 		ret = _tls13_expand_secret(session, "iv", 2, NULL, 0, session-&gt;key.proto.tls13.ap_ckey, iv_size, iv_block);</span>
<span class='curline'><a href='../S/5810.html#L278'>session</a>           278 lib/constate.c 		ret = _tls13_expand_secret(session, APPLICATION_TRAFFIC_UPDATE,</span>
<span class='curline'><a href='../S/5810.html#L281'>session</a>           281 lib/constate.c 					   session-&gt;key.proto.tls13.ap_skey,</span>
<span class='curline'><a href='../S/5810.html#L282'>session</a>           282 lib/constate.c 					   session-&gt;security_parameters.prf-&gt;output_size,</span>
<span class='curline'><a href='../S/5810.html#L283'>session</a>           283 lib/constate.c 					   session-&gt;key.proto.tls13.ap_skey);</span>
<span class='curline'><a href='../S/5810.html#L287'>session</a>           287 lib/constate.c 		ret = _tls13_expand_secret(session, "key", 3, NULL, 0, session-&gt;key.proto.tls13.ap_skey, key_size, key_block);</span>
<span class='curline'><a href='../S/5810.html#L291'>session</a>           291 lib/constate.c 		ret = _tls13_expand_secret(session, "iv", 2, NULL, 0, session-&gt;key.proto.tls13.ap_skey, iv_size, iv_block);</span>
<span class='curline'><a href='../S/5810.html#L324'>session</a>           324 lib/constate.c _tls13_set_early_keys(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5810.html#L334'>session</a>           334 lib/constate.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT &amp;&amp;</span>
<span class='curline'><a href='../S/5810.html#L335'>session</a>           335 lib/constate.c 	    !(session-&gt;internals.hsk_flags &amp; HSK_TLS13_TICKET_SENT)) {</span>
<span class='curline'><a href='../S/5810.html#L339'>session</a>           339 lib/constate.c 	ret = _tls13_expand_secret(session, "key", 3, NULL, 0, session-&gt;key.proto.tls13.e_ckey, key_size, key_block);</span>
<span class='curline'><a href='../S/5810.html#L343'>session</a>           343 lib/constate.c 	ret = _tls13_expand_secret(session, "iv", 2, NULL, 0, session-&gt;key.proto.tls13.e_ckey, iv_size, iv_block);</span>
<span class='curline'><a href='../S/5810.html#L347'>session</a>           347 lib/constate.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5810.html#L379'>session</a>           379 lib/constate.c _tls13_set_keys(gnutls_session_t session, hs_stage_t stage,</span>
<span class='curline'><a href='../S/5810.html#L396'>session</a>           396 lib/constate.c 		return _tls13_update_keys(session, stage,</span>
<span class='curline'><a href='../S/5810.html#L400'>session</a>           400 lib/constate.c 		return _tls13_set_early_keys(session,</span>
<span class='curline'><a href='../S/5810.html#L406'>session</a>           406 lib/constate.c 		hsk_len = session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5810.html#L408'>session</a>           408 lib/constate.c 		ckey = session-&gt;key.proto.tls13.hs_ckey;</span>
<span class='curline'><a href='../S/5810.html#L412'>session</a>           412 lib/constate.c 		hsk_len = session-&gt;internals.handshake_hash_buffer_server_finished_len;</span>
<span class='curline'><a href='../S/5810.html#L414'>session</a>           414 lib/constate.c 		ckey = session-&gt;key.proto.tls13.ap_ckey;</span>
<span class='curline'><a href='../S/5810.html#L417'>session</a>           417 lib/constate.c 	ret = _tls13_derive_secret(session, label, label_size,</span>
<span class='curline'><a href='../S/5810.html#L418'>session</a>           418 lib/constate.c 				   session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5810.html#L420'>session</a>           420 lib/constate.c 				   session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5810.html#L425'>session</a>           425 lib/constate.c 	ret = _gnutls_call_keylog_func(session, keylog_label,</span>
<span class='curline'><a href='../S/5810.html#L427'>session</a>           427 lib/constate.c 				       session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5810.html#L432'>session</a>           432 lib/constate.c 	ret = _tls13_expand_secret(session, "key", 3, NULL, 0, ckey, key_size, ckey_block);</span>
<span class='curline'><a href='../S/5810.html#L436'>session</a>           436 lib/constate.c 	ret = _tls13_expand_secret(session, "iv", 2, NULL, 0, ckey, iv_size, civ_block);</span>
<span class='curline'><a href='../S/5810.html#L445'>session</a>           445 lib/constate.c 		skey = session-&gt;key.proto.tls13.hs_skey;</span>
<span class='curline'><a href='../S/5810.html#L450'>session</a>           450 lib/constate.c 		skey = session-&gt;key.proto.tls13.ap_skey;</span>
<span class='curline'><a href='../S/5810.html#L453'>session</a>           453 lib/constate.c 	ret = _tls13_derive_secret(session, label, label_size,</span>
<span class='curline'><a href='../S/5810.html#L454'>session</a>           454 lib/constate.c 				   session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5810.html#L456'>session</a>           456 lib/constate.c 				   session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5810.html#L462'>session</a>           462 lib/constate.c 	ret = _gnutls_call_keylog_func(session, keylog_label,</span>
<span class='curline'><a href='../S/5810.html#L464'>session</a>           464 lib/constate.c 				       session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5810.html#L468'>session</a>           468 lib/constate.c 	ret = _tls13_expand_secret(session, "key", 3, NULL, 0, skey, key_size, skey_block);</span>
<span class='curline'><a href='../S/5810.html#L472'>session</a>           472 lib/constate.c 	ret = _tls13_expand_secret(session, "iv", 2, NULL, 0, skey, iv_size, siv_block);</span>
<span class='curline'><a href='../S/5810.html#L476'>session</a>           476 lib/constate.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5810.html#L569'>session</a>           569 lib/constate.c _gnutls_set_cipher_suite2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5810.html#L576'>session</a>           576 lib/constate.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5810.html#L578'>session</a>           578 lib/constate.c 	ret = _gnutls_epoch_get(session, EPOCH_NEXT, &amp;params);</span>
<span class='curline'><a href='../S/5810.html#L585'>session</a>           585 lib/constate.c 	if (ver-&gt;tls13_sem &amp;&amp; (session-&gt;internals.hsk_flags &amp; HSK_HRR_SENT)) {</span>
<span class='curline'><a href='../S/5810.html#L587'>session</a>           587 lib/constate.c 		    params-&gt;mac != mac_algo || cs != session-&gt;security_parameters.cs))</span>
<span class='curline'><a href='../S/5810.html#L601'>session</a>           601 lib/constate.c 	if (_gnutls_version_has_selectable_prf(get_version(session))) {</span>
<span class='curline'><a href='../S/5810.html#L605'>session</a>           605 lib/constate.c 		session-&gt;security_parameters.prf = mac_to_entry(cs-&gt;prf);</span>
<span class='curline'><a href='../S/5810.html#L607'>session</a>           607 lib/constate.c 		session-&gt;security_parameters.prf = mac_to_entry(GNUTLS_MAC_MD5_SHA1);</span>
<span class='curline'><a href='../S/5810.html#L610'>session</a>           610 lib/constate.c 	session-&gt;security_parameters.cs = cs;</span>
<span class='curline'><a href='../S/5810.html#L620'>session</a>           620 lib/constate.c int _gnutls_epoch_dup(gnutls_session_t session, unsigned int epoch_rel)</span>
<span class='curline'><a href='../S/5810.html#L626'>session</a>           626 lib/constate.c 	ret = _gnutls_epoch_get(session, epoch_rel, &amp;prev);</span>
<span class='curline'><a href='../S/5810.html#L630'>session</a>           630 lib/constate.c 	ret = _gnutls_epoch_get(session, EPOCH_NEXT, &amp;next);</span>
<span class='curline'><a href='../S/5810.html#L632'>session</a>           632 lib/constate.c 		ret = _gnutls_epoch_setup_next(session, 0, &amp;next);</span>
<span class='curline'><a href='../S/5810.html#L647'>session</a>           647 lib/constate.c int _gnutls_epoch_set_keys(gnutls_session_t session, uint16_t epoch, hs_stage_t stage)</span>
<span class='curline'><a href='../S/5810.html#L654'>session</a>           654 lib/constate.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5810.html#L659'>session</a>           659 lib/constate.c 	ret = _gnutls_epoch_get(session, epoch, &amp;params);</span>
<span class='curline'><a href='../S/5810.html#L667'>session</a>           667 lib/constate.c 	    ("REC[%p]: Initializing epoch #%u\n", session, params-&gt;epoch);</span>
<span class='curline'><a href='../S/5810.html#L682'>session</a>           682 lib/constate.c 	params-&gt;etm = session-&gt;security_parameters.etm;</span>
<span class='curline'><a href='../S/5810.html#L686'>session</a>           686 lib/constate.c 		    (session, stage, params, IV_size, key_size);</span>
<span class='curline'><a href='../S/5810.html#L691'>session</a>           691 lib/constate.c 		    session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5810.html#L698'>session</a>           698 lib/constate.c 		    session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5810.html#L705'>session</a>           705 lib/constate.c 		    (session, params, hash_size, IV_size, key_size);</span>
<span class='curline'><a href='../S/5810.html#L722'>session</a>           722 lib/constate.c 		session-&gt;internals.max_recv_size = 256;</span>
<span class='curline'><a href='../S/5810.html#L724'>session</a>           724 lib/constate.c 		session-&gt;internals.max_recv_size = 0;</span>
<span class='curline'><a href='../S/5810.html#L728'>session</a>           728 lib/constate.c 		session-&gt;internals.max_recv_size += _gnutls_record_overhead(ver, params-&gt;cipher, params-&gt;mac, 1);</span>
<span class='curline'><a href='../S/5810.html#L729'>session</a>           729 lib/constate.c 		if (session-&gt;internals.allow_large_records != 0)</span>
<span class='curline'><a href='../S/5810.html#L730'>session</a>           730 lib/constate.c 			session-&gt;internals.max_recv_size += EXTRA_COMP_SIZE;</span>
<span class='curline'><a href='../S/5810.html#L733'>session</a>           733 lib/constate.c 	session-&gt;internals.max_recv_size += session-&gt;security_parameters.max_record_recv_size + RECORD_HEADER_SIZE(session);</span>
<span class='curline'><a href='../S/5810.html#L737'>session</a>           737 lib/constate.c 	_gnutls_record_log("REC[%p]: Epoch #%u ready\n", session,</span>
<span class='curline'><a href='../S/5810.html#L767'>session</a>           767 lib/constate.c void _gnutls_set_resumed_parameters(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5810.html#L770'>session</a>           770 lib/constate.c 	    &amp;session-&gt;internals.resumed_security_parameters;</span>
<span class='curline'><a href='../S/5810.html#L771'>session</a>           771 lib/constate.c 	security_parameters_st *dst = &amp;session-&gt;security_parameters;</span>
<span class='curline'><a href='../S/5810.html#L772'>session</a>           772 lib/constate.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5810.html#L777'>session</a>           777 lib/constate.c 	    !(session-&gt;internals.hsk_flags &amp; HSK_RECORD_SIZE_LIMIT_NEGOTIATED)) {</span>
<span class='curline'><a href='../S/5810.html#L789'>session</a>           789 lib/constate.c int _gnutls_connection_state_init(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5810.html#L795'>session</a>           795 lib/constate.c 	if ((ret = _gnutls_generate_master(session, 0)) &lt; 0)</span>
<span class='curline'><a href='../S/5810.html#L804'>session</a>           804 lib/constate.c int _gnutls_read_connection_state_init(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5810.html#L807'>session</a>           807 lib/constate.c 	    session-&gt;security_parameters.epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L813'>session</a>           813 lib/constate.c 	if (session-&gt;internals.resumed != RESUME_FALSE &amp;&amp;</span>
<span class='curline'><a href='../S/5810.html#L814'>session</a>           814 lib/constate.c 	    session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5810.html#L815'>session</a>           815 lib/constate.c 		_gnutls_set_resumed_parameters(session);</span>
<span class='curline'><a href='../S/5810.html#L817'>session</a>           817 lib/constate.c 	ret = _gnutls_epoch_set_keys(session, epoch_next, 0);</span>
<span class='curline'><a href='../S/5810.html#L822'>session</a>           822 lib/constate.c 			      session,</span>
<span class='curline'><a href='../S/5810.html#L823'>session</a>           823 lib/constate.c 			      session-&gt;security_parameters.cs-&gt;name);</span>
<span class='curline'><a href='../S/5810.html#L825'>session</a>           825 lib/constate.c 	session-&gt;security_parameters.epoch_read = epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L833'>session</a>           833 lib/constate.c int _gnutls_write_connection_state_init(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5810.html#L836'>session</a>           836 lib/constate.c 	    session-&gt;security_parameters.epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L841'>session</a>           841 lib/constate.c 	if (!(session-&gt;internals.hsk_flags &amp; HSK_RECORD_SIZE_LIMIT_NEGOTIATED) &amp;&amp;</span>
<span class='curline'><a href='../S/5810.html#L842'>session</a>           842 lib/constate.c 	    session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5810.html#L843'>session</a>           843 lib/constate.c 		session-&gt;security_parameters.max_record_send_size =</span>
<span class='curline'><a href='../S/5810.html#L844'>session</a>           844 lib/constate.c 			session-&gt;security_parameters.max_user_record_send_size;</span>
<span class='curline'><a href='../S/5810.html#L849'>session</a>           849 lib/constate.c 	if (session-&gt;internals.resumed != RESUME_FALSE &amp;&amp;</span>
<span class='curline'><a href='../S/5810.html#L850'>session</a>           850 lib/constate.c 	    session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5810.html#L851'>session</a>           851 lib/constate.c 		_gnutls_set_resumed_parameters(session);</span>
<span class='curline'><a href='../S/5810.html#L853'>session</a>           853 lib/constate.c 	ret = _gnutls_epoch_set_keys(session, epoch_next, 0);</span>
<span class='curline'><a href='../S/5810.html#L857'>session</a>           857 lib/constate.c 	_gnutls_handshake_log("HSK[%p]: Cipher Suite: %s\n", session,</span>
<span class='curline'><a href='../S/5810.html#L858'>session</a>           858 lib/constate.c 			      session-&gt;security_parameters.cs-&gt;name);</span>
<span class='curline'><a href='../S/5810.html#L862'>session</a>           862 lib/constate.c 	     session);</span>
<span class='curline'><a href='../S/5810.html#L864'>session</a>           864 lib/constate.c 	session-&gt;security_parameters.epoch_write = epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L870'>session</a>           870 lib/constate.c epoch_resolve(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5810.html#L875'>session</a>           875 lib/constate.c 		*epoch_out = session-&gt;security_parameters.epoch_read;</span>
<span class='curline'><a href='../S/5810.html#L879'>session</a>           879 lib/constate.c 		*epoch_out = session-&gt;security_parameters.epoch_write;</span>
<span class='curline'><a href='../S/5810.html#L883'>session</a>           883 lib/constate.c 		*epoch_out = session-&gt;security_parameters.epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L896'>session</a>           896 lib/constate.c 						    session,</span>
<span class='curline'><a href='../S/5810.html#L900'>session</a>           900 lib/constate.c 	    epoch - session-&gt;security_parameters.epoch_min;</span>
<span class='curline'><a href='../S/5810.html#L910'>session</a>           910 lib/constate.c 	return &amp;session-&gt;record_parameters[epoch_index];</span>
<span class='curline'><a href='../S/5810.html#L914'>session</a>           914 lib/constate.c _gnutls_epoch_get(gnutls_session_t session, unsigned int epoch_rel,</span>
<span class='curline'><a href='../S/5810.html#L921'>session</a>           921 lib/constate.c 	gnutls_mutex_lock(&amp;session-&gt;internals.epoch_lock);</span>
<span class='curline'><a href='../S/5810.html#L923'>session</a>           923 lib/constate.c 	ret = epoch_resolve(session, epoch_rel, &amp;epoch);</span>
<span class='curline'><a href='../S/5810.html#L929'>session</a>           929 lib/constate.c 	params = epoch_get_slot(session, epoch);</span>
<span class='curline'><a href='../S/5810.html#L941'>session</a>           941 lib/constate.c 	gnutls_mutex_unlock(&amp;session-&gt;internals.epoch_lock);</span>
<span class='curline'><a href='../S/5810.html#L950'>session</a>           950 lib/constate.c _gnutls_epoch_setup_next(gnutls_session_t session, unsigned null_epoch, record_parameters_st **newp)</span>
<span class='curline'><a href='../S/5810.html#L954'>session</a>           954 lib/constate.c 	slot = epoch_get_slot(session, session-&gt;security_parameters.epoch_next);</span>
<span class='curline'><a href='../S/5810.html#L964'>session</a>           964 lib/constate.c 		if (unlikely((*slot)-&gt;epoch != session-&gt;security_parameters.epoch_next))</span>
<span class='curline'><a href='../S/5810.html#L970'>session</a>           970 lib/constate.c 	_gnutls_record_log("REC[%p]: Allocating epoch #%u\n", session,</span>
<span class='curline'><a href='../S/5810.html#L971'>session</a>           971 lib/constate.c 			   session-&gt;security_parameters.epoch_next);</span>
<span class='curline'><a href='../S/5810.html#L977'>session</a>           977 lib/constate.c 	(*slot)-&gt;epoch = session-&gt;security_parameters.epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L988'>session</a>           988 lib/constate.c 	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5810.html#L991'>session</a>           991 lib/constate.c 		seq |= ((uint64_t)session-&gt;security_parameters.epoch_next) &lt;&lt; 48;</span>
<span class='curline'><a href='../S/5810.html#L1003'>session</a>          1003 lib/constate.c epoch_is_active(gnutls_session_t session, record_parameters_st * params)</span>
<span class='curline'><a href='../S/5810.html#L1005'>session</a>          1005 lib/constate.c 	const security_parameters_st *sp = &amp;session-&gt;security_parameters;</span>
<span class='curline'><a href='../S/5810.html#L1020'>session</a>          1020 lib/constate.c epoch_alive(gnutls_session_t session, record_parameters_st * params)</span>
<span class='curline'><a href='../S/5810.html#L1025'>session</a>          1025 lib/constate.c 	return epoch_is_active(session, params);</span>
<span class='curline'><a href='../S/5810.html#L1028'>session</a>          1028 lib/constate.c void _gnutls_epoch_gc(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5810.html#L1033'>session</a>          1033 lib/constate.c 	_gnutls_record_log("REC[%p]: Start of epoch cleanup\n", session);</span>
<span class='curline'><a href='../S/5810.html#L1035'>session</a>          1035 lib/constate.c 	gnutls_mutex_lock(&amp;session-&gt;internals.epoch_lock);</span>
<span class='curline'><a href='../S/5810.html#L1039'>session</a>          1039 lib/constate.c 		if (session-&gt;record_parameters[i] != NULL) {</span>
<span class='curline'><a href='../S/5810.html#L1041'>session</a>          1041 lib/constate.c 			    (session, session-&gt;record_parameters[i])</span>
<span class='curline'><a href='../S/5810.html#L1042'>session</a>          1042 lib/constate.c 			    &amp;&amp; session-&gt;record_parameters[i]-&gt;usage_cnt)</span>
<span class='curline'><a href='../S/5810.html#L1045'>session</a>          1045 lib/constate.c 				     session,</span>
<span class='curline'><a href='../S/5810.html#L1046'>session</a>          1046 lib/constate.c 				     session-&gt;record_parameters[i]-&gt;epoch,</span>
<span class='curline'><a href='../S/5810.html#L1047'>session</a>          1047 lib/constate.c 				     session-&gt;record_parameters[i]-&gt;</span>
<span class='curline'><a href='../S/5810.html#L1050'>session</a>          1050 lib/constate.c 			    (session, session-&gt;record_parameters[i])) {</span>
<span class='curline'><a href='../S/5810.html#L1051'>session</a>          1051 lib/constate.c 				_gnutls_epoch_free(session,</span>
<span class='curline'><a href='../S/5810.html#L1052'>session</a>          1052 lib/constate.c 						   session-&gt;</span>
<span class='curline'><a href='../S/5810.html#L1054'>session</a>          1054 lib/constate.c 				session-&gt;record_parameters[i] = NULL;</span>
<span class='curline'><a href='../S/5810.html#L1061'>session</a>          1061 lib/constate.c 	     i &lt; MAX_EPOCH_INDEX &amp;&amp; session-&gt;record_parameters[i] == NULL;</span>
<span class='curline'><a href='../S/5810.html#L1068'>session</a>          1068 lib/constate.c 			session-&gt;record_parameters[i] =</span>
<span class='curline'><a href='../S/5810.html#L1069'>session</a>          1069 lib/constate.c 			    session-&gt;record_parameters[j];</span>
<span class='curline'><a href='../S/5810.html#L1070'>session</a>          1070 lib/constate.c 			session-&gt;record_parameters[j] = NULL;</span>
<span class='curline'><a href='../S/5810.html#L1075'>session</a>          1075 lib/constate.c 	if (session-&gt;record_parameters[0] != NULL)</span>
<span class='curline'><a href='../S/5810.html#L1076'>session</a>          1076 lib/constate.c 		session-&gt;security_parameters.epoch_min =</span>
<span class='curline'><a href='../S/5810.html#L1077'>session</a>          1077 lib/constate.c 		    session-&gt;record_parameters[0]-&gt;epoch;</span>
<span class='curline'><a href='../S/5810.html#L1079'>session</a>          1079 lib/constate.c 	gnutls_mutex_unlock(&amp;session-&gt;internals.epoch_lock);</span>
<span class='curline'><a href='../S/5810.html#L1081'>session</a>          1081 lib/constate.c 	_gnutls_record_log("REC[%p]: End of epoch cleanup\n", session);</span>
<span class='curline'><a href='../S/5810.html#L1097'>session</a>          1097 lib/constate.c _gnutls_epoch_free(gnutls_session_t session, record_parameters_st * params)</span>
<span class='curline'><a href='../S/5810.html#L1099'>session</a>          1099 lib/constate.c 	_gnutls_record_log("REC[%p]: Epoch #%u freed\n", session,</span>
<span class='curline'><a href='../S/5810.html#L1108'>session</a>          1108 lib/constate.c int _tls13_connection_state_init(gnutls_session_t session, hs_stage_t stage)</span>
<span class='curline'><a href='../S/5810.html#L1111'>session</a>          1111 lib/constate.c 	    session-&gt;security_parameters.epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L1114'>session</a>          1114 lib/constate.c 	ret = _gnutls_epoch_set_keys(session, epoch_next, stage);</span>
<span class='curline'><a href='../S/5810.html#L1119'>session</a>          1119 lib/constate.c 			      session,</span>
<span class='curline'><a href='../S/5810.html#L1120'>session</a>          1120 lib/constate.c 			      session-&gt;security_parameters.cs-&gt;name);</span>
<span class='curline'><a href='../S/5810.html#L1122'>session</a>          1122 lib/constate.c 	session-&gt;security_parameters.epoch_read = epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L1123'>session</a>          1123 lib/constate.c 	session-&gt;security_parameters.epoch_write = epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L1128'>session</a>          1128 lib/constate.c int _tls13_read_connection_state_init(gnutls_session_t session, hs_stage_t stage)</span>
<span class='curline'><a href='../S/5810.html#L1131'>session</a>          1131 lib/constate.c 	    session-&gt;security_parameters.epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L1134'>session</a>          1134 lib/constate.c 	ret = _gnutls_epoch_set_keys(session, epoch_next, stage);</span>
<span class='curline'><a href='../S/5810.html#L1139'>session</a>          1139 lib/constate.c 			      session,</span>
<span class='curline'><a href='../S/5810.html#L1140'>session</a>          1140 lib/constate.c 			      session-&gt;security_parameters.cs-&gt;name);</span>
<span class='curline'><a href='../S/5810.html#L1142'>session</a>          1142 lib/constate.c 	session-&gt;security_parameters.epoch_read = epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L1147'>session</a>          1147 lib/constate.c int _tls13_write_connection_state_init(gnutls_session_t session, hs_stage_t stage)</span>
<span class='curline'><a href='../S/5810.html#L1150'>session</a>          1150 lib/constate.c 	    session-&gt;security_parameters.epoch_next;</span>
<span class='curline'><a href='../S/5810.html#L1153'>session</a>          1153 lib/constate.c 	ret = _gnutls_epoch_set_keys(session, epoch_next, stage);</span>
<span class='curline'><a href='../S/5810.html#L1158'>session</a>          1158 lib/constate.c 			      session,</span>
<span class='curline'><a href='../S/5810.html#L1159'>session</a>          1159 lib/constate.c 			      session-&gt;security_parameters.cs-&gt;name);</span>
<span class='curline'><a href='../S/5810.html#L1161'>session</a>          1161 lib/constate.c 	session-&gt;security_parameters.epoch_write = epoch_next;</span>
<span class='curline'><a href='../S/5991.html#L26'>session</a>            26 lib/constate.h int _gnutls_set_cipher_suite2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5991.html#L29'>session</a>            29 lib/constate.h int _gnutls_epoch_set_keys(gnutls_session_t session, uint16_t epoch, hs_stage_t stage);</span>
<span class='curline'><a href='../S/5991.html#L30'>session</a>            30 lib/constate.h int _gnutls_connection_state_init(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5991.html#L31'>session</a>            31 lib/constate.h int _gnutls_read_connection_state_init(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5991.html#L32'>session</a>            32 lib/constate.h int _gnutls_write_connection_state_init(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5991.html#L34'>session</a>            34 lib/constate.h #define _gnutls_epoch_bump(session) \</span>
<span class='curline'><a href='../S/5991.html#L35'>session</a>            35 lib/constate.h 	(session)-&gt;security_parameters.epoch_next++</span>
<span class='curline'><a href='../S/5991.html#L37'>session</a>            37 lib/constate.h int _gnutls_epoch_dup(gnutls_session_t session, unsigned int epoch_rel);</span>
<span class='curline'><a href='../S/5991.html#L39'>session</a>            39 lib/constate.h int _gnutls_epoch_get(gnutls_session_t session, unsigned int epoch_rel,</span>
<span class='curline'><a href='../S/5991.html#L41'>session</a>            41 lib/constate.h int _gnutls_epoch_setup_next(gnutls_session_t session, unsigned null_epoch, record_parameters_st **newp);</span>
<span class='curline'><a href='../S/5991.html#L42'>session</a>            42 lib/constate.h void _gnutls_epoch_gc(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5991.html#L43'>session</a>            43 lib/constate.h void _gnutls_epoch_free(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5991.html#L46'>session</a>            46 lib/constate.h void _gnutls_set_resumed_parameters(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5991.html#L48'>session</a>            48 lib/constate.h int _tls13_connection_state_init(gnutls_session_t session, hs_stage_t stage);</span>
<span class='curline'><a href='../S/5991.html#L49'>session</a>            49 lib/constate.h int _tls13_read_connection_state_init(gnutls_session_t session, hs_stage_t stage);</span>
<span class='curline'><a href='../S/5991.html#L50'>session</a>            50 lib/constate.h int _tls13_write_connection_state_init(gnutls_session_t session, hs_stage_t stage);</span>
<span class='curline'><a href='../S/5991.html#L52'>session</a>            52 lib/constate.h static inline int _gnutls_epoch_is_valid(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5991.html#L58'>session</a>            58 lib/constate.h 	ret = _gnutls_epoch_get(session, epoch, &amp;params);</span>
<span class='curline'><a href='../S/5991.html#L66'>session</a>            66 lib/constate.h static inline int _gnutls_epoch_refcount_inc(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5991.html#L72'>session</a>            72 lib/constate.h 	ret = _gnutls_epoch_get(session, epoch, &amp;params);</span>
<span class='curline'><a href='../S/5991.html#L81'>session</a>            81 lib/constate.h static inline int _gnutls_epoch_refcount_dec(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5991.html#L87'>session</a>            87 lib/constate.h 	ret = _gnutls_epoch_get(session, epoch, &amp;params);</span>
<span class='curline'><a href='../S/5755.html#L52'>session</a>            52 lib/db.c       gnutls_db_set_retrieve_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5755.html#L55'>session</a>            55 lib/db.c       	session-&gt;internals.db_retrieve_func = retr_func;</span>
<span class='curline'><a href='../S/5755.html#L70'>session</a>            70 lib/db.c       gnutls_db_set_remove_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5755.html#L73'>session</a>            73 lib/db.c       	session-&gt;internals.db_remove_func = rem_func;</span>
<span class='curline'><a href='../S/5755.html#L88'>session</a>            88 lib/db.c       gnutls_db_set_store_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5755.html#L91'>session</a>            91 lib/db.c       	session-&gt;internals.db_store_func = store_func;</span>
<span class='curline'><a href='../S/5755.html#L102'>session</a>           102 lib/db.c       void gnutls_db_set_ptr(gnutls_session_t session, void *ptr)</span>
<span class='curline'><a href='../S/5755.html#L104'>session</a>           104 lib/db.c       	session-&gt;internals.db_ptr = ptr;</span>
<span class='curline'><a href='../S/5755.html#L116'>session</a>           116 lib/db.c       void *gnutls_db_get_ptr(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5755.html#L118'>session</a>           118 lib/db.c       	return session-&gt;internals.db_ptr;</span>
<span class='curline'><a href='../S/5755.html#L133'>session</a>           133 lib/db.c       void gnutls_db_set_cache_expiration(gnutls_session_t session, int seconds)</span>
<span class='curline'><a href='../S/5755.html#L135'>session</a>           135 lib/db.c       	session-&gt;internals.expire_time = seconds;</span>
<span class='curline'><a href='../S/5755.html#L136'>session</a>           136 lib/db.c       	if (session-&gt;internals.expire_time &gt; 604800)</span>
<span class='curline'><a href='../S/5755.html#L137'>session</a>           137 lib/db.c       		session-&gt;internals.expire_time = 604800;</span>
<span class='curline'><a href='../S/5755.html#L163'>session</a>           163 lib/db.c       gnutls_db_check_entry(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5755.html#L233'>session</a>           233 lib/db.c       static int db_func_is_ok(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5755.html#L235'>session</a>           235 lib/db.c       	if (session-&gt;internals.db_store_func != NULL &amp;&amp;</span>
<span class='curline'><a href='../S/5755.html#L236'>session</a>           236 lib/db.c       	    session-&gt;internals.db_retrieve_func != NULL)</span>
<span class='curline'><a href='../S/5755.html#L245'>session</a>           245 lib/db.c       store_session(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5755.html#L250'>session</a>           250 lib/db.c       	if (db_func_is_ok(session) != 0) {</span>
<span class='curline'><a href='../S/5755.html#L260'>session</a>           260 lib/db.c       	ret = session-&gt;internals.db_store_func(session-&gt;internals.db_ptr,</span>
<span class='curline'><a href='../S/5755.html#L266'>session</a>           266 lib/db.c       int _gnutls_server_register_current_session(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5755.html#L272'>session</a>           272 lib/db.c       	key.data = session-&gt;security_parameters.session_id;</span>
<span class='curline'><a href='../S/5755.html#L273'>session</a>           273 lib/db.c       	key.size = session-&gt;security_parameters.session_id_size;</span>
<span class='curline'><a href='../S/5755.html#L275'>session</a>           275 lib/db.c       	if (session-&gt;internals.resumable == RESUME_FALSE) {</span>
<span class='curline'><a href='../S/5755.html#L280'>session</a>           280 lib/db.c       	if (session-&gt;security_parameters.session_id_size == 0) {</span>
<span class='curline'><a href='../S/5755.html#L285'>session</a>           285 lib/db.c       	ret = _gnutls_session_pack(session, &amp;content);</span>
<span class='curline'><a href='../S/5755.html#L291'>session</a>           291 lib/db.c       	ret = store_session(session, key, content);</span>
<span class='curline'><a href='../S/5755.html#L297'>session</a>           297 lib/db.c       int _gnutls_check_resumed_params(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5755.html#L304'>session</a>           304 lib/db.c       	    session-&gt;internals.resumed_security_parameters.timestamp &gt;</span>
<span class='curline'><a href='../S/5755.html#L305'>session</a>           305 lib/db.c       	    session-&gt;internals.expire_time</span>
<span class='curline'><a href='../S/5755.html#L306'>session</a>           306 lib/db.c       	    || session-&gt;internals.resumed_security_parameters.timestamp &gt;</span>
<span class='curline'><a href='../S/5755.html#L312'>session</a>           312 lib/db.c       	vers = get_version(session);</span>
<span class='curline'><a href='../S/5755.html#L314'>session</a>           314 lib/db.c       		if (session-&gt;internals.resumed_security_parameters.ext_master_secret !=</span>
<span class='curline'><a href='../S/5755.html#L315'>session</a>           315 lib/db.c       		    session-&gt;security_parameters.ext_master_secret)</span>
<span class='curline'><a href='../S/5755.html#L318'>session</a>           318 lib/db.c       		if (!_gnutls_server_name_matches_resumed(session))</span>
<span class='curline'><a href='../S/5755.html#L326'>session</a>           326 lib/db.c       _gnutls_server_restore_session(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5755.html#L338'>session</a>           338 lib/db.c       	if (session-&gt;internals.premaster_set != 0) {	/* hack for CISCO's DTLS-0.9 */</span>
<span class='curline'><a href='../S/5755.html#L340'>session</a>           340 lib/db.c       		    session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5755.html#L343'>session</a>           343 lib/db.c       			      session-&gt;internals.</span>
<span class='curline'><a href='../S/5755.html#L352'>session</a>           352 lib/db.c       	if (db_func_is_ok(session) != 0) {</span>
<span class='curline'><a href='../S/5755.html#L358'>session</a>           358 lib/db.c       	    session-&gt;internals.db_retrieve_func(session-&gt;internals.db_ptr,</span>
<span class='curline'><a href='../S/5755.html#L366'>session</a>           366 lib/db.c       	ret = gnutls_session_set_data(session, data.data, data.size);</span>
<span class='curline'><a href='../S/5755.html#L375'>session</a>           375 lib/db.c       	ret = _gnutls_check_resumed_params(session);</span>
<span class='curline'><a href='../S/5755.html#L394'>session</a>           394 lib/db.c       void gnutls_db_remove_session(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5755.html#L399'>session</a>           399 lib/db.c       	session_id.data = session-&gt;security_parameters.session_id;</span>
<span class='curline'><a href='../S/5755.html#L400'>session</a>           400 lib/db.c       	session_id.size = session-&gt;security_parameters.session_id_size;</span>
<span class='curline'><a href='../S/5755.html#L402'>session</a>           402 lib/db.c       	if (session-&gt;internals.db_remove_func == NULL) {</span>
<span class='curline'><a href='../S/5755.html#L413'>session</a>           413 lib/db.c       	ret = session-&gt;internals.db_remove_func(session-&gt;internals.db_ptr,</span>
<span class='curline'><a href='../S/5461.html#L26'>session</a>            26 lib/db.h       int _gnutls_server_register_current_session(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5461.html#L27'>session</a>            27 lib/db.h       int _gnutls_server_restore_session(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5461.html#L31'>session</a>            31 lib/db.h       int _gnutls_check_resumed_params(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5812.html#L68'>session</a>            68 lib/dh-session.c void gnutls_dh_set_prime_bits(gnutls_session_t session, unsigned int bits)</span>
<span class='curline'><a href='../S/5812.html#L72'>session</a>            72 lib/dh-session.c 		_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5812.html#L75'>session</a>            75 lib/dh-session.c 	session-&gt;internals.dh_prime_bits = bits;</span>
<span class='curline'><a href='../S/5812.html#L98'>session</a>            98 lib/dh-session.c gnutls_dh_get_group(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5812.html#L107'>session</a>           107 lib/dh-session.c 	switch (gnutls_auth_get_type(session)) {</span>
<span class='curline'><a href='../S/5812.html#L109'>session</a>           109 lib/dh-session.c 		anon_info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5812.html#L115'>session</a>           115 lib/dh-session.c 		psk_info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5812.html#L121'>session</a>           121 lib/dh-session.c 		cert_info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5812.html#L166'>session</a>           166 lib/dh-session.c gnutls_dh_get_pubkey(gnutls_session_t session, gnutls_datum_t * raw_key)</span>
<span class='curline'><a href='../S/5812.html#L173'>session</a>           173 lib/dh-session.c 	switch (gnutls_auth_get_type(session)) {</span>
<span class='curline'><a href='../S/5812.html#L176'>session</a>           176 lib/dh-session.c 			anon_info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5812.html#L184'>session</a>           184 lib/dh-session.c 			psk_info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5812.html#L193'>session</a>           193 lib/dh-session.c 			cert_info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5812.html#L219'>session</a>           219 lib/dh-session.c int gnutls_dh_get_secret_bits(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5812.html#L221'>session</a>           221 lib/dh-session.c 	switch (gnutls_auth_get_type(session)) {</span>
<span class='curline'><a href='../S/5812.html#L226'>session</a>           226 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5812.html#L235'>session</a>           235 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5812.html#L244'>session</a>           244 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5812.html#L288'>session</a>           288 lib/dh-session.c int gnutls_dh_get_prime_bits(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5812.html#L292'>session</a>           292 lib/dh-session.c 	switch (gnutls_auth_get_type(session)) {</span>
<span class='curline'><a href='../S/5812.html#L297'>session</a>           297 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5812.html#L307'>session</a>           307 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5812.html#L317'>session</a>           317 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5812.html#L346'>session</a>           346 lib/dh-session.c int gnutls_dh_get_peers_public_bits(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5812.html#L350'>session</a>           350 lib/dh-session.c 	switch (gnutls_auth_get_type(session)) {</span>
<span class='curline'><a href='../S/5812.html#L355'>session</a>           355 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5812.html#L366'>session</a>           366 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5812.html#L377'>session</a>           377 lib/dh-session.c 			info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5622.html#L39'>session</a>            39 lib/dh.c       int set_dh_pk_params(gnutls_session_t session, bigint_t g, bigint_t p,</span>
<span class='curline'><a href='../S/5622.html#L43'>session</a>            43 lib/dh.c       	gnutls_pk_params_release(&amp;session-&gt;key.proto.tls12.dh.params);</span>
<span class='curline'><a href='../S/5622.html#L45'>session</a>            45 lib/dh.c       	gnutls_pk_params_init(&amp;session-&gt;key.proto.tls12.dh.params);</span>
<span class='curline'><a href='../S/5622.html#L47'>session</a>            47 lib/dh.c       	session-&gt;key.proto.tls12.dh.params.params[DH_G] = _gnutls_mpi_copy(g);</span>
<span class='curline'><a href='../S/5622.html#L48'>session</a>            48 lib/dh.c       	if (session-&gt;key.proto.tls12.dh.params.params[DH_G] == NULL)</span>
<span class='curline'><a href='../S/5622.html#L51'>session</a>            51 lib/dh.c       	session-&gt;key.proto.tls12.dh.params.params[DH_P] = _gnutls_mpi_copy(p);</span>
<span class='curline'><a href='../S/5622.html#L52'>session</a>            52 lib/dh.c       	if (session-&gt;key.proto.tls12.dh.params.params[DH_P] == NULL) {</span>
<span class='curline'><a href='../S/5622.html#L53'>session</a>            53 lib/dh.c       		_gnutls_mpi_release(&amp;session-&gt;key.proto.tls12.dh.params.params[DH_G]);</span>
<span class='curline'><a href='../S/5622.html#L58'>session</a>            58 lib/dh.c       		session-&gt;key.proto.tls12.dh.params.params[DH_Q] = _gnutls_mpi_copy(q);</span>
<span class='curline'><a href='../S/5622.html#L59'>session</a>            59 lib/dh.c       		if (session-&gt;key.proto.tls12.dh.params.params[DH_Q] == NULL) {</span>
<span class='curline'><a href='../S/5622.html#L60'>session</a>            60 lib/dh.c       			_gnutls_mpi_release(&amp;session-&gt;key.proto.tls12.dh.params.params[DH_P]);</span>
<span class='curline'><a href='../S/5622.html#L61'>session</a>            61 lib/dh.c       			_gnutls_mpi_release(&amp;session-&gt;key.proto.tls12.dh.params.params[DH_G]);</span>
<span class='curline'><a href='../S/5622.html#L66'>session</a>            66 lib/dh.c       	session-&gt;key.proto.tls12.dh.params.params_nr = 3;</span>
<span class='curline'><a href='../S/5622.html#L67'>session</a>            67 lib/dh.c       	session-&gt;key.proto.tls12.dh.params.algo = GNUTLS_PK_DH;</span>
<span class='curline'><a href='../S/5622.html#L68'>session</a>            68 lib/dh.c       	session-&gt;key.proto.tls12.dh.params.qbits = q_bits;</span>
<span class='curline'><a href='../S/5622.html#L78'>session</a>            78 lib/dh.c       _gnutls_figure_dh_params(gnutls_session_t session, gnutls_dh_params_t dh_params,</span>
<span class='curline'><a href='../S/5622.html#L88'>session</a>            88 lib/dh.c       	group = get_group(session);</span>
<span class='curline'><a href='../S/5622.html#L94'>session</a>            94 lib/dh.c       		for (i=0;i&lt;session-&gt;internals.priorities-&gt;groups.size;i++) {</span>
<span class='curline'><a href='../S/5622.html#L95'>session</a>            95 lib/dh.c       			if (session-&gt;internals.priorities-&gt;groups.entry[i] == group) {</span>
<span class='curline'><a href='../S/5622.html#L97'>session</a>            97 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;prime-&gt;data,</span>
<span class='curline'><a href='../S/5622.html#L98'>session</a>            98 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;prime-&gt;size);</span>
<span class='curline'><a href='../S/5622.html#L105'>session</a>           105 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;generator-&gt;data,</span>
<span class='curline'><a href='../S/5622.html#L106'>session</a>           106 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;generator-&gt;size);</span>
<span class='curline'><a href='../S/5622.html#L113'>session</a>           113 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;q-&gt;data,</span>
<span class='curline'><a href='../S/5622.html#L114'>session</a>           114 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;q-&gt;size);</span>
<span class='curline'><a href='../S/5622.html#L120'>session</a>           120 lib/dh.c       				session-&gt;internals.hsk_flags |= HSK_USED_FFDHE;</span>
<span class='curline'><a href='../S/5622.html#L121'>session</a>           121 lib/dh.c       				q_bits = *session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;q_bits;</span>
<span class='curline'><a href='../S/5622.html#L132'>session</a>           132 lib/dh.c       		for (i=0;i&lt;session-&gt;internals.priorities-&gt;groups.size;i++) {</span>
<span class='curline'><a href='../S/5622.html#L133'>session</a>           133 lib/dh.c       			if (!session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;prime)</span>
<span class='curline'><a href='../S/5622.html#L136'>session</a>           136 lib/dh.c       			if (bits &lt;= session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;prime-&gt;size) {</span>
<span class='curline'><a href='../S/5622.html#L138'>session</a>           138 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;prime-&gt;data,</span>
<span class='curline'><a href='../S/5622.html#L139'>session</a>           139 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;prime-&gt;size);</span>
<span class='curline'><a href='../S/5622.html#L146'>session</a>           146 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;generator-&gt;data,</span>
<span class='curline'><a href='../S/5622.html#L147'>session</a>           147 lib/dh.c       						session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;generator-&gt;size);</span>
<span class='curline'><a href='../S/5622.html#L153'>session</a>           153 lib/dh.c       				q_bits = *session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;q_bits;</span>
<span class='curline'><a href='../S/5622.html#L165'>session</a>           165 lib/dh.c       		ret = func(session, GNUTLS_PARAMS_DH, &amp;params);</span>
<span class='curline'><a href='../S/5622.html#L176'>session</a>           176 lib/dh.c       	_gnutls_dh_save_group(session, g, p);</span>
<span class='curline'><a href='../S/5622.html#L178'>session</a>           178 lib/dh.c       	ret = set_dh_pk_params(session, g, p, q, q_bits);</span>
<span class='curline'><a href='../S/5983.html#L29'>session</a>            29 lib/dh.h       _gnutls_figure_dh_params(gnutls_session_t session, gnutls_dh_params_t dh_params,</span>
<span class='curline'><a href='../S/6022.html#L40'>session</a>            40 lib/dtls.c     void _dtls_async_timer_delete(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L42'>session</a>            42 lib/dtls.c     	if (session-&gt;internals.dtls.async_term != 0) {</span>
<span class='curline'><a href='../S/6022.html#L45'>session</a>            45 lib/dtls.c     		     session);</span>
<span class='curline'><a href='../S/6022.html#L46'>session</a>            46 lib/dtls.c     		session-&gt;internals.dtls.async_term = 0;	/* turn off "timer" */</span>
<span class='curline'><a href='../S/6022.html#L48'>session</a>            48 lib/dtls.c     		_dtls_reset_hsk_state(session);</span>
<span class='curline'><a href='../S/6022.html#L49'>session</a>            49 lib/dtls.c     		_gnutls_handshake_io_buffer_clear(session);</span>
<span class='curline'><a href='../S/6022.html#L50'>session</a>            50 lib/dtls.c     		_gnutls_epoch_gc(session);</span>
<span class='curline'><a href='../S/6022.html#L59'>session</a>            59 lib/dtls.c     transmit_message(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6022.html#L66'>session</a>            66 lib/dtls.c     	    gnutls_dtls_get_data_mtu(session);</span>
<span class='curline'><a href='../S/6022.html#L68'>session</a>            68 lib/dtls.c     	if (session-&gt;security_parameters.max_record_send_size &lt; mtu)</span>
<span class='curline'><a href='../S/6022.html#L69'>session</a>            69 lib/dtls.c     		mtu = session-&gt;security_parameters.max_record_send_size;</span>
<span class='curline'><a href='../S/6022.html#L76'>session</a>            76 lib/dtls.c     		     session, bufel-&gt;handshake_sequence,</span>
<span class='curline'><a href='../S/6022.html#L79'>session</a>            79 lib/dtls.c     		return _gnutls_send_int(session, bufel-&gt;type, -1,</span>
<span class='curline'><a href='../S/6022.html#L135'>session</a>           135 lib/dtls.c     		     session, bufel-&gt;handshake_sequence,</span>
<span class='curline'><a href='../S/6022.html#L139'>session</a>           139 lib/dtls.c     		ret = _gnutls_send_int(session, bufel-&gt;type, bufel-&gt;htype,</span>
<span class='curline'><a href='../S/6022.html#L152'>session</a>           152 lib/dtls.c     static int drop_usage_count(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6022.html#L159'>session</a>           159 lib/dtls.c     		ret = _gnutls_epoch_refcount_dec(session, cur-&gt;epoch);</span>
<span class='curline'><a href='../S/6022.html#L175'>session</a>           175 lib/dtls.c     static int is_next_hpacket_expected(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L181'>session</a>           181 lib/dtls.c     	    _gnutls_recv_in_buffers(session, GNUTLS_HANDSHAKE,</span>
<span class='curline'><a href='../S/6022.html#L186'>session</a>           186 lib/dtls.c     	ret = _gnutls_parse_record_buffered_msgs(session);</span>
<span class='curline'><a href='../S/6022.html#L190'>session</a>           190 lib/dtls.c     	if (session-&gt;internals.handshake_recv_buffer_size &gt; 0)</span>
<span class='curline'><a href='../S/6022.html#L198'>session</a>           198 lib/dtls.c     void _dtls_reset_hsk_state(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L200'>session</a>           200 lib/dtls.c     	session-&gt;internals.dtls.flight_init = 0;</span>
<span class='curline'><a href='../S/6022.html#L201'>session</a>           201 lib/dtls.c     	drop_usage_count(session,</span>
<span class='curline'><a href='../S/6022.html#L202'>session</a>           202 lib/dtls.c     			 &amp;session-&gt;internals.handshake_send_buffer);</span>
<span class='curline'><a href='../S/6022.html#L203'>session</a>           203 lib/dtls.c     	_mbuffer_head_clear(&amp;session-&gt;internals.handshake_send_buffer);</span>
<span class='curline'><a href='../S/6022.html#L208'>session</a>           208 lib/dtls.c           session-&gt;internals.dtls.actual_retrans_timeout_ms *= 2; \</span>
<span class='curline'><a href='../S/6022.html#L209'>session</a>           209 lib/dtls.c           session-&gt;internals.dtls.actual_retrans_timeout_ms %= MAX_DTLS_TIMEOUT; \</span>
<span class='curline'><a href='../S/6022.html#L213'>session</a>           213 lib/dtls.c           session-&gt;internals.dtls.actual_retrans_timeout_ms = session-&gt;internals.dtls.retrans_timeout_ms</span>
<span class='curline'><a href='../S/6022.html#L215'>session</a>           215 lib/dtls.c     #define TIMER_WINDOW session-&gt;internals.dtls.actual_retrans_timeout_ms</span>
<span class='curline'><a href='../S/6022.html#L223'>session</a>           223 lib/dtls.c     int _dtls_transmit(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L231'>session</a>           231 lib/dtls.c     	    &amp;session-&gt;internals.handshake_send_buffer;</span>
<span class='curline'><a href='../S/6022.html#L243'>session</a>           243 lib/dtls.c     	if (session-&gt;internals.dtls.flight_init != 0</span>
<span class='curline'><a href='../S/6022.html#L244'>session</a>           244 lib/dtls.c     	    &amp;&amp; (session-&gt;internals.flags &amp; GNUTLS_NONBLOCK)) {</span>
<span class='curline'><a href='../S/6022.html#L246'>session</a>           246 lib/dtls.c     		ret = _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/6022.html#L252'>session</a>           252 lib/dtls.c     		if (session-&gt;internals.dtls.last_flight == 0</span>
<span class='curline'><a href='../S/6022.html#L253'>session</a>           253 lib/dtls.c     		    || !_dtls_is_async(session)) {</span>
<span class='curline'><a href='../S/6022.html#L255'>session</a>           255 lib/dtls.c     			ret = _gnutls_io_check_recv(session, 0);</span>
<span class='curline'><a href='../S/6022.html#L261'>session</a>           261 lib/dtls.c     				     &amp;session-&gt;internals.dtls.</span>
<span class='curline'><a href='../S/6022.html#L271'>session</a>           271 lib/dtls.c     					    (session);</span>
<span class='curline'><a href='../S/6022.html#L296'>session</a>           296 lib/dtls.c     				    &amp;session-&gt;internals.handshake_start_time);</span>
<span class='curline'><a href='../S/6022.html#L297'>session</a>           297 lib/dtls.c     		if (diff &gt;= session-&gt;internals.handshake_timeout_ms) {</span>
<span class='curline'><a href='../S/6022.html#L305'>session</a>           305 lib/dtls.c     				    &amp;session-&gt;internals.dtls.</span>
<span class='curline'><a href='../S/6022.html#L307'>session</a>           307 lib/dtls.c     		if (session-&gt;internals.dtls.flight_init == 0</span>
<span class='curline'><a href='../S/6022.html#L311'>session</a>           311 lib/dtls.c     			     session,</span>
<span class='curline'><a href='../S/6022.html#L312'>session</a>           312 lib/dtls.c     			     (session-&gt;internals.dtls.flight_init ==</span>
<span class='curline'><a href='../S/6022.html#L316'>session</a>           316 lib/dtls.c     				ret = transmit_message(session, cur, &amp;buf);</span>
<span class='curline'><a href='../S/6022.html#L324'>session</a>           324 lib/dtls.c     			gnutls_gettime(&amp;session-&gt;internals.dtls.last_retransmit);</span>
<span class='curline'><a href='../S/6022.html#L326'>session</a>           326 lib/dtls.c     			if (session-&gt;internals.dtls.flight_init == 0) {</span>
<span class='curline'><a href='../S/6022.html#L327'>session</a>           327 lib/dtls.c     				session-&gt;internals.dtls.flight_init = 1;</span>
<span class='curline'><a href='../S/6022.html#L336'>session</a>           336 lib/dtls.c     					session-&gt;internals.dtls.</span>
<span class='curline'><a href='../S/6022.html#L339'>session</a>           339 lib/dtls.c     					session-&gt;internals.dtls.</span>
<span class='curline'><a href='../S/6022.html#L346'>session</a>           346 lib/dtls.c     		ret = _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/6022.html#L353'>session</a>           353 lib/dtls.c     		if (session-&gt;internals.dtls.last_flight != 0) {</span>
<span class='curline'><a href='../S/6022.html#L363'>session</a>           363 lib/dtls.c     			if (!(session-&gt;internals.flags &amp; GNUTLS_NONBLOCK))</span>
<span class='curline'><a href='../S/6022.html#L365'>session</a>           365 lib/dtls.c     				    _gnutls_io_check_recv(session,</span>
<span class='curline'><a href='../S/6022.html#L368'>session</a>           368 lib/dtls.c     				ret = _gnutls_io_check_recv(session, 0);</span>
<span class='curline'><a href='../S/6022.html#L375'>session</a>           375 lib/dtls.c     				ret = is_next_hpacket_expected(session);</span>
<span class='curline'><a href='../S/6022.html#L406'>session</a>           406 lib/dtls.c     			 session);</span>
<span class='curline'><a href='../S/6022.html#L407'>session</a>           407 lib/dtls.c     	_dtls_reset_hsk_state(session);</span>
<span class='curline'><a href='../S/6022.html#L420'>session</a>           420 lib/dtls.c     	RETURN_DTLS_EAGAIN_OR_TIMEOUT(session, ret);</span>
<span class='curline'><a href='../S/6022.html#L426'>session</a>           426 lib/dtls.c     int _dtls_wait_and_retransmit(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L430'>session</a>           430 lib/dtls.c     	if (!(session-&gt;internals.flags &amp; GNUTLS_NONBLOCK))</span>
<span class='curline'><a href='../S/6022.html#L431'>session</a>           431 lib/dtls.c     		ret = _gnutls_io_check_recv(session, TIMER_WINDOW);</span>
<span class='curline'><a href='../S/6022.html#L433'>session</a>           433 lib/dtls.c     		ret = _gnutls_io_check_recv(session, 0);</span>
<span class='curline'><a href='../S/6022.html#L436'>session</a>           436 lib/dtls.c     		ret = _dtls_retransmit(session);</span>
<span class='curline'><a href='../S/6022.html#L438'>session</a>           438 lib/dtls.c     			RETURN_DTLS_EAGAIN_OR_TIMEOUT(session, 0);</span>
<span class='curline'><a href='../S/6022.html#L466'>session</a>           466 lib/dtls.c     void gnutls_dtls_set_timeouts(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6022.html#L471'>session</a>           471 lib/dtls.c     		session-&gt;internals.handshake_timeout_ms = 0;</span>
<span class='curline'><a href='../S/6022.html#L473'>session</a>           473 lib/dtls.c     		session-&gt;internals.handshake_timeout_ms = total_timeout;</span>
<span class='curline'><a href='../S/6022.html#L475'>session</a>           475 lib/dtls.c     	session-&gt;internals.dtls.retrans_timeout_ms = retrans_timeout;</span>
<span class='curline'><a href='../S/6022.html#L491'>session</a>           491 lib/dtls.c     void gnutls_dtls_set_mtu(gnutls_session_t session, unsigned int mtu)</span>
<span class='curline'><a href='../S/6022.html#L493'>session</a>           493 lib/dtls.c     	session-&gt;internals.dtls.mtu = MIN(mtu, DEFAULT_MAX_RECORD_SIZE);</span>
<span class='curline'><a href='../S/6022.html#L605'>session</a>           605 lib/dtls.c     static int record_overhead_rt(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L610'>session</a>           610 lib/dtls.c     	if (session-&gt;internals.initial_negotiation_completed == 0)</span>
<span class='curline'><a href='../S/6022.html#L612'>session</a>           612 lib/dtls.c     	ret = _gnutls_epoch_get(session, EPOCH_WRITE_CURRENT, &amp;params);</span>
<span class='curline'><a href='../S/6022.html#L616'>session</a>           616 lib/dtls.c     	return _gnutls_record_overhead(get_version(session), params-&gt;cipher, params-&gt;mac, 1);</span>
<span class='curline'><a href='../S/6022.html#L630'>session</a>           630 lib/dtls.c     size_t gnutls_record_overhead_size(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L632'>session</a>           632 lib/dtls.c     	const version_entry_st *v = get_version(session);</span>
<span class='curline'><a href='../S/6022.html#L641'>session</a>           641 lib/dtls.c     	ret = record_overhead_rt(session);</span>
<span class='curline'><a href='../S/6022.html#L662'>session</a>           662 lib/dtls.c     unsigned int gnutls_dtls_get_data_mtu(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L664'>session</a>           664 lib/dtls.c     	int mtu = session-&gt;internals.dtls.mtu;</span>
<span class='curline'><a href='../S/6022.html#L668'>session</a>           668 lib/dtls.c     	mtu -= RECORD_HEADER_SIZE(session);</span>
<span class='curline'><a href='../S/6022.html#L670'>session</a>           670 lib/dtls.c     	if (session-&gt;internals.initial_negotiation_completed == 0)</span>
<span class='curline'><a href='../S/6022.html#L673'>session</a>           673 lib/dtls.c     	ret = _gnutls_epoch_get(session, EPOCH_WRITE_CURRENT, &amp;params);</span>
<span class='curline'><a href='../S/6022.html#L678'>session</a>           678 lib/dtls.c     		return mtu-_gnutls_record_overhead(get_version(session), params-&gt;cipher, params-&gt;mac, 0);</span>
<span class='curline'><a href='../S/6022.html#L735'>session</a>           735 lib/dtls.c     int gnutls_dtls_set_data_mtu(gnutls_session_t session, unsigned int mtu)</span>
<span class='curline'><a href='../S/6022.html#L739'>session</a>           739 lib/dtls.c     	overhead = record_overhead_rt(session);</span>
<span class='curline'><a href='../S/6022.html#L749'>session</a>           749 lib/dtls.c     	mtu += RECORD_HEADER_SIZE(session);</span>
<span class='curline'><a href='../S/6022.html#L751'>session</a>           751 lib/dtls.c     	gnutls_dtls_set_mtu(session, mtu);</span>
<span class='curline'><a href='../S/6022.html#L768'>session</a>           768 lib/dtls.c     unsigned int gnutls_dtls_get_mtu(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L770'>session</a>           770 lib/dtls.c     	return session-&gt;internals.dtls.mtu;</span>
<span class='curline'><a href='../S/6022.html#L787'>session</a>           787 lib/dtls.c     unsigned int gnutls_dtls_get_timeout(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L796'>session</a>           796 lib/dtls.c     			    &amp;session-&gt;internals.dtls.last_retransmit);</span>
<span class='curline'><a href='../S/6022.html#L1027'>session</a>          1027 lib/dtls.c     void gnutls_dtls_prestate_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6022.html#L1039'>session</a>          1039 lib/dtls.c     	ret = _gnutls_epoch_get(session, EPOCH_WRITE_CURRENT, &amp;params);</span>
<span class='curline'><a href='../S/6022.html#L1045'>session</a>          1045 lib/dtls.c     	session-&gt;internals.dtls.hsk_read_seq = prestate-&gt;hsk_read_seq;</span>
<span class='curline'><a href='../S/6022.html#L1046'>session</a>          1046 lib/dtls.c     	session-&gt;internals.dtls.hsk_write_seq =</span>
<span class='curline'><a href='../S/6022.html#L1061'>session</a>          1061 lib/dtls.c     unsigned int gnutls_record_get_discarded(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6022.html#L1063'>session</a>          1063 lib/dtls.c     	return session-&gt;internals.dtls.packets_dropped;</span>
<span class='curline'><a href='../S/5264.html#L32'>session</a>            32 lib/dtls.h     int _dtls_transmit(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5264.html#L34'>session</a>            34 lib/dtls.h     void _dtls_reset_hsk_state(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5264.html#L40'>session</a>            40 lib/dtls.h     #define RETURN_DTLS_EAGAIN_OR_TIMEOUT(session, r) { \</span>
<span class='curline'><a href='../S/5264.html#L45'>session</a>            45 lib/dtls.h       _diff = timespec_sub_ms(&amp;_now, &amp;session-&gt;internals.handshake_start_time); \</span>
<span class='curline'><a href='../S/5264.html#L46'>session</a>            46 lib/dtls.h       if (_diff &gt; session-&gt;internals.handshake_timeout_ms) \</span>
<span class='curline'><a href='../S/5264.html#L56'>session</a>            56 lib/dtls.h           if (!(session-&gt;internals.flags &amp; GNUTLS_NONBLOCK)) \</span>
<span class='curline'><a href='../S/5264.html#L63'>session</a>            63 lib/dtls.h     int _dtls_wait_and_retransmit(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5264.html#L68'>session</a>            68 lib/dtls.h     inline static int _dtls_is_async(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5264.html#L70'>session</a>            70 lib/dtls.h     	if ((session-&gt;security_parameters.entity == GNUTLS_SERVER</span>
<span class='curline'><a href='../S/5264.html#L71'>session</a>            71 lib/dtls.h     	     &amp;&amp; session-&gt;internals.resumed == RESUME_FALSE)</span>
<span class='curline'><a href='../S/5264.html#L72'>session</a>            72 lib/dtls.h     	    || (session-&gt;security_parameters.entity == GNUTLS_CLIENT</span>
<span class='curline'><a href='../S/5264.html#L73'>session</a>            73 lib/dtls.h     		&amp;&amp; session-&gt;internals.resumed == RESUME_TRUE))</span>
<span class='curline'><a href='../S/5264.html#L79'>session</a>            79 lib/dtls.h     inline static void _dtls_async_timer_init(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5264.html#L81'>session</a>            81 lib/dtls.h     	if (_dtls_is_async(session)) {</span>
<span class='curline'><a href='../S/5264.html#L84'>session</a>            84 lib/dtls.h     		     session);</span>
<span class='curline'><a href='../S/5264.html#L85'>session</a>            85 lib/dtls.h     		session-&gt;internals.dtls.async_term =</span>
<span class='curline'><a href='../S/5264.html#L88'>session</a>            88 lib/dtls.h     		_dtls_reset_hsk_state(session);</span>
<span class='curline'><a href='../S/5264.html#L89'>session</a>            89 lib/dtls.h     		_gnutls_handshake_io_buffer_clear(session);</span>
<span class='curline'><a href='../S/5264.html#L90'>session</a>            90 lib/dtls.h     		_gnutls_epoch_gc(session);</span>
<span class='curline'><a href='../S/5264.html#L91'>session</a>            91 lib/dtls.h     		session-&gt;internals.dtls.async_term = 0;</span>
<span class='curline'><a href='../S/5264.html#L95'>session</a>            95 lib/dtls.h     void _dtls_async_timer_delete(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5264.html#L99'>session</a>            99 lib/dtls.h     inline static void _dtls_async_timer_check(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5264.html#L101'>session</a>           101 lib/dtls.h     	if (!IS_DTLS(session))</span>
<span class='curline'><a href='../S/5264.html#L104'>session</a>           104 lib/dtls.h     	if (session-&gt;internals.dtls.async_term != 0) {</span>
<span class='curline'><a href='../S/5264.html#L108'>session</a>           108 lib/dtls.h     		if (_now &gt; session-&gt;internals.dtls.async_term) {</span>
<span class='curline'><a href='../S/5264.html#L109'>session</a>           109 lib/dtls.h     			_dtls_async_timer_delete(session);</span>
<span class='curline'><a href='../S/5264.html#L120'>session</a>           120 lib/dtls.h     inline static int _dtls_async_timer_active(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5264.html#L122'>session</a>           122 lib/dtls.h     	if (!IS_DTLS(session))</span>
<span class='curline'><a href='../S/5264.html#L125'>session</a>           125 lib/dtls.h     	return session-&gt;internals.dtls.async_term;</span>
<span class='curline'><a href='../S/5264.html#L133'>session</a>           133 lib/dtls.h     inline static int _dtls_retransmit(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5264.html#L135'>session</a>           135 lib/dtls.h     	return _dtls_transmit(session);</span>
<span class='curline'><a href='../S/5298.html#L718'>session</a>           718 lib/errors.c   void _gnutls_audit_log(gnutls_session_t session, const char *fmt, ...)</span>
<span class='curline'><a href='../S/5298.html#L733'>session</a>           733 lib/errors.c   			_gnutls_audit_log_func(session, str);</span>
<span class='curline'><a href='../S/5424.html#L28'>session</a>            28 lib/ext/alpn.c static int _gnutls_alpn_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5424.html#L31'>session</a>            31 lib/ext/alpn.c static int _gnutls_alpn_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5424.html#L54'>session</a>            54 lib/ext/alpn.c _gnutls_alpn_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5424.html#L66'>session</a>            66 lib/ext/alpn.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_ALPN,</span>
<span class='curline'><a href='../S/5424.html#L81'>session</a>            81 lib/ext/alpn.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5424.html#L145'>session</a>           145 lib/ext/alpn.c _gnutls_alpn_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5424.html#L154'>session</a>           154 lib/ext/alpn.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_ALPN,</span>
<span class='curline'><a href='../S/5424.html#L164'>session</a>           164 lib/ext/alpn.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5424.html#L235'>session</a>           235 lib/ext/alpn.c gnutls_alpn_get_selected_protocol(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5424.html#L243'>session</a>           243 lib/ext/alpn.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_ALPN,</span>
<span class='curline'><a href='../S/5424.html#L282'>session</a>           282 lib/ext/alpn.c gnutls_alpn_set_protocols(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5424.html#L292'>session</a>           292 lib/ext/alpn.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_ALPN,</span>
<span class='curline'><a href='../S/5424.html#L301'>session</a>           301 lib/ext/alpn.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5403.html#L61'>session</a>            61 lib/ext/cert_types.h static inline bool is_cert_type_enabled(gnutls_session_t session, gnutls_certificate_type_t cert_type)</span>
<span class='curline'><a href='../S/5403.html#L68'>session</a>            68 lib/ext/cert_types.h 			return session-&gt;internals.flags &amp; GNUTLS_ENABLE_RAWPK;</span>
<span class='curline'><a href='../S/5403.html#L78'>session</a>            78 lib/ext/cert_types.h static inline bool are_alternative_cert_types_allowed(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5403.html#L83'>session</a>            83 lib/ext/cert_types.h 	return session-&gt;internals.flags &amp; CERT_TYPES_FLAGS;</span>
<span class='curline'><a href='../S/5434.html#L40'>session</a>            40 lib/ext/client_cert_type.c static int _gnutls_client_cert_type_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5434.html#L43'>session</a>            43 lib/ext/client_cert_type.c static int _gnutls_client_cert_type_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5434.html#L67'>session</a>            67 lib/ext/client_cert_type.c static int _gnutls_client_cert_type_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5434.html#L81'>session</a>            81 lib/ext/client_cert_type.c 	if (!are_alternative_cert_types_allowed(session) ||</span>
<span class='curline'><a href='../S/5434.html#L82'>session</a>            82 lib/ext/client_cert_type.c 		(_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE) == NULL))</span>
<span class='curline'><a href='../S/5434.html#L85'>session</a>            85 lib/ext/client_cert_type.c 	if (!IS_SERVER(session)) {	// client mode</span>
<span class='curline'><a href='../S/5434.html#L110'>session</a>           110 lib/ext/client_cert_type.c 		ret = _gnutls_hello_ext_get_datum(session,</span>
<span class='curline'><a href='../S/5434.html#L128'>session</a>           128 lib/ext/client_cert_type.c 			_gnutls_session_client_cert_type_set(session, cert_type);</span>
<span class='curline'><a href='../S/5434.html#L151'>session</a>           151 lib/ext/client_cert_type.c 		_gnutls_hello_ext_set_datum(session,</span>
<span class='curline'><a href='../S/5434.html#L171'>session</a>           171 lib/ext/client_cert_type.c 					(session, cert_type, false, GNUTLS_CTYPE_CLIENT) == 0) {</span>
<span class='curline'><a href='../S/5434.html#L179'>session</a>           179 lib/ext/client_cert_type.c 			_gnutls_session_client_cert_type_set(session, cert_type);</span>
<span class='curline'><a href='../S/5434.html#L188'>session</a>           188 lib/ext/client_cert_type.c 					 "Aborting connection.\n", session);</span>
<span class='curline'><a href='../S/5434.html#L196'>session</a>           196 lib/ext/client_cert_type.c static int _gnutls_client_cert_type_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5434.html#L205'>session</a>           205 lib/ext/client_cert_type.c 	const version_entry_st* vers = get_version(session);</span>
<span class='curline'><a href='../S/5434.html#L209'>session</a>           209 lib/ext/client_cert_type.c 	if (!are_alternative_cert_types_allowed(session) ||</span>
<span class='curline'><a href='../S/5434.html#L210'>session</a>           210 lib/ext/client_cert_type.c 		(_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE) == NULL))</span>
<span class='curline'><a href='../S/5434.html#L213'>session</a>           213 lib/ext/client_cert_type.c 	if (!IS_SERVER(session)) {	// Client mode</span>
<span class='curline'><a href='../S/5434.html#L216'>session</a>           216 lib/ext/client_cert_type.c 				&amp;session-&gt;internals.priorities-&gt;client_ctype;</span>
<span class='curline'><a href='../S/5434.html#L235'>session</a>           235 lib/ext/client_cert_type.c 						 session,</span>
<span class='curline'><a href='../S/5434.html#L248'>session</a>           248 lib/ext/client_cert_type.c 						(session, cert_priorities-&gt;priorities[i],</span>
<span class='curline'><a href='../S/5434.html#L271'>session</a>           271 lib/ext/client_cert_type.c 							 session,</span>
<span class='curline'><a href='../S/5434.html#L287'>session</a>           287 lib/ext/client_cert_type.c 						 session);</span>
<span class='curline'><a href='../S/5434.html#L295'>session</a>           295 lib/ext/client_cert_type.c 						 session,</span>
<span class='curline'><a href='../S/5434.html#L308'>session</a>           308 lib/ext/client_cert_type.c 			_gnutls_hello_ext_set_datum(session,</span>
<span class='curline'><a href='../S/5434.html#L341'>session</a>           341 lib/ext/client_cert_type.c 		if (session-&gt;internals.send_cert_req != 0 ||</span>
<span class='curline'><a href='../S/5434.html#L352'>session</a>           352 lib/ext/client_cert_type.c 						session, GNUTLS_CTYPE_CLIENT));</span>
<span class='curline'><a href='../S/5422.html#L32'>session</a>            32 lib/ext/cookie.c static int cookie_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5422.html#L35'>session</a>            35 lib/ext/cookie.c static int cookie_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5422.html#L56'>session</a>            56 lib/ext/cookie.c cookie_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5422.html#L63'>session</a>            63 lib/ext/cookie.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5422.html#L67'>session</a>            67 lib/ext/cookie.c 		if (_gnutls_ext_get_msg(session) == GNUTLS_EXT_FLAG_HRR) {</span>
<span class='curline'><a href='../S/5422.html#L81'>session</a>            81 lib/ext/cookie.c 			ret = _gnutls_hello_ext_set_datum(session, GNUTLS_EXTENSION_COOKIE, &amp;tmp);</span>
<span class='curline'><a href='../S/5422.html#L97'>session</a>            97 lib/ext/cookie.c cookie_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5422.html#L104'>session</a>           104 lib/ext/cookie.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5422.html#L105'>session</a>           105 lib/ext/cookie.c 		ret = _gnutls_hello_ext_get_datum(session, GNUTLS_EXTENSION_COOKIE, &amp;tmp);</span>
<span class='curline'><a href='../S/5420.html#L36'>session</a>            36 lib/ext/dumbfw.c static int _gnutls_dumbfw_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5420.html#L55'>session</a>            55 lib/ext/dumbfw.c _gnutls_dumbfw_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5420.html#L63'>session</a>            63 lib/ext/dumbfw.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER ||</span>
<span class='curline'><a href='../S/5420.html#L64'>session</a>            64 lib/ext/dumbfw.c 	    session-&gt;internals.dumbfw == 0 ||</span>
<span class='curline'><a href='../S/5420.html#L65'>session</a>            65 lib/ext/dumbfw.c 	    IS_DTLS(session) != 0 ||</span>
<span class='curline'><a href='../S/5397.html#L32'>session</a>            32 lib/ext/early_data.c static int early_data_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5397.html#L35'>session</a>            35 lib/ext/early_data.c static int early_data_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5397.html#L54'>session</a>            54 lib/ext/early_data.c early_data_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5397.html#L57'>session</a>            57 lib/ext/early_data.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5397.html#L62'>session</a>            62 lib/ext/early_data.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5397.html#L65'>session</a>            65 lib/ext/early_data.c 		if ((session-&gt;internals.flags &amp; GNUTLS_ENABLE_EARLY_DATA) &amp;&amp;</span>
<span class='curline'><a href='../S/5397.html#L67'>session</a>            67 lib/ext/early_data.c 		    !(session-&gt;internals.hsk_flags &amp; HSK_HRR_SENT))</span>
<span class='curline'><a href='../S/5397.html#L68'>session</a>            68 lib/ext/early_data.c 			session-&gt;internals.hsk_flags |= HSK_EARLY_DATA_ACCEPTED;</span>
<span class='curline'><a href='../S/5397.html#L70'>session</a>            70 lib/ext/early_data.c 		session-&gt;internals.hsk_flags |= HSK_EARLY_DATA_IN_FLIGHT;</span>
<span class='curline'><a href='../S/5397.html#L72'>session</a>            72 lib/ext/early_data.c 		if (_gnutls_ext_get_msg(session) == GNUTLS_EXT_FLAG_EE)</span>
<span class='curline'><a href='../S/5397.html#L73'>session</a>            73 lib/ext/early_data.c 			session-&gt;internals.hsk_flags |= HSK_EARLY_DATA_ACCEPTED;</span>
<span class='curline'><a href='../S/5397.html#L82'>session</a>            82 lib/ext/early_data.c early_data_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5397.html#L85'>session</a>            85 lib/ext/early_data.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5397.html#L86'>session</a>            86 lib/ext/early_data.c 		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_ACCEPTED)</span>
<span class='curline'><a href='../S/5397.html#L89'>session</a>            89 lib/ext/early_data.c 		if (session-&gt;internals.early_data_presend_buffer.length &gt; 0) {</span>
<span class='curline'><a href='../S/5397.html#L90'>session</a>            90 lib/ext/early_data.c 			session-&gt;internals.hsk_flags |= HSK_EARLY_DATA_IN_FLIGHT;</span>
<span class='curline'><a href='../S/5397.html#L112'>session</a>           112 lib/ext/early_data.c gnutls_record_get_max_early_data_size(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5397.html#L114'>session</a>           114 lib/ext/early_data.c 	return session-&gt;security_parameters.max_early_data_size;</span>
<span class='curline'><a href='../S/5397.html#L133'>session</a>           133 lib/ext/early_data.c gnutls_record_set_max_early_data_size(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5397.html#L136'>session</a>           136 lib/ext/early_data.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5397.html#L143'>session</a>           143 lib/ext/early_data.c 	session-&gt;security_parameters.max_early_data_size = (uint32_t) size;</span>
<span class='curline'><a href='../S/5446.html#L33'>session</a>            33 lib/ext/ec_point_formats.c static int _gnutls_supported_ec_point_formats_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5446.html#L36'>session</a>            36 lib/ext/ec_point_formats.c static int _gnutls_supported_ec_point_formats_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5446.html#L59'>session</a>            59 lib/ext/ec_point_formats.c _gnutls_supported_ec_point_formats_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5446.html#L66'>session</a>            66 lib/ext/ec_point_formats.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5446.html#L106'>session</a>           106 lib/ext/ec_point_formats.c _gnutls_supported_ec_point_formats_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5446.html#L112'>session</a>           112 lib/ext/ec_point_formats.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER</span>
<span class='curline'><a href='../S/5446.html#L113'>session</a>           113 lib/ext/ec_point_formats.c 	    &amp;&amp; !_gnutls_session_is_ecc(session))</span>
<span class='curline'><a href='../S/5446.html#L116'>session</a>           116 lib/ext/ec_point_formats.c 	if (session-&gt;internals.priorities-&gt;groups.size &gt; 0) {</span>
<span class='curline'><a href='../S/5440.html#L32'>session</a>            32 lib/ext/etm.c  static int _gnutls_ext_etm_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5440.html#L35'>session</a>            35 lib/ext/etm.c  static int _gnutls_ext_etm_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5440.html#L60'>session</a>            60 lib/ext/etm.c  _gnutls_ext_etm_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5440.html#L69'>session</a>            69 lib/ext/etm.c  	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5440.html#L72'>session</a>            72 lib/ext/etm.c  		if (session-&gt;internals.no_etm != 0)</span>
<span class='curline'><a href='../S/5440.html#L76'>session</a>            76 lib/ext/etm.c  		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5440.html#L84'>session</a>            84 lib/ext/etm.c  			session-&gt;security_parameters.cs;</span>
<span class='curline'><a href='../S/5440.html#L91'>session</a>            91 lib/ext/etm.c  			session-&gt;security_parameters.etm = 1;</span>
<span class='curline'><a href='../S/5440.html#L101'>session</a>           101 lib/ext/etm.c  _gnutls_ext_etm_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5440.html#L104'>session</a>           104 lib/ext/etm.c  	if (session-&gt;internals.no_etm != 0)</span>
<span class='curline'><a href='../S/5440.html#L108'>session</a>           108 lib/ext/etm.c  	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5440.html#L109'>session</a>           109 lib/ext/etm.c  		if (session-&gt;internals.priorities-&gt;have_cbc != 0)</span>
<span class='curline'><a href='../S/5440.html#L119'>session</a>           119 lib/ext/etm.c  		e = session-&gt;security_parameters.cs;</span>
<span class='curline'><a href='../S/5440.html#L125'>session</a>           125 lib/ext/etm.c  			ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5440.html#L131'>session</a>           131 lib/ext/etm.c  			session-&gt;security_parameters.etm = 1;</span>
<span class='curline'><a href='../S/5440.html#L148'>session</a>           148 lib/ext/etm.c  unsigned gnutls_session_etm_status(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5440.html#L150'>session</a>           150 lib/ext/etm.c  	return session-&gt;security_parameters.etm;</span>
<span class='curline'><a href='../S/5423.html#L32'>session</a>            32 lib/ext/ext_master_secret.c static int _gnutls_ext_master_secret_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5423.html#L35'>session</a>            35 lib/ext/ext_master_secret.c static int _gnutls_ext_master_secret_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5423.html#L55'>session</a>            55 lib/ext/ext_master_secret.c static inline unsigned have_only_ssl3_enabled(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5423.html#L57'>session</a>            57 lib/ext/ext_master_secret.c 	if (session-&gt;internals.priorities-&gt;protocol.num_priorities == 1 &amp;&amp;</span>
<span class='curline'><a href='../S/5423.html#L58'>session</a>            58 lib/ext/ext_master_secret.c 	    session-&gt;internals.priorities-&gt;protocol.priorities[0] == GNUTLS_SSL3)</span>
<span class='curline'><a href='../S/5423.html#L70'>session</a>            70 lib/ext/ext_master_secret.c _gnutls_ext_master_secret_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5423.html#L75'>session</a>            75 lib/ext/ext_master_secret.c 	if ((session-&gt;internals.flags &amp; GNUTLS_NO_EXTENSIONS) ||</span>
<span class='curline'><a href='../S/5423.html#L76'>session</a>            76 lib/ext/ext_master_secret.c 	    session-&gt;internals.priorities-&gt;no_extensions ||</span>
<span class='curline'><a href='../S/5423.html#L77'>session</a>            77 lib/ext/ext_master_secret.c 	    session-&gt;internals.no_ext_master_secret != 0) {</span>
<span class='curline'><a href='../S/5423.html#L86'>session</a>            86 lib/ext/ext_master_secret.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5423.html#L87'>session</a>            87 lib/ext/ext_master_secret.c 		const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5423.html#L93'>session</a>            93 lib/ext/ext_master_secret.c 			session-&gt;security_parameters.ext_master_secret = 1;</span>
<span class='curline'><a href='../S/5423.html#L95'>session</a>            95 lib/ext/ext_master_secret.c 	} else if (!have_only_ssl3_enabled(session))</span>
<span class='curline'><a href='../S/5423.html#L97'>session</a>            97 lib/ext/ext_master_secret.c 		session-&gt;security_parameters.ext_master_secret = 1;</span>
<span class='curline'><a href='../S/5423.html#L105'>session</a>           105 lib/ext/ext_master_secret.c _gnutls_ext_master_secret_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5423.html#L108'>session</a>           108 lib/ext/ext_master_secret.c 	if ((session-&gt;internals.flags &amp; GNUTLS_NO_EXTENSIONS) ||</span>
<span class='curline'><a href='../S/5423.html#L109'>session</a>           109 lib/ext/ext_master_secret.c 	    session-&gt;internals.priorities-&gt;no_extensions != 0 ||</span>
<span class='curline'><a href='../S/5423.html#L110'>session</a>           110 lib/ext/ext_master_secret.c 	    session-&gt;internals.no_ext_master_secret != 0) {</span>
<span class='curline'><a href='../S/5423.html#L111'>session</a>           111 lib/ext/ext_master_secret.c 	    session-&gt;security_parameters.ext_master_secret = 0;</span>
<span class='curline'><a href='../S/5423.html#L117'>session</a>           117 lib/ext/ext_master_secret.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5423.html#L118'>session</a>           118 lib/ext/ext_master_secret.c 		if (have_only_ssl3_enabled(session))</span>
<span class='curline'><a href='../S/5423.html#L123'>session</a>           123 lib/ext/ext_master_secret.c 		const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5423.html#L127'>session</a>           127 lib/ext/ext_master_secret.c 		if (ver-&gt;id != GNUTLS_SSL3 &amp;&amp; session-&gt;security_parameters.ext_master_secret != 0)</span>
<span class='curline'><a href='../S/5423.html#L134'>session</a>           134 lib/ext/ext_master_secret.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT ||</span>
<span class='curline'><a href='../S/5423.html#L135'>session</a>           135 lib/ext/ext_master_secret.c 	    session-&gt;security_parameters.ext_master_secret != 0)</span>
<span class='curline'><a href='../S/5423.html#L151'>session</a>           151 lib/ext/ext_master_secret.c unsigned gnutls_session_ext_master_secret_status(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5423.html#L153'>session</a>           153 lib/ext/ext_master_secret.c 	return session-&gt;security_parameters.ext_master_secret;</span>
<span class='curline'><a href='../S/5411.html#L54'>session</a>            54 lib/ext/heartbeat.c void gnutls_heartbeat_enable(gnutls_session_t session, unsigned int type)</span>
<span class='curline'><a href='../S/5411.html#L59'>session</a>            59 lib/ext/heartbeat.c 	_gnutls_hello_ext_set_priv(session, GNUTLS_EXTENSION_HEARTBEAT,</span>
<span class='curline'><a href='../S/5411.html#L75'>session</a>            75 lib/ext/heartbeat.c unsigned gnutls_heartbeat_allowed(gnutls_session_t session, unsigned int type)</span>
<span class='curline'><a href='../S/5411.html#L79'>session</a>            79 lib/ext/heartbeat.c 	if (session-&gt;internals.handshake_in_progress != 0)</span>
<span class='curline'><a href='../S/5411.html#L83'>session</a>            83 lib/ext/heartbeat.c 	    (session, GNUTLS_EXTENSION_HEARTBEAT, &amp;epriv) &lt; 0)</span>
<span class='curline'><a href='../S/5411.html#L101'>session</a>           101 lib/ext/heartbeat.c heartbeat_send_data(gnutls_session_t session, const void *data,</span>
<span class='curline'><a href='../S/5411.html#L130'>session</a>           130 lib/ext/heartbeat.c 	    _gnutls_send_int(session, GNUTLS_HEARTBEAT, -1,</span>
<span class='curline'><a href='../S/5411.html#L161'>session</a>           161 lib/ext/heartbeat.c gnutls_heartbeat_ping(gnutls_session_t session, size_t data_size,</span>
<span class='curline'><a href='../S/5411.html#L173'>session</a>           173 lib/ext/heartbeat.c 	    (session, GNUTLS_HB_LOCAL_ALLOWED_TO_SEND) == 0)</span>
<span class='curline'><a href='../S/5411.html#L177'>session</a>           177 lib/ext/heartbeat.c 	if (session-&gt;internals.record_send_buffer.byte_length &gt; 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5411.html#L178'>session</a>           178 lib/ext/heartbeat.c 	    session-&gt;internals.record_send_buffer.head != NULL &amp;&amp;</span>
<span class='curline'><a href='../S/5411.html#L179'>session</a>           179 lib/ext/heartbeat.c 	    session-&gt;internals.record_send_buffer.head-&gt;type ==</span>
<span class='curline'><a href='../S/5411.html#L181'>session</a>           181 lib/ext/heartbeat.c 		return _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/5411.html#L183'>session</a>           183 lib/ext/heartbeat.c 	switch (session-&gt;internals.hb_state) {</span>
<span class='curline'><a href='../S/5411.html#L190'>session</a>           190 lib/ext/heartbeat.c 		_gnutls_buffer_reset(&amp;session-&gt;internals.hb_local_data);</span>
<span class='curline'><a href='../S/5411.html#L193'>session</a>           193 lib/ext/heartbeat.c 		    _gnutls_buffer_resize(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5411.html#L200'>session</a>           200 lib/ext/heartbeat.c 				session-&gt;internals.hb_local_data.data,</span>
<span class='curline'><a href='../S/5411.html#L205'>session</a>           205 lib/ext/heartbeat.c 		gnutls_gettime(&amp;session-&gt;internals.hb_ping_start);</span>
<span class='curline'><a href='../S/5411.html#L206'>session</a>           206 lib/ext/heartbeat.c 		session-&gt;internals.hb_local_data.length = data_size;</span>
<span class='curline'><a href='../S/5411.html#L207'>session</a>           207 lib/ext/heartbeat.c 		session-&gt;internals.hb_state = SHB_SEND2;</span>
<span class='curline'><a href='../S/5411.html#L211'>session</a>           211 lib/ext/heartbeat.c 		session-&gt;internals.hb_actual_retrans_timeout_ms =</span>
<span class='curline'><a href='../S/5411.html#L212'>session</a>           212 lib/ext/heartbeat.c 		    session-&gt;internals.hb_retrans_timeout_ms;</span>
<span class='curline'><a href='../S/5411.html#L215'>session</a>           215 lib/ext/heartbeat.c 		    heartbeat_send_data(session,</span>
<span class='curline'><a href='../S/5411.html#L216'>session</a>           216 lib/ext/heartbeat.c 					session-&gt;internals.hb_local_data.</span>
<span class='curline'><a href='../S/5411.html#L218'>session</a>           218 lib/ext/heartbeat.c 					session-&gt;internals.hb_local_data.</span>
<span class='curline'><a href='../S/5411.html#L223'>session</a>           223 lib/ext/heartbeat.c 		gnutls_gettime(&amp;session-&gt;internals.hb_ping_sent);</span>
<span class='curline'><a href='../S/5411.html#L226'>session</a>           226 lib/ext/heartbeat.c 			session-&gt;internals.hb_state = SHB_SEND1;</span>
<span class='curline'><a href='../S/5411.html#L230'>session</a>           230 lib/ext/heartbeat.c 		session-&gt;internals.hb_state = SHB_RECV;</span>
<span class='curline'><a href='../S/5411.html#L235'>session</a>           235 lib/ext/heartbeat.c 		    _gnutls_recv_int(session, GNUTLS_HEARTBEAT,</span>
<span class='curline'><a href='../S/5411.html#L237'>session</a>           237 lib/ext/heartbeat.c 				     session-&gt;internals.</span>
<span class='curline'><a href='../S/5411.html#L240'>session</a>           240 lib/ext/heartbeat.c 			session-&gt;internals.hb_state = SHB_SEND1;</span>
<span class='curline'><a href='../S/5411.html#L245'>session</a>           245 lib/ext/heartbeat.c 				session-&gt;internals.hb_state = SHB_SEND1;</span>
<span class='curline'><a href='../S/5411.html#L252'>session</a>           252 lib/ext/heartbeat.c 					    &amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5411.html#L254'>session</a>           254 lib/ext/heartbeat.c 			if (diff &gt; session-&gt;internals.hb_total_timeout_ms) {</span>
<span class='curline'><a href='../S/5411.html#L255'>session</a>           255 lib/ext/heartbeat.c 				session-&gt;internals.hb_state = SHB_SEND1;</span>
<span class='curline'><a href='../S/5411.html#L260'>session</a>           260 lib/ext/heartbeat.c 			session-&gt;internals.hb_actual_retrans_timeout_ms *=</span>
<span class='curline'><a href='../S/5411.html#L262'>session</a>           262 lib/ext/heartbeat.c 			session-&gt;internals.hb_actual_retrans_timeout_ms %=</span>
<span class='curline'><a href='../S/5411.html#L265'>session</a>           265 lib/ext/heartbeat.c 			session-&gt;internals.hb_state = SHB_SEND2;</span>
<span class='curline'><a href='../S/5411.html#L268'>session</a>           268 lib/ext/heartbeat.c 			session-&gt;internals.hb_state = SHB_SEND1;</span>
<span class='curline'><a href='../S/5411.html#L287'>session</a>           287 lib/ext/heartbeat.c int gnutls_heartbeat_pong(gnutls_session_t session, unsigned int flags)</span>
<span class='curline'><a href='../S/5411.html#L291'>session</a>           291 lib/ext/heartbeat.c 	if (session-&gt;internals.record_send_buffer.byte_length &gt; 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5411.html#L292'>session</a>           292 lib/ext/heartbeat.c 	    session-&gt;internals.record_send_buffer.head != NULL &amp;&amp;</span>
<span class='curline'><a href='../S/5411.html#L293'>session</a>           293 lib/ext/heartbeat.c 	    session-&gt;internals.record_send_buffer.head-&gt;type ==</span>
<span class='curline'><a href='../S/5411.html#L295'>session</a>           295 lib/ext/heartbeat.c 		return _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/5411.html#L297'>session</a>           297 lib/ext/heartbeat.c 	if (session-&gt;internals.hb_remote_data.length == 0)</span>
<span class='curline'><a href='../S/5411.html#L301'>session</a>           301 lib/ext/heartbeat.c 	    heartbeat_send_data(session,</span>
<span class='curline'><a href='../S/5411.html#L302'>session</a>           302 lib/ext/heartbeat.c 				session-&gt;internals.hb_remote_data.data,</span>
<span class='curline'><a href='../S/5411.html#L303'>session</a>           303 lib/ext/heartbeat.c 				session-&gt;internals.hb_remote_data.length,</span>
<span class='curline'><a href='../S/5411.html#L306'>session</a>           306 lib/ext/heartbeat.c 	_gnutls_buffer_reset(&amp;session-&gt;internals.hb_remote_data);</span>
<span class='curline'><a href='../S/5411.html#L317'>session</a>           317 lib/ext/heartbeat.c int _gnutls_heartbeat_handle(gnutls_session_t session, mbuffer_st * bufel)</span>
<span class='curline'><a href='../S/5411.html#L326'>session</a>           326 lib/ext/heartbeat.c 	    (session, GNUTLS_HB_PEER_ALLOWED_TO_SEND) == 0)</span>
<span class='curline'><a href='../S/5411.html#L345'>session</a>           345 lib/ext/heartbeat.c 		_gnutls_buffer_reset(&amp;session-&gt;internals.hb_remote_data);</span>
<span class='curline'><a href='../S/5411.html#L348'>session</a>           348 lib/ext/heartbeat.c 		    _gnutls_buffer_resize(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5411.html#L354'>session</a>           354 lib/ext/heartbeat.c 			memcpy(session-&gt;internals.hb_remote_data.data,</span>
<span class='curline'><a href='../S/5411.html#L356'>session</a>           356 lib/ext/heartbeat.c 		session-&gt;internals.hb_remote_data.length = hb_len;</span>
<span class='curline'><a href='../S/5411.html#L362'>session</a>           362 lib/ext/heartbeat.c 		if (hb_len != session-&gt;internals.hb_local_data.length)</span>
<span class='curline'><a href='../S/5411.html#L368'>session</a>           368 lib/ext/heartbeat.c 			   session-&gt;internals.hb_local_data.data,</span>
<span class='curline'><a href='../S/5411.html#L370'>session</a>           370 lib/ext/heartbeat.c 			if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5411.html#L378'>session</a>           378 lib/ext/heartbeat.c 		_gnutls_buffer_reset(&amp;session-&gt;internals.hb_local_data);</span>
<span class='curline'><a href='../S/5411.html#L383'>session</a>           383 lib/ext/heartbeat.c 		    ("REC[%p]: HB: received unknown type %u\n", session,</span>
<span class='curline'><a href='../S/5411.html#L403'>session</a>           403 lib/ext/heartbeat.c unsigned int gnutls_heartbeat_get_timeout(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5411.html#L409'>session</a>           409 lib/ext/heartbeat.c 	diff = timespec_sub_ms(&amp;now, &amp;session-&gt;internals.hb_ping_sent);</span>
<span class='curline'><a href='../S/5411.html#L410'>session</a>           410 lib/ext/heartbeat.c 	if (diff &gt;= session-&gt;internals.hb_actual_retrans_timeout_ms)</span>
<span class='curline'><a href='../S/5411.html#L413'>session</a>           413 lib/ext/heartbeat.c 		return session-&gt;internals.hb_actual_retrans_timeout_ms -</span>
<span class='curline'><a href='../S/5411.html#L431'>session</a>           431 lib/ext/heartbeat.c void gnutls_heartbeat_set_timeouts(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5411.html#L435'>session</a>           435 lib/ext/heartbeat.c 	session-&gt;internals.hb_retrans_timeout_ms = retrans_timeout;</span>
<span class='curline'><a href='../S/5411.html#L436'>session</a>           436 lib/ext/heartbeat.c 	session-&gt;internals.hb_total_timeout_ms = total_timeout;</span>
<span class='curline'><a href='../S/5411.html#L441'>session</a>           441 lib/ext/heartbeat.c _gnutls_heartbeat_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5411.html#L448'>session</a>           448 lib/ext/heartbeat.c 	    (session, GNUTLS_EXTENSION_HEARTBEAT, &amp;epriv) &lt; 0) {</span>
<span class='curline'><a href='../S/5411.html#L449'>session</a>           449 lib/ext/heartbeat.c 		if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5411.html#L470'>session</a>           470 lib/ext/heartbeat.c 	_gnutls_hello_ext_set_priv(session, GNUTLS_EXTENSION_HEARTBEAT,</span>
<span class='curline'><a href='../S/5411.html#L477'>session</a>           477 lib/ext/heartbeat.c _gnutls_heartbeat_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5411.html#L484'>session</a>           484 lib/ext/heartbeat.c 	    (session, GNUTLS_EXTENSION_HEARTBEAT, &amp;epriv) &lt; 0)</span>
<span class='curline'><a href='../S/5411.html#L542'>session</a>           542 lib/ext/heartbeat.c void gnutls_heartbeat_enable(gnutls_session_t session, unsigned int type)</span>
<span class='curline'><a href='../S/5411.html#L546'>session</a>           546 lib/ext/heartbeat.c unsigned gnutls_heartbeat_allowed(gnutls_session_t session, unsigned int type)</span>
<span class='curline'><a href='../S/5411.html#L552'>session</a>           552 lib/ext/heartbeat.c gnutls_heartbeat_ping(gnutls_session_t session, size_t data_size,</span>
<span class='curline'><a href='../S/5411.html#L558'>session</a>           558 lib/ext/heartbeat.c int gnutls_heartbeat_pong(gnutls_session_t session, unsigned int flags)</span>
<span class='curline'><a href='../S/5411.html#L563'>session</a>           563 lib/ext/heartbeat.c unsigned int gnutls_heartbeat_get_timeout(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5411.html#L568'>session</a>           568 lib/ext/heartbeat.c void gnutls_heartbeat_set_timeouts(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5437.html#L41'>session</a>            41 lib/ext/heartbeat.h int _gnutls_heartbeat_handle(gnutls_session_t session, mbuffer_st * bufel);</span>
<span class='curline'><a href='../S/5437.html#L42'>session</a>            42 lib/ext/heartbeat.h int _gnutls_heartbeat_enabled(gnutls_session_t session, int local);</span>
<span class='curline'><a href='../S/5413.html#L40'>session</a>            40 lib/ext/key_share.c static int key_share_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5413.html#L43'>session</a>            43 lib/ext/key_share.c static int key_share_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5413.html#L72'>session</a>            72 lib/ext/key_share.c static int client_gen_key_share(gnutls_session_t session, const gnutls_group_entry_st *group, gnutls_buffer_st *extdata)</span>
<span class='curline'><a href='../S/5413.html#L84'>session</a>            84 lib/ext/key_share.c 	_gnutls_handshake_log("EXT[%p]: sending key share for %s\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L92'>session</a>            92 lib/ext/key_share.c 		gnutls_pk_params_release(&amp;session-&gt;key.kshare.ecdh_params);</span>
<span class='curline'><a href='../S/5413.html#L93'>session</a>            93 lib/ext/key_share.c 		gnutls_pk_params_init(&amp;session-&gt;key.kshare.ecdh_params);</span>
<span class='curline'><a href='../S/5413.html#L96'>session</a>            96 lib/ext/key_share.c 						&amp;session-&gt;key.kshare.ecdh_params, 1);</span>
<span class='curline'><a href='../S/5413.html#L101'>session</a>           101 lib/ext/key_share.c 				session-&gt;key.kshare.ecdh_params.params[ECC_X],</span>
<span class='curline'><a href='../S/5413.html#L102'>session</a>           102 lib/ext/key_share.c 				session-&gt;key.kshare.ecdh_params.params[ECC_Y],</span>
<span class='curline'><a href='../S/5413.html#L114'>session</a>           114 lib/ext/key_share.c 		session-&gt;key.kshare.ecdh_params.algo = group-&gt;pk;</span>
<span class='curline'><a href='../S/5413.html#L115'>session</a>           115 lib/ext/key_share.c 		session-&gt;key.kshare.ecdh_params.curve = group-&gt;curve;</span>
<span class='curline'><a href='../S/5413.html#L121'>session</a>           121 lib/ext/key_share.c 		gnutls_pk_params_release(&amp;session-&gt;key.kshare.ecdhx_params);</span>
<span class='curline'><a href='../S/5413.html#L122'>session</a>           122 lib/ext/key_share.c 		gnutls_pk_params_init(&amp;session-&gt;key.kshare.ecdhx_params);</span>
<span class='curline'><a href='../S/5413.html#L125'>session</a>           125 lib/ext/key_share.c 						&amp;session-&gt;key.kshare.ecdhx_params, 1);</span>
<span class='curline'><a href='../S/5413.html#L131'>session</a>           131 lib/ext/key_share.c 				session-&gt;key.kshare.ecdhx_params.raw_pub.data,</span>
<span class='curline'><a href='../S/5413.html#L132'>session</a>           132 lib/ext/key_share.c 				session-&gt;key.kshare.ecdhx_params.raw_pub.size);</span>
<span class='curline'><a href='../S/5413.html#L138'>session</a>           138 lib/ext/key_share.c 		session-&gt;key.kshare.ecdhx_params.algo = group-&gt;pk;</span>
<span class='curline'><a href='../S/5413.html#L139'>session</a>           139 lib/ext/key_share.c 		session-&gt;key.kshare.ecdhx_params.curve = group-&gt;curve;</span>
<span class='curline'><a href='../S/5413.html#L145'>session</a>           145 lib/ext/key_share.c 		gnutls_pk_params_release(&amp;session-&gt;key.kshare.dh_params);</span>
<span class='curline'><a href='../S/5413.html#L146'>session</a>           146 lib/ext/key_share.c 		gnutls_pk_params_init(&amp;session-&gt;key.kshare.dh_params);</span>
<span class='curline'><a href='../S/5413.html#L148'>session</a>           148 lib/ext/key_share.c 		ret = _gnutls_mpi_init_scan_nz(&amp;session-&gt;key.kshare.dh_params.params[DH_G],</span>
<span class='curline'><a href='../S/5413.html#L153'>session</a>           153 lib/ext/key_share.c 		ret = _gnutls_mpi_init_scan_nz(&amp;session-&gt;key.kshare.dh_params.params[DH_P],</span>
<span class='curline'><a href='../S/5413.html#L158'>session</a>           158 lib/ext/key_share.c 		ret = _gnutls_mpi_init_scan_nz(&amp;session-&gt;key.kshare.dh_params.params[DH_Q],</span>
<span class='curline'><a href='../S/5413.html#L163'>session</a>           163 lib/ext/key_share.c 		session-&gt;key.kshare.dh_params.algo = group-&gt;pk;</span>
<span class='curline'><a href='../S/5413.html#L164'>session</a>           164 lib/ext/key_share.c 		session-&gt;key.kshare.dh_params.dh_group = group-&gt;id; /* no curve in FFDH, we write the group */</span>
<span class='curline'><a href='../S/5413.html#L165'>session</a>           165 lib/ext/key_share.c 		session-&gt;key.kshare.dh_params.qbits = *group-&gt;q_bits;</span>
<span class='curline'><a href='../S/5413.html#L166'>session</a>           166 lib/ext/key_share.c 		session-&gt;key.kshare.dh_params.params_nr = 3;</span>
<span class='curline'><a href='../S/5413.html#L168'>session</a>           168 lib/ext/key_share.c 		ret = _gnutls_pk_generate_keys(group-&gt;pk, 0, &amp;session-&gt;key.kshare.dh_params, 1);</span>
<span class='curline'><a href='../S/5413.html#L177'>session</a>           177 lib/ext/key_share.c 		ret = _gnutls_buffer_append_fixed_mpi(extdata, session-&gt;key.kshare.dh_params.params[DH_Y],</span>
<span class='curline'><a href='../S/5413.html#L194'>session</a>           194 lib/ext/key_share.c static int server_gen_key_share(gnutls_session_t session, const gnutls_group_entry_st *group, gnutls_buffer_st *extdata)</span>
<span class='curline'><a href='../S/5413.html#L206'>session</a>           206 lib/ext/key_share.c 	_gnutls_handshake_log("EXT[%p]: sending key share for %s\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L215'>session</a>           215 lib/ext/key_share.c 				session-&gt;key.kshare.ecdh_params.params[ECC_X],</span>
<span class='curline'><a href='../S/5413.html#L216'>session</a>           216 lib/ext/key_share.c 				session-&gt;key.kshare.ecdh_params.params[ECC_Y],</span>
<span class='curline'><a href='../S/5413.html#L234'>session</a>           234 lib/ext/key_share.c 				session-&gt;key.kshare.ecdhx_params.raw_pub.data,</span>
<span class='curline'><a href='../S/5413.html#L235'>session</a>           235 lib/ext/key_share.c 				session-&gt;key.kshare.ecdhx_params.raw_pub.size);</span>
<span class='curline'><a href='../S/5413.html#L247'>session</a>           247 lib/ext/key_share.c 		ret = _gnutls_buffer_append_fixed_mpi(extdata, session-&gt;key.kshare.dh_params.params[DH_Y],</span>
<span class='curline'><a href='../S/5413.html#L263'>session</a>           263 lib/ext/key_share.c server_use_key_share(gnutls_session_t session, const gnutls_group_entry_st *group,</span>
<span class='curline'><a href='../S/5413.html#L272'>session</a>           272 lib/ext/key_share.c 		gnutls_pk_params_release(&amp;session-&gt;key.kshare.ecdh_params);</span>
<span class='curline'><a href='../S/5413.html#L273'>session</a>           273 lib/ext/key_share.c 		gnutls_pk_params_init(&amp;session-&gt;key.kshare.ecdh_params);</span>
<span class='curline'><a href='../S/5413.html#L283'>session</a>           283 lib/ext/key_share.c 		ret = _gnutls_pk_generate_keys(curve-&gt;pk, curve-&gt;id, &amp;session-&gt;key.kshare.ecdh_params, 1);</span>
<span class='curline'><a href='../S/5413.html#L299'>session</a>           299 lib/ext/key_share.c 		ret = _gnutls_pk_derive_tls13(curve-&gt;pk, &amp;session-&gt;key.key, &amp;session-&gt;key.kshare.ecdh_params, &amp;pub);</span>
<span class='curline'><a href='../S/5413.html#L311'>session</a>           311 lib/ext/key_share.c 		gnutls_pk_params_release(&amp;session-&gt;key.kshare.ecdhx_params);</span>
<span class='curline'><a href='../S/5413.html#L312'>session</a>           312 lib/ext/key_share.c 		gnutls_pk_params_init(&amp;session-&gt;key.kshare.ecdhx_params);</span>
<span class='curline'><a href='../S/5413.html#L320'>session</a>           320 lib/ext/key_share.c 		ret = _gnutls_pk_generate_keys(curve-&gt;pk, curve-&gt;id, &amp;session-&gt;key.kshare.ecdhx_params, 1);</span>
<span class='curline'><a href='../S/5413.html#L336'>session</a>           336 lib/ext/key_share.c 		ret = _gnutls_pk_derive_tls13(curve-&gt;pk, &amp;session-&gt;key.key, &amp;session-&gt;key.kshare.ecdhx_params, &amp;pub);</span>
<span class='curline'><a href='../S/5413.html#L347'>session</a>           347 lib/ext/key_share.c 		gnutls_pk_params_release(&amp;session-&gt;key.kshare.dh_params);</span>
<span class='curline'><a href='../S/5413.html#L348'>session</a>           348 lib/ext/key_share.c 		gnutls_pk_params_init(&amp;session-&gt;key.kshare.dh_params);</span>
<span class='curline'><a href='../S/5413.html#L354'>session</a>           354 lib/ext/key_share.c 		ret = _gnutls_mpi_init_scan_nz(&amp;session-&gt;key.kshare.dh_params.params[DH_G],</span>
<span class='curline'><a href='../S/5413.html#L359'>session</a>           359 lib/ext/key_share.c 		ret = _gnutls_mpi_init_scan_nz(&amp;session-&gt;key.kshare.dh_params.params[DH_P],</span>
<span class='curline'><a href='../S/5413.html#L364'>session</a>           364 lib/ext/key_share.c 		ret = _gnutls_mpi_init_scan_nz(&amp;session-&gt;key.kshare.dh_params.params[DH_Q],</span>
<span class='curline'><a href='../S/5413.html#L369'>session</a>           369 lib/ext/key_share.c 		session-&gt;key.kshare.dh_params.algo = GNUTLS_PK_DH;</span>
<span class='curline'><a href='../S/5413.html#L370'>session</a>           370 lib/ext/key_share.c 		session-&gt;key.kshare.dh_params.qbits = *group-&gt;q_bits;</span>
<span class='curline'><a href='../S/5413.html#L371'>session</a>           371 lib/ext/key_share.c 		session-&gt;key.kshare.dh_params.params_nr = 3;</span>
<span class='curline'><a href='../S/5413.html#L374'>session</a>           374 lib/ext/key_share.c 		ret = _gnutls_pk_generate_keys(group-&gt;pk, 0, &amp;session-&gt;key.kshare.dh_params, 1);</span>
<span class='curline'><a href='../S/5413.html#L389'>session</a>           389 lib/ext/key_share.c 		ret = _gnutls_pk_derive_tls13(GNUTLS_PK_DH, &amp;session-&gt;key.key, &amp;session-&gt;key.kshare.dh_params, &amp;pub);</span>
<span class='curline'><a href='../S/5413.html#L399'>session</a>           399 lib/ext/key_share.c 	_gnutls_debug_log("EXT[%p]: server generated %s shared key\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L407'>session</a>           407 lib/ext/key_share.c client_use_key_share(gnutls_session_t session, const gnutls_group_entry_st *group,</span>
<span class='curline'><a href='../S/5413.html#L420'>session</a>           420 lib/ext/key_share.c 		if (session-&gt;key.kshare.ecdh_params.algo != group-&gt;pk || session-&gt;key.kshare.ecdh_params.curve != curve-&gt;id)</span>
<span class='curline'><a href='../S/5413.html#L438'>session</a>           438 lib/ext/key_share.c 		ret = _gnutls_pk_derive_tls13(curve-&gt;pk, &amp;session-&gt;key.key, &amp;session-&gt;key.kshare.ecdh_params, &amp;pub);</span>
<span class='curline'><a href='../S/5413.html#L452'>session</a>           452 lib/ext/key_share.c 		if (session-&gt;key.kshare.ecdhx_params.algo != group-&gt;pk || session-&gt;key.kshare.ecdhx_params.curve != curve-&gt;id)</span>
<span class='curline'><a href='../S/5413.html#L470'>session</a>           470 lib/ext/key_share.c 		ret = _gnutls_pk_derive_tls13(curve-&gt;pk, &amp;session-&gt;key.key, &amp;session-&gt;key.kshare.ecdhx_params, &amp;pub);</span>
<span class='curline'><a href='../S/5413.html#L480'>session</a>           480 lib/ext/key_share.c 		if (session-&gt;key.kshare.dh_params.algo != group-&gt;pk || session-&gt;key.kshare.dh_params.dh_group != group-&gt;id)</span>
<span class='curline'><a href='../S/5413.html#L497'>session</a>           497 lib/ext/key_share.c 		ret = _gnutls_pk_derive_tls13(GNUTLS_PK_DH, &amp;session-&gt;key.key, &amp;session-&gt;key.kshare.dh_params, &amp;pub);</span>
<span class='curline'><a href='../S/5413.html#L507'>session</a>           507 lib/ext/key_share.c 	_gnutls_debug_log("EXT[%p]: client generated %s shared key\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L513'>session</a>           513 lib/ext/key_share.c key_share_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5413.html#L523'>session</a>           523 lib/ext/key_share.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5413.html#L524'>session</a>           524 lib/ext/key_share.c 		ver = get_version(session);</span>
<span class='curline'><a href='../S/5413.html#L536'>session</a>           536 lib/ext/key_share.c 		if ((session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED) &amp;&amp;</span>
<span class='curline'><a href='../S/5413.html#L537'>session</a>           537 lib/ext/key_share.c 		    (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_PSK)) {</span>
<span class='curline'><a href='../S/5413.html#L538'>session</a>           538 lib/ext/key_share.c 			reset_cand_groups(session);</span>
<span class='curline'><a href='../S/5413.html#L558'>session</a>           558 lib/ext/key_share.c 				_gnutls_handshake_log("EXT[%p]: Received key share for %s\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L560'>session</a>           560 lib/ext/key_share.c 			if (group != NULL &amp;&amp; group == session-&gt;internals.cand_group) {</span>
<span class='curline'><a href='../S/5413.html#L561'>session</a>           561 lib/ext/key_share.c 				_gnutls_session_group_set(session, group);</span>
<span class='curline'><a href='../S/5413.html#L563'>session</a>           563 lib/ext/key_share.c 				ret = server_use_key_share(session, group, data, size);</span>
<span class='curline'><a href='../S/5413.html#L594'>session</a>           594 lib/ext/key_share.c 		session-&gt;internals.hsk_flags |= HSK_KEY_SHARE_RECEIVED;</span>
<span class='curline'><a href='../S/5413.html#L596'>session</a>           596 lib/ext/key_share.c 		ver = get_version(session);</span>
<span class='curline'><a href='../S/5413.html#L600'>session</a>           600 lib/ext/key_share.c 		if (_gnutls_ext_get_msg(session) == GNUTLS_EXT_FLAG_HRR) {</span>
<span class='curline'><a href='../S/5413.html#L601'>session</a>           601 lib/ext/key_share.c 			if (unlikely(!(session-&gt;internals.hsk_flags &amp; HSK_HRR_RECEIVED)))</span>
<span class='curline'><a href='../S/5413.html#L611'>session</a>           611 lib/ext/key_share.c 			_gnutls_handshake_log("EXT[%p]: HRR key share with %s\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L614'>session</a>           614 lib/ext/key_share.c 			ret = _gnutls_session_supports_group(session, group-&gt;id);</span>
<span class='curline'><a href='../S/5413.html#L616'>session</a>           616 lib/ext/key_share.c 				_gnutls_handshake_log("EXT[%p]: received share for %s which is disabled\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L620'>session</a>           620 lib/ext/key_share.c 			_gnutls_session_group_set(session, group);</span>
<span class='curline'><a href='../S/5413.html#L642'>session</a>           642 lib/ext/key_share.c 		ret = _gnutls_session_supports_group(session, group-&gt;id);</span>
<span class='curline'><a href='../S/5413.html#L644'>session</a>           644 lib/ext/key_share.c 			_gnutls_handshake_log("EXT[%p]: received share for %s which is disabled\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L648'>session</a>           648 lib/ext/key_share.c 		_gnutls_session_group_set(session, group);</span>
<span class='curline'><a href='../S/5413.html#L649'>session</a>           649 lib/ext/key_share.c 		session-&gt;internals.hsk_flags |= HSK_KEY_SHARE_RECEIVED;</span>
<span class='curline'><a href='../S/5413.html#L651'>session</a>           651 lib/ext/key_share.c 		ret = client_use_key_share(session, group, data, size);</span>
<span class='curline'><a href='../S/5413.html#L662'>session</a>           662 lib/ext/key_share.c key_share_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5413.html#L674'>session</a>           674 lib/ext/key_share.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5413.html#L675'>session</a>           675 lib/ext/key_share.c 		ver = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5413.html#L679'>session</a>           679 lib/ext/key_share.c 		if (!have_creds_for_tls13(session))</span>
<span class='curline'><a href='../S/5413.html#L692'>session</a>           692 lib/ext/key_share.c 		if (session-&gt;internals.hsk_flags &amp; HSK_HRR_RECEIVED) { /* we know the group */</span>
<span class='curline'><a href='../S/5413.html#L693'>session</a>           693 lib/ext/key_share.c 			group = get_group(session);</span>
<span class='curline'><a href='../S/5413.html#L697'>session</a>           697 lib/ext/key_share.c 			ret = client_gen_key_share(session, group, extdata);</span>
<span class='curline'><a href='../S/5413.html#L706'>session</a>           706 lib/ext/key_share.c 			if (session-&gt;internals.flags &amp; GNUTLS_KEY_SHARE_TOP)</span>
<span class='curline'><a href='../S/5413.html#L708'>session</a>           708 lib/ext/key_share.c 			else if (session-&gt;internals.flags &amp; GNUTLS_KEY_SHARE_TOP3)</span>
<span class='curline'><a href='../S/5413.html#L715'>session</a>           715 lib/ext/key_share.c 			for (i = 0; i &lt; session-&gt;internals.priorities-&gt;groups.size; i++) {</span>
<span class='curline'><a href='../S/5413.html#L716'>session</a>           716 lib/ext/key_share.c 				group = session-&gt;internals.priorities-&gt;groups.entry[i];</span>
<span class='curline'><a href='../S/5413.html#L725'>session</a>           725 lib/ext/key_share.c 				ret = client_gen_key_share(session, group, extdata);</span>
<span class='curline'><a href='../S/5413.html#L742'>session</a>           742 lib/ext/key_share.c 		ver = get_version(session);</span>
<span class='curline'><a href='../S/5413.html#L746'>session</a>           746 lib/ext/key_share.c 		if (_gnutls_ext_get_msg(session) == GNUTLS_EXT_FLAG_HRR) {</span>
<span class='curline'><a href='../S/5413.html#L747'>session</a>           747 lib/ext/key_share.c 			group = session-&gt;internals.cand_group;</span>
<span class='curline'><a href='../S/5413.html#L752'>session</a>           752 lib/ext/key_share.c 			_gnutls_session_group_set(session, group);</span>
<span class='curline'><a href='../S/5413.html#L754'>session</a>           754 lib/ext/key_share.c 			_gnutls_handshake_log("EXT[%p]: requesting retry with group %s\n", session, group-&gt;name);</span>
<span class='curline'><a href='../S/5413.html#L761'>session</a>           761 lib/ext/key_share.c 			if ((session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED) &amp;&amp;</span>
<span class='curline'><a href='../S/5413.html#L762'>session</a>           762 lib/ext/key_share.c 			    (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_PSK))</span>
<span class='curline'><a href='../S/5413.html#L765'>session</a>           765 lib/ext/key_share.c 			group = get_group(session);</span>
<span class='curline'><a href='../S/5413.html#L769'>session</a>           769 lib/ext/key_share.c 			ret = server_gen_key_share(session, group, extdata);</span>
<span class='curline'><a href='../S/5413.html#L774'>session</a>           774 lib/ext/key_share.c 		session-&gt;internals.hsk_flags |= HSK_KEY_SHARE_SENT;</span>
<span class='curline'><a href='../S/5406.html#L32'>session</a>            32 lib/ext/max_record.c static int _gnutls_max_record_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5406.html#L35'>session</a>            35 lib/ext/max_record.c static int _gnutls_max_record_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5406.html#L68'>session</a>            68 lib/ext/max_record.c _gnutls_max_record_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5406.html#L73'>session</a>            73 lib/ext/max_record.c 	if (session-&gt;internals.hsk_flags &amp; HSK_RECORD_SIZE_LIMIT_NEGOTIATED)</span>
<span class='curline'><a href='../S/5406.html#L76'>session</a>            76 lib/ext/max_record.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5406.html#L87'>session</a>            87 lib/ext/max_record.c 			session-&gt;security_parameters.max_record_send_size =</span>
<span class='curline'><a href='../S/5406.html#L89'>session</a>            89 lib/ext/max_record.c 			session-&gt;security_parameters.max_record_recv_size =</span>
<span class='curline'><a href='../S/5406.html#L107'>session</a>           107 lib/ext/max_record.c 			if (new_size != session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5406.html#L112'>session</a>           112 lib/ext/max_record.c 				session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5406.html#L114'>session</a>           114 lib/ext/max_record.c 				session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5406.html#L129'>session</a>           129 lib/ext/max_record.c _gnutls_max_record_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5406.html#L136'>session</a>           136 lib/ext/max_record.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5406.html#L140'>session</a>           140 lib/ext/max_record.c 		if (session-&gt;security_parameters.max_user_record_send_size !=</span>
<span class='curline'><a href='../S/5406.html#L141'>session</a>           141 lib/ext/max_record.c 		    session-&gt;security_parameters.max_user_record_recv_size)</span>
<span class='curline'><a href='../S/5406.html#L144'>session</a>           144 lib/ext/max_record.c 		if (session-&gt;security_parameters.max_user_record_send_size !=</span>
<span class='curline'><a href='../S/5406.html#L147'>session</a>           147 lib/ext/max_record.c 			      (session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5406.html#L165'>session</a>           165 lib/ext/max_record.c 		if (session-&gt;internals.hsk_flags &amp; HSK_RECORD_SIZE_LIMIT_SENT)</span>
<span class='curline'><a href='../S/5406.html#L168'>session</a>           168 lib/ext/max_record.c 		if (session-&gt;security_parameters.max_record_recv_size !=</span>
<span class='curline'><a href='../S/5406.html#L171'>session</a>           171 lib/ext/max_record.c 			      (session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5406.html#L237'>session</a>           237 lib/ext/max_record.c size_t gnutls_record_get_max_size(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5406.html#L242'>session</a>           242 lib/ext/max_record.c 	return session-&gt;security_parameters.max_record_recv_size;</span>
<span class='curline'><a href='../S/5406.html#L271'>session</a>           271 lib/ext/max_record.c ssize_t gnutls_record_set_max_size(gnutls_session_t session, size_t size)</span>
<span class='curline'><a href='../S/5406.html#L276'>session</a>           276 lib/ext/max_record.c 	if (session-&gt;internals.handshake_in_progress)</span>
<span class='curline'><a href='../S/5406.html#L279'>session</a>           279 lib/ext/max_record.c 	session-&gt;security_parameters.max_user_record_send_size = size;</span>
<span class='curline'><a href='../S/5406.html#L280'>session</a>           280 lib/ext/max_record.c 	session-&gt;security_parameters.max_user_record_recv_size = size;</span>
<span class='curline'><a href='../S/5406.html#L303'>session</a>           303 lib/ext/max_record.c ssize_t gnutls_record_set_max_recv_size(gnutls_session_t session, size_t size)</span>
<span class='curline'><a href='../S/5406.html#L306'>session</a>           306 lib/ext/max_record.c 	    (session-&gt;internals.allow_small_records ?</span>
<span class='curline'><a href='../S/5406.html#L311'>session</a>           311 lib/ext/max_record.c 	if (session-&gt;internals.handshake_in_progress)</span>
<span class='curline'><a href='../S/5406.html#L314'>session</a>           314 lib/ext/max_record.c 	session-&gt;security_parameters.max_user_record_recv_size = size;</span>
<span class='curline'><a href='../S/5405.html#L33'>session</a>            33 lib/ext/post_handshake.c static int _gnutls_post_handshake_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5405.html#L36'>session</a>            36 lib/ext/post_handshake.c static int _gnutls_post_handshake_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5405.html#L55'>session</a>            55 lib/ext/post_handshake.c _gnutls_post_handshake_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5405.html#L60'>session</a>            60 lib/ext/post_handshake.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5405.html#L61'>session</a>            61 lib/ext/post_handshake.c 		vers = get_version(session);</span>
<span class='curline'><a href='../S/5405.html#L65'>session</a>            65 lib/ext/post_handshake.c 		if ((session-&gt;internals.flags &amp; GNUTLS_POST_HANDSHAKE_AUTH) &amp;&amp;</span>
<span class='curline'><a href='../S/5405.html#L67'>session</a>            67 lib/ext/post_handshake.c 			session-&gt;security_parameters.post_handshake_auth = 1;</span>
<span class='curline'><a href='../S/5405.html#L76'>session</a>            76 lib/ext/post_handshake.c _gnutls_post_handshake_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5405.html#L82'>session</a>            82 lib/ext/post_handshake.c 	if (session-&gt;security_parameters.entity != GNUTLS_CLIENT ||</span>
<span class='curline'><a href='../S/5405.html#L83'>session</a>            83 lib/ext/post_handshake.c 	    !(session-&gt;internals.flags &amp; GNUTLS_POST_HANDSHAKE_AUTH)) {</span>
<span class='curline'><a href='../S/5405.html#L89'>session</a>            89 lib/ext/post_handshake.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5405.html#L93'>session</a>            93 lib/ext/post_handshake.c 	max = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5414.html#L95'>session</a>            95 lib/ext/pre_shared_key.c compute_psk_binder(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5414.html#L108'>session</a>           108 lib/ext/pre_shared_key.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5414.html#L109'>session</a>           109 lib/ext/pre_shared_key.c 		if (session-&gt;internals.hsk_flags &amp; HSK_HRR_RECEIVED) {</span>
<span class='curline'><a href='../S/5414.html#L111'>session</a>           111 lib/ext/pre_shared_key.c 							(const void *) session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5414.html#L112'>session</a>           112 lib/ext/pre_shared_key.c 							session-&gt;internals.handshake_hash_buffer.length);</span>
<span class='curline'><a href='../S/5414.html#L141'>session</a>           141 lib/ext/pre_shared_key.c 		if (session-&gt;internals.hsk_flags &amp; HSK_HRR_SENT) {</span>
<span class='curline'><a href='../S/5414.html#L142'>session</a>           142 lib/ext/pre_shared_key.c 			if (unlikely(session-&gt;internals.handshake_hash_buffer.length &lt;= client_hello-&gt;size)) {</span>
<span class='curline'><a href='../S/5414.html#L148'>session</a>           148 lib/ext/pre_shared_key.c 							session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5414.html#L149'>session</a>           149 lib/ext/pre_shared_key.c 							session-&gt;internals.handshake_hash_buffer.length - client_hello-&gt;size);</span>
<span class='curline'><a href='../S/5414.html#L193'>session</a>           193 lib/ext/pre_shared_key.c generate_early_secrets(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5414.html#L199'>session</a>           199 lib/ext/pre_shared_key.c 				    session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5414.html#L200'>session</a>           200 lib/ext/pre_shared_key.c 				    session-&gt;internals.handshake_hash_buffer_client_hello_len,</span>
<span class='curline'><a href='../S/5414.html#L201'>session</a>           201 lib/ext/pre_shared_key.c 				    session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5414.html#L202'>session</a>           202 lib/ext/pre_shared_key.c 				    session-&gt;key.proto.tls13.e_ckey);</span>
<span class='curline'><a href='../S/5414.html#L206'>session</a>           206 lib/ext/pre_shared_key.c 	ret = _gnutls_call_keylog_func(session, "CLIENT_EARLY_TRAFFIC_SECRET",</span>
<span class='curline'><a href='../S/5414.html#L207'>session</a>           207 lib/ext/pre_shared_key.c 				       session-&gt;key.proto.tls13.e_ckey,</span>
<span class='curline'><a href='../S/5414.html#L213'>session</a>           213 lib/ext/pre_shared_key.c 				    session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5414.html#L214'>session</a>           214 lib/ext/pre_shared_key.c 				    session-&gt;internals.handshake_hash_buffer_client_hello_len,</span>
<span class='curline'><a href='../S/5414.html#L215'>session</a>           215 lib/ext/pre_shared_key.c 				    session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5414.html#L216'>session</a>           216 lib/ext/pre_shared_key.c 				    session-&gt;key.proto.tls13.ap_expkey);</span>
<span class='curline'><a href='../S/5414.html#L220'>session</a>           220 lib/ext/pre_shared_key.c 	ret = _gnutls_call_keylog_func(session, "EARLY_EXPORTER_SECRET",</span>
<span class='curline'><a href='../S/5414.html#L221'>session</a>           221 lib/ext/pre_shared_key.c 				       session-&gt;key.proto.tls13.ap_expkey,</span>
<span class='curline'><a href='../S/5414.html#L232'>session</a>           232 lib/ext/pre_shared_key.c _gnutls_generate_early_secrets_for_psk(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5414.html#L239'>session</a>           239 lib/ext/pre_shared_key.c 	psk = session-&gt;key.binders[0].psk.data;</span>
<span class='curline'><a href='../S/5414.html#L240'>session</a>           240 lib/ext/pre_shared_key.c 	psk_size = session-&gt;key.binders[0].psk.size;</span>
<span class='curline'><a href='../S/5414.html#L241'>session</a>           241 lib/ext/pre_shared_key.c 	prf = session-&gt;key.binders[0].prf;</span>
<span class='curline'><a href='../S/5414.html#L247'>session</a>           247 lib/ext/pre_shared_key.c 				  session-&gt;key.proto.tls13.temp_secret);</span>
<span class='curline'><a href='../S/5414.html#L251'>session</a>           251 lib/ext/pre_shared_key.c 	session-&gt;key.proto.tls13.temp_secret_size = prf-&gt;output_size;</span>
<span class='curline'><a href='../S/5414.html#L253'>session</a>           253 lib/ext/pre_shared_key.c 	ret = generate_early_secrets(session, session-&gt;key.binders[0].prf);</span>
<span class='curline'><a href='../S/5414.html#L261'>session</a>           261 lib/ext/pre_shared_key.c client_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5414.html#L281'>session</a>           281 lib/ext/pre_shared_key.c 	if (((session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS) ||</span>
<span class='curline'><a href='../S/5414.html#L282'>session</a>           282 lib/ext/pre_shared_key.c 	    session-&gt;internals.tls13_ticket.ticket.data == NULL) &amp;&amp;</span>
<span class='curline'><a href='../S/5414.html#L283'>session</a>           283 lib/ext/pre_shared_key.c 	    (!cred || !_gnutls_have_psk_credentials(cred, session))) {</span>
<span class='curline'><a href='../S/5414.html#L297'>session</a>           297 lib/ext/pre_shared_key.c 	if (!(session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS) &amp;&amp;</span>
<span class='curline'><a href='../S/5414.html#L298'>session</a>           298 lib/ext/pre_shared_key.c 	    session-&gt;internals.tls13_ticket.ticket.data != NULL) {</span>
<span class='curline'><a href='../S/5414.html#L300'>session</a>           300 lib/ext/pre_shared_key.c 		if (unlikely(session-&gt;internals.tls13_ticket.prf == NULL)) {</span>
<span class='curline'><a href='../S/5414.html#L301'>session</a>           301 lib/ext/pre_shared_key.c 			_gnutls13_session_ticket_unset(session);</span>
<span class='curline'><a href='../S/5414.html#L306'>session</a>           306 lib/ext/pre_shared_key.c 		prf_res = session-&gt;internals.tls13_ticket.prf;</span>
<span class='curline'><a href='../S/5414.html#L310'>session</a>           310 lib/ext/pre_shared_key.c 						  &amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5414.html#L314'>session</a>           314 lib/ext/pre_shared_key.c 			_gnutls13_session_ticket_unset(session);</span>
<span class='curline'><a href='../S/5414.html#L320'>session</a>           320 lib/ext/pre_shared_key.c 					     &amp;session-&gt;internals.tls13_ticket.</span>
<span class='curline'><a href='../S/5414.html#L322'>session</a>           322 lib/ext/pre_shared_key.c 		if (ticket_age / 1000 &gt; session-&gt;internals.tls13_ticket.lifetime) {</span>
<span class='curline'><a href='../S/5414.html#L323'>session</a>           323 lib/ext/pre_shared_key.c 			_gnutls13_session_ticket_unset(session);</span>
<span class='curline'><a href='../S/5414.html#L327'>session</a>           327 lib/ext/pre_shared_key.c 		ret = compute_psk_from_ticket(&amp;session-&gt;internals.tls13_ticket, &amp;rkey);</span>
<span class='curline'><a href='../S/5414.html#L329'>session</a>           329 lib/ext/pre_shared_key.c 			_gnutls13_session_ticket_unset(session);</span>
<span class='curline'><a href='../S/5414.html#L334'>session</a>           334 lib/ext/pre_shared_key.c 		ob_ticket_age = ticket_age + session-&gt;internals.tls13_ticket.age_add;</span>
<span class='curline'><a href='../S/5414.html#L337'>session</a>           337 lib/ext/pre_shared_key.c 							     session-&gt;internals.tls13_ticket.ticket.data,</span>
<span class='curline'><a href='../S/5414.html#L338'>session</a>           338 lib/ext/pre_shared_key.c 							     session-&gt;internals.tls13_ticket.ticket.size)) &lt; 0) {</span>
<span class='curline'><a href='../S/5414.html#L349'>session</a>           349 lib/ext/pre_shared_key.c 		psk_id_len += 6 + session-&gt;internals.tls13_ticket.ticket.size;</span>
<span class='curline'><a href='../S/5414.html#L354'>session</a>           354 lib/ext/pre_shared_key.c 	if (cred &amp;&amp; _gnutls_have_psk_credentials(cred, session)) {</span>
<span class='curline'><a href='../S/5414.html#L365'>session</a>           365 lib/ext/pre_shared_key.c 		ret = _gnutls_find_psk_key(session, cred, &amp;username, &amp;tkey, &amp;free_username);</span>
<span class='curline'><a href='../S/5414.html#L388'>session</a>           388 lib/ext/pre_shared_key.c 		ret = _gnutls_auth_info_init(session, GNUTLS_CRD_PSK, sizeof(psk_auth_info_st), 1);</span>
<span class='curline'><a href='../S/5414.html#L394'>session</a>           394 lib/ext/pre_shared_key.c 		info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5414.html#L426'>session</a>           426 lib/ext/pre_shared_key.c 	ext_offset = _gnutls_ext_get_extensions_offset(session);</span>
<span class='curline'><a href='../S/5414.html#L445'>session</a>           445 lib/ext/pre_shared_key.c 		ret = compute_psk_binder(session, prf_res,</span>
<span class='curline'><a href='../S/5414.html#L455'>session</a>           455 lib/ext/pre_shared_key.c 		gnutls_free(session-&gt;key.binders[next_idx].psk.data);</span>
<span class='curline'><a href='../S/5414.html#L456'>session</a>           456 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].psk.data = rkey.data;</span>
<span class='curline'><a href='../S/5414.html#L457'>session</a>           457 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].psk.size = rkey.size;</span>
<span class='curline'><a href='../S/5414.html#L460'>session</a>           460 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].prf = prf_res;</span>
<span class='curline'><a href='../S/5414.html#L461'>session</a>           461 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].resumption = 1;</span>
<span class='curline'><a href='../S/5414.html#L462'>session</a>           462 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].idx = next_idx;</span>
<span class='curline'><a href='../S/5414.html#L464'>session</a>           464 lib/ext/pre_shared_key.c 		_gnutls_handshake_log("EXT[%p]: sent PSK resumption identity (%d)\n", session, next_idx);</span>
<span class='curline'><a href='../S/5414.html#L475'>session</a>           475 lib/ext/pre_shared_key.c 		session-&gt;internals.hsk_flags |= HSK_TLS13_TICKET_SENT;</span>
<span class='curline'><a href='../S/5414.html#L479'>session</a>           479 lib/ext/pre_shared_key.c 		ret = compute_psk_binder(session, prf_psk,</span>
<span class='curline'><a href='../S/5414.html#L489'>session</a>           489 lib/ext/pre_shared_key.c 		gnutls_free(session-&gt;key.binders[next_idx].psk.data);</span>
<span class='curline'><a href='../S/5414.html#L490'>session</a>           490 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].psk.data = user_key.data;</span>
<span class='curline'><a href='../S/5414.html#L491'>session</a>           491 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].psk.size = user_key.size;</span>
<span class='curline'><a href='../S/5414.html#L494'>session</a>           494 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].prf = prf_psk;</span>
<span class='curline'><a href='../S/5414.html#L495'>session</a>           495 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].resumption = 0;</span>
<span class='curline'><a href='../S/5414.html#L496'>session</a>           496 lib/ext/pre_shared_key.c 		session-&gt;key.binders[next_idx].idx = next_idx;</span>
<span class='curline'><a href='../S/5414.html#L498'>session</a>           498 lib/ext/pre_shared_key.c 		_gnutls_handshake_log("EXT[%p]: sent PSK identity '%s' (%d)\n", session, info-&gt;username, next_idx);</span>
<span class='curline'><a href='../S/5414.html#L523'>session</a>           523 lib/ext/pre_shared_key.c server_send_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/5414.html#L527'>session</a>           527 lib/ext/pre_shared_key.c 	if (!(session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED))</span>
<span class='curline'><a href='../S/5414.html#L531'>session</a>           531 lib/ext/pre_shared_key.c 					   session-&gt;key.binders[0].idx);</span>
<span class='curline'><a href='../S/5414.html#L538'>session</a>           538 lib/ext/pre_shared_key.c static int server_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5414.html#L579'>session</a>           579 lib/ext/pre_shared_key.c 		if (!(session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS) &amp;&amp;</span>
<span class='curline'><a href='../S/5414.html#L580'>session</a>           580 lib/ext/pre_shared_key.c 		    (ret = _gnutls13_unpack_session_ticket(session, &amp;psk.identity, &amp;ticket_data)) == 0) {</span>
<span class='curline'><a href='../S/5414.html#L583'>session</a>           583 lib/ext/pre_shared_key.c 			session-&gt;internals.resumption_requested = 1;</span>
<span class='curline'><a href='../S/5414.html#L615'>session</a>           615 lib/ext/pre_shared_key.c 			ret = _gnutls_psk_pwd_find_entry(session, (char *) psk.identity.data, psk.identity.size, &amp;key);</span>
<span class='curline'><a href='../S/5414.html#L637'>session</a>           637 lib/ext/pre_shared_key.c 	if (!_gnutls_ext_get_full_client_hello(session, &amp;full_client_hello)) {</span>
<span class='curline'><a href='../S/5414.html#L644'>session</a>           644 lib/ext/pre_shared_key.c 	ret = compute_psk_binder(session, prf, psk_parser.binders_len+2, 0, 0,</span>
<span class='curline'><a href='../S/5414.html#L659'>session</a>           659 lib/ext/pre_shared_key.c 	if (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_DHE_PSK)</span>
<span class='curline'><a href='../S/5414.html#L660'>session</a>           660 lib/ext/pre_shared_key.c 		_gnutls_handshake_log("EXT[%p]: selected DHE-PSK mode\n", session);</span>
<span class='curline'><a href='../S/5414.html#L662'>session</a>           662 lib/ext/pre_shared_key.c 		reset_cand_groups(session);</span>
<span class='curline'><a href='../S/5414.html#L663'>session</a>           663 lib/ext/pre_shared_key.c 		_gnutls_handshake_log("EXT[%p]: selected PSK mode\n", session);</span>
<span class='curline'><a href='../S/5414.html#L671'>session</a>           671 lib/ext/pre_shared_key.c 		ret = _gnutls_auth_info_init(session, GNUTLS_CRD_PSK, sizeof(psk_auth_info_st), 1);</span>
<span class='curline'><a href='../S/5414.html#L677'>session</a>           677 lib/ext/pre_shared_key.c 		info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5414.html#L681'>session</a>           681 lib/ext/pre_shared_key.c 		_gnutls_handshake_log("EXT[%p]: selected PSK identity: %s (%d)\n", session, info-&gt;username, psk_index);</span>
<span class='curline'><a href='../S/5414.html#L683'>session</a>           683 lib/ext/pre_shared_key.c 		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_ACCEPTED) {</span>
<span class='curline'><a href='../S/5414.html#L684'>session</a>           684 lib/ext/pre_shared_key.c 			if (session-&gt;internals.anti_replay) {</span>
<span class='curline'><a href='../S/5414.html#L685'>session</a>           685 lib/ext/pre_shared_key.c 				ret = _gnutls_anti_replay_check(session-&gt;internals.anti_replay,</span>
<span class='curline'><a href='../S/5414.html#L690'>session</a>           690 lib/ext/pre_shared_key.c 					session-&gt;internals.hsk_flags &amp;= ~HSK_EARLY_DATA_ACCEPTED;</span>
<span class='curline'><a href='../S/5414.html#L692'>session</a>           692 lib/ext/pre_shared_key.c 						      session);</span>
<span class='curline'><a href='../S/5414.html#L696'>session</a>           696 lib/ext/pre_shared_key.c 						      session);</span>
<span class='curline'><a href='../S/5414.html#L697'>session</a>           697 lib/ext/pre_shared_key.c 				session-&gt;internals.hsk_flags &amp;= ~HSK_EARLY_DATA_ACCEPTED;</span>
<span class='curline'><a href='../S/5414.html#L701'>session</a>           701 lib/ext/pre_shared_key.c 		session-&gt;internals.resumed = RESUME_TRUE;</span>
<span class='curline'><a href='../S/5414.html#L702'>session</a>           702 lib/ext/pre_shared_key.c 		_gnutls_handshake_log("EXT[%p]: selected resumption PSK identity (%d)\n", session, psk_index);</span>
<span class='curline'><a href='../S/5414.html#L705'>session</a>           705 lib/ext/pre_shared_key.c 	session-&gt;internals.hsk_flags |= HSK_PSK_SELECTED;</span>
<span class='curline'><a href='../S/5414.html#L708'>session</a>           708 lib/ext/pre_shared_key.c 	session-&gt;key.binders[0].psk.data = key.data;</span>
<span class='curline'><a href='../S/5414.html#L709'>session</a>           709 lib/ext/pre_shared_key.c 	session-&gt;key.binders[0].psk.size = key.size;</span>
<span class='curline'><a href='../S/5414.html#L711'>session</a>           711 lib/ext/pre_shared_key.c 	session-&gt;key.binders[0].idx = psk_index;</span>
<span class='curline'><a href='../S/5414.html#L712'>session</a>           712 lib/ext/pre_shared_key.c 	session-&gt;key.binders[0].prf = prf;</span>
<span class='curline'><a href='../S/5414.html#L713'>session</a>           713 lib/ext/pre_shared_key.c 	session-&gt;key.binders[0].resumption = resuming;</span>
<span class='curline'><a href='../S/5414.html#L715'>session</a>           715 lib/ext/pre_shared_key.c 	ret = _gnutls_generate_early_secrets_for_psk(session);</span>
<span class='curline'><a href='../S/5414.html#L754'>session</a>           754 lib/ext/pre_shared_key.c static int _gnutls_psk_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5414.html#L760'>session</a>           760 lib/ext/pre_shared_key.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5414.html#L761'>session</a>           761 lib/ext/pre_shared_key.c 		vers = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5414.html#L766'>session</a>           766 lib/ext/pre_shared_key.c 		if (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODES_SENT) {</span>
<span class='curline'><a href='../S/5414.html#L768'>session</a>           768 lib/ext/pre_shared_key.c 					_gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5414.html#L771'>session</a>           771 lib/ext/pre_shared_key.c 		if ((session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS) &amp;&amp; !session-&gt;internals.priorities-&gt;have_psk)</span>
<span class='curline'><a href='../S/5414.html#L774'>session</a>           774 lib/ext/pre_shared_key.c 		return client_send_params(session, extdata, cred);</span>
<span class='curline'><a href='../S/5414.html#L776'>session</a>           776 lib/ext/pre_shared_key.c 		vers = get_version(session);</span>
<span class='curline'><a href='../S/5414.html#L781'>session</a>           781 lib/ext/pre_shared_key.c 		if ((session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS) &amp;&amp; !session-&gt;internals.priorities-&gt;have_psk)</span>
<span class='curline'><a href='../S/5414.html#L784'>session</a>           784 lib/ext/pre_shared_key.c 		if (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODES_RECEIVED)</span>
<span class='curline'><a href='../S/5414.html#L785'>session</a>           785 lib/ext/pre_shared_key.c 			return server_send_params(session, extdata);</span>
<span class='curline'><a href='../S/5414.html#L791'>session</a>           791 lib/ext/pre_shared_key.c static void swap_binders(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5414.html#L795'>session</a>           795 lib/ext/pre_shared_key.c 	memcpy(&amp;tmp, &amp;session-&gt;key.binders[0], sizeof(struct binder_data_st));</span>
<span class='curline'><a href='../S/5414.html#L796'>session</a>           796 lib/ext/pre_shared_key.c 	memcpy(&amp;session-&gt;key.binders[0], &amp;session-&gt;key.binders[1], sizeof(struct binder_data_st));</span>
<span class='curline'><a href='../S/5414.html#L797'>session</a>           797 lib/ext/pre_shared_key.c 	memcpy(&amp;session-&gt;key.binders[1], &amp;tmp, sizeof(struct binder_data_st));</span>
<span class='curline'><a href='../S/5414.html#L806'>session</a>           806 lib/ext/pre_shared_key.c static int _gnutls_psk_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5414.html#L811'>session</a>           811 lib/ext/pre_shared_key.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5414.html#L817'>session</a>           817 lib/ext/pre_shared_key.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5414.html#L818'>session</a>           818 lib/ext/pre_shared_key.c 		if (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODES_SENT) {</span>
<span class='curline'><a href='../S/5414.html#L821'>session</a>           821 lib/ext/pre_shared_key.c 			for (i=0;i&lt;sizeof(session-&gt;key.binders)/sizeof(session-&gt;key.binders[0]);i++) {</span>
<span class='curline'><a href='../S/5414.html#L822'>session</a>           822 lib/ext/pre_shared_key.c 				if (session-&gt;key.binders[i].prf != NULL &amp;&amp; session-&gt;key.binders[i].idx == selected_identity) {</span>
<span class='curline'><a href='../S/5414.html#L823'>session</a>           823 lib/ext/pre_shared_key.c 					if (session-&gt;key.binders[i].resumption) {</span>
<span class='curline'><a href='../S/5414.html#L824'>session</a>           824 lib/ext/pre_shared_key.c 						session-&gt;internals.resumed = RESUME_TRUE;</span>
<span class='curline'><a href='../S/5414.html#L825'>session</a>           825 lib/ext/pre_shared_key.c 						_gnutls_handshake_log("EXT[%p]: selected PSK-resumption mode\n", session);</span>
<span class='curline'><a href='../S/5414.html#L827'>session</a>           827 lib/ext/pre_shared_key.c 						_gnutls_handshake_log("EXT[%p]: selected PSK mode\n", session);</span>
<span class='curline'><a href='../S/5414.html#L833'>session</a>           833 lib/ext/pre_shared_key.c 						swap_binders(session);</span>
<span class='curline'><a href='../S/5414.html#L835'>session</a>           835 lib/ext/pre_shared_key.c 						ret = _gnutls_generate_early_secrets_for_psk(session);</span>
<span class='curline'><a href='../S/5414.html#L839'>session</a>           839 lib/ext/pre_shared_key.c 					session-&gt;internals.hsk_flags |= HSK_PSK_SELECTED;</span>
<span class='curline'><a href='../S/5414.html#L848'>session</a>           848 lib/ext/pre_shared_key.c 		if (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODES_RECEIVED) {</span>
<span class='curline'><a href='../S/5414.html#L849'>session</a>           849 lib/ext/pre_shared_key.c 			if (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_INVALID) {</span>
<span class='curline'><a href='../S/5414.html#L855'>session</a>           855 lib/ext/pre_shared_key.c 					_gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5414.html#L859'>session</a>           859 lib/ext/pre_shared_key.c 			if (pskcred == NULL &amp;&amp; (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS))</span>
<span class='curline'><a href='../S/5414.html#L862'>session</a>           862 lib/ext/pre_shared_key.c 			return server_recv_params(session, data, len, pskcred);</span>
<span class='curline'><a href='../S/5447.html#L13'>session</a>            13 lib/ext/pre_shared_key.h unsigned _gnutls_have_psk_credentials(const gnutls_psk_client_credentials_t cred, gnutls_session_t session)</span>
<span class='curline'><a href='../S/5447.html#L15'>session</a>            15 lib/ext/pre_shared_key.h 	if ((cred-&gt;get_function || cred-&gt;username.data) &amp;&amp; session-&gt;internals.priorities-&gt;have_psk)</span>
<span class='curline'><a href='../S/5447.html#L21'>session</a>            21 lib/ext/pre_shared_key.h int _gnutls_generate_early_secrets_for_psk(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5412.html#L32'>session</a>            32 lib/ext/psk_ke_modes.c psk_ke_modes_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5412.html#L43'>session</a>            43 lib/ext/psk_ke_modes.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5412.html#L48'>session</a>            48 lib/ext/psk_ke_modes.c 	if ((session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS) &amp;&amp;</span>
<span class='curline'><a href='../S/5412.html#L49'>session</a>            49 lib/ext/psk_ke_modes.c 	    !session-&gt;internals.priorities-&gt;have_psk)</span>
<span class='curline'><a href='../S/5412.html#L52'>session</a>            52 lib/ext/psk_ke_modes.c 	vers = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5412.html#L62'>session</a>            62 lib/ext/psk_ke_modes.c 	for (i=0;i&lt;session-&gt;internals.priorities-&gt;_kx.num_priorities;i++) {</span>
<span class='curline'><a href='../S/5412.html#L63'>session</a>            63 lib/ext/psk_ke_modes.c 		if (session-&gt;internals.priorities-&gt;_kx.priorities[i] == GNUTLS_KX_PSK &amp;&amp; !have_psk) {</span>
<span class='curline'><a href='../S/5412.html#L66'>session</a>            66 lib/ext/psk_ke_modes.c 			session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_PSK;</span>
<span class='curline'><a href='../S/5412.html#L68'>session</a>            68 lib/ext/psk_ke_modes.c 		} else if ((session-&gt;internals.priorities-&gt;_kx.priorities[i] == GNUTLS_KX_DHE_PSK ||</span>
<span class='curline'><a href='../S/5412.html#L69'>session</a>            69 lib/ext/psk_ke_modes.c 			    session-&gt;internals.priorities-&gt;_kx.priorities[i] == GNUTLS_KX_ECDHE_PSK) &amp;&amp; !have_dhpsk) {</span>
<span class='curline'><a href='../S/5412.html#L72'>session</a>            72 lib/ext/psk_ke_modes.c 			session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_DHE_PSK;</span>
<span class='curline'><a href='../S/5412.html#L82'>session</a>            82 lib/ext/psk_ke_modes.c 		if (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS)</span>
<span class='curline'><a href='../S/5412.html#L87'>session</a>            87 lib/ext/psk_ke_modes.c 		session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_DHE_PSK;</span>
<span class='curline'><a href='../S/5412.html#L88'>session</a>            88 lib/ext/psk_ke_modes.c 		session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_PSK;</span>
<span class='curline'><a href='../S/5412.html#L95'>session</a>            95 lib/ext/psk_ke_modes.c 	session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODES_SENT;</span>
<span class='curline'><a href='../S/5412.html#L108'>session</a>           108 lib/ext/psk_ke_modes.c psk_ke_modes_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5412.html#L112'>session</a>           112 lib/ext/psk_ke_modes.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5412.html#L121'>session</a>           121 lib/ext/psk_ke_modes.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5412.html#L128'>session</a>           128 lib/ext/psk_ke_modes.c 		session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_INVALID;</span>
<span class='curline'><a href='../S/5412.html#L132'>session</a>           132 lib/ext/psk_ke_modes.c 	cred = (gnutls_psk_server_credentials_t)_gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5412.html#L133'>session</a>           133 lib/ext/psk_ke_modes.c 	if (cred == NULL &amp;&amp; (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS)) {</span>
<span class='curline'><a href='../S/5412.html#L134'>session</a>           134 lib/ext/psk_ke_modes.c 		session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_INVALID;</span>
<span class='curline'><a href='../S/5412.html#L141'>session</a>           141 lib/ext/psk_ke_modes.c 	for (i=0;i&lt;session-&gt;internals.priorities-&gt;_kx.num_priorities;i++) {</span>
<span class='curline'><a href='../S/5412.html#L142'>session</a>           142 lib/ext/psk_ke_modes.c 		if (session-&gt;internals.priorities-&gt;_kx.priorities[i] == GNUTLS_KX_PSK &amp;&amp; psk_pos == MAX_POS) {</span>
<span class='curline'><a href='../S/5412.html#L144'>session</a>           144 lib/ext/psk_ke_modes.c 		} else if ((session-&gt;internals.priorities-&gt;_kx.priorities[i] == GNUTLS_KX_DHE_PSK ||</span>
<span class='curline'><a href='../S/5412.html#L145'>session</a>           145 lib/ext/psk_ke_modes.c 			    session-&gt;internals.priorities-&gt;_kx.priorities[i] == GNUTLS_KX_ECDHE_PSK) &amp;&amp;</span>
<span class='curline'><a href='../S/5412.html#L155'>session</a>           155 lib/ext/psk_ke_modes.c 		if (!(session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS))</span>
<span class='curline'><a href='../S/5412.html#L157'>session</a>           157 lib/ext/psk_ke_modes.c 		else if (session-&gt;internals.priorities-&gt;groups.size == 0)</span>
<span class='curline'><a href='../S/5412.html#L169'>session</a>           169 lib/ext/psk_ke_modes.c 				      session, (unsigned)data[i]);</span>
<span class='curline'><a href='../S/5412.html#L174'>session</a>           174 lib/ext/psk_ke_modes.c 	if (session-&gt;internals.priorities-&gt;server_precedence) {</span>
<span class='curline'><a href='../S/5412.html#L176'>session</a>           176 lib/ext/psk_ke_modes.c 			session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_DHE_PSK;</span>
<span class='curline'><a href='../S/5412.html#L178'>session</a>           178 lib/ext/psk_ke_modes.c 			session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_PSK;</span>
<span class='curline'><a href='../S/5412.html#L181'>session</a>           181 lib/ext/psk_ke_modes.c 			session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_DHE_PSK;</span>
<span class='curline'><a href='../S/5412.html#L183'>session</a>           183 lib/ext/psk_ke_modes.c 			session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_PSK;</span>
<span class='curline'><a href='../S/5412.html#L186'>session</a>           186 lib/ext/psk_ke_modes.c 	if ((session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_PSK) ||</span>
<span class='curline'><a href='../S/5412.html#L187'>session</a>           187 lib/ext/psk_ke_modes.c 	    (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_DHE_PSK)) {</span>
<span class='curline'><a href='../S/5412.html#L191'>session</a>           191 lib/ext/psk_ke_modes.c 		session-&gt;internals.hsk_flags |= HSK_PSK_KE_MODE_INVALID;</span>
<span class='curline'><a href='../S/5438.html#L32'>session</a>            32 lib/ext/record_size_limit.c static int _gnutls_record_size_limit_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5438.html#L35'>session</a>            35 lib/ext/record_size_limit.c static int _gnutls_record_size_limit_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5438.html#L51'>session</a>            51 lib/ext/record_size_limit.c _gnutls_record_size_limit_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5438.html#L66'>session</a>            66 lib/ext/record_size_limit.c 	session-&gt;internals.hsk_flags |= HSK_RECORD_SIZE_LIMIT_RECEIVED;</span>
<span class='curline'><a href='../S/5438.html#L70'>session</a>            70 lib/ext/record_size_limit.c 	    (session-&gt;internals.allow_small_records ?</span>
<span class='curline'><a href='../S/5438.html#L73'>session</a>            73 lib/ext/record_size_limit.c 		if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5438.html#L75'>session</a>            75 lib/ext/record_size_limit.c 					      session, (unsigned)new_size);</span>
<span class='curline'><a href='../S/5438.html#L79'>session</a>            79 lib/ext/record_size_limit.c 					      session, (unsigned)new_size);</span>
<span class='curline'><a href='../S/5438.html#L84'>session</a>            84 lib/ext/record_size_limit.c 	session-&gt;internals.hsk_flags |= HSK_RECORD_SIZE_LIMIT_NEGOTIATED;</span>
<span class='curline'><a href='../S/5438.html#L88'>session</a>            88 lib/ext/record_size_limit.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5438.html#L89'>session</a>            89 lib/ext/record_size_limit.c 		session-&gt;security_parameters.max_record_recv_size =</span>
<span class='curline'><a href='../S/5438.html#L90'>session</a>            90 lib/ext/record_size_limit.c 			session-&gt;security_parameters.max_user_record_recv_size;</span>
<span class='curline'><a href='../S/5438.html#L93'>session</a>            93 lib/ext/record_size_limit.c 			      session, (unsigned)new_size);</span>
<span class='curline'><a href='../S/5438.html#L96'>session</a>            96 lib/ext/record_size_limit.c 	vers = get_version(session);</span>
<span class='curline'><a href='../S/5438.html#L100'>session</a>           100 lib/ext/record_size_limit.c 	session-&gt;security_parameters.max_record_send_size =</span>
<span class='curline'><a href='../S/5438.html#L102'>session</a>           102 lib/ext/record_size_limit.c 		    session-&gt;security_parameters.max_user_record_send_size);</span>
<span class='curline'><a href='../S/5438.html#L110'>session</a>           110 lib/ext/record_size_limit.c _gnutls_record_size_limit_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5438.html#L116'>session</a>           116 lib/ext/record_size_limit.c 	assert(session-&gt;security_parameters.max_user_record_recv_size &gt;= 64 &amp;&amp;</span>
<span class='curline'><a href='../S/5438.html#L117'>session</a>           117 lib/ext/record_size_limit.c 	       session-&gt;security_parameters.max_user_record_recv_size &lt;=</span>
<span class='curline'><a href='../S/5438.html#L120'>session</a>           120 lib/ext/record_size_limit.c 	send_size = session-&gt;security_parameters.max_user_record_recv_size;</span>
<span class='curline'><a href='../S/5438.html#L122'>session</a>           122 lib/ext/record_size_limit.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5438.html#L126'>session</a>           126 lib/ext/record_size_limit.c 		if (session-&gt;internals.hsk_flags &amp; HSK_RECORD_SIZE_LIMIT_RECEIVED &amp;&amp;</span>
<span class='curline'><a href='../S/5438.html#L127'>session</a>           127 lib/ext/record_size_limit.c 		    !(session-&gt;internals.hsk_flags &amp; HSK_RECORD_SIZE_LIMIT_NEGOTIATED))</span>
<span class='curline'><a href='../S/5438.html#L131'>session</a>           131 lib/ext/record_size_limit.c 		vers = get_version(session);</span>
<span class='curline'><a href='../S/5438.html#L135'>session</a>           135 lib/ext/record_size_limit.c 		session-&gt;security_parameters.max_record_recv_size =</span>
<span class='curline'><a href='../S/5438.html#L143'>session</a>           143 lib/ext/record_size_limit.c 		vers = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5438.html#L154'>session</a>           154 lib/ext/record_size_limit.c 	session-&gt;internals.hsk_flags |= HSK_RECORD_SIZE_LIMIT_SENT;</span>
<span class='curline'><a href='../S/5415.html#L51'>session</a>            51 lib/ext/safe_renegotiation.c _gnutls_ext_sr_finished(gnutls_session_t session, void *vdata,</span>
<span class='curline'><a href='../S/5415.html#L58'>session</a>            58 lib/ext/safe_renegotiation.c 	if (session-&gt;internals.priorities-&gt;sr == SR_DISABLED ||</span>
<span class='curline'><a href='../S/5415.html#L59'>session</a>            59 lib/ext/safe_renegotiation.c 	    session-&gt;internals.priorities-&gt;no_extensions) {</span>
<span class='curline'><a href='../S/5415.html#L63'>session</a>            63 lib/ext/safe_renegotiation.c 	ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L70'>session</a>            70 lib/ext/safe_renegotiation.c 		if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5415.html#L83'>session</a>            83 lib/ext/safe_renegotiation.c 	if ((session-&gt;security_parameters.entity == GNUTLS_CLIENT</span>
<span class='curline'><a href='../S/5415.html#L85'>session</a>            85 lib/ext/safe_renegotiation.c 	    || (session-&gt;security_parameters.entity == GNUTLS_SERVER</span>
<span class='curline'><a href='../S/5415.html#L97'>session</a>            97 lib/ext/safe_renegotiation.c int _gnutls_ext_sr_verify(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5415.html#L103'>session</a>           103 lib/ext/safe_renegotiation.c 	if (session-&gt;internals.priorities-&gt;sr == SR_DISABLED) {</span>
<span class='curline'><a href='../S/5415.html#L108'>session</a>           108 lib/ext/safe_renegotiation.c 	ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L126'>session</a>           126 lib/ext/safe_renegotiation.c 			     session);</span>
<span class='curline'><a href='../S/5415.html#L130'>session</a>           130 lib/ext/safe_renegotiation.c 		if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5415.html#L141'>session</a>           141 lib/ext/safe_renegotiation.c 				     session);</span>
<span class='curline'><a href='../S/5415.html#L151'>session</a>           151 lib/ext/safe_renegotiation.c 				     session);</span>
<span class='curline'><a href='../S/5415.html#L157'>session</a>           157 lib/ext/safe_renegotiation.c 		    ("HSK[%p]: Safe renegotiation succeeded\n", session);</span>
<span class='curline'><a href='../S/5415.html#L164'>session</a>           164 lib/ext/safe_renegotiation.c 			     session);</span>
<span class='curline'><a href='../S/5415.html#L169'>session</a>           169 lib/ext/safe_renegotiation.c 		if (session-&gt;internals.initial_negotiation_completed) {</span>
<span class='curline'><a href='../S/5415.html#L170'>session</a>           170 lib/ext/safe_renegotiation.c 			if (session-&gt;internals.priorities-&gt;sr &lt; SR_PARTIAL) {</span>
<span class='curline'><a href='../S/5415.html#L173'>session</a>           173 lib/ext/safe_renegotiation.c 				     session);</span>
<span class='curline'><a href='../S/5415.html#L178'>session</a>           178 lib/ext/safe_renegotiation.c 				     session);</span>
<span class='curline'><a href='../S/5415.html#L183'>session</a>           183 lib/ext/safe_renegotiation.c 			if (session-&gt;internals.priorities-&gt;sr &lt; SR_SAFE) {</span>
<span class='curline'><a href='../S/5415.html#L186'>session</a>           186 lib/ext/safe_renegotiation.c 				     session);</span>
<span class='curline'><a href='../S/5415.html#L191'>session</a>           191 lib/ext/safe_renegotiation.c 				     session);</span>
<span class='curline'><a href='../S/5415.html#L202'>session</a>           202 lib/ext/safe_renegotiation.c int _gnutls_ext_sr_recv_cs(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5415.html#L208'>session</a>           208 lib/ext/safe_renegotiation.c 	ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L227'>session</a>           227 lib/ext/safe_renegotiation.c 	_gnutls_hello_ext_save_sr(session);</span>
<span class='curline'><a href='../S/5415.html#L230'>session</a>           230 lib/ext/safe_renegotiation.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L237'>session</a>           237 lib/ext/safe_renegotiation.c int _gnutls_ext_sr_send_cs(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5415.html#L243'>session</a>           243 lib/ext/safe_renegotiation.c 	ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L260'>session</a>           260 lib/ext/safe_renegotiation.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L268'>session</a>           268 lib/ext/safe_renegotiation.c _gnutls_sr_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5415.html#L283'>session</a>           283 lib/ext/safe_renegotiation.c 	if (session-&gt;internals.priorities-&gt;sr == SR_DISABLED) {</span>
<span class='curline'><a href='../S/5415.html#L288'>session</a>           288 lib/ext/safe_renegotiation.c 	ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L292'>session</a>           292 lib/ext/safe_renegotiation.c 	    &amp;&amp; session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5415.html#L307'>session</a>           307 lib/ext/safe_renegotiation.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L317'>session</a>           317 lib/ext/safe_renegotiation.c 	if (session-&gt;internals.initial_negotiation_completed != 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5415.html#L343'>session</a>           343 lib/ext/safe_renegotiation.c _gnutls_sr_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5415.html#L356'>session</a>           356 lib/ext/safe_renegotiation.c 	if (session-&gt;internals.priorities-&gt;sr == SR_DISABLED) {</span>
<span class='curline'><a href='../S/5415.html#L361'>session</a>           361 lib/ext/safe_renegotiation.c 	ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L376'>session</a>           376 lib/ext/safe_renegotiation.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5415.html#L384'>session</a>           384 lib/ext/safe_renegotiation.c 	    session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5415.html#L386'>session</a>           386 lib/ext/safe_renegotiation.c 		if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5415.html#L401'>session</a>           401 lib/ext/safe_renegotiation.c 		if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5415.html#L434'>session</a>           434 lib/ext/safe_renegotiation.c unsigned gnutls_safe_renegotiation_status(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5415.html#L440'>session</a>           440 lib/ext/safe_renegotiation.c 	ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5425.html#L43'>session</a>            43 lib/ext/safe_renegotiation.h int _gnutls_ext_sr_finished(gnutls_session_t session, void *vdata,</span>
<span class='curline'><a href='../S/5425.html#L45'>session</a>            45 lib/ext/safe_renegotiation.h int _gnutls_ext_sr_recv_cs(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5425.html#L46'>session</a>            46 lib/ext/safe_renegotiation.h int _gnutls_ext_sr_verify(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5443.html#L40'>session</a>            40 lib/ext/server_cert_type.c static int _gnutls_server_cert_type_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5443.html#L43'>session</a>            43 lib/ext/server_cert_type.c static int _gnutls_server_cert_type_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5443.html#L67'>session</a>            67 lib/ext/server_cert_type.c static int _gnutls_server_cert_type_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5443.html#L81'>session</a>            81 lib/ext/server_cert_type.c 	if (!are_alternative_cert_types_allowed(session) ||</span>
<span class='curline'><a href='../S/5443.html#L82'>session</a>            82 lib/ext/server_cert_type.c 		(_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE) == NULL))</span>
<span class='curline'><a href='../S/5443.html#L85'>session</a>            85 lib/ext/server_cert_type.c 	if (!IS_SERVER(session)) {	// client mode</span>
<span class='curline'><a href='../S/5443.html#L109'>session</a>           109 lib/ext/server_cert_type.c 		ret = _gnutls_hello_ext_get_datum(session,</span>
<span class='curline'><a href='../S/5443.html#L127'>session</a>           127 lib/ext/server_cert_type.c 			_gnutls_session_server_cert_type_set(session, cert_type);</span>
<span class='curline'><a href='../S/5443.html#L150'>session</a>           150 lib/ext/server_cert_type.c 		_gnutls_hello_ext_set_datum(session,</span>
<span class='curline'><a href='../S/5443.html#L170'>session</a>           170 lib/ext/server_cert_type.c 					(session, cert_type, true, GNUTLS_CTYPE_SERVER) == 0) {</span>
<span class='curline'><a href='../S/5443.html#L178'>session</a>           178 lib/ext/server_cert_type.c 			_gnutls_session_server_cert_type_set(session, cert_type);</span>
<span class='curline'><a href='../S/5443.html#L192'>session</a>           192 lib/ext/server_cert_type.c static int _gnutls_server_cert_type_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5443.html#L204'>session</a>           204 lib/ext/server_cert_type.c 	if (!are_alternative_cert_types_allowed(session) ||</span>
<span class='curline'><a href='../S/5443.html#L205'>session</a>           205 lib/ext/server_cert_type.c 		(_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE) == NULL))</span>
<span class='curline'><a href='../S/5443.html#L208'>session</a>           208 lib/ext/server_cert_type.c 	if (!IS_SERVER(session)) {	// Client mode</span>
<span class='curline'><a href='../S/5443.html#L211'>session</a>           211 lib/ext/server_cert_type.c 				&amp;session-&gt;internals.priorities-&gt;server_ctype;</span>
<span class='curline'><a href='../S/5443.html#L230'>session</a>           230 lib/ext/server_cert_type.c 						 session,</span>
<span class='curline'><a href='../S/5443.html#L248'>session</a>           248 lib/ext/server_cert_type.c 						(session, cert_priorities-&gt;priorities[i],</span>
<span class='curline'><a href='../S/5443.html#L271'>session</a>           271 lib/ext/server_cert_type.c 							 session,</span>
<span class='curline'><a href='../S/5443.html#L286'>session</a>           286 lib/ext/server_cert_type.c 						 session);</span>
<span class='curline'><a href='../S/5443.html#L294'>session</a>           294 lib/ext/server_cert_type.c 						 session,</span>
<span class='curline'><a href='../S/5443.html#L307'>session</a>           307 lib/ext/server_cert_type.c 			_gnutls_hello_ext_set_datum(session,</span>
<span class='curline'><a href='../S/5443.html#L330'>session</a>           330 lib/ext/server_cert_type.c 					session, GNUTLS_CTYPE_SERVER));</span>
<span class='curline'><a href='../S/5432.html#L32'>session</a>            32 lib/ext/server_name.c static int _gnutls_server_name_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5432.html#L35'>session</a>            35 lib/ext/server_name.c static int _gnutls_server_name_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5432.html#L39'>session</a>            39 lib/ext/server_name.c _gnutls_server_name_set_raw(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5432.html#L69'>session</a>            69 lib/ext/server_name.c _gnutls_server_name_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5432.html#L76'>session</a>            76 lib/ext/server_name.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5432.html#L101'>session</a>           101 lib/ext/server_name.c 				     session);</span>
<span class='curline'><a href='../S/5432.html#L111'>session</a>           111 lib/ext/server_name.c 					     session, (int) len, p);</span>
<span class='curline'><a href='../S/5432.html#L118'>session</a>           118 lib/ext/server_name.c 				_gnutls_hello_ext_unset_priv(session, GNUTLS_EXTENSION_SERVER_NAME);</span>
<span class='curline'><a href='../S/5432.html#L119'>session</a>           119 lib/ext/server_name.c 				return _gnutls_hello_ext_set_datum(session,</span>
<span class='curline'><a href='../S/5432.html#L136'>session</a>           136 lib/ext/server_name.c _gnutls_server_name_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5432.html#L143'>session</a>           143 lib/ext/server_name.c 	    _gnutls_hello_ext_get_datum(session, GNUTLS_EXTENSION_SERVER_NAME,</span>
<span class='curline'><a href='../S/5432.html#L150'>session</a>           150 lib/ext/server_name.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5432.html#L175'>session</a>           175 lib/ext/server_name.c 		_gnutls_debug_log("HSK[%p]: sent server name: '%.*s'\n", session, name.size, name.data);</span>
<span class='curline'><a href='../S/5432.html#L220'>session</a>           220 lib/ext/server_name.c gnutls_server_name_get(gnutls_session_t session, void *data,</span>
<span class='curline'><a href='../S/5432.html#L228'>session</a>           228 lib/ext/server_name.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5432.html#L237'>session</a>           237 lib/ext/server_name.c 	    _gnutls_hello_ext_get_datum(session, GNUTLS_EXTENSION_SERVER_NAME, &amp;name);</span>
<span class='curline'><a href='../S/5432.html#L269'>session</a>           269 lib/ext/server_name.c _gnutls_server_name_set_raw(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5432.html#L280'>session</a>           280 lib/ext/server_name.c 	_gnutls_hello_ext_unset_priv(session, GNUTLS_EXTENSION_SERVER_NAME);</span>
<span class='curline'><a href='../S/5432.html#L285'>session</a>           285 lib/ext/server_name.c 	ret = _gnutls_hello_ext_set_datum(session, GNUTLS_EXTENSION_SERVER_NAME, &amp;dname);</span>
<span class='curline'><a href='../S/5432.html#L316'>session</a>           316 lib/ext/server_name.c gnutls_server_name_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5432.html#L323'>session</a>           323 lib/ext/server_name.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5432.html#L329'>session</a>           329 lib/ext/server_name.c 		_gnutls_hello_ext_unset_priv(session, GNUTLS_EXTENSION_SERVER_NAME);</span>
<span class='curline'><a href='../S/5432.html#L342'>session</a>           342 lib/ext/server_name.c 	ret = _gnutls_server_name_set_raw(session, type, name, name_length);</span>
<span class='curline'><a href='../S/5432.html#L348'>session</a>           348 lib/ext/server_name.c unsigned _gnutls_server_name_matches_resumed(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5432.html#L354'>session</a>           354 lib/ext/server_name.c 	    _gnutls_hello_ext_get_datum(session,</span>
<span class='curline'><a href='../S/5432.html#L363'>session</a>           363 lib/ext/server_name.c 	    _gnutls_hello_ext_get_resumed_datum(session,</span>
<span class='curline'><a href='../S/5408.html#L40'>session</a>            40 lib/ext/session_ticket.c static int session_ticket_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5408.html#L43'>session</a>            43 lib/ext/session_ticket.c static int session_ticket_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5408.html#L181'>session</a>           181 lib/ext/session_ticket.c _gnutls_decrypt_session_ticket(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5408.html#L193'>session</a>           193 lib/ext/session_ticket.c 	assert(!(session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS));</span>
<span class='curline'><a href='../S/5408.html#L196'>session</a>           196 lib/ext/session_ticket.c 	if (_gnutls_get_session_ticket_decryption_key(session,</span>
<span class='curline'><a href='../S/5408.html#L270'>session</a>           270 lib/ext/session_ticket.c _gnutls_encrypt_session_ticket(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5408.html#L295'>session</a>           295 lib/ext/session_ticket.c 	if (_gnutls_get_session_ticket_encryption_key(session,</span>
<span class='curline'><a href='../S/5408.html#L358'>session</a>           358 lib/ext/session_ticket.c unpack_session(gnutls_session_t session, const gnutls_datum_t *state)</span>
<span class='curline'><a href='../S/5408.html#L365'>session</a>           365 lib/ext/session_ticket.c 	ret = _gnutls_session_unpack(session, state);</span>
<span class='curline'><a href='../S/5408.html#L369'>session</a>           369 lib/ext/session_ticket.c 	ret = _gnutls_check_resumed_params(session);</span>
<span class='curline'><a href='../S/5408.html#L373'>session</a>           373 lib/ext/session_ticket.c 	session-&gt;internals.resumed = RESUME_TRUE;</span>
<span class='curline'><a href='../S/5408.html#L378'>session</a>           378 lib/ext/session_ticket.c session_ticket_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5408.html#L385'>session</a>           385 lib/ext/session_ticket.c 	if (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS)</span>
<span class='curline'><a href='../S/5408.html#L388'>session</a>           388 lib/ext/session_ticket.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5408.html#L391'>session</a>           391 lib/ext/session_ticket.c 			session-&gt;internals.session_ticket_renew = 1;</span>
<span class='curline'><a href='../S/5408.html#L397'>session</a>           397 lib/ext/session_ticket.c 		if ((ret = _gnutls_decrypt_session_ticket(session, &amp;ticket_data, &amp;state)) == 0) {</span>
<span class='curline'><a href='../S/5408.html#L398'>session</a>           398 lib/ext/session_ticket.c 			ret = unpack_session(session, &amp;state);</span>
<span class='curline'><a href='../S/5408.html#L404'>session</a>           404 lib/ext/session_ticket.c 			session-&gt;internals.session_ticket_renew = 1;</span>
<span class='curline'><a href='../S/5408.html#L410'>session</a>           410 lib/ext/session_ticket.c 			session-&gt;internals.session_ticket_renew = 1;</span>
<span class='curline'><a href='../S/5408.html#L422'>session</a>           422 lib/ext/session_ticket.c session_ticket_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5408.html#L429'>session</a>           429 lib/ext/session_ticket.c 	if (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS)</span>
<span class='curline'><a href='../S/5408.html#L432'>session</a>           432 lib/ext/session_ticket.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5408.html#L433'>session</a>           433 lib/ext/session_ticket.c 		if (session-&gt;internals.session_ticket_renew) {</span>
<span class='curline'><a href='../S/5408.html#L438'>session</a>           438 lib/ext/session_ticket.c 		    _gnutls_hello_ext_get_resumed_priv(session,</span>
<span class='curline'><a href='../S/5408.html#L449'>session</a>           449 lib/ext/session_ticket.c 		if (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS)</span>
<span class='curline'><a href='../S/5408.html#L570'>session</a>           570 lib/ext/session_ticket.c int gnutls_session_ticket_enable_client(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5408.html#L572'>session</a>           572 lib/ext/session_ticket.c 	if (!session) {</span>
<span class='curline'><a href='../S/5408.html#L577'>session</a>           577 lib/ext/session_ticket.c 	session-&gt;internals.flags &amp;= ~GNUTLS_NO_TICKETS;</span>
<span class='curline'><a href='../S/5408.html#L602'>session</a>           602 lib/ext/session_ticket.c gnutls_session_ticket_enable_server(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5408.html#L607'>session</a>           607 lib/ext/session_ticket.c 	if (!session || !key || key-&gt;size != TICKET_MASTER_KEY_SIZE || !key-&gt;data) {</span>
<span class='curline'><a href='../S/5408.html#L612'>session</a>           612 lib/ext/session_ticket.c 	ret = _gnutls_initialize_session_ticket_key_rotation(session, key);</span>
<span class='curline'><a href='../S/5408.html#L616'>session</a>           616 lib/ext/session_ticket.c 	session-&gt;internals.flags &amp;= ~GNUTLS_NO_TICKETS;</span>
<span class='curline'><a href='../S/5408.html#L624'>session</a>           624 lib/ext/session_ticket.c int _gnutls_send_new_session_ticket(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5408.html#L631'>session</a>           631 lib/ext/session_ticket.c 	uint16_t epoch_saved = session-&gt;security_parameters.epoch_write;</span>
<span class='curline'><a href='../S/5408.html#L635'>session</a>           635 lib/ext/session_ticket.c 		if (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS)</span>
<span class='curline'><a href='../S/5408.html#L637'>session</a>           637 lib/ext/session_ticket.c 		if (!session-&gt;internals.session_ticket_renew)</span>
<span class='curline'><a href='../S/5408.html#L641'>session</a>           641 lib/ext/session_ticket.c 		    ("HSK[%p]: sending session ticket\n", session);</span>
<span class='curline'><a href='../S/5408.html#L648'>session</a>           648 lib/ext/session_ticket.c 		    _gnutls_epoch_set_keys(session,</span>
<span class='curline'><a href='../S/5408.html#L649'>session</a>           649 lib/ext/session_ticket.c 					   session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5408.html#L659'>session</a>           659 lib/ext/session_ticket.c 		if (session-&gt;internals.resumed != RESUME_TRUE) {</span>
<span class='curline'><a href='../S/5408.html#L660'>session</a>           660 lib/ext/session_ticket.c 			ret = _gnutls_generate_session_id(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5408.html#L662'>session</a>           662 lib/ext/session_ticket.c 							  &amp;session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5408.html#L670'>session</a>           670 lib/ext/session_ticket.c 		session-&gt;security_parameters.epoch_write =</span>
<span class='curline'><a href='../S/5408.html#L671'>session</a>           671 lib/ext/session_ticket.c 		    session-&gt;security_parameters.epoch_next;</span>
<span class='curline'><a href='../S/5408.html#L674'>session</a>           674 lib/ext/session_ticket.c 		ret = _gnutls_session_pack(session, &amp;state);</span>
<span class='curline'><a href='../S/5408.html#L681'>session</a>           681 lib/ext/session_ticket.c 		ret = _gnutls_encrypt_session_ticket(session, &amp;state, &amp;ticket_data);</span>
<span class='curline'><a href='../S/5408.html#L682'>session</a>           682 lib/ext/session_ticket.c 		session-&gt;security_parameters.epoch_write = epoch_saved;</span>
<span class='curline'><a href='../S/5408.html#L690'>session</a>           690 lib/ext/session_ticket.c 		    _gnutls_handshake_alloc(session, </span>
<span class='curline'><a href='../S/5408.html#L701'>session</a>           701 lib/ext/session_ticket.c 		_gnutls_write_uint32(session-&gt;internals.expire_time, p);</span>
<span class='curline'><a href='../S/5408.html#L714'>session</a>           714 lib/ext/session_ticket.c 		session-&gt;internals.hsk_flags |= HSK_TLS12_TICKET_SENT;</span>
<span class='curline'><a href='../S/5408.html#L716'>session</a>           716 lib/ext/session_ticket.c 	return _gnutls_send_handshake(session, data_size ? bufel : NULL,</span>
<span class='curline'><a href='../S/5408.html#L723'>session</a>           723 lib/ext/session_ticket.c int _gnutls_recv_new_session_ticket(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5408.html#L733'>session</a>           733 lib/ext/session_ticket.c 	if (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS)</span>
<span class='curline'><a href='../S/5408.html#L735'>session</a>           735 lib/ext/session_ticket.c 	if (!session-&gt;internals.session_ticket_renew)</span>
<span class='curline'><a href='../S/5408.html#L741'>session</a>           741 lib/ext/session_ticket.c 	if (IS_DTLS(session) &amp;&amp; !_dtls_is_async(session)) {</span>
<span class='curline'><a href='../S/5408.html#L745'>session</a>           745 lib/ext/session_ticket.c 		have = gnutls_record_check_pending(session) +</span>
<span class='curline'><a href='../S/5408.html#L746'>session</a>           746 lib/ext/session_ticket.c 		       record_check_unprocessed(session);</span>
<span class='curline'><a href='../S/5408.html#L749'>session</a>           749 lib/ext/session_ticket.c 			bufel = _mbuffer_head_get_first(&amp;session-&gt;internals.record_buffer, NULL);</span>
<span class='curline'><a href='../S/5408.html#L753'>session</a>           753 lib/ext/session_ticket.c 			ret = _dtls_wait_and_retransmit(session);</span>
<span class='curline'><a href='../S/5408.html#L759'>session</a>           759 lib/ext/session_ticket.c 	ret = _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5408.html#L806'>session</a>           806 lib/ext/session_ticket.c 	    _gnutls_generate_session_id(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5408.html#L808'>session</a>           808 lib/ext/session_ticket.c 					&amp;session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5408.html#L819'>session</a>           819 lib/ext/session_ticket.c 		    ("HSK[%p]: received session ticket\n", session);</span>
<span class='curline'><a href='../S/5408.html#L820'>session</a>           820 lib/ext/session_ticket.c 	session-&gt;internals.hsk_flags |= HSK_TICKET_RECEIVED;</span>
<span class='curline'><a href='../S/5408.html#L822'>session</a>           822 lib/ext/session_ticket.c 	_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5448.html#L30'>session</a>            30 lib/ext/session_ticket.h int _gnutls_send_new_session_ticket(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5448.html#L31'>session</a>            31 lib/ext/session_ticket.h int _gnutls_recv_new_session_ticket(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5448.html#L33'>session</a>            33 lib/ext/session_ticket.h int _gnutls_encrypt_session_ticket(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5448.html#L36'>session</a>            36 lib/ext/session_ticket.h int _gnutls_decrypt_session_ticket(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5399.html#L47'>session</a>            47 lib/ext/signature.c 						   session,</span>
<span class='curline'><a href='../S/5399.html#L51'>session</a>            51 lib/ext/signature.c 						   session,</span>
<span class='curline'><a href='../S/5399.html#L84'>session</a>            84 lib/ext/signature.c _gnutls_sign_algorithm_write_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5399.html#L99'>session</a>            99 lib/ext/signature.c 	for (i=0;i&lt;session-&gt;internals.priorities-&gt;sigalg.size;i++) {</span>
<span class='curline'><a href='../S/5399.html#L100'>session</a>           100 lib/ext/signature.c 		aid = &amp;session-&gt;internals.priorities-&gt;sigalg.entry[i]-&gt;aid;</span>
<span class='curline'><a href='../S/5399.html#L109'>session</a>           109 lib/ext/signature.c 		if (session-&gt;security_parameters.cs &amp;&amp;</span>
<span class='curline'><a href='../S/5399.html#L110'>session</a>           110 lib/ext/signature.c 		    _gnutls_kx_is_vko_gost(session-&gt;security_parameters.cs-&gt;kx_algorithm) &amp;&amp;</span>
<span class='curline'><a href='../S/5399.html#L111'>session</a>           111 lib/ext/signature.c 		    !_sign_is_gost(session-&gt;internals.priorities-&gt;sigalg.entry[i]))</span>
<span class='curline'><a href='../S/5399.html#L115'>session</a>           115 lib/ext/signature.c 		    ("EXT[%p]: sent signature algo (%d.%d) %s\n", session,</span>
<span class='curline'><a href='../S/5399.html#L117'>session</a>           117 lib/ext/signature.c 		     session-&gt;internals.priorities-&gt;sigalg.entry[i]-&gt;name);</span>
<span class='curline'><a href='../S/5399.html#L140'>session</a>           140 lib/ext/signature.c _gnutls_sign_algorithm_parse_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5399.html#L146'>session</a>           146 lib/ext/signature.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5399.html#L173'>session</a>           173 lib/ext/signature.c 		    ("EXT[%p]: rcvd signature algo (%d.%d) %s\n", session,</span>
<span class='curline'><a href='../S/5399.html#L186'>session</a>           186 lib/ext/signature.c 	_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5399.html#L203'>session</a>           203 lib/ext/signature.c _gnutls_signature_algorithm_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5399.html#L209'>session</a>           209 lib/ext/signature.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5399.html#L231'>session</a>           231 lib/ext/signature.c 			    _gnutls_sign_algorithm_parse_data(session,</span>
<span class='curline'><a href='../S/5399.html#L249'>session</a>           249 lib/ext/signature.c _gnutls_signature_algorithm_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5399.html#L254'>session</a>           254 lib/ext/signature.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5399.html#L260'>session</a>           260 lib/ext/signature.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT</span>
<span class='curline'><a href='../S/5399.html#L262'>session</a>           262 lib/ext/signature.c 		if (session-&gt;internals.priorities-&gt;sigalg.size &gt; 0) {</span>
<span class='curline'><a href='../S/5399.html#L264'>session</a>           264 lib/ext/signature.c 			    _gnutls_sign_algorithm_write_params(session, extdata);</span>
<span class='curline'><a href='../S/5399.html#L302'>session</a>           302 lib/ext/signature.c _gnutls_session_get_sign_algo(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5399.html#L310'>session</a>           310 lib/ext/signature.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5399.html#L322'>session</a>           322 lib/ext/signature.c 	    _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5399.html#L344'>session</a>           344 lib/ext/signature.c 		_gnutls_handshake_log("EXT[%p]: GOST KX, but no GOST SigAlgs received, patching up.", session);</span>
<span class='curline'><a href='../S/5399.html#L357'>session</a>           357 lib/ext/signature.c 		if (!client_cert &amp;&amp; _gnutls_session_sign_algo_enabled(session, ret) &lt; 0)</span>
<span class='curline'><a href='../S/5399.html#L367'>session</a>           367 lib/ext/signature.c 		if (!client_cert &amp;&amp; _gnutls_session_sign_algo_enabled(session, ret) &lt; 0)</span>
<span class='curline'><a href='../S/5399.html#L386'>session</a>           386 lib/ext/signature.c 			    (session, cert-&gt;pubkey, ver, se-&gt;id) &lt; 0)</span>
<span class='curline'><a href='../S/5399.html#L390'>session</a>           390 lib/ext/signature.c 			    (session, se-&gt;id) &lt; 0)</span>
<span class='curline'><a href='../S/5399.html#L401'>session</a>           401 lib/ext/signature.c 		_gnutls_audit_log(session, "No shared signature schemes with peer for client certificate (%s). Is the certificate a legacy one?\n",</span>
<span class='curline'><a href='../S/5399.html#L414'>session</a>           414 lib/ext/signature.c _gnutls_session_sign_algo_enabled(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5399.html#L418'>session</a>           418 lib/ext/signature.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5399.html#L438'>session</a>           438 lib/ext/signature.c 	for (i = 0; i &lt; session-&gt;internals.priorities-&gt;sigalg.size; i++) {</span>
<span class='curline'><a href='../S/5399.html#L439'>session</a>           439 lib/ext/signature.c 		if (session-&gt;internals.priorities-&gt;sigalg.entry[i]-&gt;id == sig) {</span>
<span class='curline'><a href='../S/5399.html#L521'>session</a>           521 lib/ext/signature.c gnutls_sign_algorithm_get_requested(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5399.html#L525'>session</a>           525 lib/ext/signature.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5399.html#L534'>session</a>           534 lib/ext/signature.c 	    _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5399.html#L567'>session</a>           567 lib/ext/signature.c int gnutls_sign_algorithm_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5399.html#L569'>session</a>           569 lib/ext/signature.c 	return session-&gt;security_parameters.server_sign_algo;</span>
<span class='curline'><a href='../S/5399.html#L584'>session</a>           584 lib/ext/signature.c int gnutls_sign_algorithm_get_client(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5399.html#L586'>session</a>           586 lib/ext/signature.c 	return session-&gt;security_parameters.client_sign_algo;</span>
<span class='curline'><a href='../S/5400.html#L34'>session</a>            34 lib/ext/signature.h _gnutls_session_get_sign_algo(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5400.html#L39'>session</a>            39 lib/ext/signature.h int _gnutls_sign_algorithm_parse_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5400.html#L42'>session</a>            42 lib/ext/signature.h int _gnutls_sign_algorithm_write_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5400.html#L44'>session</a>            44 lib/ext/signature.h int _gnutls_session_sign_algo_enabled(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5400.html#L48'>session</a>            48 lib/ext/signature.h gnutls_sign_algorithm_set_server(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5400.html#L51'>session</a>            51 lib/ext/signature.h 	session-&gt;security_parameters.server_sign_algo = sign;</span>
<span class='curline'><a href='../S/5400.html#L55'>session</a>            55 lib/ext/signature.h gnutls_sign_algorithm_set_client(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5400.html#L58'>session</a>            58 lib/ext/signature.h 	session-&gt;security_parameters.client_sign_algo = sign;</span>
<span class='curline'><a href='../S/5410.html#L62'>session</a>            62 lib/ext/srp.c  _gnutls_srp_recv_params(gnutls_session_t session, const uint8_t * data,</span>
<span class='curline'><a href='../S/5410.html#L69'>session</a>            69 lib/ext/srp.c  	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5410.html#L95'>session</a>            95 lib/ext/srp.c  			_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5410.html#L103'>session</a>           103 lib/ext/srp.c  static unsigned have_srp_ciphersuites(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5410.html#L108'>session</a>           108 lib/ext/srp.c  	for (j = 0; j &lt; session-&gt;internals.priorities-&gt;cs.size; j++) {</span>
<span class='curline'><a href='../S/5410.html#L109'>session</a>           109 lib/ext/srp.c  		kx = session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5410.html#L121'>session</a>           121 lib/ext/srp.c  _gnutls_srp_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5410.html#L131'>session</a>           131 lib/ext/srp.c  		    _gnutls_get_cred(session, GNUTLS_CRD_SRP);</span>
<span class='curline'><a href='../S/5410.html#L133'>session</a>           133 lib/ext/srp.c  	if (session-&gt;security_parameters.entity != GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5410.html#L139'>session</a>           139 lib/ext/srp.c  	if (!have_srp_ciphersuites(session)) {</span>
<span class='curline'><a href='../S/5410.html#L174'>session</a>           174 lib/ext/srp.c  		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5410.html#L184'>session</a>           184 lib/ext/srp.c  		    get_function(session, &amp;username, &amp;password) &lt; 0</span>
<span class='curline'><a href='../S/5410.html#L205'>session</a>           205 lib/ext/srp.c  		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5445.html#L29'>session</a>            29 lib/ext/srtp.c static int _gnutls_srtp_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5445.html#L32'>session</a>            32 lib/ext/srtp.c static int _gnutls_srtp_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5445.html#L165'>session</a>           165 lib/ext/srtp.c _gnutls_srtp_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5445.html#L177'>session</a>           177 lib/ext/srtp.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRTP,</span>
<span class='curline'><a href='../S/5445.html#L192'>session</a>           192 lib/ext/srtp.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5445.html#L234'>session</a>           234 lib/ext/srtp.c _gnutls_srtp_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5445.html#L243'>session</a>           243 lib/ext/srtp.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRTP,</span>
<span class='curline'><a href='../S/5445.html#L253'>session</a>           253 lib/ext/srtp.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5445.html#L309'>session</a>           309 lib/ext/srtp.c gnutls_srtp_get_selected_profile(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5445.html#L317'>session</a>           317 lib/ext/srtp.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRTP,</span>
<span class='curline'><a href='../S/5445.html#L349'>session</a>           349 lib/ext/srtp.c int gnutls_srtp_get_mki(gnutls_session_t session, gnutls_datum_t * mki)</span>
<span class='curline'><a href='../S/5445.html#L356'>session</a>           356 lib/ext/srtp.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRTP,</span>
<span class='curline'><a href='../S/5445.html#L390'>session</a>           390 lib/ext/srtp.c gnutls_srtp_set_mki(gnutls_session_t session, const gnutls_datum_t * mki)</span>
<span class='curline'><a href='../S/5445.html#L397'>session</a>           397 lib/ext/srtp.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRTP,</span>
<span class='curline'><a href='../S/5445.html#L406'>session</a>           406 lib/ext/srtp.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5445.html#L434'>session</a>           434 lib/ext/srtp.c gnutls_srtp_set_profile(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5445.html#L442'>session</a>           442 lib/ext/srtp.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRTP,</span>
<span class='curline'><a href='../S/5445.html#L451'>session</a>           451 lib/ext/srtp.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5445.html#L479'>session</a>           479 lib/ext/srtp.c gnutls_srtp_set_profile_direct(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5445.html#L490'>session</a>           490 lib/ext/srtp.c 	    _gnutls_hello_ext_get_priv(session, GNUTLS_EXTENSION_SRTP,</span>
<span class='curline'><a href='../S/5445.html#L524'>session</a>           524 lib/ext/srtp.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5445.html#L553'>session</a>           553 lib/ext/srtp.c gnutls_srtp_get_keys(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5445.html#L567'>session</a>           567 lib/ext/srtp.c 	ret = gnutls_srtp_get_selected_profile(session, &amp;profile);</span>
<span class='curline'><a href='../S/5445.html#L583'>session</a>           583 lib/ext/srtp.c 	    gnutls_prf(session, sizeof("EXTRACTOR-dtls_srtp") - 1,</span>
<span class='curline'><a href='../S/5436.html#L70'>session</a>            70 lib/ext/status_request.c client_send(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5436.html#L83'>session</a>            83 lib/ext/status_request.c 	session-&gt;internals.hsk_flags |= HSK_OCSP_REQUESTED;</span>
<span class='curline'><a href='../S/5436.html#L89'>session</a>            89 lib/ext/status_request.c server_recv(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5436.html#L105'>session</a>           105 lib/ext/status_request.c 				      session, data[0]);</span>
<span class='curline'><a href='../S/5436.html#L122'>session</a>           122 lib/ext/status_request.c 	_gnutls_handshake_log("EXT[%p]: OCSP status was requested\n", session);</span>
<span class='curline'><a href='../S/5436.html#L123'>session</a>           123 lib/ext/status_request.c 	session-&gt;internals.hsk_flags |= HSK_OCSP_REQUESTED;</span>
<span class='curline'><a href='../S/5436.html#L130'>session</a>           130 lib/ext/status_request.c client_recv(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5436.html#L165'>session</a>           165 lib/ext/status_request.c server_send(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5436.html#L172'>session</a>           172 lib/ext/status_request.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5436.html#L175'>session</a>           175 lib/ext/status_request.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5436.html#L186'>session</a>           186 lib/ext/status_request.c 	if (session-&gt;internals.selected_ocsp_length &gt; 0) {</span>
<span class='curline'><a href='../S/5436.html#L187'>session</a>           187 lib/ext/status_request.c 		if (session-&gt;internals.selected_ocsp[0].response.data) {</span>
<span class='curline'><a href='../S/5436.html#L188'>session</a>           188 lib/ext/status_request.c 			if (session-&gt;internals.selected_ocsp[0].exptime != 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5436.html#L189'>session</a>           189 lib/ext/status_request.c 			    (gnutls_time(0) &gt;= session-&gt;internals.selected_ocsp[0].exptime)) {</span>
<span class='curline'><a href='../S/5436.html#L195'>session</a>           195 lib/ext/status_request.c 						session-&gt;internals.selected_ocsp[0].response.data,</span>
<span class='curline'><a href='../S/5436.html#L196'>session</a>           196 lib/ext/status_request.c 						session-&gt;internals.selected_ocsp[0].response.size);</span>
<span class='curline'><a href='../S/5436.html#L203'>session</a>           203 lib/ext/status_request.c 	} else if (session-&gt;internals.selected_ocsp_func) {</span>
<span class='curline'><a href='../S/5436.html#L204'>session</a>           204 lib/ext/status_request.c 		func = session-&gt;internals.selected_ocsp_func;</span>
<span class='curline'><a href='../S/5436.html#L205'>session</a>           205 lib/ext/status_request.c 		func_ptr = session-&gt;internals.selected_ocsp_func_ptr;</span>
<span class='curline'><a href='../S/5436.html#L210'>session</a>           210 lib/ext/status_request.c 		ret = func(session, func_ptr, &amp;priv-&gt;sresp);</span>
<span class='curline'><a href='../S/5436.html#L223'>session</a>           223 lib/ext/status_request.c _gnutls_status_request_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5436.html#L232'>session</a>           232 lib/ext/status_request.c 	if (_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE) == NULL)</span>
<span class='curline'><a href='../S/5436.html#L235'>session</a>           235 lib/ext/status_request.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5436.html#L236'>session</a>           236 lib/ext/status_request.c 		ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5436.html#L243'>session</a>           243 lib/ext/status_request.c 		return client_send(session, extdata, priv);</span>
<span class='curline'><a href='../S/5436.html#L249'>session</a>           249 lib/ext/status_request.c 		_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5436.html#L253'>session</a>           253 lib/ext/status_request.c 		return server_send(session, extdata, priv);</span>
<span class='curline'><a href='../S/5436.html#L258'>session</a>           258 lib/ext/status_request.c _gnutls_status_request_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5436.html#L265'>session</a>           265 lib/ext/status_request.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5436.html#L266'>session</a>           266 lib/ext/status_request.c 		ret = _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5436.html#L273'>session</a>           273 lib/ext/status_request.c 		return client_recv(session, priv, data, size);</span>
<span class='curline'><a href='../S/5436.html#L275'>session</a>           275 lib/ext/status_request.c 		return server_recv(session, data, size);</span>
<span class='curline'><a href='../S/5436.html#L301'>session</a>           301 lib/ext/status_request.c gnutls_ocsp_status_request_enable_client(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5436.html#L309'>session</a>           309 lib/ext/status_request.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5436.html#L316'>session</a>           316 lib/ext/status_request.c 	_gnutls_hello_ext_set_priv(session,</span>
<span class='curline'><a href='../S/5436.html#L352'>session</a>           352 lib/ext/status_request.c _gnutls_send_server_certificate_status(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5436.html#L361'>session</a>           361 lib/ext/status_request.c 	if (!(session-&gt;internals.hsk_flags &amp; HSK_OCSP_REQUESTED))</span>
<span class='curline'><a href='../S/5436.html#L366'>session</a>           366 lib/ext/status_request.c 		    _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5436.html#L379'>session</a>           379 lib/ext/status_request.c 		    _gnutls_handshake_alloc(session, data_size);</span>
<span class='curline'><a href='../S/5436.html#L393'>session</a>           393 lib/ext/status_request.c 	return _gnutls_send_handshake(session, data_size ? bufel : NULL,</span>
<span class='curline'><a href='../S/5436.html#L397'>session</a>           397 lib/ext/status_request.c int _gnutls_parse_ocsp_response(gnutls_session_t session, const uint8_t *data, ssize_t data_size, gnutls_datum_t *resp)</span>
<span class='curline'><a href='../S/5436.html#L413'>session</a>           413 lib/ext/status_request.c 				      session, data[0]);</span>
<span class='curline'><a href='../S/5436.html#L441'>session</a>           441 lib/ext/status_request.c int _gnutls_recv_server_certificate_status(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5436.html#L450'>session</a>           450 lib/ext/status_request.c 	cert_auth_info_t info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5436.html#L456'>session</a>           456 lib/ext/status_request.c 	    _gnutls_hello_ext_get_priv(session,</span>
<span class='curline'><a href='../S/5436.html#L467'>session</a>           467 lib/ext/status_request.c 	ret = _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5436.html#L483'>session</a>           483 lib/ext/status_request.c 	ret = _gnutls_parse_ocsp_response(session, data, data_size, &amp;resp);</span>
<span class='curline'><a href='../S/5441.html#L33'>session</a>            33 lib/ext/status_request.h _gnutls_send_server_certificate_status(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5441.html#L35'>session</a>            35 lib/ext/status_request.h int _gnutls_recv_server_certificate_status(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5441.html#L37'>session</a>            37 lib/ext/status_request.h int _gnutls_parse_ocsp_response(gnutls_session_t session, const uint8_t *data,</span>
<span class='curline'><a href='../S/5401.html#L38'>session</a>            38 lib/ext/supported_groups.c static int _gnutls_supported_groups_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5401.html#L41'>session</a>            41 lib/ext/supported_groups.c static int _gnutls_supported_groups_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5401.html#L62'>session</a>            62 lib/ext/supported_groups.c static unsigned get_min_dh(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5401.html#L69'>session</a>            69 lib/ext/supported_groups.c 	cert_cred = (gnutls_certificate_credentials_t)_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5401.html#L70'>session</a>            70 lib/ext/supported_groups.c 	psk_cred = (gnutls_psk_server_credentials_t)_gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5401.html#L71'>session</a>            71 lib/ext/supported_groups.c 	anon_cred = (gnutls_anon_server_credentials_t)_gnutls_get_cred(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5401.html#L96'>session</a>            96 lib/ext/supported_groups.c _gnutls_supported_groups_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5401.html#L110'>session</a>           110 lib/ext/supported_groups.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5401.html#L132'>session</a>           132 lib/ext/supported_groups.c 		min_dh = get_min_dh(session);</span>
<span class='curline'><a href='../S/5401.html#L146'>session</a>           146 lib/ext/supported_groups.c 			_gnutls_handshake_log("EXT[%p]: Received group %s (0x%x)\n", session, group?group-&gt;name:"unknown", tls_id);</span>
<span class='curline'><a href='../S/5401.html#L155'>session</a>           155 lib/ext/supported_groups.c 			for (j = 0; j &lt; session-&gt;internals.priorities-&gt;groups.size; j++) {</span>
<span class='curline'><a href='../S/5401.html#L156'>session</a>           156 lib/ext/supported_groups.c 				if (session-&gt;internals.priorities-&gt;groups.entry[j]-&gt;id == group-&gt;id) {</span>
<span class='curline'><a href='../S/5401.html#L157'>session</a>           157 lib/ext/supported_groups.c 					if (session-&gt;internals.priorities-&gt;server_precedence) {</span>
<span class='curline'><a href='../S/5401.html#L190'>session</a>           190 lib/ext/supported_groups.c 			session-&gt;internals.cand_dh_group = session-&gt;internals.priorities-&gt;groups.entry[serv_dh_idx];</span>
<span class='curline'><a href='../S/5401.html#L191'>session</a>           191 lib/ext/supported_groups.c 			session-&gt;internals.cand_group = session-&gt;internals.cand_dh_group;</span>
<span class='curline'><a href='../S/5401.html#L195'>session</a>           195 lib/ext/supported_groups.c 			session-&gt;internals.cand_ec_group = session-&gt;internals.priorities-&gt;groups.entry[serv_ec_idx];</span>
<span class='curline'><a href='../S/5401.html#L196'>session</a>           196 lib/ext/supported_groups.c 			if (session-&gt;internals.cand_group == NULL ||</span>
<span class='curline'><a href='../S/5401.html#L197'>session</a>           197 lib/ext/supported_groups.c 			    (session-&gt;internals.priorities-&gt;server_precedence &amp;&amp; serv_ec_idx &lt; serv_dh_idx) ||</span>
<span class='curline'><a href='../S/5401.html#L198'>session</a>           198 lib/ext/supported_groups.c 			    (!session-&gt;internals.priorities-&gt;server_precedence &amp;&amp; cli_ec_pos &lt; cli_dh_pos)) {</span>
<span class='curline'><a href='../S/5401.html#L199'>session</a>           199 lib/ext/supported_groups.c 				session-&gt;internals.cand_group = session-&gt;internals.cand_ec_group;</span>
<span class='curline'><a href='../S/5401.html#L203'>session</a>           203 lib/ext/supported_groups.c 		if (session-&gt;internals.cand_group)</span>
<span class='curline'><a href='../S/5401.html#L204'>session</a>           204 lib/ext/supported_groups.c 			_gnutls_handshake_log("EXT[%p]: Selected group %s\n", session, session-&gt;internals.cand_group-&gt;name);</span>
<span class='curline'><a href='../S/5401.html#L207'>session</a>           207 lib/ext/supported_groups.c 			session-&gt;internals.hsk_flags |= HSK_HAVE_FFDHE;</span>
<span class='curline'><a href='../S/5401.html#L216'>session</a>           216 lib/ext/supported_groups.c _gnutls_supported_groups_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5401.html#L224'>session</a>           224 lib/ext/supported_groups.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5401.html#L226'>session</a>           226 lib/ext/supported_groups.c 		len = session-&gt;internals.priorities-&gt;groups.size;</span>
<span class='curline'><a href='../S/5401.html#L235'>session</a>           235 lib/ext/supported_groups.c 				p = session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;tls_id;</span>
<span class='curline'><a href='../S/5401.html#L237'>session</a>           237 lib/ext/supported_groups.c 				_gnutls_handshake_log("EXT[%p]: Sent group %s (0x%x)\n", session,</span>
<span class='curline'><a href='../S/5401.html#L238'>session</a>           238 lib/ext/supported_groups.c 					session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;name, (unsigned)p);</span>
<span class='curline'><a href='../S/5401.html#L258'>session</a>           258 lib/ext/supported_groups.c _gnutls_session_supports_group(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5401.html#L263'>session</a>           263 lib/ext/supported_groups.c 	for (i = 0; i &lt; session-&gt;internals.priorities-&gt;groups.size; i++) {</span>
<span class='curline'><a href='../S/5401.html#L264'>session</a>           264 lib/ext/supported_groups.c 		if (session-&gt;internals.priorities-&gt;groups.entry[i]-&gt;id == group)</span>
<span class='curline'><a href='../S/5427.html#L31'>session</a>            31 lib/ext/supported_groups.h _gnutls_session_supports_group(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5416.html#L34'>session</a>            34 lib/ext/supported_versions.c static int supported_versions_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5416.html#L37'>session</a>            37 lib/ext/supported_versions.c static int supported_versions_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5416.html#L57'>session</a>            57 lib/ext/supported_versions.c supported_versions_recv_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5416.html#L65'>session</a>            65 lib/ext/supported_versions.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5416.html#L69'>session</a>            69 lib/ext/supported_versions.c 		vers = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5416.html#L70'>session</a>            70 lib/ext/supported_versions.c 		old_vers = get_version(session);</span>
<span class='curline'><a href='../S/5416.html#L97'>session</a>            97 lib/ext/supported_versions.c 					      session, (int)major, (int)minor);</span>
<span class='curline'><a href='../S/5416.html#L99'>session</a>            99 lib/ext/supported_versions.c 			if (!_gnutls_nversion_is_supported(session, major, minor))</span>
<span class='curline'><a href='../S/5416.html#L117'>session</a>           117 lib/ext/supported_versions.c 		session-&gt;security_parameters.pversion = cli_vers;</span>
<span class='curline'><a href='../S/5416.html#L120'>session</a>           120 lib/ext/supported_versions.c 				      session,</span>
<span class='curline'><a href='../S/5416.html#L128'>session</a>           128 lib/ext/supported_versions.c 			ret = _gnutls_gen_server_random(session, cli_vers-&gt;id);</span>
<span class='curline'><a href='../S/5416.html#L136'>session</a>           136 lib/ext/supported_versions.c 		if (!have_creds_for_tls13(session)) {</span>
<span class='curline'><a href='../S/5416.html#L156'>session</a>           156 lib/ext/supported_versions.c 		set_adv_version(session, major, minor);</span>
<span class='curline'><a href='../S/5416.html#L159'>session</a>           159 lib/ext/supported_versions.c 				      session, (int)major, (int)minor);</span>
<span class='curline'><a href='../S/5416.html#L164'>session</a>           164 lib/ext/supported_versions.c 		ret = _gnutls_negotiate_version(session, major, minor, 1);</span>
<span class='curline'><a href='../S/5416.html#L177'>session</a>           177 lib/ext/supported_versions.c supported_versions_send_params(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5416.html#L186'>session</a>           186 lib/ext/supported_versions.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5416.html#L187'>session</a>           187 lib/ext/supported_versions.c 		vers = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5416.html#L192'>session</a>           192 lib/ext/supported_versions.c 		if (!have_creds_for_tls13(session)) {</span>
<span class='curline'><a href='../S/5416.html#L205'>session</a>           205 lib/ext/supported_versions.c 		ret = _gnutls_write_supported_versions(session, versions, sizeof(versions));</span>
<span class='curline'><a href='../S/5416.html#L217'>session</a>           217 lib/ext/supported_versions.c 		vers = get_version(session);</span>
<span class='curline'><a href='../S/5822.html#L175'>session</a>           175 lib/gnutls_int.h #define IS_SERVER(session) (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5822.html#L178'>session</a>           178 lib/gnutls_int.h #define IS_DTLS(session) (session-&gt;internals.transport == GNUTLS_DGRAM)</span>
<span class='curline'><a href='../S/5822.html#L185'>session</a>           185 lib/gnutls_int.h #define RECORD_HEADER_SIZE(session) (IS_DTLS(session) ? DTLS_RECORD_HEADER_SIZE : TLS_RECORD_HEADER_SIZE)</span>
<span class='curline'><a href='../S/5822.html#L195'>session</a>           195 lib/gnutls_int.h #define MAX_RECORD_SEND_OVERHEAD(session) (MAX_CIPHER_BLOCK_SIZE/*iv*/+MAX_PAD_SIZE+MAX_HASH_SIZE/*MAC*/)</span>
<span class='curline'><a href='../S/5822.html#L196'>session</a>           196 lib/gnutls_int.h #define MAX_RECORD_SEND_SIZE(session) (IS_DTLS(session)? \</span>
<span class='curline'><a href='../S/5822.html#L197'>session</a>           197 lib/gnutls_int.h 	(MIN((size_t)gnutls_dtls_get_mtu(session), (size_t)session-&gt;security_parameters.max_record_send_size+MAX_RECORD_SEND_OVERHEAD(session))): \</span>
<span class='curline'><a href='../S/5822.html#L198'>session</a>           198 lib/gnutls_int.h 	((size_t)session-&gt;security_parameters.max_record_send_size+MAX_RECORD_SEND_OVERHEAD(session)))</span>
<span class='curline'><a href='../S/5822.html#L204'>session</a>           204 lib/gnutls_int.h #define HANDSHAKE_HEADER_SIZE(session) (IS_DTLS(session) ? DTLS_HANDSHAKE_HEADER_SIZE : TLS_HANDSHAKE_HEADER_SIZE)</span>
<span class='curline'><a href='../S/5822.html#L276'>session</a>           276 lib/gnutls_int.h #define TICKET_STATE session-&gt;internals.ticket_state</span>
<span class='curline'><a href='../S/5822.html#L277'>session</a>           277 lib/gnutls_int.h #define BYE_STATE session-&gt;internals.bye_state</span>
<span class='curline'><a href='../S/5822.html#L278'>session</a>           278 lib/gnutls_int.h #define REAUTH_STATE session-&gt;internals.reauth_state</span>
<span class='curline'><a href='../S/5822.html#L1418'>session</a>          1418 lib/gnutls_int.h #define ADD_PROFILE_VFLAGS(session, vflags) do { \</span>
<span class='curline'><a href='../S/5822.html#L1419'>session</a>          1419 lib/gnutls_int.h 	if ((session-&gt;internals.additional_verify_flags &amp; GNUTLS_VFLAGS_PROFILE_MASK) &amp;&amp; \</span>
<span class='curline'><a href='../S/5822.html#L1421'>session</a>          1421 lib/gnutls_int.h 		session-&gt;internals.additional_verify_flags &amp;= ~GNUTLS_VFLAGS_PROFILE_MASK; \</span>
<span class='curline'><a href='../S/5822.html#L1422'>session</a>          1422 lib/gnutls_int.h 	session-&gt;internals.additional_verify_flags |= vflags; \</span>
<span class='curline'><a href='../S/5822.html#L1493'>session</a>          1493 lib/gnutls_int.h #define reset_cand_groups(session) \</span>
<span class='curline'><a href='../S/5822.html#L1494'>session</a>          1494 lib/gnutls_int.h 	session-&gt;internals.cand_ec_group = session-&gt;internals.cand_dh_group = \</span>
<span class='curline'><a href='../S/5822.html#L1495'>session</a>          1495 lib/gnutls_int.h 		session-&gt;internals.cand_group = NULL</span>
<span class='curline'><a href='../S/5822.html#L1507'>session</a>          1507 lib/gnutls_int.h void _gnutls_free_auth_info(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5822.html#L1512'>session</a>          1512 lib/gnutls_int.h #define _gnutls_get_adv_version_major(session) \</span>
<span class='curline'><a href='../S/5822.html#L1513'>session</a>          1513 lib/gnutls_int.h 	session-&gt;internals.adv_version_major</span>
<span class='curline'><a href='../S/5822.html#L1515'>session</a>          1515 lib/gnutls_int.h #define _gnutls_get_adv_version_minor(session) \</span>
<span class='curline'><a href='../S/5822.html#L1516'>session</a>          1516 lib/gnutls_int.h 	session-&gt;internals.adv_version_minor</span>
<span class='curline'><a href='../S/5822.html#L1518'>session</a>          1518 lib/gnutls_int.h #define set_adv_version(session, major, minor) \</span>
<span class='curline'><a href='../S/5822.html#L1519'>session</a>          1519 lib/gnutls_int.h 	session-&gt;internals.adv_version_major = major; \</span>
<span class='curline'><a href='../S/5822.html#L1520'>session</a>          1520 lib/gnutls_int.h 	session-&gt;internals.adv_version_minor = minor</span>
<span class='curline'><a href='../S/5822.html#L1524'>session</a>          1524 lib/gnutls_int.h inline static const version_entry_st *get_version(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5822.html#L1526'>session</a>          1526 lib/gnutls_int.h 	return session-&gt;security_parameters.pversion;</span>
<span class='curline'><a href='../S/5822.html#L1529'>session</a>          1529 lib/gnutls_int.h inline static unsigned get_num_version(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5822.html#L1531'>session</a>          1531 lib/gnutls_int.h 	if (likely(session-&gt;security_parameters.pversion != NULL))</span>
<span class='curline'><a href='../S/5822.html#L1532'>session</a>          1532 lib/gnutls_int.h 		return session-&gt;security_parameters.pversion-&gt;id;</span>
<span class='curline'><a href='../S/5822.html#L1571'>session</a>          1571 lib/gnutls_int.h inline static size_t max_record_send_size(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5822.html#L1577'>session</a>          1577 lib/gnutls_int.h 	max = MIN(session-&gt;security_parameters.max_record_send_size,</span>
<span class='curline'><a href='../S/5822.html#L1578'>session</a>          1578 lib/gnutls_int.h 		  session-&gt;security_parameters.max_user_record_send_size);</span>
<span class='curline'><a href='../S/5822.html#L1580'>session</a>          1580 lib/gnutls_int.h 	if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5822.html#L1581'>session</a>          1581 lib/gnutls_int.h 		max = MIN(gnutls_dtls_get_data_mtu(session), max);</span>
<span class='curline'><a href='../S/5822.html#L1592'>session</a>          1592 lib/gnutls_int.h get_certificate_type(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5822.html#L1597'>session</a>          1597 lib/gnutls_int.h 			return session-&gt;security_parameters.client_ctype;</span>
<span class='curline'><a href='../S/5822.html#L1600'>session</a>          1600 lib/gnutls_int.h 			return session-&gt;security_parameters.server_ctype;</span>
<span class='curline'><a href='../S/5822.html#L1603'>session</a>          1603 lib/gnutls_int.h 			if (IS_SERVER(session)) {</span>
<span class='curline'><a href='../S/5822.html#L1604'>session</a>          1604 lib/gnutls_int.h 				return session-&gt;security_parameters.server_ctype;</span>
<span class='curline'><a href='../S/5822.html#L1606'>session</a>          1606 lib/gnutls_int.h 				return session-&gt;security_parameters.client_ctype;</span>
<span class='curline'><a href='../S/5822.html#L1610'>session</a>          1610 lib/gnutls_int.h 			if (IS_SERVER(session)) {</span>
<span class='curline'><a href='../S/5822.html#L1611'>session</a>          1611 lib/gnutls_int.h 				return session-&gt;security_parameters.client_ctype;</span>
<span class='curline'><a href='../S/5822.html#L1613'>session</a>          1613 lib/gnutls_int.h 				return session-&gt;security_parameters.server_ctype;</span>
<span class='curline'><a href='../S/5262.html#L39'>session</a>            39 lib/gnutlsxx.cpp   session::session (unsigned int flags)</span>
<span class='curline'><a href='../S/5262.html#L44'>session</a>            44 lib/gnutlsxx.cpp   session::~session ()</span>
<span class='curline'><a href='../S/5262.html#L49'>session</a>            49 lib/gnutlsxx.cpp   gnutls_session_t session::ptr()</span>
<span class='curline'><a href='../S/5262.html#L54'>session</a>            54 lib/gnutlsxx.cpp   int session::bye (gnutls_close_request_t how)</span>
<span class='curline'><a href='../S/5262.html#L59'>session</a>            59 lib/gnutlsxx.cpp   int session::handshake ()</span>
<span class='curline'><a href='../S/5262.html#L64'>session</a>            64 lib/gnutlsxx.cpp   server_session::server_session ():session (GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5262.html#L68'>session</a>            68 lib/gnutlsxx.cpp   server_session::server_session (int flags):session (GNUTLS_SERVER |</span>
<span class='curline'><a href='../S/5262.html#L82'>session</a>            82 lib/gnutlsxx.cpp   gnutls_alert_description_t session::get_alert () const</span>
<span class='curline'><a href='../S/5262.html#L87'>session</a>            87 lib/gnutlsxx.cpp   int session::send_alert (gnutls_alert_level_t level,</span>
<span class='curline'><a href='../S/5262.html#L93'>session</a>            93 lib/gnutlsxx.cpp   int session::send_appropriate_alert (int err)</span>
<span class='curline'><a href='../S/5262.html#L98'>session</a>            98 lib/gnutlsxx.cpp   gnutls_cipher_algorithm_t session::get_cipher () const</span>
<span class='curline'><a href='../S/5262.html#L103'>session</a>           103 lib/gnutlsxx.cpp   gnutls_kx_algorithm_t session::get_kx () const</span>
<span class='curline'><a href='../S/5262.html#L108'>session</a>           108 lib/gnutlsxx.cpp   gnutls_mac_algorithm_t session::get_mac () const</span>
<span class='curline'><a href='../S/5262.html#L113'>session</a>           113 lib/gnutlsxx.cpp   gnutls_compression_method_t session::get_compression () const</span>
<span class='curline'><a href='../S/5262.html#L118'>session</a>           118 lib/gnutlsxx.cpp   gnutls_certificate_type_t session::get_certificate_type () const</span>
<span class='curline'><a href='../S/5262.html#L123'>session</a>           123 lib/gnutlsxx.cpp   void session::set_private_extensions (bool allow)</span>
<span class='curline'><a href='../S/5262.html#L128'>session</a>           128 lib/gnutlsxx.cpp   gnutls_handshake_description_t session::get_handshake_last_out () const</span>
<span class='curline'><a href='../S/5262.html#L133'>session</a>           133 lib/gnutlsxx.cpp   gnutls_handshake_description_t session::get_handshake_last_in () const</span>
<span class='curline'><a href='../S/5262.html#L138'>session</a>           138 lib/gnutlsxx.cpp   ssize_t session::send (const void *data, size_t sizeofdata)</span>
<span class='curline'><a href='../S/5262.html#L143'>session</a>           143 lib/gnutlsxx.cpp   ssize_t session::recv (void *data, size_t sizeofdata)</span>
<span class='curline'><a href='../S/5262.html#L148'>session</a>           148 lib/gnutlsxx.cpp   bool session::get_record_direction () const</span>
<span class='curline'><a href='../S/5262.html#L154'>session</a>           154 lib/gnutlsxx.cpp   size_t session::get_max_size () const</span>
<span class='curline'><a href='../S/5262.html#L159'>session</a>           159 lib/gnutlsxx.cpp   void session::set_max_size (size_t size)</span>
<span class='curline'><a href='../S/5262.html#L164'>session</a>           164 lib/gnutlsxx.cpp   size_t session::check_pending () const</span>
<span class='curline'><a href='../S/5262.html#L170'>session</a>           170 lib/gnutlsxx.cpp   void session::prf (size_t label_size, const char *label,</span>
<span class='curline'><a href='../S/5262.html#L179'>session</a>           179 lib/gnutlsxx.cpp   void session::prf_raw (size_t label_size, const char *label,</span>
<span class='curline'><a href='../S/5262.html#L190'>session</a>           190 lib/gnutlsxx.cpp   void session::set_priority (const char *prio, const char **err_pos)</span>
<span class='curline'><a href='../S/5262.html#L195'>session</a>           195 lib/gnutlsxx.cpp   void session::set_priority (gnutls_priority_t p)</span>
<span class='curline'><a href='../S/5262.html#L200'>session</a>           200 lib/gnutlsxx.cpp   gnutls_protocol_t session::get_protocol_version () const</span>
<span class='curline'><a href='../S/5262.html#L205'>session</a>           205 lib/gnutlsxx.cpp   void session::set_data (const void *session_data, size_t session_data_size)</span>
<span class='curline'><a href='../S/5262.html#L210'>session</a>           210 lib/gnutlsxx.cpp   void session::get_data (void *session_data, size_t * session_data_size) const</span>
<span class='curline'><a href='../S/5262.html#L215'>session</a>           215 lib/gnutlsxx.cpp   void session::get_data (gnutls_session_t session, gnutls_datum_t &amp; data) const</span>
<span class='curline'><a href='../S/5262.html#L221'>session</a>           221 lib/gnutlsxx.cpp   void session::get_id (void *session_id, size_t * session_id_size) const</span>
<span class='curline'><a href='../S/5262.html#L226'>session</a>           226 lib/gnutlsxx.cpp   bool session::is_resumed () const</span>
<span class='curline'><a href='../S/5262.html#L233'>session</a>           233 lib/gnutlsxx.cpp   bool session::get_peers_certificate (std::vector &lt; gnutls_datum_t &gt;</span>
<span class='curline'><a href='../S/5262.html#L250'>session</a>           250 lib/gnutlsxx.cpp   bool session::get_peers_certificate (const gnutls_datum_t ** certs,</span>
<span class='curline'><a href='../S/5262.html#L260'>session</a>           260 lib/gnutlsxx.cpp   void session::get_our_certificate (gnutls_datum_t &amp; cert) const</span>
<span class='curline'><a href='../S/5262.html#L271'>session</a>           271 lib/gnutlsxx.cpp   time_t session::get_peers_certificate_activation_time () const</span>
<span class='curline'><a href='../S/5262.html#L276'>session</a>           276 lib/gnutlsxx.cpp   time_t session::get_peers_certificate_expiration_time () const</span>
<span class='curline'><a href='../S/5262.html#L280'>session</a>           280 lib/gnutlsxx.cpp   void session::verify_peers_certificate (unsigned int &amp;status) const</span>
<span class='curline'><a href='../S/5262.html#L286'>session</a>           286 lib/gnutlsxx.cpp   client_session::client_session ():session (GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5262.html#L290'>session</a>           290 lib/gnutlsxx.cpp   client_session::client_session (int flags):session (GNUTLS_CLIENT |</span>
<span class='curline'><a href='../S/5262.html#L409'>session</a>           409 lib/gnutlsxx.cpp   void session::set_max_handshake_packet_length (size_t max)</span>
<span class='curline'><a href='../S/5262.html#L414'>session</a>           414 lib/gnutlsxx.cpp   void session::clear_credentials ()</span>
<span class='curline'><a href='../S/5262.html#L419'>session</a>           419 lib/gnutlsxx.cpp   void session::set_credentials (credentials &amp; cred)</span>
<span class='curline'><a href='../S/5262.html#L439'>session</a>           439 lib/gnutlsxx.cpp   void session::set_transport_ptr (gnutls_transport_ptr_t ptr)</span>
<span class='curline'><a href='../S/5262.html#L444'>session</a>           444 lib/gnutlsxx.cpp   void session::set_transport_ptr (gnutls_transport_ptr_t recv_ptr,</span>
<span class='curline'><a href='../S/5262.html#L451'>session</a>           451 lib/gnutlsxx.cpp   gnutls_transport_ptr_t session::get_transport_ptr () const</span>
<span class='curline'><a href='../S/5262.html#L456'>session</a>           456 lib/gnutlsxx.cpp   void session::get_transport_ptr (gnutls_transport_ptr_t &amp; recv_ptr,</span>
<span class='curline'><a href='../S/5262.html#L462'>session</a>           462 lib/gnutlsxx.cpp   void session::set_transport_lowat (size_t num)</span>
<span class='curline'><a href='../S/5262.html#L467'>session</a>           467 lib/gnutlsxx.cpp   void session::set_transport_push_function (gnutls_push_func push_func)</span>
<span class='curline'><a href='../S/5262.html#L472'>session</a>           472 lib/gnutlsxx.cpp   void session::set_transport_vec_push_function (gnutls_vec_push_func vec_push_func)</span>
<span class='curline'><a href='../S/5262.html#L477'>session</a>           477 lib/gnutlsxx.cpp   void session::set_transport_pull_function (gnutls_pull_func pull_func)</span>
<span class='curline'><a href='../S/5262.html#L482'>session</a>           482 lib/gnutlsxx.cpp   void session::set_transport_pull_timeout_function (gnutls_pull_timeout_func pull_timeout_func)</span>
<span class='curline'><a href='../S/5262.html#L487'>session</a>           487 lib/gnutlsxx.cpp   void session::set_user_ptr (void *ptr)</span>
<span class='curline'><a href='../S/5262.html#L492'>session</a>           492 lib/gnutlsxx.cpp   void *session::get_user_ptr () const</span>
<span class='curline'><a href='../S/5262.html#L497'>session</a>           497 lib/gnutlsxx.cpp   void session::send_openpgp_cert (gnutls_openpgp_crt_status_t status)</span>
<span class='curline'><a href='../S/5262.html#L504'>session</a>           504 lib/gnutlsxx.cpp   void session::set_dh_prime_bits (unsigned int bits)</span>
<span class='curline'><a href='../S/5262.html#L509'>session</a>           509 lib/gnutlsxx.cpp   unsigned int session::get_dh_secret_bits () const</span>
<span class='curline'><a href='../S/5262.html#L514'>session</a>           514 lib/gnutlsxx.cpp   unsigned int session::get_dh_peers_public_bits () const</span>
<span class='curline'><a href='../S/5262.html#L519'>session</a>           519 lib/gnutlsxx.cpp   unsigned int session::get_dh_prime_bits () const</span>
<span class='curline'><a href='../S/5262.html#L524'>session</a>           524 lib/gnutlsxx.cpp   void session::get_dh_group (gnutls_datum_t &amp; gen,</span>
<span class='curline'><a href='../S/5262.html#L530'>session</a>           530 lib/gnutlsxx.cpp   void session::get_dh_pubkey (gnutls_datum_t &amp; raw_key) const</span>
<span class='curline'><a href='../S/5262.html#L536'>session</a>           536 lib/gnutlsxx.cpp   void session::get_rsa_export_pubkey (gnutls_datum_t &amp; exponent,</span>
<span class='curline'><a href='../S/5262.html#L542'>session</a>           542 lib/gnutlsxx.cpp   unsigned int session::get_rsa_export_modulus_bits () const</span>
<span class='curline'><a href='../S/5262.html#L560'>session</a>           560 lib/gnutlsxx.cpp   gnutls_credentials_type_t session::get_auth_type () const</span>
<span class='curline'><a href='../S/5262.html#L565'>session</a>           565 lib/gnutlsxx.cpp   gnutls_credentials_type_t session::get_server_auth_type () const</span>
<span class='curline'><a href='../S/5262.html#L570'>session</a>           570 lib/gnutlsxx.cpp   gnutls_credentials_type_t session::get_client_auth_type () const</span>
<span class='curline'><a href='../S/5288.html#L41'>session</a>            41 lib/handshake-checks.c int _gnutls_check_id_for_change(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5288.html#L47'>session</a>            47 lib/handshake-checks.c 	if (session-&gt;internals.flags &amp; GNUTLS_ALLOW_ID_CHANGE)</span>
<span class='curline'><a href='../S/5288.html#L50'>session</a>            50 lib/handshake-checks.c 	cred_type = gnutls_auth_get_type(session);</span>
<span class='curline'><a href='../S/5288.html#L58'>session</a>            58 lib/handshake-checks.c 			ai = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5288.html#L66'>session</a>            66 lib/handshake-checks.c 			srp_server_auth_info_t ai = _gnutls_get_auth_info(session, GNUTLS_CRD_SRP);</span>
<span class='curline'><a href='../S/5288.html#L78'>session</a>            78 lib/handshake-checks.c 		if (session-&gt;internals.saved_username_size != -1) {</span>
<span class='curline'><a href='../S/5288.html#L79'>session</a>            79 lib/handshake-checks.c 			if (session-&gt;internals.saved_username_size == username_length &amp;&amp;</span>
<span class='curline'><a href='../S/5288.html#L80'>session</a>            80 lib/handshake-checks.c 			    strncmp(session-&gt;internals.saved_username, username, username_length) != 0) {</span>
<span class='curline'><a href='../S/5288.html#L85'>session</a>            85 lib/handshake-checks.c 			memcpy(session-&gt;internals.saved_username, username, username_length);</span>
<span class='curline'><a href='../S/5288.html#L86'>session</a>            86 lib/handshake-checks.c 			session-&gt;internals.saved_username[username_length] = 0;</span>
<span class='curline'><a href='../S/5288.html#L87'>session</a>            87 lib/handshake-checks.c 			session-&gt;internals.saved_username_size = username_length;</span>
<span class='curline'><a href='../S/5288.html#L94'>session</a>            94 lib/handshake-checks.c int _gnutls_check_if_cert_hash_is_same(gnutls_session_t session, gnutls_certificate_credentials_t cred)</span>
<span class='curline'><a href='../S/5288.html#L100'>session</a>           100 lib/handshake-checks.c 	if (session-&gt;internals.flags &amp; GNUTLS_ALLOW_ID_CHANGE)</span>
<span class='curline'><a href='../S/5288.html#L103'>session</a>           103 lib/handshake-checks.c 	ai = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5288.html#L114'>session</a>           114 lib/handshake-checks.c 	if (session-&gt;internals.cert_hash_set) {</span>
<span class='curline'><a href='../S/5288.html#L115'>session</a>           115 lib/handshake-checks.c 		if (memcmp(tmp, session-&gt;internals.cert_hash, 32) != 0) {</span>
<span class='curline'><a href='../S/5288.html#L120'>session</a>           120 lib/handshake-checks.c 		memcpy(session-&gt;internals.cert_hash, tmp, 32);</span>
<span class='curline'><a href='../S/5288.html#L121'>session</a>           121 lib/handshake-checks.c 		session-&gt;internals.cert_hash_set = 1;</span>
<span class='curline'><a href='../S/5752.html#L61'>session</a>            61 lib/handshake-tls13.c static int generate_rms_keys(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5752.html#L62'>session</a>            62 lib/handshake-tls13.c static int generate_hs_traffic_keys(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5752.html#L63'>session</a>            63 lib/handshake-tls13.c static int generate_ap_traffic_keys(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5752.html#L66'>session</a>            66 lib/handshake-tls13.c 	if (session-&gt;internals.flags &amp; GNUTLS_POST_HANDSHAKE_AUTH) { \</span>
<span class='curline'><a href='../S/5752.html#L69'>session</a>            69 lib/handshake-tls13.c 		memcpy( &amp;session-&gt;internals.post_handshake_hash_buffer, \</span>
<span class='curline'><a href='../S/5752.html#L70'>session</a>            70 lib/handshake-tls13.c 			&amp;session-&gt;internals.handshake_hash_buffer, \</span>
<span class='curline'><a href='../S/5752.html#L71'>session</a>            71 lib/handshake-tls13.c 			sizeof(session-&gt;internals.handshake_hash_buffer)); \</span>
<span class='curline'><a href='../S/5752.html#L72'>session</a>            72 lib/handshake-tls13.c 		_gnutls_buffer_init(&amp;session-&gt;internals.handshake_hash_buffer); \</span>
<span class='curline'><a href='../S/5752.html#L79'>session</a>            79 lib/handshake-tls13.c int _gnutls13_handshake_client(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5752.html#L89'>session</a>            89 lib/handshake-tls13.c 		ret = _gnutls_send_change_cipher_spec(session, AGAIN(STATE100));</span>
<span class='curline'><a href='../S/5752.html#L98'>session</a>            98 lib/handshake-tls13.c 		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_IN_FLIGHT) {</span>
<span class='curline'><a href='../S/5752.html#L99'>session</a>            99 lib/handshake-tls13.c 			ret = _tls13_write_connection_state_init(session, STAGE_EARLY);</span>
<span class='curline'><a href='../S/5752.html#L101'>session</a>           101 lib/handshake-tls13.c 				_gnutls_epoch_bump(session);</span>
<span class='curline'><a href='../S/5752.html#L102'>session</a>           102 lib/handshake-tls13.c 				ret = _gnutls_epoch_dup(session, EPOCH_WRITE_CURRENT);</span>
<span class='curline'><a href='../S/5752.html#L109'>session</a>           109 lib/handshake-tls13.c 		ret = _gnutls13_send_early_data(session);</span>
<span class='curline'><a href='../S/5752.html#L115'>session</a>           115 lib/handshake-tls13.c 		ret = generate_hs_traffic_keys(session);</span>
<span class='curline'><a href='../S/5752.html#L120'>session</a>           120 lib/handshake-tls13.c 		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_IN_FLIGHT)</span>
<span class='curline'><a href='../S/5752.html#L121'>session</a>           121 lib/handshake-tls13.c 			ret = _tls13_read_connection_state_init(session, STAGE_HS);</span>
<span class='curline'><a href='../S/5752.html#L123'>session</a>           123 lib/handshake-tls13.c 			ret = _tls13_connection_state_init(session, STAGE_HS);</span>
<span class='curline'><a href='../S/5752.html#L127'>session</a>           127 lib/handshake-tls13.c 		ret = _gnutls13_recv_encrypted_extensions(session);</span>
<span class='curline'><a href='../S/5752.html#L132'>session</a>           132 lib/handshake-tls13.c 		ret = _gnutls13_recv_certificate_request(session);</span>
<span class='curline'><a href='../S/5752.html#L137'>session</a>           137 lib/handshake-tls13.c 		ret = _gnutls13_recv_certificate(session);</span>
<span class='curline'><a href='../S/5752.html#L142'>session</a>           142 lib/handshake-tls13.c 		ret = _gnutls13_recv_certificate_verify(session);</span>
<span class='curline'><a href='../S/5752.html#L147'>session</a>           147 lib/handshake-tls13.c 		ret = _gnutls_run_verify_callback(session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5752.html#L153'>session</a>           153 lib/handshake-tls13.c 		ret = _gnutls13_recv_finished(session);</span>
<span class='curline'><a href='../S/5752.html#L158'>session</a>           158 lib/handshake-tls13.c 		ret = _gnutls13_send_end_of_early_data(session, AGAIN(STATE110));</span>
<span class='curline'><a href='../S/5752.html#L165'>session</a>           165 lib/handshake-tls13.c 		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_IN_FLIGHT) {</span>
<span class='curline'><a href='../S/5752.html#L166'>session</a>           166 lib/handshake-tls13.c 			session-&gt;internals.hsk_flags &amp;= ~HSK_EARLY_DATA_IN_FLIGHT;</span>
<span class='curline'><a href='../S/5752.html#L167'>session</a>           167 lib/handshake-tls13.c 			ret = _tls13_write_connection_state_init(session, STAGE_HS);</span>
<span class='curline'><a href='../S/5752.html#L172'>session</a>           172 lib/handshake-tls13.c 		ret = _gnutls13_send_certificate(session, AGAIN(STATE111));</span>
<span class='curline'><a href='../S/5752.html#L177'>session</a>           177 lib/handshake-tls13.c 		ret = _gnutls13_send_certificate_verify(session, AGAIN(STATE112));</span>
<span class='curline'><a href='../S/5752.html#L182'>session</a>           182 lib/handshake-tls13.c 		ret = _gnutls13_send_finished(session, AGAIN(STATE113));</span>
<span class='curline'><a href='../S/5752.html#L190'>session</a>           190 lib/handshake-tls13.c 		    generate_ap_traffic_keys(session);</span>
<span class='curline'><a href='../S/5752.html#L193'>session</a>           193 lib/handshake-tls13.c 		ret = generate_rms_keys(session);</span>
<span class='curline'><a href='../S/5752.html#L197'>session</a>           197 lib/handshake-tls13.c 		ret = _tls13_connection_state_init(session, STAGE_APP);</span>
<span class='curline'><a href='../S/5752.html#L208'>session</a>           208 lib/handshake-tls13.c 	session-&gt;internals.recv_state = RECV_STATE_0;</span>
<span class='curline'><a href='../S/5752.html#L209'>session</a>           209 lib/handshake-tls13.c 	session-&gt;internals.initial_negotiation_completed = 1;</span>
<span class='curline'><a href='../S/5752.html#L213'>session</a>           213 lib/handshake-tls13.c 	if (session-&gt;internals.resumed != RESUME_FALSE)</span>
<span class='curline'><a href='../S/5752.html#L214'>session</a>           214 lib/handshake-tls13.c 		_gnutls_set_resumed_parameters(session);</span>
<span class='curline'><a href='../S/5752.html#L219'>session</a>           219 lib/handshake-tls13.c static int generate_non_auth_rms_keys(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5752.html#L226'>session</a>           226 lib/handshake-tls13.c 	ret = _gnutls13_compute_finished(session-&gt;security_parameters.prf,</span>
<span class='curline'><a href='../S/5752.html#L227'>session</a>           227 lib/handshake-tls13.c 					 session-&gt;key.proto.tls13.hs_ckey,</span>
<span class='curline'><a href='../S/5752.html#L228'>session</a>           228 lib/handshake-tls13.c 					 &amp;session-&gt;internals.handshake_hash_buffer,</span>
<span class='curline'><a href='../S/5752.html#L233'>session</a>           233 lib/handshake-tls13.c 	spos = session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5752.html#L236'>session</a>           236 lib/handshake-tls13.c 	_gnutls_write_uint24(session-&gt;security_parameters.prf-&gt;output_size, finished+1);</span>
<span class='curline'><a href='../S/5752.html#L238'>session</a>           238 lib/handshake-tls13.c 	ret = _gnutls_buffer_append_data(&amp;session-&gt;internals.handshake_hash_buffer, finished,</span>
<span class='curline'><a href='../S/5752.html#L239'>session</a>           239 lib/handshake-tls13.c 					 TLS_HANDSHAKE_HEADER_SIZE+session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5752.html#L243'>session</a>           243 lib/handshake-tls13.c 	ret = _tls13_derive_secret(session, RMS_MASTER_LABEL, sizeof(RMS_MASTER_LABEL)-1,</span>
<span class='curline'><a href='../S/5752.html#L244'>session</a>           244 lib/handshake-tls13.c 				   session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5752.html#L245'>session</a>           245 lib/handshake-tls13.c 				   session-&gt;internals.handshake_hash_buffer.length,</span>
<span class='curline'><a href='../S/5752.html#L246'>session</a>           246 lib/handshake-tls13.c 				   session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5752.html#L247'>session</a>           247 lib/handshake-tls13.c 				   session-&gt;key.proto.tls13.ap_rms);</span>
<span class='curline'><a href='../S/5752.html#L251'>session</a>           251 lib/handshake-tls13.c 	session-&gt;internals.handshake_hash_buffer.length = spos;</span>
<span class='curline'><a href='../S/5752.html#L256'>session</a>           256 lib/handshake-tls13.c static int generate_rms_keys(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5752.html#L260'>session</a>           260 lib/handshake-tls13.c 	ret = _tls13_derive_secret(session, RMS_MASTER_LABEL, sizeof(RMS_MASTER_LABEL)-1,</span>
<span class='curline'><a href='../S/5752.html#L261'>session</a>           261 lib/handshake-tls13.c 				   session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5752.html#L262'>session</a>           262 lib/handshake-tls13.c 				   session-&gt;internals.handshake_hash_buffer_client_finished_len,</span>
<span class='curline'><a href='../S/5752.html#L263'>session</a>           263 lib/handshake-tls13.c 				   session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5752.html#L264'>session</a>           264 lib/handshake-tls13.c 				   session-&gt;key.proto.tls13.ap_rms);</span>
<span class='curline'><a href='../S/5752.html#L271'>session</a>           271 lib/handshake-tls13.c static int generate_ap_traffic_keys(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5752.html#L276'>session</a>           276 lib/handshake-tls13.c 	ret = _tls13_derive_secret(session, DERIVED_LABEL, sizeof(DERIVED_LABEL)-1,</span>
<span class='curline'><a href='../S/5752.html#L277'>session</a>           277 lib/handshake-tls13.c 				   NULL, 0, session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5752.html#L278'>session</a>           278 lib/handshake-tls13.c 				   session-&gt;key.proto.tls13.temp_secret);</span>
<span class='curline'><a href='../S/5752.html#L282'>session</a>           282 lib/handshake-tls13.c 	memset(zero, 0, session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5752.html#L283'>session</a>           283 lib/handshake-tls13.c 	ret = _tls13_update_secret(session, zero, session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5752.html#L287'>session</a>           287 lib/handshake-tls13.c 	ret = _tls13_derive_secret(session, EXPORTER_MASTER_LABEL, sizeof(EXPORTER_MASTER_LABEL)-1,</span>
<span class='curline'><a href='../S/5752.html#L288'>session</a>           288 lib/handshake-tls13.c 				   session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5752.html#L289'>session</a>           289 lib/handshake-tls13.c 				   session-&gt;internals.handshake_hash_buffer_server_finished_len,</span>
<span class='curline'><a href='../S/5752.html#L290'>session</a>           290 lib/handshake-tls13.c 				   session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5752.html#L291'>session</a>           291 lib/handshake-tls13.c 				   session-&gt;key.proto.tls13.ap_expkey);</span>
<span class='curline'><a href='../S/5752.html#L295'>session</a>           295 lib/handshake-tls13.c 	ret = _gnutls_call_keylog_func(session, "EXPORTER_SECRET",</span>
<span class='curline'><a href='../S/5752.html#L296'>session</a>           296 lib/handshake-tls13.c 				       session-&gt;key.proto.tls13.ap_expkey,</span>
<span class='curline'><a href='../S/5752.html#L297'>session</a>           297 lib/handshake-tls13.c 				       session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5752.html#L301'>session</a>           301 lib/handshake-tls13.c 	_gnutls_epoch_bump(session);</span>
<span class='curline'><a href='../S/5752.html#L302'>session</a>           302 lib/handshake-tls13.c 	ret = _gnutls_epoch_dup(session, EPOCH_READ_CURRENT);</span>
<span class='curline'><a href='../S/5752.html#L309'>session</a>           309 lib/handshake-tls13.c static int generate_hs_traffic_keys(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5752.html#L314'>session</a>           314 lib/handshake-tls13.c 	if (unlikely(session-&gt;key.proto.tls13.temp_secret_size == 0))</span>
<span class='curline'><a href='../S/5752.html#L317'>session</a>           317 lib/handshake-tls13.c 	ret = _tls13_derive_secret(session, DERIVED_LABEL, sizeof(DERIVED_LABEL)-1,</span>
<span class='curline'><a href='../S/5752.html#L318'>session</a>           318 lib/handshake-tls13.c 				   NULL, 0, session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5752.html#L319'>session</a>           319 lib/handshake-tls13.c 				   session-&gt;key.proto.tls13.temp_secret);</span>
<span class='curline'><a href='../S/5752.html#L325'>session</a>           325 lib/handshake-tls13.c 	if ((session-&gt;security_parameters.entity == GNUTLS_CLIENT &amp;&amp;</span>
<span class='curline'><a href='../S/5752.html#L326'>session</a>           326 lib/handshake-tls13.c 	      (!(session-&gt;internals.hsk_flags &amp; HSK_KEY_SHARE_RECEIVED) ||</span>
<span class='curline'><a href='../S/5752.html#L327'>session</a>           327 lib/handshake-tls13.c 	        (!(session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_DHE_PSK) &amp;&amp;</span>
<span class='curline'><a href='../S/5752.html#L328'>session</a>           328 lib/handshake-tls13.c 	           session-&gt;internals.resumed != RESUME_FALSE))) ||</span>
<span class='curline'><a href='../S/5752.html#L329'>session</a>           329 lib/handshake-tls13.c 	    (session-&gt;security_parameters.entity == GNUTLS_SERVER &amp;&amp;</span>
<span class='curline'><a href='../S/5752.html#L330'>session</a>           330 lib/handshake-tls13.c 	      !(session-&gt;internals.hsk_flags &amp; HSK_KEY_SHARE_SENT))) {</span>
<span class='curline'><a href='../S/5752.html#L332'>session</a>           332 lib/handshake-tls13.c 		if ((session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED) &amp;&amp;</span>
<span class='curline'><a href='../S/5752.html#L333'>session</a>           333 lib/handshake-tls13.c 		    (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_PSK)) {</span>
<span class='curline'><a href='../S/5752.html#L342'>session</a>           342 lib/handshake-tls13.c 		if (unlikely(session-&gt;security_parameters.prf == NULL))</span>
<span class='curline'><a href='../S/5752.html#L345'>session</a>           345 lib/handshake-tls13.c 		digest_size = session-&gt;security_parameters.prf-&gt;output_size;</span>
<span class='curline'><a href='../S/5752.html#L348'>session</a>           348 lib/handshake-tls13.c 		ret = _tls13_update_secret(session, digest, digest_size);</span>
<span class='curline'><a href='../S/5752.html#L354'>session</a>           354 lib/handshake-tls13.c 		if (unlikely(session-&gt;key.key.size == 0))</span>
<span class='curline'><a href='../S/5752.html#L357'>session</a>           357 lib/handshake-tls13.c 		ret = _tls13_update_secret(session, session-&gt;key.key.data, session-&gt;key.key.size);</span>
<span class='curline'><a href='../S/5752.html#L371'>session</a>           371 lib/handshake-tls13.c int _gnutls13_handshake_server(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5752.html#L377'>session</a>           377 lib/handshake-tls13.c 		ret = _gnutls13_handshake_hash_buffers_synth(session, session-&gt;security_parameters.prf, 0);</span>
<span class='curline'><a href='../S/5752.html#L382'>session</a>           382 lib/handshake-tls13.c 		ret = _gnutls13_send_hello_retry_request(session, AGAIN(STATE91));</span>
<span class='curline'><a href='../S/5752.html#L388'>session</a>           388 lib/handshake-tls13.c 		ret = _gnutls_send_change_cipher_spec(session, AGAIN(STATE92));</span>
<span class='curline'><a href='../S/5752.html#L395'>session</a>           395 lib/handshake-tls13.c 		    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5752.html#L410'>session</a>           410 lib/handshake-tls13.c 		ret = _gnutls_send_server_hello(session, AGAIN(STATE94));</span>
<span class='curline'><a href='../S/5752.html#L419'>session</a>           419 lib/handshake-tls13.c 		if (!(session-&gt;internals.hsk_flags &amp; HSK_HRR_SENT)) {</span>
<span class='curline'><a href='../S/5752.html#L420'>session</a>           420 lib/handshake-tls13.c 			ret = _gnutls_send_change_cipher_spec(session, AGAIN(STATE100));</span>
<span class='curline'><a href='../S/5752.html#L428'>session</a>           428 lib/handshake-tls13.c 		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_ACCEPTED) {</span>
<span class='curline'><a href='../S/5752.html#L429'>session</a>           429 lib/handshake-tls13.c 			ret = _tls13_read_connection_state_init(session, STAGE_EARLY);</span>
<span class='curline'><a href='../S/5752.html#L431'>session</a>           431 lib/handshake-tls13.c 				_gnutls_epoch_bump(session);</span>
<span class='curline'><a href='../S/5752.html#L432'>session</a>           432 lib/handshake-tls13.c 				ret = _gnutls_epoch_dup(session, EPOCH_READ_CURRENT);</span>
<span class='curline'><a href='../S/5752.html#L436'>session</a>           436 lib/handshake-tls13.c 			ret = generate_hs_traffic_keys(session);</span>
<span class='curline'><a href='../S/5752.html#L439'>session</a>           439 lib/handshake-tls13.c 			ret = _tls13_write_connection_state_init(session, STAGE_HS);</span>
<span class='curline'><a href='../S/5752.html#L441'>session</a>           441 lib/handshake-tls13.c 			ret = generate_hs_traffic_keys(session);</span>
<span class='curline'><a href='../S/5752.html#L444'>session</a>           444 lib/handshake-tls13.c 			ret = _tls13_connection_state_init(session, STAGE_HS);</span>
<span class='curline'><a href='../S/5752.html#L449'>session</a>           449 lib/handshake-tls13.c 		ret = _gnutls13_send_encrypted_extensions(session, AGAIN(STATE102));</span>
<span class='curline'><a href='../S/5752.html#L454'>session</a>           454 lib/handshake-tls13.c 		ret = _gnutls13_send_certificate_request(session, AGAIN(STATE103));</span>
<span class='curline'><a href='../S/5752.html#L459'>session</a>           459 lib/handshake-tls13.c 		ret = _gnutls13_send_certificate(session, AGAIN(STATE104));</span>
<span class='curline'><a href='../S/5752.html#L464'>session</a>           464 lib/handshake-tls13.c 		ret = _gnutls13_send_certificate_verify(session, AGAIN(STATE105));</span>
<span class='curline'><a href='../S/5752.html#L469'>session</a>           469 lib/handshake-tls13.c 		ret = _gnutls13_send_finished(session, AGAIN(STATE106));</span>
<span class='curline'><a href='../S/5752.html#L474'>session</a>           474 lib/handshake-tls13.c 		ret = _gnutls13_recv_end_of_early_data(session);</span>
<span class='curline'><a href='../S/5752.html#L478'>session</a>           478 lib/handshake-tls13.c 		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_ACCEPTED) {</span>
<span class='curline'><a href='../S/5752.html#L479'>session</a>           479 lib/handshake-tls13.c 			ret = _tls13_read_connection_state_init(session, STAGE_HS);</span>
<span class='curline'><a href='../S/5752.html#L487'>session</a>           487 lib/handshake-tls13.c 		    generate_ap_traffic_keys(session);</span>
<span class='curline'><a href='../S/5752.html#L492'>session</a>           492 lib/handshake-tls13.c 		if (!(session-&gt;internals.hsk_flags &amp; (HSK_CRT_REQ_SENT|HSK_PSK_SELECTED))) {</span>
<span class='curline'><a href='../S/5752.html#L495'>session</a>           495 lib/handshake-tls13.c 			ret = generate_non_auth_rms_keys(session);</span>
<span class='curline'><a href='../S/5752.html#L498'>session</a>           498 lib/handshake-tls13.c 			session-&gt;internals.hsk_flags |= HSK_EARLY_START_USED;</span>
<span class='curline'><a href='../S/5752.html#L499'>session</a>           499 lib/handshake-tls13.c 			_gnutls_handshake_log("HSK[%p]: unauthenticated session eligible for early start\n", session);</span>
<span class='curline'><a href='../S/5752.html#L502'>session</a>           502 lib/handshake-tls13.c 		ret = _tls13_write_connection_state_init(session, STAGE_APP);</span>
<span class='curline'><a href='../S/5752.html#L505'>session</a>           505 lib/handshake-tls13.c 		_gnutls_handshake_log("HSK[%p]: switching early to application traffic keys\n", session);</span>
<span class='curline'><a href='../S/5752.html#L509'>session</a>           509 lib/handshake-tls13.c 		if (session-&gt;internals.resumed != RESUME_FALSE)</span>
<span class='curline'><a href='../S/5752.html#L510'>session</a>           510 lib/handshake-tls13.c 			_gnutls_set_resumed_parameters(session);</span>
<span class='curline'><a href='../S/5752.html#L512'>session</a>           512 lib/handshake-tls13.c 		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_START_USED) {</span>
<span class='curline'><a href='../S/5752.html#L513'>session</a>           513 lib/handshake-tls13.c 			if (!(session-&gt;internals.flags &amp; GNUTLS_NO_AUTO_SEND_TICKET))</span>
<span class='curline'><a href='../S/5752.html#L514'>session</a>           514 lib/handshake-tls13.c 				ret = _gnutls13_send_session_ticket(session, TLS13_TICKETS_TO_SEND,</span>
<span class='curline'><a href='../S/5752.html#L524'>session</a>           524 lib/handshake-tls13.c 			if (session-&gt;internals.flags &amp; GNUTLS_ENABLE_EARLY_START) {</span>
<span class='curline'><a href='../S/5752.html#L528'>session</a>           528 lib/handshake-tls13.c 				session-&gt;internals.recv_state = RECV_STATE_EARLY_START;</span>
<span class='curline'><a href='../S/5752.html#L534'>session</a>           534 lib/handshake-tls13.c 		ret = _gnutls13_recv_certificate(session);</span>
<span class='curline'><a href='../S/5752.html#L539'>session</a>           539 lib/handshake-tls13.c 		ret = _gnutls13_recv_certificate_verify(session);</span>
<span class='curline'><a href='../S/5752.html#L544'>session</a>           544 lib/handshake-tls13.c 		ret = _gnutls_run_verify_callback(session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5752.html#L550'>session</a>           550 lib/handshake-tls13.c 		ret = _gnutls13_recv_finished(session);</span>
<span class='curline'><a href='../S/5752.html#L559'>session</a>           559 lib/handshake-tls13.c 		if (!(session-&gt;internals.hsk_flags &amp; HSK_EARLY_START_USED)) {</span>
<span class='curline'><a href='../S/5752.html#L560'>session</a>           560 lib/handshake-tls13.c 			ret = generate_rms_keys(session);</span>
<span class='curline'><a href='../S/5752.html#L564'>session</a>           564 lib/handshake-tls13.c 		ret = _tls13_read_connection_state_init(session, STAGE_APP);</span>
<span class='curline'><a href='../S/5752.html#L569'>session</a>           569 lib/handshake-tls13.c 		if (!(session-&gt;internals.hsk_flags &amp; (HSK_TLS13_TICKET_SENT|HSK_EARLY_START_USED)) &amp;&amp;</span>
<span class='curline'><a href='../S/5752.html#L570'>session</a>           570 lib/handshake-tls13.c 		    !(session-&gt;internals.flags &amp; GNUTLS_NO_AUTO_SEND_TICKET)) {</span>
<span class='curline'><a href='../S/5752.html#L571'>session</a>           571 lib/handshake-tls13.c 			ret = _gnutls13_send_session_ticket(session, TLS13_TICKETS_TO_SEND,</span>
<span class='curline'><a href='../S/5752.html#L584'>session</a>           584 lib/handshake-tls13.c 	gnutls_mutex_lock(&amp;session-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5752.html#L585'>session</a>           585 lib/handshake-tls13.c 	session-&gt;internals.recv_state = RECV_STATE_0;</span>
<span class='curline'><a href='../S/5752.html#L586'>session</a>           586 lib/handshake-tls13.c 	session-&gt;internals.initial_negotiation_completed = 1;</span>
<span class='curline'><a href='../S/5752.html#L587'>session</a>           587 lib/handshake-tls13.c 	gnutls_mutex_unlock(&amp;session-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5752.html#L600'>session</a>           600 lib/handshake-tls13.c _gnutls13_recv_async_handshake(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5752.html#L608'>session</a>           608 lib/handshake-tls13.c 	if (unlikely(session-&gt;internals.handshake_in_progress))</span>
<span class='curline'><a href='../S/5752.html#L617'>session</a>           617 lib/handshake-tls13.c 		ret = _gnutls_handshake_io_recv_int(session, GNUTLS_HANDSHAKE_ANY, &amp;hsk, 0);</span>
<span class='curline'><a href='../S/5752.html#L622'>session</a>           622 lib/handshake-tls13.c 		session-&gt;internals.last_handshake_in = hsk.htype;</span>
<span class='curline'><a href='../S/5752.html#L624'>session</a>           624 lib/handshake-tls13.c 		ret = _gnutls_call_hook_func(session, hsk.htype, GNUTLS_HOOK_PRE, 1,</span>
<span class='curline'><a href='../S/5752.html#L633'>session</a>           633 lib/handshake-tls13.c 				if (!(session-&gt;security_parameters.entity == GNUTLS_CLIENT) ||</span>
<span class='curline'><a href='../S/5752.html#L634'>session</a>           634 lib/handshake-tls13.c 				    !(session-&gt;internals.flags &amp; GNUTLS_POST_HANDSHAKE_AUTH)) {</span>
<span class='curline'><a href='../S/5752.html#L639'>session</a>           639 lib/handshake-tls13.c 				_gnutls_buffer_reset(&amp;session-&gt;internals.reauth_buffer);</span>
<span class='curline'><a href='../S/5752.html#L642'>session</a>           642 lib/handshake-tls13.c 				ret = _gnutls_buffer_append_data(&amp;session-&gt;internals.reauth_buffer,</span>
<span class='curline'><a href='../S/5752.html#L649'>session</a>           649 lib/handshake-tls13.c 				ret = _gnutls_buffer_append_data(&amp;session-&gt;internals.reauth_buffer,</span>
<span class='curline'><a href='../S/5752.html#L656'>session</a>           656 lib/handshake-tls13.c 				if (session-&gt;internals.flags &amp; GNUTLS_AUTO_REAUTH) {</span>
<span class='curline'><a href='../S/5752.html#L657'>session</a>           657 lib/handshake-tls13.c 					ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5752.html#L673'>session</a>           673 lib/handshake-tls13.c 				ret = _gnutls13_recv_key_update(session, &amp;hsk.data);</span>
<span class='curline'><a href='../S/5752.html#L682'>session</a>           682 lib/handshake-tls13.c 				if (session-&gt;internals.handshake_recv_buffer_size != 0) {</span>
<span class='curline'><a href='../S/5752.html#L688'>session</a>           688 lib/handshake-tls13.c 				if (session-&gt;security_parameters.entity != GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5752.html#L693'>session</a>           693 lib/handshake-tls13.c 				ret = _gnutls13_recv_session_ticket(session, &amp;hsk.data);</span>
<span class='curline'><a href='../S/5752.html#L699'>session</a>           699 lib/handshake-tls13.c 				memcpy(session-&gt;internals.tls13_ticket.resumption_master_secret,</span>
<span class='curline'><a href='../S/5752.html#L700'>session</a>           700 lib/handshake-tls13.c 				       session-&gt;key.proto.tls13.ap_rms,</span>
<span class='curline'><a href='../S/5752.html#L701'>session</a>           701 lib/handshake-tls13.c 				       session-&gt;key.proto.tls13.temp_secret_size);</span>
<span class='curline'><a href='../S/5752.html#L703'>session</a>           703 lib/handshake-tls13.c 				session-&gt;internals.tls13_ticket.prf = session-&gt;security_parameters.prf;</span>
<span class='curline'><a href='../S/5752.html#L704'>session</a>           704 lib/handshake-tls13.c 				session-&gt;internals.hsk_flags |= HSK_TICKET_RECEIVED;</span>
<span class='curline'><a href='../S/5752.html#L712'>session</a>           712 lib/handshake-tls13.c 		ret = _gnutls_call_hook_func(session, hsk.htype, GNUTLS_HOOK_POST, 1, hsk.data.data, hsk.data.length);</span>
<span class='curline'><a href='../S/5752.html#L719'>session</a>           719 lib/handshake-tls13.c 	} while (_gnutls_record_buffer_get_size(session) &gt; 0);</span>
<span class='curline'><a href='../S/5752.html#L721'>session</a>           721 lib/handshake-tls13.c 	session-&gt;internals.recv_state = next_state;</span>
<span class='curline'><a href='../S/5752.html#L728'>session</a>           728 lib/handshake-tls13.c 	if (_gnutls_record_buffer_get_size(session) &gt; 0)</span>
<span class='curline'><a href='../S/5752.html#L729'>session</a>           729 lib/handshake-tls13.c 		session-&gt;internals.recv_state = RECV_STATE_ASYNC_HANDSHAKE;</span>
<span class='curline'><a href='../S/5752.html#L731'>session</a>           731 lib/handshake-tls13.c 		session-&gt;internals.recv_state = next_state;</span>
<span class='curline'><a href='../S/5752.html#L749'>session</a>           749 lib/handshake-tls13.c int gnutls_session_ticket_send(gnutls_session_t session, unsigned nr, unsigned flags)</span>
<span class='curline'><a href='../S/5752.html#L752'>session</a>           752 lib/handshake-tls13.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5752.html#L754'>session</a>           754 lib/handshake-tls13.c 	if (!vers-&gt;tls13_sem || session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5752.html#L762'>session</a>           762 lib/handshake-tls13.c 		ret = _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/5752.html#L771'>session</a>           771 lib/handshake-tls13.c 		    _gnutls13_send_session_ticket(session, nr, TICKET_STATE==TICKET_STATE1?1:0);</span>
<span class='curline'><a href='../S/5300.html#L67'>session</a>            67 lib/handshake.c static int check_if_null_comp_present(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L69'>session</a>            69 lib/handshake.c static int handshake_client(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5300.html#L70'>session</a>            70 lib/handshake.c static int handshake_server(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5300.html#L73'>session</a>            73 lib/handshake.c read_server_hello(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L77'>session</a>            77 lib/handshake.c recv_handshake_final(gnutls_session_t session, int init);</span>
<span class='curline'><a href='../S/5300.html#L79'>session</a>            79 lib/handshake.c send_handshake_final(gnutls_session_t session, int init);</span>
<span class='curline'><a href='../S/5300.html#L84'>session</a>            84 lib/handshake.c handshake_hash_buffer_reset(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L88'>session</a>            88 lib/handshake.c 	session-&gt;internals.handshake_hash_buffer_client_hello_len = 0;</span>
<span class='curline'><a href='../S/5300.html#L89'>session</a>            89 lib/handshake.c 	session-&gt;internals.handshake_hash_buffer_client_kx_len = 0;</span>
<span class='curline'><a href='../S/5300.html#L90'>session</a>            90 lib/handshake.c 	session-&gt;internals.handshake_hash_buffer_server_finished_len = 0;</span>
<span class='curline'><a href='../S/5300.html#L91'>session</a>            91 lib/handshake.c 	session-&gt;internals.handshake_hash_buffer_client_finished_len = 0;</span>
<span class='curline'><a href='../S/5300.html#L92'>session</a>            92 lib/handshake.c 	session-&gt;internals.handshake_hash_buffer_prev_len = 0;</span>
<span class='curline'><a href='../S/5300.html#L93'>session</a>            93 lib/handshake.c 	session-&gt;internals.handshake_hash_buffer.length = 0;</span>
<span class='curline'><a href='../S/5300.html#L94'>session</a>            94 lib/handshake.c 	session-&gt;internals.full_client_hello.length = 0;</span>
<span class='curline'><a href='../S/5300.html#L99'>session</a>            99 lib/handshake.c handshake_hash_add_recvd(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L105'>session</a>           105 lib/handshake.c handshake_hash_add_sent(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L110'>session</a>           110 lib/handshake.c recv_hello_verify_request(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L116'>session</a>           116 lib/handshake.c void _gnutls_handshake_hash_buffers_clear(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L118'>session</a>           118 lib/handshake.c 	handshake_hash_buffer_reset(session);</span>
<span class='curline'><a href='../S/5300.html#L119'>session</a>           119 lib/handshake.c 	_gnutls_buffer_clear(&amp;session-&gt;internals.handshake_hash_buffer);</span>
<span class='curline'><a href='../S/5300.html#L120'>session</a>           120 lib/handshake.c 	_gnutls_buffer_clear(&amp;session-&gt;internals.full_client_hello);</span>
<span class='curline'><a href='../S/5300.html#L125'>session</a>           125 lib/handshake.c int _gnutls13_handshake_hash_buffers_synth(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L134'>session</a>           134 lib/handshake.c 		length = session-&gt;internals.handshake_hash_buffer_prev_len;</span>
<span class='curline'><a href='../S/5300.html#L136'>session</a>           136 lib/handshake.c 		length = session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L143'>session</a>           143 lib/handshake.c 			       session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5300.html#L148'>session</a>           148 lib/handshake.c 	handshake_hash_buffer_reset(session);</span>
<span class='curline'><a href='../S/5300.html#L151'>session</a>           151 lib/handshake.c 	    _gnutls_buffer_append_data(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L167'>session</a>           167 lib/handshake.c static int tls12_resume_copy_required_vals(gnutls_session_t session, unsigned ticket)</span>
<span class='curline'><a href='../S/5300.html#L172'>session</a>           172 lib/handshake.c 	memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L173'>session</a>           173 lib/handshake.c 	       server_random, session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5300.html#L175'>session</a>           175 lib/handshake.c 	memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L176'>session</a>           176 lib/handshake.c 	       client_random, session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5300.html#L183'>session</a>           183 lib/handshake.c 	ret = _gnutls_set_cipher_suite2(session,</span>
<span class='curline'><a href='../S/5300.html#L184'>session</a>           184 lib/handshake.c 				       session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L194'>session</a>           194 lib/handshake.c 	session-&gt;security_parameters.entity =</span>
<span class='curline'><a href='../S/5300.html#L195'>session</a>           195 lib/handshake.c 	    session-&gt;internals.resumed_security_parameters.entity;</span>
<span class='curline'><a href='../S/5300.html#L197'>session</a>           197 lib/handshake.c 	if (session-&gt;internals.resumed_security_parameters.pversion ==</span>
<span class='curline'><a href='../S/5300.html#L201'>session</a>           201 lib/handshake.c 	if (_gnutls_set_current_version(session,</span>
<span class='curline'><a href='../S/5300.html#L202'>session</a>           202 lib/handshake.c 				    session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L207'>session</a>           207 lib/handshake.c 	session-&gt;security_parameters.client_ctype =</span>
<span class='curline'><a href='../S/5300.html#L208'>session</a>           208 lib/handshake.c 	    session-&gt;internals.resumed_security_parameters.client_ctype;</span>
<span class='curline'><a href='../S/5300.html#L209'>session</a>           209 lib/handshake.c 	session-&gt;security_parameters.server_ctype =</span>
<span class='curline'><a href='../S/5300.html#L210'>session</a>           210 lib/handshake.c 	    session-&gt;internals.resumed_security_parameters.server_ctype;</span>
<span class='curline'><a href='../S/5300.html#L213'>session</a>           213 lib/handshake.c 		memcpy(session-&gt;security_parameters.session_id,</span>
<span class='curline'><a href='../S/5300.html#L214'>session</a>           214 lib/handshake.c 		       session-&gt;internals.resumed_security_parameters.session_id,</span>
<span class='curline'><a href='../S/5300.html#L215'>session</a>           215 lib/handshake.c 		       sizeof(session-&gt;security_parameters.session_id));</span>
<span class='curline'><a href='../S/5300.html#L216'>session</a>           216 lib/handshake.c 		session-&gt;security_parameters.session_id_size =</span>
<span class='curline'><a href='../S/5300.html#L217'>session</a>           217 lib/handshake.c 		    session-&gt;internals.resumed_security_parameters.session_id_size;</span>
<span class='curline'><a href='../S/5300.html#L223'>session</a>           223 lib/handshake.c void _gnutls_set_client_random(gnutls_session_t session, uint8_t * rnd)</span>
<span class='curline'><a href='../S/5300.html#L225'>session</a>           225 lib/handshake.c 	memcpy(session-&gt;security_parameters.client_random, rnd,</span>
<span class='curline'><a href='../S/5300.html#L230'>session</a>           230 lib/handshake.c int _gnutls_gen_client_random(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L235'>session</a>           235 lib/handshake.c 	if (session-&gt;internals.sc_random_set != 0) {</span>
<span class='curline'><a href='../S/5300.html#L236'>session</a>           236 lib/handshake.c 		memcpy(session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5300.html#L237'>session</a>           237 lib/handshake.c 		       session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L242'>session</a>           242 lib/handshake.c 			session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5300.html#L250'>session</a>           250 lib/handshake.c 		VALGRIND_MAKE_MEM_DEFINED(session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5300.html#L258'>session</a>           258 lib/handshake.c int _gnutls_set_server_random(gnutls_session_t session, const version_entry_st *vers, uint8_t * rnd)</span>
<span class='curline'><a href='../S/5300.html#L262'>session</a>           262 lib/handshake.c 	memcpy(session-&gt;security_parameters.server_random, rnd,</span>
<span class='curline'><a href='../S/5300.html#L267'>session</a>           267 lib/handshake.c 	if (!IS_DTLS(session) &amp;&amp; vers-&gt;id &lt;= GNUTLS_TLS1_2 &amp;&amp; have_creds_for_tls13(session)) {</span>
<span class='curline'><a href='../S/5300.html#L269'>session</a>           269 lib/handshake.c 		max = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L274'>session</a>           274 lib/handshake.c 		    memcmp(&amp;session-&gt;security_parameters.server_random[GNUTLS_RANDOM_SIZE-8],</span>
<span class='curline'><a href='../S/5300.html#L277'>session</a>           277 lib/handshake.c 			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5300.html#L281'>session</a>           281 lib/handshake.c 			   memcmp(&amp;session-&gt;security_parameters.server_random[GNUTLS_RANDOM_SIZE-8],</span>
<span class='curline'><a href='../S/5300.html#L284'>session</a>           284 lib/handshake.c 			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5300.html#L293'>session</a>           293 lib/handshake.c int _gnutls_gen_server_random(gnutls_session_t session, int version)</span>
<span class='curline'><a href='../S/5300.html#L298'>session</a>           298 lib/handshake.c 	if (session-&gt;internals.sc_random_set != 0) {</span>
<span class='curline'><a href='../S/5300.html#L299'>session</a>           299 lib/handshake.c 		memcpy(session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5300.html#L300'>session</a>           300 lib/handshake.c 		       session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L306'>session</a>           306 lib/handshake.c 	max = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L310'>session</a>           310 lib/handshake.c 	if (!IS_DTLS(session) &amp;&amp; max-&gt;id &gt;= GNUTLS_TLS1_3 &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L313'>session</a>           313 lib/handshake.c 			memcpy(&amp;session-&gt;security_parameters.server_random[GNUTLS_RANDOM_SIZE-8],</span>
<span class='curline'><a href='../S/5300.html#L316'>session</a>           316 lib/handshake.c 			memcpy(&amp;session-&gt;security_parameters.server_random[GNUTLS_RANDOM_SIZE-8],</span>
<span class='curline'><a href='../S/5300.html#L320'>session</a>           320 lib/handshake.c 		    gnutls_rnd(GNUTLS_RND_NONCE, session-&gt;security_parameters.server_random, GNUTLS_RANDOM_SIZE-8);</span>
<span class='curline'><a href='../S/5300.html#L324'>session</a>           324 lib/handshake.c 		    gnutls_rnd(GNUTLS_RND_NONCE, session-&gt;security_parameters.server_random, GNUTLS_RANDOM_SIZE);</span>
<span class='curline'><a href='../S/5300.html#L334'>session</a>           334 lib/handshake.c 		VALGRIND_MAKE_MEM_DEFINED(session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5300.html#L348'>session</a>           348 lib/handshake.c _gnutls_ssl3_finished(gnutls_session_t session, int type, uint8_t * ret,</span>
<span class='curline'><a href='../S/5300.html#L357'>session</a>           357 lib/handshake.c 		len = session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L359'>session</a>           359 lib/handshake.c 		len = session-&gt;internals.handshake_hash_buffer_prev_len;</span>
<span class='curline'><a href='../S/5300.html#L372'>session</a>           372 lib/handshake.c 		     session-&gt;internals.handshake_hash_buffer.data, len);</span>
<span class='curline'><a href='../S/5300.html#L374'>session</a>           374 lib/handshake.c 		     session-&gt;internals.handshake_hash_buffer.data, len);</span>
<span class='curline'><a href='../S/5300.html#L385'>session</a>           385 lib/handshake.c 					       session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L395'>session</a>           395 lib/handshake.c 					       session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L413'>session</a>           413 lib/handshake.c _gnutls_finished(gnutls_session_t session, int type, void *ret,</span>
<span class='curline'><a href='../S/5300.html#L423'>session</a>           423 lib/handshake.c 		len = session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L425'>session</a>           425 lib/handshake.c 		len = session-&gt;internals.handshake_hash_buffer_prev_len;</span>
<span class='curline'><a href='../S/5300.html#L427'>session</a>           427 lib/handshake.c 	algorithm = session-&gt;security_parameters.prf-&gt;id;</span>
<span class='curline'><a href='../S/5300.html#L429'>session</a>           429 lib/handshake.c 			       session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L435'>session</a>           435 lib/handshake.c 	hash_len = session-&gt;security_parameters.prf-&gt;output_size;</span>
<span class='curline'><a href='../S/5300.html#L443'>session</a>           443 lib/handshake.c 	return _gnutls_PRF(session,</span>
<span class='curline'><a href='../S/5300.html#L444'>session</a>           444 lib/handshake.c 			   session-&gt;security_parameters.master_secret,</span>
<span class='curline'><a href='../S/5300.html#L453'>session</a>           453 lib/handshake.c _gnutls_negotiate_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L462'>session</a>           462 lib/handshake.c 	    _gnutls_nversion_is_supported(session, major, minor) == 0) {</span>
<span class='curline'><a href='../S/5300.html#L465'>session</a>           465 lib/handshake.c 			vers = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L470'>session</a>           470 lib/handshake.c 				session-&gt;security_parameters.pversion = aversion;</span>
<span class='curline'><a href='../S/5300.html#L477'>session</a>           477 lib/handshake.c 		if (!_gnutls_version_is_too_high(session, major, minor))</span>
<span class='curline'><a href='../S/5300.html#L483'>session</a>           483 lib/handshake.c 		vers = _gnutls_legacy_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L491'>session</a>           491 lib/handshake.c 		session-&gt;security_parameters.pversion = vers;</span>
<span class='curline'><a href='../S/5300.html#L495'>session</a>           495 lib/handshake.c 		session-&gt;security_parameters.pversion = aversion;</span>
<span class='curline'><a href='../S/5300.html#L499'>session</a>           499 lib/handshake.c 			vers = _gnutls_legacy_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L500'>session</a>           500 lib/handshake.c 			session-&gt;security_parameters.pversion = vers;</span>
<span class='curline'><a href='../S/5300.html#L513'>session</a>           513 lib/handshake.c _gnutls_user_hello_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L520'>session</a>           520 lib/handshake.c 	if (session-&gt;internals.user_hello_func != NULL) {</span>
<span class='curline'><a href='../S/5300.html#L521'>session</a>           521 lib/handshake.c 		ret = session-&gt;internals.user_hello_func(session);</span>
<span class='curline'><a href='../S/5300.html#L535'>session</a>           535 lib/handshake.c 		if (session-&gt;internals.resumed != RESUME_TRUE) {</span>
<span class='curline'><a href='../S/5300.html#L536'>session</a>           536 lib/handshake.c 			new_max = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L537'>session</a>           537 lib/handshake.c 			old_vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L546'>session</a>           546 lib/handshake.c 				ret = _gnutls_negotiate_version(session, major, minor, 0);</span>
<span class='curline'><a href='../S/5300.html#L550'>session</a>           550 lib/handshake.c 				vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L555'>session</a>           555 lib/handshake.c 					ret = _gnutls_gen_server_random(session, vers-&gt;id);</span>
<span class='curline'><a href='../S/5300.html#L567'>session</a>           567 lib/handshake.c static int set_auth_types(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L569'>session</a>           569 lib/handshake.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L575'>session</a>           575 lib/handshake.c 		if (unlikely(!(session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_PSK) &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L576'>session</a>           576 lib/handshake.c 			     !(session-&gt;internals.hsk_flags &amp; HSK_KEY_SHARE_RECEIVED))) {</span>
<span class='curline'><a href='../S/5300.html#L583'>session</a>           583 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)</span>
<span class='curline'><a href='../S/5300.html#L584'>session</a>           584 lib/handshake.c 			kx = gnutls_kx_get(session);</span>
<span class='curline'><a href='../S/5300.html#L589'>session</a>           589 lib/handshake.c 		kx = session-&gt;security_parameters.cs-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5300.html#L593'>session</a>           593 lib/handshake.c 		session-&gt;security_parameters.server_auth_type = _gnutls_map_kx_get_cred(kx, 1);</span>
<span class='curline'><a href='../S/5300.html#L594'>session</a>           594 lib/handshake.c 		session-&gt;security_parameters.client_auth_type = _gnutls_map_kx_get_cred(kx, 0);</span>
<span class='curline'><a href='../S/5300.html#L595'>session</a>           595 lib/handshake.c 	} else if (unlikely(session-&gt;internals.resumed == RESUME_FALSE)) {</span>
<span class='curline'><a href='../S/5300.html#L610'>session</a>           610 lib/handshake.c read_client_hello(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5300.html#L625'>session</a>           625 lib/handshake.c 			      session, data[pos], data[pos + 1]);</span>
<span class='curline'><a href='../S/5300.html#L630'>session</a>           630 lib/handshake.c 	set_adv_version(session, major, minor);</span>
<span class='curline'><a href='../S/5300.html#L632'>session</a>           632 lib/handshake.c 	ret = _gnutls_negotiate_version(session, major, minor, 0);</span>
<span class='curline'><a href='../S/5300.html#L636'>session</a>           636 lib/handshake.c 	vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L647'>session</a>           647 lib/handshake.c 	_gnutls_set_client_random(session, &amp;data[pos]);</span>
<span class='curline'><a href='../S/5300.html#L651'>session</a>           651 lib/handshake.c 	ret = _gnutls_gen_server_random(session, neg_version);</span>
<span class='curline'><a href='../S/5300.html#L655'>session</a>           655 lib/handshake.c 	session-&gt;security_parameters.timestamp = gnutls_time(NULL);</span>
<span class='curline'><a href='../S/5300.html#L670'>session</a>           670 lib/handshake.c 	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5300.html#L709'>session</a>           709 lib/handshake.c 	    _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/5300.html#L716'>session</a>           716 lib/handshake.c 	    _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/5300.html#L722'>session</a>           722 lib/handshake.c 	vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L728'>session</a>           728 lib/handshake.c 		    _gnutls_server_restore_session(session, session_id,</span>
<span class='curline'><a href='../S/5300.html#L732'>session</a>           732 lib/handshake.c 			session-&gt;internals.resumption_requested = 1;</span>
<span class='curline'><a href='../S/5300.html#L735'>session</a>           735 lib/handshake.c 			ret = _gnutls_server_select_suite(session, suite_ptr, suite_size, 1);</span>
<span class='curline'><a href='../S/5300.html#L739'>session</a>           739 lib/handshake.c 			ret = tls12_resume_copy_required_vals(session, 0);</span>
<span class='curline'><a href='../S/5300.html#L743'>session</a>           743 lib/handshake.c 			session-&gt;internals.resumed = RESUME_TRUE;</span>
<span class='curline'><a href='../S/5300.html#L745'>session</a>           745 lib/handshake.c 			return _gnutls_user_hello_func(session, major, minor);</span>
<span class='curline'><a href='../S/5300.html#L747'>session</a>           747 lib/handshake.c 			ret = _gnutls_generate_session_id(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L749'>session</a>           749 lib/handshake.c 							  &amp;session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L754'>session</a>           754 lib/handshake.c 			session-&gt;internals.resumed = RESUME_FALSE;</span>
<span class='curline'><a href='../S/5300.html#L760'>session</a>           760 lib/handshake.c 			memcpy(session-&gt;security_parameters.session_id, session_id, session_id_len);</span>
<span class='curline'><a href='../S/5300.html#L761'>session</a>           761 lib/handshake.c 		session-&gt;security_parameters.session_id_size = session_id_len;</span>
<span class='curline'><a href='../S/5300.html#L769'>session</a>           769 lib/handshake.c 	ret = _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/5300.html#L779'>session</a>           779 lib/handshake.c 	sret = _gnutls_user_hello_func(session, major, minor);</span>
<span class='curline'><a href='../S/5300.html#L787'>session</a>           787 lib/handshake.c 	    _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/5300.html#L795'>session</a>           795 lib/handshake.c 	if (!vers-&gt;tls13_sem &amp;&amp; session-&gt;internals.resumed != RESUME_FALSE) {</span>
<span class='curline'><a href='../S/5300.html#L796'>session</a>           796 lib/handshake.c 		session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L798'>session</a>           798 lib/handshake.c 		    session-&gt;security_parameters.max_record_recv_size;</span>
<span class='curline'><a href='../S/5300.html#L799'>session</a>           799 lib/handshake.c 		session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L801'>session</a>           801 lib/handshake.c 		    session-&gt;security_parameters.max_record_send_size;</span>
<span class='curline'><a href='../S/5300.html#L803'>session</a>           803 lib/handshake.c 		ret = _gnutls_server_select_suite(session, suite_ptr, suite_size, 1);</span>
<span class='curline'><a href='../S/5300.html#L807'>session</a>           807 lib/handshake.c 		ret = tls12_resume_copy_required_vals(session, 1);</span>
<span class='curline'><a href='../S/5300.html#L812'>session</a>           812 lib/handshake.c 		memcpy(session-&gt;security_parameters.session_id, session_id, session_id_len);</span>
<span class='curline'><a href='../S/5300.html#L813'>session</a>           813 lib/handshake.c 		session-&gt;security_parameters.session_id_size = session_id_len;</span>
<span class='curline'><a href='../S/5300.html#L820'>session</a>           820 lib/handshake.c 	ret = _gnutls_server_select_suite(session, suite_ptr, suite_size, 0);</span>
<span class='curline'><a href='../S/5300.html#L829'>session</a>           829 lib/handshake.c 	vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L833'>session</a>           833 lib/handshake.c 	if (_gnutls_version_priority(session, vers-&gt;id) &lt; 0)</span>
<span class='curline'><a href='../S/5300.html#L836'>session</a>           836 lib/handshake.c 	_gnutls_handshake_log("HSK[%p]: Selected version %s\n", session, vers-&gt;name);</span>
<span class='curline'><a href='../S/5300.html#L840'>session</a>           840 lib/handshake.c 	    check_if_null_comp_present(session, comp_ptr,</span>
<span class='curline'><a href='../S/5300.html#L850'>session</a>           850 lib/handshake.c 	    _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/5300.html#L858'>session</a>           858 lib/handshake.c 	if (session-&gt;security_parameters.pversion-&gt;tls13_sem &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L859'>session</a>           859 lib/handshake.c 	    !(session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED)) {</span>
<span class='curline'><a href='../S/5300.html#L860'>session</a>           860 lib/handshake.c 		ret = _tls13_init_secret(session, NULL, 0);</span>
<span class='curline'><a href='../S/5300.html#L865'>session</a>           865 lib/handshake.c 	ret = set_auth_types(session);</span>
<span class='curline'><a href='../S/5300.html#L878'>session</a>           878 lib/handshake.c int _gnutls_send_finished(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5300.html#L888'>session</a>           888 lib/handshake.c 		    _gnutls_handshake_alloc(session,</span>
<span class='curline'><a href='../S/5300.html#L896'>session</a>           896 lib/handshake.c 		vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L903'>session</a>           903 lib/handshake.c 			    _gnutls_ssl3_finished(session,</span>
<span class='curline'><a href='../S/5300.html#L904'>session</a>           904 lib/handshake.c 						  session-&gt;</span>
<span class='curline'><a href='../S/5300.html#L910'>session</a>           910 lib/handshake.c 			ret = _gnutls_finished(session,</span>
<span class='curline'><a href='../S/5300.html#L911'>session</a>           911 lib/handshake.c 					       session-&gt;</span>
<span class='curline'><a href='../S/5300.html#L927'>session</a>           927 lib/handshake.c 		    _gnutls_ext_sr_finished(session, data, vdata_size, 0);</span>
<span class='curline'><a href='../S/5300.html#L933'>session</a>           933 lib/handshake.c 		if ((session-&gt;internals.resumed == RESUME_FALSE</span>
<span class='curline'><a href='../S/5300.html#L934'>session</a>           934 lib/handshake.c 		     &amp;&amp; session-&gt;security_parameters.entity ==</span>
<span class='curline'><a href='../S/5300.html#L936'>session</a>           936 lib/handshake.c 		    || (session-&gt;internals.resumed != RESUME_FALSE</span>
<span class='curline'><a href='../S/5300.html#L937'>session</a>           937 lib/handshake.c 			&amp;&amp; session-&gt;security_parameters.entity ==</span>
<span class='curline'><a href='../S/5300.html#L942'>session</a>           942 lib/handshake.c 			     session);</span>
<span class='curline'><a href='../S/5300.html#L943'>session</a>           943 lib/handshake.c 			memcpy(session-&gt;internals.cb_tls_unique, data,</span>
<span class='curline'><a href='../S/5300.html#L945'>session</a>           945 lib/handshake.c 			session-&gt;internals.cb_tls_unique_len = vdata_size;</span>
<span class='curline'><a href='../S/5300.html#L949'>session</a>           949 lib/handshake.c 		    _gnutls_send_handshake(session, bufel,</span>
<span class='curline'><a href='../S/5300.html#L953'>session</a>           953 lib/handshake.c 		    _gnutls_send_handshake(session, NULL,</span>
<span class='curline'><a href='../S/5300.html#L963'>session</a>           963 lib/handshake.c int _gnutls_recv_finished(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L970'>session</a>           970 lib/handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L976'>session</a>           976 lib/handshake.c 	    _gnutls_recv_handshake(session, GNUTLS_HANDSHAKE_FINISHED,</span>
<span class='curline'><a href='../S/5300.html#L1002'>session</a>          1002 lib/handshake.c 		    _gnutls_ssl3_finished(session,</span>
<span class='curline'><a href='../S/5300.html#L1003'>session</a>          1003 lib/handshake.c 					  (session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L1008'>session</a>          1008 lib/handshake.c 		    _gnutls_finished(session,</span>
<span class='curline'><a href='../S/5300.html#L1009'>session</a>          1009 lib/handshake.c 				     (session-&gt;security_parameters.entity +</span>
<span class='curline'><a href='../S/5300.html#L1031'>session</a>          1031 lib/handshake.c 	ret = _gnutls_ext_sr_finished(session, data, data_size, 1);</span>
<span class='curline'><a href='../S/5300.html#L1037'>session</a>          1037 lib/handshake.c 	if ((session-&gt;internals.resumed != RESUME_FALSE</span>
<span class='curline'><a href='../S/5300.html#L1038'>session</a>          1038 lib/handshake.c 	     &amp;&amp; session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5300.html#L1039'>session</a>          1039 lib/handshake.c 	    || (session-&gt;internals.resumed == RESUME_FALSE</span>
<span class='curline'><a href='../S/5300.html#L1040'>session</a>          1040 lib/handshake.c 		&amp;&amp; session-&gt;security_parameters.entity == GNUTLS_SERVER)) {</span>
<span class='curline'><a href='../S/5300.html#L1043'>session</a>          1043 lib/handshake.c 		    ("HSK[%p]: recording tls-unique CB (recv)\n", session);</span>
<span class='curline'><a href='../S/5300.html#L1044'>session</a>          1044 lib/handshake.c 		memcpy(session-&gt;internals.cb_tls_unique, data, data_size);</span>
<span class='curline'><a href='../S/5300.html#L1045'>session</a>          1045 lib/handshake.c 		session-&gt;internals.cb_tls_unique_len = data_size;</span>
<span class='curline'><a href='../S/5300.html#L1062'>session</a>          1062 lib/handshake.c _gnutls_server_select_suite(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5300.html#L1071'>session</a>          1071 lib/handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L1080'>session</a>          1080 lib/handshake.c 		if (session-&gt;internals.priorities-&gt;sr != SR_DISABLED &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L1085'>session</a>          1085 lib/handshake.c 			     session);</span>
<span class='curline'><a href='../S/5300.html#L1086'>session</a>          1086 lib/handshake.c 			retval = _gnutls_ext_sr_recv_cs(session);</span>
<span class='curline'><a href='../S/5300.html#L1096'>session</a>          1096 lib/handshake.c 			const version_entry_st *max = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L1100'>session</a>          1100 lib/handshake.c 			     session);</span>
<span class='curline'><a href='../S/5300.html#L1116'>session</a>          1116 lib/handshake.c 	ret = _gnutls_figure_common_ciphersuite(session, &amp;peer_clist, &amp;selected);</span>
<span class='curline'><a href='../S/5300.html#L1122'>session</a>          1122 lib/handshake.c 		    ("HSK[%p]: Selected cipher suite: %s\n", session, selected-&gt;name);</span>
<span class='curline'><a href='../S/5300.html#L1124'>session</a>          1124 lib/handshake.c 	ret = _gnutls_set_cipher_suite2(session, selected);</span>
<span class='curline'><a href='../S/5300.html#L1134'>session</a>          1134 lib/handshake.c 		if (_gnutls_get_kx_cred(session, kx) == NULL) {</span>
<span class='curline'><a href='../S/5300.html#L1143'>session</a>          1143 lib/handshake.c 		session-&gt;internals.auth_struct = _gnutls_kx_auth_struct(kx);</span>
<span class='curline'><a href='../S/5300.html#L1144'>session</a>          1144 lib/handshake.c 		if (session-&gt;internals.auth_struct == NULL) {</span>
<span class='curline'><a href='../S/5300.html#L1147'>session</a>          1147 lib/handshake.c 			     session);</span>
<span class='curline'><a href='../S/5300.html#L1161'>session</a>          1161 lib/handshake.c check_if_null_comp_present(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L1185'>session</a>          1185 lib/handshake.c _gnutls_send_empty_handshake(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L1192'>session</a>          1192 lib/handshake.c 		bufel = _gnutls_handshake_alloc(session, 0);</span>
<span class='curline'><a href='../S/5300.html#L1200'>session</a>          1200 lib/handshake.c 	return _gnutls_send_handshake(session, bufel, type);</span>
<span class='curline'><a href='../S/5300.html#L1203'>session</a>          1203 lib/handshake.c int _gnutls_call_hook_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L1210'>session</a>          1210 lib/handshake.c 	if (session-&gt;internals.h_hook != NULL) {</span>
<span class='curline'><a href='../S/5300.html#L1211'>session</a>          1211 lib/handshake.c 		if ((session-&gt;internals.h_type == type</span>
<span class='curline'><a href='../S/5300.html#L1212'>session</a>          1212 lib/handshake.c 		     || session-&gt;internals.h_type == GNUTLS_HANDSHAKE_ANY)</span>
<span class='curline'><a href='../S/5300.html#L1213'>session</a>          1213 lib/handshake.c 		    &amp;&amp; (session-&gt;internals.h_post == post</span>
<span class='curline'><a href='../S/5300.html#L1214'>session</a>          1214 lib/handshake.c 			|| session-&gt;internals.h_post == GNUTLS_HOOK_BOTH)) {</span>
<span class='curline'><a href='../S/5300.html#L1224'>session</a>          1224 lib/handshake.c 			    session-&gt;internals.h_type != GNUTLS_HANDSHAKE_CHANGE_CIPHER_SPEC)</span>
<span class='curline'><a href='../S/5300.html#L1227'>session</a>          1227 lib/handshake.c 			return session-&gt;internals.h_hook(session, type,</span>
<span class='curline'><a href='../S/5300.html#L1242'>session</a>          1242 lib/handshake.c _gnutls_send_handshake(gnutls_session_t session, mbuffer_st * bufel,</span>
<span class='curline'><a href='../S/5300.html#L1245'>session</a>          1245 lib/handshake.c 	return _gnutls_send_handshake2(session, bufel, type, 0);</span>
<span class='curline'><a href='../S/5300.html#L1254'>session</a>          1254 lib/handshake.c _gnutls_send_handshake2(gnutls_session_t session, mbuffer_st * bufel,</span>
<span class='curline'><a href='../S/5300.html#L1261'>session</a>          1261 lib/handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L1267'>session</a>          1267 lib/handshake.c 		ret = _gnutls_handshake_io_write_flush(session);</span>
<span class='curline'><a href='../S/5300.html#L1285'>session</a>          1285 lib/handshake.c 	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5300.html#L1286'>session</a>          1286 lib/handshake.c 		_gnutls_write_uint16(session-&gt;internals.dtls.</span>
<span class='curline'><a href='../S/5300.html#L1300'>session</a>          1300 lib/handshake.c 			      session, _gnutls_handshake2str(type),</span>
<span class='curline'><a href='../S/5300.html#L1307'>session</a>          1307 lib/handshake.c 		     handshake_hash_add_sent(session, type, data,</span>
<span class='curline'><a href='../S/5300.html#L1317'>session</a>          1317 lib/handshake.c 		    session-&gt;key.binders[0].prf != NULL) {</span>
<span class='curline'><a href='../S/5300.html#L1318'>session</a>          1318 lib/handshake.c 			ret = _gnutls_generate_early_secrets_for_psk(session);</span>
<span class='curline'><a href='../S/5300.html#L1327'>session</a>          1327 lib/handshake.c 	ret = _gnutls_call_hook_func(session, type, GNUTLS_HOOK_PRE, 0,</span>
<span class='curline'><a href='../S/5300.html#L1335'>session</a>          1335 lib/handshake.c 	session-&gt;internals.last_handshake_out = type;</span>
<span class='curline'><a href='../S/5300.html#L1337'>session</a>          1337 lib/handshake.c 	ret = _gnutls_handshake_io_cache_int(session, type, bufel);</span>
<span class='curline'><a href='../S/5300.html#L1344'>session</a>          1344 lib/handshake.c 	ret = _gnutls_call_hook_func(session, type, GNUTLS_HOOK_POST, 0,</span>
<span class='curline'><a href='../S/5300.html#L1357'>session</a>          1357 lib/handshake.c 		if (session-&gt;internals.initial_negotiation_completed) {</span>
<span class='curline'><a href='../S/5300.html#L1406'>session</a>          1406 lib/handshake.c 	return _gnutls_handshake_io_write_flush(session);</span>
<span class='curline'><a href='../S/5300.html#L1410'>session</a>          1410 lib/handshake.c   if ((session-&gt;internals.max_handshake_data_buffer_size &gt; 0) &amp;&amp; \</span>
<span class='curline'><a href='../S/5300.html#L1411'>session</a>          1411 lib/handshake.c       (((ll) + session-&gt;internals.handshake_hash_buffer.length) &gt; \</span>
<span class='curline'><a href='../S/5300.html#L1412'>session</a>          1412 lib/handshake.c        session-&gt;internals.max_handshake_data_buffer_size)) { \</span>
<span class='curline'><a href='../S/5300.html#L1413'>session</a>          1413 lib/handshake.c     _gnutls_debug_log("Handshake buffer length is %u (max: %u)\n", (unsigned)((ll) + session-&gt;internals.handshake_hash_buffer.length), (unsigned)session-&gt;internals.max_handshake_data_buffer_size); \</span>
<span class='curline'><a href='../S/5300.html#L1423'>session</a>          1423 lib/handshake.c handshake_hash_add_recvd(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L1429'>session</a>          1429 lib/handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L1441'>session</a>          1441 lib/handshake.c 	session-&gt;internals.handshake_hash_buffer_prev_len =</span>
<span class='curline'><a href='../S/5300.html#L1442'>session</a>          1442 lib/handshake.c 	    session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1446'>session</a>          1446 lib/handshake.c 		    _gnutls_buffer_append_data(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L1454'>session</a>          1454 lib/handshake.c 		    _gnutls_buffer_append_data(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L1465'>session</a>          1465 lib/handshake.c 		session-&gt;internals.handshake_hash_buffer_client_hello_len =</span>
<span class='curline'><a href='../S/5300.html#L1466'>session</a>          1466 lib/handshake.c 			session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1468'>session</a>          1468 lib/handshake.c 		session-&gt;internals.handshake_hash_buffer_client_kx_len =</span>
<span class='curline'><a href='../S/5300.html#L1469'>session</a>          1469 lib/handshake.c 			session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1470'>session</a>          1470 lib/handshake.c 	if (recv_type == GNUTLS_HANDSHAKE_FINISHED &amp;&amp; session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5300.html#L1471'>session</a>          1471 lib/handshake.c 		session-&gt;internals.handshake_hash_buffer_server_finished_len =</span>
<span class='curline'><a href='../S/5300.html#L1472'>session</a>          1472 lib/handshake.c 			session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1473'>session</a>          1473 lib/handshake.c 	if (recv_type == GNUTLS_HANDSHAKE_FINISHED &amp;&amp; session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5300.html#L1474'>session</a>          1474 lib/handshake.c 		session-&gt;internals.handshake_hash_buffer_client_finished_len =</span>
<span class='curline'><a href='../S/5300.html#L1475'>session</a>          1475 lib/handshake.c 			session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1483'>session</a>          1483 lib/handshake.c handshake_hash_add_sent(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L1488'>session</a>          1488 lib/handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L1512'>session</a>          1512 lib/handshake.c 	    _gnutls_buffer_append_data(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5300.html#L1519'>session</a>          1519 lib/handshake.c 		session-&gt;internals.handshake_hash_buffer_client_hello_len =</span>
<span class='curline'><a href='../S/5300.html#L1520'>session</a>          1520 lib/handshake.c 			session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1522'>session</a>          1522 lib/handshake.c 		session-&gt;internals.handshake_hash_buffer_client_kx_len =</span>
<span class='curline'><a href='../S/5300.html#L1523'>session</a>          1523 lib/handshake.c 			session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1524'>session</a>          1524 lib/handshake.c 	if (type == GNUTLS_HANDSHAKE_FINISHED &amp;&amp; session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5300.html#L1525'>session</a>          1525 lib/handshake.c 		session-&gt;internals.handshake_hash_buffer_server_finished_len =</span>
<span class='curline'><a href='../S/5300.html#L1526'>session</a>          1526 lib/handshake.c 			session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1527'>session</a>          1527 lib/handshake.c 	if (type == GNUTLS_HANDSHAKE_FINISHED &amp;&amp; session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5300.html#L1528'>session</a>          1528 lib/handshake.c 		session-&gt;internals.handshake_hash_buffer_client_finished_len =</span>
<span class='curline'><a href='../S/5300.html#L1529'>session</a>          1529 lib/handshake.c 			session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5300.html#L1540'>session</a>          1540 lib/handshake.c _gnutls_recv_handshake(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L1547'>session</a>          1547 lib/handshake.c 	ret = _gnutls_handshake_io_recv_int(session, type, &amp;hsk, optional);</span>
<span class='curline'><a href='../S/5300.html#L1558'>session</a>          1558 lib/handshake.c 	session-&gt;internals.last_handshake_in = hsk.htype;</span>
<span class='curline'><a href='../S/5300.html#L1560'>session</a>          1560 lib/handshake.c 	ret = _gnutls_call_hook_func(session, hsk.htype, GNUTLS_HOOK_PRE, 1, hsk.data.data, hsk.data.length);</span>
<span class='curline'><a href='../S/5300.html#L1566'>session</a>          1566 lib/handshake.c 	ret = handshake_hash_add_recvd(session, hsk.rtype,</span>
<span class='curline'><a href='../S/5300.html#L1578'>session</a>          1578 lib/handshake.c 		if (!(IS_SERVER(session))) {</span>
<span class='curline'><a href='../S/5300.html#L1586'>session</a>          1586 lib/handshake.c 			    _gnutls_read_client_hello_v2(session,</span>
<span class='curline'><a href='../S/5300.html#L1593'>session</a>          1593 lib/handshake.c 			ret = _gnutls_ext_set_full_client_hello(session, &amp;hsk);</span>
<span class='curline'><a href='../S/5300.html#L1597'>session</a>          1597 lib/handshake.c 			ret = read_client_hello(session, hsk.data.data,</span>
<span class='curline'><a href='../S/5300.html#L1609'>session</a>          1609 lib/handshake.c 		if (IS_SERVER(session)) {</span>
<span class='curline'><a href='../S/5300.html#L1614'>session</a>          1614 lib/handshake.c 		ret = read_server_hello(session, hsk.data.data,</span>
<span class='curline'><a href='../S/5300.html#L1624'>session</a>          1624 lib/handshake.c 		if (IS_SERVER(session)) {</span>
<span class='curline'><a href='../S/5300.html#L1630'>session</a>          1630 lib/handshake.c 		    recv_hello_verify_request(session,</span>
<span class='curline'><a href='../S/5300.html#L1647'>session</a>          1647 lib/handshake.c 		if (IS_SERVER(session)) {</span>
<span class='curline'><a href='../S/5300.html#L1653'>session</a>          1653 lib/handshake.c 		    _gnutls13_recv_hello_retry_request(session,</span>
<span class='curline'><a href='../S/5300.html#L1661'>session</a>          1661 lib/handshake.c 			ret = handshake_hash_add_recvd(session, hsk.htype,</span>
<span class='curline'><a href='../S/5300.html#L1708'>session</a>          1708 lib/handshake.c 	ret2 = _gnutls_call_hook_func(session, hsk.htype, GNUTLS_HOOK_POST, 1, hsk.data.data, hsk.data.length);</span>
<span class='curline'><a href='../S/5300.html#L1729'>session</a>          1729 lib/handshake.c set_client_ciphersuite(gnutls_session_t session, uint8_t suite[2])</span>
<span class='curline'><a href='../S/5300.html#L1734'>session</a>          1734 lib/handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L1737'>session</a>          1737 lib/handshake.c 	for (j = 0; j &lt; session-&gt;internals.priorities-&gt;cs.size; j++) {</span>
<span class='curline'><a href='../S/5300.html#L1738'>session</a>          1738 lib/handshake.c 		if (suite[0] == session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;id[0] &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L1739'>session</a>          1739 lib/handshake.c 		    suite[1] == session-&gt;internals.priorities-&gt;cs.entry[j]-&gt;id[1]) {</span>
<span class='curline'><a href='../S/5300.html#L1740'>session</a>          1740 lib/handshake.c 			selected = session-&gt;internals.priorities-&gt;cs.entry[j];</span>
<span class='curline'><a href='../S/5300.html#L1749'>session</a>          1749 lib/handshake.c 		     session, (unsigned int) suite[0],</span>
<span class='curline'><a href='../S/5300.html#L1754'>session</a>          1754 lib/handshake.c 	ret = _gnutls_set_cipher_suite2(session, selected);</span>
<span class='curline'><a href='../S/5300.html#L1759'>session</a>          1759 lib/handshake.c 			      session,</span>
<span class='curline'><a href='../S/5300.html#L1768'>session</a>          1768 lib/handshake.c 		if (!session-&gt;internals.premaster_set &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L1770'>session</a>          1770 lib/handshake.c 		    (session, kx) == NULL) {</span>
<span class='curline'><a href='../S/5300.html#L1779'>session</a>          1779 lib/handshake.c 		session-&gt;internals.auth_struct =</span>
<span class='curline'><a href='../S/5300.html#L1782'>session</a>          1782 lib/handshake.c 		if (session-&gt;internals.auth_struct == NULL) {</span>
<span class='curline'><a href='../S/5300.html#L1785'>session</a>          1785 lib/handshake.c 			     session);</span>
<span class='curline'><a href='../S/5300.html#L1790'>session</a>          1790 lib/handshake.c 		if (session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED) {</span>
<span class='curline'><a href='../S/5300.html#L1791'>session</a>          1791 lib/handshake.c 			if (session-&gt;key.binders[0].prf-&gt;id != selected-&gt;prf) {</span>
<span class='curline'><a href='../S/5300.html#L1794'>session</a>          1794 lib/handshake.c 				     session, selected-&gt;name, session-&gt;key.binders[0].prf-&gt;name);</span>
<span class='curline'><a href='../S/5300.html#L1809'>session</a>          1809 lib/handshake.c client_check_if_resuming(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L1815'>session</a>          1815 lib/handshake.c 	_gnutls_handshake_log("HSK[%p]: SessionID length: %d\n", session,</span>
<span class='curline'><a href='../S/5300.html#L1817'>session</a>          1817 lib/handshake.c 	_gnutls_handshake_log("HSK[%p]: SessionID: %s\n", session,</span>
<span class='curline'><a href='../S/5300.html#L1821'>session</a>          1821 lib/handshake.c 	if ((session-&gt;internals.resumption_requested != 0 ||</span>
<span class='curline'><a href='../S/5300.html#L1822'>session</a>          1822 lib/handshake.c 	     session-&gt;internals.premaster_set != 0) &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L1824'>session</a>          1824 lib/handshake.c 	    session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L1827'>session</a>          1827 lib/handshake.c 		      session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L1830'>session</a>          1830 lib/handshake.c 		memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L1832'>session</a>          1832 lib/handshake.c 		       session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5300.html#L1834'>session</a>          1834 lib/handshake.c 		memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L1836'>session</a>          1836 lib/handshake.c 		       session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5300.html#L1840'>session</a>          1840 lib/handshake.c 		    (session,</span>
<span class='curline'><a href='../S/5300.html#L1841'>session</a>          1841 lib/handshake.c 		     session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L1848'>session</a>          1848 lib/handshake.c 		session-&gt;internals.resumed = RESUME_TRUE;	/* we are resuming */</span>
<span class='curline'><a href='../S/5300.html#L1854'>session</a>          1854 lib/handshake.c 		session-&gt;internals.resumed = RESUME_FALSE;	/* we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L1865'>session</a>          1865 lib/handshake.c read_server_hello(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L1884'>session</a>          1884 lib/handshake.c 			      session, data[pos], data[pos + 1]);</span>
<span class='curline'><a href='../S/5300.html#L1890'>session</a>          1890 lib/handshake.c 	saved_vers = get_version(session); /* will be non-null if HRR has been received */</span>
<span class='curline'><a href='../S/5300.html#L1899'>session</a>          1899 lib/handshake.c 	if (_gnutls_set_current_version(session, vers-&gt;id) &lt; 0)</span>
<span class='curline'><a href='../S/5300.html#L1933'>session</a>          1933 lib/handshake.c 	    _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_TLS12_SERVER_HELLO|</span>
<span class='curline'><a href='../S/5300.html#L1940'>session</a>          1940 lib/handshake.c 	vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L1948'>session</a>          1948 lib/handshake.c 	if (_gnutls_nversion_is_supported(session, vers-&gt;major, vers-&gt;minor) == 0)</span>
<span class='curline'><a href='../S/5300.html#L1952'>session</a>          1952 lib/handshake.c 	ret = _gnutls_set_server_random(session, vers, srandom_pos);</span>
<span class='curline'><a href='../S/5300.html#L1958'>session</a>          1958 lib/handshake.c 		gnutls_memset(&amp;session-&gt;key.proto.tls13, 0,</span>
<span class='curline'><a href='../S/5300.html#L1959'>session</a>          1959 lib/handshake.c 			      sizeof(session-&gt;key.proto.tls13));</span>
<span class='curline'><a href='../S/5300.html#L1960'>session</a>          1960 lib/handshake.c 		reset_binders(session);</span>
<span class='curline'><a href='../S/5300.html#L1967'>session</a>          1967 lib/handshake.c 	    client_check_if_resuming(session, session_id, session_id_len) == 0) {</span>
<span class='curline'><a href='../S/5300.html#L1969'>session</a>          1969 lib/handshake.c 		    _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_TLS12_SERVER_HELLO,</span>
<span class='curline'><a href='../S/5300.html#L1977'>session</a>          1977 lib/handshake.c 		session-&gt;security_parameters.session_id_size = session_id_len;</span>
<span class='curline'><a href='../S/5300.html#L1979'>session</a>          1979 lib/handshake.c 			memcpy(session-&gt;security_parameters.session_id, session_id,</span>
<span class='curline'><a href='../S/5300.html#L1986'>session</a>          1986 lib/handshake.c 	ret = set_client_ciphersuite(session, cs_pos);</span>
<span class='curline'><a href='../S/5300.html#L1992'>session</a>          1992 lib/handshake.c 	if (session-&gt;internals.hsk_flags &amp; HSK_HRR_RECEIVED) {</span>
<span class='curline'><a href='../S/5300.html#L1994'>session</a>          1994 lib/handshake.c 		if (memcmp(cs_pos, session-&gt;internals.hrr_cs, 2) != 0)</span>
<span class='curline'><a href='../S/5300.html#L2013'>session</a>          2013 lib/handshake.c 	    _gnutls_parse_hello_extensions(session,</span>
<span class='curline'><a href='../S/5300.html#L2021'>session</a>          2021 lib/handshake.c 	if (!vers-&gt;tls13_sem &amp;&amp; session-&gt;internals.priorities-&gt;force_etm &amp;&amp; !session-&gt;security_parameters.etm) {</span>
<span class='curline'><a href='../S/5300.html#L2022'>session</a>          2022 lib/handshake.c 		const cipher_entry_st *cipher = cipher_to_entry(session-&gt;security_parameters.cs-&gt;block_algorithm);</span>
<span class='curline'><a href='../S/5300.html#L2029'>session</a>          2029 lib/handshake.c 	    _gnutls_parse_hello_extensions(session,</span>
<span class='curline'><a href='../S/5300.html#L2037'>session</a>          2037 lib/handshake.c 	    _gnutls_parse_hello_extensions(session,</span>
<span class='curline'><a href='../S/5300.html#L2045'>session</a>          2045 lib/handshake.c 	    _gnutls_parse_hello_extensions(session,</span>
<span class='curline'><a href='../S/5300.html#L2054'>session</a>          2054 lib/handshake.c 	    !(session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED)) {</span>
<span class='curline'><a href='../S/5300.html#L2055'>session</a>          2055 lib/handshake.c 		ret = _tls13_init_secret(session, NULL, 0);</span>
<span class='curline'><a href='../S/5300.html#L2060'>session</a>          2060 lib/handshake.c 	ret = set_auth_types(session);</span>
<span class='curline'><a href='../S/5300.html#L2064'>session</a>          2064 lib/handshake.c 	session-&gt;internals.hsk_flags |= HSK_SERVER_HELLO_RECEIVED;</span>
<span class='curline'><a href='../S/5300.html#L2073'>session</a>          2073 lib/handshake.c append_null_comp(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L2092'>session</a>          2092 lib/handshake.c static int send_client_hello(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5300.html#L2103'>session</a>          2103 lib/handshake.c 	    session-&gt;internals.resumed_security_parameters.session_id_size;</span>
<span class='curline'><a href='../S/5300.html#L2109'>session</a>          2109 lib/handshake.c 		if (session-&gt;internals.initial_negotiation_completed)</span>
<span class='curline'><a href='../S/5300.html#L2119'>session</a>          2119 lib/handshake.c 		if (session-&gt;internals.resumption_requested == 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L2120'>session</a>          2120 lib/handshake.c 		    session-&gt;internals.premaster_set == 0) {</span>
<span class='curline'><a href='../S/5300.html#L2122'>session</a>          2122 lib/handshake.c 				hver = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L2124'>session</a>          2124 lib/handshake.c 				hver = _gnutls_legacy_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L2128'>session</a>          2128 lib/handshake.c 			    session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L2132'>session</a>          2132 lib/handshake.c 				hver = _gnutls_legacy_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L2137'>session</a>          2137 lib/handshake.c 			if (session-&gt;internals.flags &amp; INT_FLAG_NO_TLS13)</span>
<span class='curline'><a href='../S/5300.html#L2144'>session</a>          2144 lib/handshake.c 		if (unlikely(session-&gt;internals.default_hello_version[0] != 0)) {</span>
<span class='curline'><a href='../S/5300.html#L2145'>session</a>          2145 lib/handshake.c 			tver[0] = session-&gt;internals.default_hello_version[0];</span>
<span class='curline'><a href='../S/5300.html#L2146'>session</a>          2146 lib/handshake.c 			tver[1] = session-&gt;internals.default_hello_version[1];</span>
<span class='curline'><a href='../S/5300.html#L2156'>session</a>          2156 lib/handshake.c 		_gnutls_handshake_log("HSK[%p]: Adv. version: %u.%u\n", session,</span>
<span class='curline'><a href='../S/5300.html#L2159'>session</a>          2159 lib/handshake.c 		min_ver = _gnutls_version_lowest(session);</span>
<span class='curline'><a href='../S/5300.html#L2160'>session</a>          2160 lib/handshake.c 		max_ver = _gnutls_version_max(session);</span>
<span class='curline'><a href='../S/5300.html#L2168'>session</a>          2168 lib/handshake.c 		if (!(session-&gt;internals.hsk_flags &amp; HSK_HRR_RECEIVED) || !get_version(session)) {</span>
<span class='curline'><a href='../S/5300.html#L2171'>session</a>          2171 lib/handshake.c 			set_adv_version(session, hver-&gt;major, hver-&gt;minor);</span>
<span class='curline'><a href='../S/5300.html#L2172'>session</a>          2172 lib/handshake.c 			if (_gnutls_set_current_version(session, hver-&gt;id) &lt; 0) {</span>
<span class='curline'><a href='../S/5300.html#L2178'>session</a>          2178 lib/handshake.c 		if (session-&gt;internals.priorities-&gt;min_record_version != 0) {</span>
<span class='curline'><a href='../S/5300.html#L2185'>session</a>          2185 lib/handshake.c 			set_default_version(session, min_ver);</span>
<span class='curline'><a href='../S/5300.html#L2187'>session</a>          2187 lib/handshake.c 			set_default_version(session, hver);</span>
<span class='curline'><a href='../S/5300.html#L2192'>session</a>          2192 lib/handshake.c 		session-&gt;security_parameters.timestamp = gnutls_time(NULL);</span>
<span class='curline'><a href='../S/5300.html#L2196'>session</a>          2196 lib/handshake.c 		if (!(session-&gt;internals.hsk_flags &amp; HSK_HRR_RECEIVED) &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L2197'>session</a>          2197 lib/handshake.c 		    !(IS_DTLS(session) &amp;&amp; session-&gt;internals.dtls.hsk_hello_verify_requests != 0)) {</span>
<span class='curline'><a href='../S/5300.html#L2198'>session</a>          2198 lib/handshake.c 			ret = _gnutls_gen_client_random(session);</span>
<span class='curline'><a href='../S/5300.html#L2207'>session</a>          2207 lib/handshake.c 						 session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5300.html#L2216'>session</a>          2216 lib/handshake.c 		    session-&gt;security_parameters.session_id_size == 0) {</span>
<span class='curline'><a href='../S/5300.html#L2220'>session</a>          2220 lib/handshake.c 			ret = _gnutls_generate_session_id(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L2222'>session</a>          2222 lib/handshake.c 							  &amp;session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L2234'>session</a>          2234 lib/handshake.c 							session-&gt;internals.resumed_security_parameters.session_id,</span>
<span class='curline'><a href='../S/5300.html#L2243'>session</a>          2243 lib/handshake.c 		if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5300.html#L2245'>session</a>          2245 lib/handshake.c 								session-&gt;internals.dtls.dcookie.data,</span>
<span class='curline'><a href='../S/5300.html#L2246'>session</a>          2246 lib/handshake.c 								session-&gt;internals.dtls.dcookie.size);</span>
<span class='curline'><a href='../S/5300.html#L2251'>session</a>          2251 lib/handshake.c 			_gnutls_free_datum(&amp;session-&gt;internals.dtls.dcookie);</span>
<span class='curline'><a href='../S/5300.html#L2261'>session</a>          2261 lib/handshake.c 		if (!session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L2262'>session</a>          2262 lib/handshake.c 		    session-&gt;security_parameters.entity == GNUTLS_CLIENT &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L2264'>session</a>          2264 lib/handshake.c 		     session-&gt;internals.priorities-&gt;no_extensions != 0)) {</span>
<span class='curline'><a href='../S/5300.html#L2268'>session</a>          2268 lib/handshake.c 		ret = _gnutls_get_client_ciphersuites(session, &amp;extdata, min_ver, add_sr_scsv);</span>
<span class='curline'><a href='../S/5300.html#L2276'>session</a>          2276 lib/handshake.c 		ret = append_null_comp(session, &amp;extdata);</span>
<span class='curline'><a href='../S/5300.html#L2284'>session</a>          2284 lib/handshake.c 		if (session-&gt;internals.priorities-&gt;no_extensions == 0) {</span>
<span class='curline'><a href='../S/5300.html#L2292'>session</a>          2292 lib/handshake.c 			    _gnutls_gen_hello_extensions(session, &amp;extdata,</span>
<span class='curline'><a href='../S/5300.html#L2304'>session</a>          2304 lib/handshake.c 	ret = _gnutls_send_handshake(session, bufel,</span>
<span class='curline'><a href='../S/5300.html#L2314'>session</a>          2314 lib/handshake.c int _gnutls_send_server_hello(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5300.html#L2320'>session</a>          2320 lib/handshake.c 	    session-&gt;security_parameters.session_id_size;</span>
<span class='curline'><a href='../S/5300.html#L2330'>session</a>          2330 lib/handshake.c 		vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L2331'>session</a>          2331 lib/handshake.c 		if (unlikely(vers == NULL || session-&gt;security_parameters.cs == NULL))</span>
<span class='curline'><a href='../S/5300.html#L2357'>session</a>          2357 lib/handshake.c 						 session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5300.html#L2365'>session</a>          2365 lib/handshake.c 							session-&gt;security_parameters.session_id,</span>
<span class='curline'><a href='../S/5300.html#L2372'>session</a>          2372 lib/handshake.c 		_gnutls_handshake_log("HSK[%p]: SessionID: %s\n", session,</span>
<span class='curline'><a href='../S/5300.html#L2373'>session</a>          2373 lib/handshake.c 				      _gnutls_bin2hex(session-&gt;</span>
<span class='curline'><a href='../S/5300.html#L2379'>session</a>          2379 lib/handshake.c 						 session-&gt;security_parameters.cs-&gt;id,</span>
<span class='curline'><a href='../S/5300.html#L2393'>session</a>          2393 lib/handshake.c 		if (!vers-&gt;tls13_sem &amp;&amp; session-&gt;internals.resumed != RESUME_FALSE)</span>
<span class='curline'><a href='../S/5300.html#L2398'>session</a>          2398 lib/handshake.c 		    _gnutls_gen_hello_extensions(session, &amp;buf, extflag, etype);</span>
<span class='curline'><a href='../S/5300.html#L2408'>session</a>          2408 lib/handshake.c 			ret = _gnutls_generate_session_id(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L2410'>session</a>          2410 lib/handshake.c 							  &amp;session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5300.html#L2422'>session</a>          2422 lib/handshake.c 	    _gnutls_send_handshake(session, bufel,</span>
<span class='curline'><a href='../S/5300.html#L2431'>session</a>          2431 lib/handshake.c recv_hello_verify_request(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L2440'>session</a>          2440 lib/handshake.c 	if (!IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5300.html#L2445'>session</a>          2445 lib/handshake.c 	nb_verifs = ++session-&gt;internals.dtls.hsk_hello_verify_requests;</span>
<span class='curline'><a href='../S/5300.html#L2467'>session</a>          2467 lib/handshake.c 	gnutls_free(session-&gt;internals.dtls.dcookie.data);</span>
<span class='curline'><a href='../S/5300.html#L2468'>session</a>          2468 lib/handshake.c 	ret = _gnutls_set_datum(&amp;session-&gt;internals.dtls.dcookie, &amp;data[pos], cookie_len);</span>
<span class='curline'><a href='../S/5300.html#L2478'>session</a>          2478 lib/handshake.c 	handshake_hash_buffer_reset(session);</span>
<span class='curline'><a href='../S/5300.html#L2480'>session</a>          2480 lib/handshake.c 	session-&gt;internals.used_exts = 0;</span>
<span class='curline'><a href='../S/5300.html#L2560'>session</a>          2560 lib/handshake.c int gnutls_rehandshake(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L2563'>session</a>          2563 lib/handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L2566'>session</a>          2566 lib/handshake.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5300.html#L2570'>session</a>          2570 lib/handshake.c 		return gnutls_session_key_update(session, GNUTLS_KU_PEER);</span>
<span class='curline'><a href='../S/5300.html#L2573'>session</a>          2573 lib/handshake.c 	_dtls_async_timer_delete(session);</span>
<span class='curline'><a href='../S/5300.html#L2576'>session</a>          2576 lib/handshake.c 	    _gnutls_send_empty_handshake(session,</span>
<span class='curline'><a href='../S/5300.html#L2596'>session</a>          2596 lib/handshake.c _gnutls_abort_handshake(gnutls_session_t session, int ret)</span>
<span class='curline'><a href='../S/5300.html#L2600'>session</a>          2600 lib/handshake.c 		if (gnutls_alert_get(session) == GNUTLS_A_NO_RENEGOTIATION) {</span>
<span class='curline'><a href='../S/5300.html#L2602'>session</a>          2602 lib/handshake.c 			if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5300.html#L2611'>session</a>          2611 lib/handshake.c 			if (session-&gt;internals.initial_negotiation_completed ||</span>
<span class='curline'><a href='../S/5300.html#L2612'>session</a>          2612 lib/handshake.c 			    !(session-&gt;internals.hsk_flags &amp; HSK_SERVER_HELLO_RECEIVED)) {</span>
<span class='curline'><a href='../S/5300.html#L2629'>session</a>          2629 lib/handshake.c static int _gnutls_send_supplemental(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5300.html#L2634'>session</a>          2634 lib/handshake.c 	_gnutls_debug_log("EXT[%p]: Sending supplemental data\n", session);</span>
<span class='curline'><a href='../S/5300.html#L2642'>session</a>          2642 lib/handshake.c 		ret = _gnutls_gen_supplemental(session, &amp;buf);</span>
<span class='curline'><a href='../S/5300.html#L2652'>session</a>          2652 lib/handshake.c 	return _gnutls_send_handshake(session, bufel,</span>
<span class='curline'><a href='../S/5300.html#L2656'>session</a>          2656 lib/handshake.c static int _gnutls_recv_supplemental(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L2662'>session</a>          2662 lib/handshake.c 			  session);</span>
<span class='curline'><a href='../S/5300.html#L2665'>session</a>          2665 lib/handshake.c 	    _gnutls_recv_handshake(session, GNUTLS_HANDSHAKE_SUPPLEMENTAL,</span>
<span class='curline'><a href='../S/5300.html#L2672'>session</a>          2672 lib/handshake.c 	ret = _gnutls_parse_supplemental(session, buf.data, buf.length);</span>
<span class='curline'><a href='../S/5300.html#L2721'>session</a>          2721 lib/handshake.c int gnutls_handshake(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L2723'>session</a>          2723 lib/handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L2726'>session</a>          2726 lib/handshake.c 	if (unlikely(session-&gt;internals.initial_negotiation_completed)) {</span>
<span class='curline'><a href='../S/5300.html#L2728'>session</a>          2728 lib/handshake.c 			if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5300.html#L2729'>session</a>          2729 lib/handshake.c 				return gnutls_session_key_update(session, GNUTLS_KU_PEER);</span>
<span class='curline'><a href='../S/5300.html#L2746'>session</a>          2746 lib/handshake.c 		if (session-&gt;internals.priorities == NULL ||</span>
<span class='curline'><a href='../S/5300.html#L2747'>session</a>          2747 lib/handshake.c 		    session-&gt;internals.priorities-&gt;cs.size == 0)</span>
<span class='curline'><a href='../S/5300.html#L2751'>session</a>          2751 lib/handshake.c 		    _gnutls_epoch_setup_next(session, 0, NULL);</span>
<span class='curline'><a href='../S/5300.html#L2755'>session</a>          2755 lib/handshake.c 		session-&gt;internals.used_exts = 0;</span>
<span class='curline'><a href='../S/5300.html#L2756'>session</a>          2756 lib/handshake.c 		session-&gt;internals.hsk_flags = 0;</span>
<span class='curline'><a href='../S/5300.html#L2757'>session</a>          2757 lib/handshake.c 		session-&gt;internals.handshake_in_progress = 1;</span>
<span class='curline'><a href='../S/5300.html#L2758'>session</a>          2758 lib/handshake.c 		session-&gt;internals.vc_status = -1;</span>
<span class='curline'><a href='../S/5300.html#L2759'>session</a>          2759 lib/handshake.c 		gnutls_gettime(&amp;session-&gt;internals.handshake_start_time);</span>
<span class='curline'><a href='../S/5300.html#L2761'>session</a>          2761 lib/handshake.c 		tmo_ms = session-&gt;internals.handshake_timeout_ms;</span>
<span class='curline'><a href='../S/5300.html#L2762'>session</a>          2762 lib/handshake.c 		end = &amp;session-&gt;internals.handshake_abs_timeout;</span>
<span class='curline'><a href='../S/5300.html#L2763'>session</a>          2763 lib/handshake.c 		start = &amp;session-&gt;internals.handshake_start_time;</span>
<span class='curline'><a href='../S/5300.html#L2773'>session</a>          2773 lib/handshake.c 	if (session-&gt;internals.recv_state == RECV_STATE_FALSE_START) {</span>
<span class='curline'><a href='../S/5300.html#L2774'>session</a>          2774 lib/handshake.c 		session_invalidate(session);</span>
<span class='curline'><a href='../S/5300.html#L2778'>session</a>          2778 lib/handshake.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5300.html#L2780'>session</a>          2780 lib/handshake.c 			ret = handshake_client(session);</span>
<span class='curline'><a href='../S/5300.html#L2783'>session</a>          2783 lib/handshake.c 		ret = handshake_server(session);</span>
<span class='curline'><a href='../S/5300.html#L2787'>session</a>          2787 lib/handshake.c 		return _gnutls_abort_handshake(session, ret);</span>
<span class='curline'><a href='../S/5300.html#L2791'>session</a>          2791 lib/handshake.c 	if (session-&gt;internals.recv_state != RECV_STATE_FALSE_START &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L2792'>session</a>          2792 lib/handshake.c 	    session-&gt;internals.recv_state != RECV_STATE_EARLY_START) {</span>
<span class='curline'><a href='../S/5300.html#L2794'>session</a>          2794 lib/handshake.c 		_gnutls_handshake_hash_buffers_clear(session);</span>
<span class='curline'><a href='../S/5300.html#L2796'>session</a>          2796 lib/handshake.c 		if (IS_DTLS(session) == 0) {</span>
<span class='curline'><a href='../S/5300.html#L2797'>session</a>          2797 lib/handshake.c 			_gnutls_handshake_io_buffer_clear(session);</span>
<span class='curline'><a href='../S/5300.html#L2799'>session</a>          2799 lib/handshake.c 			_dtls_async_timer_init(session);</span>
<span class='curline'><a href='../S/5300.html#L2802'>session</a>          2802 lib/handshake.c 		_gnutls_handshake_internal_state_clear(session);</span>
<span class='curline'><a href='../S/5300.html#L2804'>session</a>          2804 lib/handshake.c 		_gnutls_buffer_clear(&amp;session-&gt;internals.record_presend_buffer);</span>
<span class='curline'><a href='../S/5300.html#L2806'>session</a>          2806 lib/handshake.c 		_gnutls_epoch_bump(session);</span>
<span class='curline'><a href='../S/5300.html#L2810'>session</a>          2810 lib/handshake.c 	if (!IS_SERVER(session) &amp;&amp; vers-&gt;tls13_sem) {</span>
<span class='curline'><a href='../S/5300.html#L2814'>session</a>          2814 lib/handshake.c 		if (!(session-&gt;internals.hsk_flags &amp; HSK_HRR_RECEIVED)) {</span>
<span class='curline'><a href='../S/5300.html#L2815'>session</a>          2815 lib/handshake.c 			session-&gt;internals.ertt = timespec_sub_ms(&amp;handshake_finish_time, &amp;session-&gt;internals.handshake_start_time)/2;</span>
<span class='curline'><a href='../S/5300.html#L2817'>session</a>          2817 lib/handshake.c 			session-&gt;internals.ertt = timespec_sub_ms(&amp;handshake_finish_time, &amp;session-&gt;internals.handshake_start_time)/4;</span>
<span class='curline'><a href='../S/5300.html#L2841'>session</a>          2841 lib/handshake.c gnutls_handshake_set_timeout(gnutls_session_t session, unsigned int ms)</span>
<span class='curline'><a href='../S/5300.html#L2844'>session</a>          2844 lib/handshake.c 		session-&gt;internals.handshake_timeout_ms = 0;</span>
<span class='curline'><a href='../S/5300.html#L2851'>session</a>          2851 lib/handshake.c 	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5300.html#L2852'>session</a>          2852 lib/handshake.c 		gnutls_dtls_set_timeouts(session, DTLS_RETRANS_TIMEOUT, ms);</span>
<span class='curline'><a href='../S/5300.html#L2856'>session</a>          2856 lib/handshake.c 	session-&gt;internals.handshake_timeout_ms = ms;</span>
<span class='curline'><a href='../S/5300.html#L2863'>session</a>          2863 lib/handshake.c int _gnutls_run_verify_callback(gnutls_session_t session, unsigned int side)</span>
<span class='curline'><a href='../S/5300.html#L2868'>session</a>          2868 lib/handshake.c 	if (session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED)</span>
<span class='curline'><a href='../S/5300.html#L2872'>session</a>          2872 lib/handshake.c 	    (gnutls_certificate_credentials_t) _gnutls_get_cred(session,</span>
<span class='curline'><a href='../S/5300.html#L2876'>session</a>          2876 lib/handshake.c 		type = gnutls_auth_server_get_type(session);</span>
<span class='curline'><a href='../S/5300.html#L2878'>session</a>          2878 lib/handshake.c 		type = gnutls_auth_client_get_type(session);</span>
<span class='curline'><a href='../S/5300.html#L2886'>session</a>          2886 lib/handshake.c 		ret = _gnutls_check_if_cert_hash_is_same(session, cred);</span>
<span class='curline'><a href='../S/5300.html#L2893'>session</a>          2893 lib/handshake.c 	    (cred-&gt;verify_callback != NULL || session-&gt;internals.verify_callback != NULL) &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L2894'>session</a>          2894 lib/handshake.c 	    (session-&gt;security_parameters.entity == GNUTLS_CLIENT ||</span>
<span class='curline'><a href='../S/5300.html#L2895'>session</a>          2895 lib/handshake.c 	     session-&gt;internals.send_cert_req != GNUTLS_CERT_IGNORE)) {</span>
<span class='curline'><a href='../S/5300.html#L2896'>session</a>          2896 lib/handshake.c 		if (session-&gt;internals.verify_callback)</span>
<span class='curline'><a href='../S/5300.html#L2897'>session</a>          2897 lib/handshake.c 			ret = session-&gt;internals.verify_callback(session);</span>
<span class='curline'><a href='../S/5300.html#L2899'>session</a>          2899 lib/handshake.c 			ret = cred-&gt;verify_callback(session);</span>
<span class='curline'><a href='../S/5300.html#L2909'>session</a>          2909 lib/handshake.c static bool can_send_false_start(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L2913'>session</a>          2913 lib/handshake.c 	vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L2917'>session</a>          2917 lib/handshake.c 	if (session-&gt;internals.selected_cert_list != NULL)</span>
<span class='curline'><a href='../S/5300.html#L2920'>session</a>          2920 lib/handshake.c 	if (!_gnutls_kx_allows_false_start(session))</span>
<span class='curline'><a href='../S/5300.html#L2930'>session</a>          2930 lib/handshake.c static int handshake_client(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L2937'>session</a>          2937 lib/handshake.c 		return _gnutls13_handshake_client(session);</span>
<span class='curline'><a href='../S/5300.html#L2942'>session</a>          2942 lib/handshake.c 		ret = send_client_hello(session, AGAIN(STATE1));</span>
<span class='curline'><a href='../S/5300.html#L2947'>session</a>          2947 lib/handshake.c 		if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5300.html#L2949'>session</a>          2949 lib/handshake.c 			    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5300.html#L2961'>session</a>          2961 lib/handshake.c 			    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5300.html#L2976'>session</a>          2976 lib/handshake.c 		    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5300.html#L2983'>session</a>          2983 lib/handshake.c 		ver = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L2989'>session</a>          2989 lib/handshake.c 		ret = _gnutls_ext_sr_verify(session);</span>
<span class='curline'><a href='../S/5300.html#L2994'>session</a>          2994 lib/handshake.c 		if (session-&gt;security_parameters.do_recv_supplemental) {</span>
<span class='curline'><a href='../S/5300.html#L2995'>session</a>          2995 lib/handshake.c 			ret = _gnutls_recv_supplemental(session);</span>
<span class='curline'><a href='../S/5300.html#L3002'>session</a>          3002 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3003'>session</a>          3003 lib/handshake.c 			ret = _gnutls_recv_server_certificate(session);</span>
<span class='curline'><a href='../S/5300.html#L3010'>session</a>          3010 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3013'>session</a>          3013 lib/handshake.c 			    (session);</span>
<span class='curline'><a href='../S/5300.html#L3019'>session</a>          3019 lib/handshake.c 		ret = _gnutls_run_verify_callback(session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5300.html#L3027'>session</a>          3027 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3028'>session</a>          3028 lib/handshake.c 			ret = _gnutls_recv_server_kx_message(session);</span>
<span class='curline'><a href='../S/5300.html#L3036'>session</a>          3036 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3037'>session</a>          3037 lib/handshake.c 			ret = _gnutls_recv_server_crt_request(session);</span>
<span class='curline'><a href='../S/5300.html#L3044'>session</a>          3044 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3046'>session</a>          3046 lib/handshake.c 			    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5300.html#L3053'>session</a>          3053 lib/handshake.c 		if (session-&gt;security_parameters.do_send_supplemental) {</span>
<span class='curline'><a href='../S/5300.html#L3055'>session</a>          3055 lib/handshake.c 			    _gnutls_send_supplemental(session,</span>
<span class='curline'><a href='../S/5300.html#L3064'>session</a>          3064 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3066'>session</a>          3066 lib/handshake.c 			    _gnutls_send_client_certificate(session,</span>
<span class='curline'><a href='../S/5300.html#L3073'>session</a>          3073 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3075'>session</a>          3075 lib/handshake.c 			    _gnutls_send_client_kx_message(session,</span>
<span class='curline'><a href='../S/5300.html#L3082'>session</a>          3082 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3084'>session</a>          3084 lib/handshake.c 			    _gnutls_send_client_certificate_verify(session,</span>
<span class='curline'><a href='../S/5300.html#L3092'>session</a>          3092 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE) {</span>
<span class='curline'><a href='../S/5300.html#L3093'>session</a>          3093 lib/handshake.c 			ret = send_handshake_final(session, TRUE);</span>
<span class='curline'><a href='../S/5300.html#L3096'>session</a>          3096 lib/handshake.c 			ret = _gnutls_recv_new_session_ticket(session);</span>
<span class='curline'><a href='../S/5300.html#L3103'>session</a>          3103 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE &amp;&amp; (session-&gt;internals.flags &amp; GNUTLS_ENABLE_FALSE_START) &amp;&amp; can_send_false_start(session)) {</span>
<span class='curline'><a href='../S/5300.html#L3104'>session</a>          3104 lib/handshake.c 			session-&gt;internals.hsk_flags |= HSK_FALSE_START_USED;</span>
<span class='curline'><a href='../S/5300.html#L3105'>session</a>          3105 lib/handshake.c 			session-&gt;internals.recv_state = RECV_STATE_FALSE_START;</span>
<span class='curline'><a href='../S/5300.html#L3118'>session</a>          3118 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE) {</span>
<span class='curline'><a href='../S/5300.html#L3119'>session</a>          3119 lib/handshake.c 			ret = _gnutls_recv_new_session_ticket(session);</span>
<span class='curline'><a href='../S/5300.html#L3123'>session</a>          3123 lib/handshake.c 			ret = recv_handshake_final(session, TRUE);</span>
<span class='curline'><a href='../S/5300.html#L3129'>session</a>          3129 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE) {</span>
<span class='curline'><a href='../S/5300.html#L3130'>session</a>          3130 lib/handshake.c 			ret = recv_handshake_final(session, FALSE);</span>
<span class='curline'><a href='../S/5300.html#L3133'>session</a>          3133 lib/handshake.c 			ret = send_handshake_final(session, FALSE);</span>
<span class='curline'><a href='../S/5300.html#L3144'>session</a>          3144 lib/handshake.c 	gnutls_mutex_lock(&amp;session-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5300.html#L3145'>session</a>          3145 lib/handshake.c 	session-&gt;internals.initial_negotiation_completed = 1;</span>
<span class='curline'><a href='../S/5300.html#L3146'>session</a>          3146 lib/handshake.c 	session-&gt;internals.recv_state = RECV_STATE_0;</span>
<span class='curline'><a href='../S/5300.html#L3147'>session</a>          3147 lib/handshake.c 	gnutls_mutex_unlock(&amp;session-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5300.html#L3157'>session</a>          3157 lib/handshake.c ssize_t _gnutls_send_change_cipher_spec(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5300.html#L3165'>session</a>          3165 lib/handshake.c 		bufel = _gnutls_handshake_alloc(session, 3); /* max for DTLS0.9 */</span>
<span class='curline'><a href='../S/5300.html#L3169'>session</a>          3169 lib/handshake.c 		vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L3183'>session</a>          3183 lib/handshake.c 			_gnutls_write_uint16(session-&gt;internals.dtls.</span>
<span class='curline'><a href='../S/5300.html#L3185'>session</a>          3185 lib/handshake.c 			session-&gt;internals.dtls.hsk_write_seq++;</span>
<span class='curline'><a href='../S/5300.html#L3188'>session</a>          3188 lib/handshake.c 		ret = _gnutls_call_hook_func(session, GNUTLS_HANDSHAKE_CHANGE_CIPHER_SPEC, GNUTLS_HOOK_PRE, 0,</span>
<span class='curline'><a href='../S/5300.html#L3196'>session</a>          3196 lib/handshake.c 		    _gnutls_handshake_io_cache_int(session,</span>
<span class='curline'><a href='../S/5300.html#L3204'>session</a>          3204 lib/handshake.c 		ret = _gnutls_call_hook_func(session, GNUTLS_HANDSHAKE_CHANGE_CIPHER_SPEC, GNUTLS_HOOK_POST, 0,</span>
<span class='curline'><a href='../S/5300.html#L3213'>session</a>          3213 lib/handshake.c 			ret = _gnutls_handshake_io_write_flush(session);</span>
<span class='curline'><a href='../S/5300.html#L3219'>session</a>          3219 lib/handshake.c 				      session);</span>
<span class='curline'><a href='../S/5300.html#L3227'>session</a>          3227 lib/handshake.c static int send_handshake_final(gnutls_session_t session, int init)</span>
<span class='curline'><a href='../S/5300.html#L3236'>session</a>          3236 lib/handshake.c 		ret = _gnutls_send_change_cipher_spec(session, FAGAIN(STATE1));</span>
<span class='curline'><a href='../S/5300.html#L3246'>session</a>          3246 lib/handshake.c 			ret = _gnutls_connection_state_init(session);</span>
<span class='curline'><a href='../S/5300.html#L3253'>session</a>          3253 lib/handshake.c 		ret = _gnutls_write_connection_state_init(session);</span>
<span class='curline'><a href='../S/5300.html#L3262'>session</a>          3262 lib/handshake.c 		ret = _gnutls_send_finished(session, FAGAIN(STATE2));</span>
<span class='curline'><a href='../S/5300.html#L3282'>session</a>          3282 lib/handshake.c static int recv_handshake_final(gnutls_session_t session, int init)</span>
<span class='curline'><a href='../S/5300.html#L3290'>session</a>          3290 lib/handshake.c 	ret = handshake_remaining_time(session);</span>
<span class='curline'><a href='../S/5300.html#L3303'>session</a>          3303 lib/handshake.c 		if (IS_DTLS(session) &amp;&amp; !_dtls_is_async(session) &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L3304'>session</a>          3304 lib/handshake.c 		    (gnutls_record_check_pending(session) +</span>
<span class='curline'><a href='../S/5300.html#L3305'>session</a>          3305 lib/handshake.c 		     record_check_unprocessed(session)) == 0) {</span>
<span class='curline'><a href='../S/5300.html#L3306'>session</a>          3306 lib/handshake.c 			ret = _dtls_wait_and_retransmit(session);</span>
<span class='curline'><a href='../S/5300.html#L3311'>session</a>          3311 lib/handshake.c 		vers = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L3319'>session</a>          3319 lib/handshake.c 		    _gnutls_recv_int(session, GNUTLS_CHANGE_CIPHER_SPEC,</span>
<span class='curline'><a href='../S/5300.html#L3327'>session</a>          3327 lib/handshake.c 			session-&gt;internals.dtls.hsk_read_seq++;</span>
<span class='curline'><a href='../S/5300.html#L3331'>session</a>          3331 lib/handshake.c 			ret = _gnutls_connection_state_init(session);</span>
<span class='curline'><a href='../S/5300.html#L3338'>session</a>          3338 lib/handshake.c 		ret = _gnutls_read_connection_state_init(session);</span>
<span class='curline'><a href='../S/5300.html#L3347'>session</a>          3347 lib/handshake.c 		if (IS_DTLS(session) &amp;&amp; !_dtls_is_async(session) &amp;&amp;</span>
<span class='curline'><a href='../S/5300.html#L3348'>session</a>          3348 lib/handshake.c 		    (gnutls_record_check_pending(session) +</span>
<span class='curline'><a href='../S/5300.html#L3349'>session</a>          3349 lib/handshake.c 		     record_check_unprocessed(session)) == 0) {</span>
<span class='curline'><a href='../S/5300.html#L3350'>session</a>          3350 lib/handshake.c 			ret = _dtls_wait_and_retransmit(session);</span>
<span class='curline'><a href='../S/5300.html#L3355'>session</a>          3355 lib/handshake.c 		ret = _gnutls_recv_finished(session);</span>
<span class='curline'><a href='../S/5300.html#L3373'>session</a>          3373 lib/handshake.c static int handshake_server(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L3381'>session</a>          3381 lib/handshake.c 		return _gnutls13_handshake_server(session);</span>
<span class='curline'><a href='../S/5300.html#L3387'>session</a>          3387 lib/handshake.c 		    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5300.html#L3401'>session</a>          3401 lib/handshake.c 			session-&gt;internals.hsk_flags |= HSK_HRR_SENT;</span>
<span class='curline'><a href='../S/5300.html#L3409'>session</a>          3409 lib/handshake.c 		ret = _gnutls_ext_sr_verify(session);</span>
<span class='curline'><a href='../S/5300.html#L3414'>session</a>          3414 lib/handshake.c 		ret = _gnutls_send_server_hello(session, AGAIN(STATE3));</span>
<span class='curline'><a href='../S/5300.html#L3418'>session</a>          3418 lib/handshake.c 		ver = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L3426'>session</a>          3426 lib/handshake.c 		if (session-&gt;security_parameters.do_send_supplemental) {</span>
<span class='curline'><a href='../S/5300.html#L3428'>session</a>          3428 lib/handshake.c 			    _gnutls_send_supplemental(session,</span>
<span class='curline'><a href='../S/5300.html#L3438'>session</a>          3438 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)</span>
<span class='curline'><a href='../S/5300.html#L3440'>session</a>          3440 lib/handshake.c 			    _gnutls_send_server_certificate(session,</span>
<span class='curline'><a href='../S/5300.html#L3447'>session</a>          3447 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)</span>
<span class='curline'><a href='../S/5300.html#L3449'>session</a>          3449 lib/handshake.c 			    _gnutls_send_server_certificate_status(session,</span>
<span class='curline'><a href='../S/5300.html#L3458'>session</a>          3458 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)</span>
<span class='curline'><a href='../S/5300.html#L3460'>session</a>          3460 lib/handshake.c 			    _gnutls_send_server_kx_message(session,</span>
<span class='curline'><a href='../S/5300.html#L3467'>session</a>          3467 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)</span>
<span class='curline'><a href='../S/5300.html#L3469'>session</a>          3469 lib/handshake.c 			    _gnutls_send_server_crt_request(session,</span>
<span class='curline'><a href='../S/5300.html#L3476'>session</a>          3476 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3478'>session</a>          3478 lib/handshake.c 			    _gnutls_send_empty_handshake(session,</span>
<span class='curline'><a href='../S/5300.html#L3485'>session</a>          3485 lib/handshake.c 		if (session-&gt;security_parameters.do_recv_supplemental) {</span>
<span class='curline'><a href='../S/5300.html#L3486'>session</a>          3486 lib/handshake.c 			ret = _gnutls_recv_supplemental(session);</span>
<span class='curline'><a href='../S/5300.html#L3494'>session</a>          3494 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3495'>session</a>          3495 lib/handshake.c 			ret = _gnutls_recv_client_certificate(session);</span>
<span class='curline'><a href='../S/5300.html#L3500'>session</a>          3500 lib/handshake.c 		ret = _gnutls_run_verify_callback(session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5300.html#L3507'>session</a>          3507 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3508'>session</a>          3508 lib/handshake.c 			ret = _gnutls_recv_client_kx_message(session);</span>
<span class='curline'><a href='../S/5300.html#L3514'>session</a>          3514 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE)	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3517'>session</a>          3517 lib/handshake.c 			    (session);</span>
<span class='curline'><a href='../S/5300.html#L3523'>session</a>          3523 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE) {	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3524'>session</a>          3524 lib/handshake.c 			ret = recv_handshake_final(session, TRUE);</span>
<span class='curline'><a href='../S/5300.html#L3527'>session</a>          3527 lib/handshake.c 			ret = send_handshake_final(session, TRUE);</span>
<span class='curline'><a href='../S/5300.html#L3533'>session</a>          3533 lib/handshake.c 		    _gnutls_send_new_session_ticket(session,</span>
<span class='curline'><a href='../S/5300.html#L3540'>session</a>          3540 lib/handshake.c 		if (session-&gt;internals.resumed == RESUME_FALSE) {	/* if we are not resuming */</span>
<span class='curline'><a href='../S/5300.html#L3541'>session</a>          3541 lib/handshake.c 			ret = send_handshake_final(session, FALSE);</span>
<span class='curline'><a href='../S/5300.html#L3544'>session</a>          3544 lib/handshake.c 			if (session-&gt;security_parameters.entity ==</span>
<span class='curline'><a href='../S/5300.html#L3546'>session</a>          3546 lib/handshake.c 			    &amp;&amp; !(session-&gt;internals.hsk_flags &amp; HSK_TLS12_TICKET_SENT)) {</span>
<span class='curline'><a href='../S/5300.html#L3549'>session</a>          3549 lib/handshake.c 				    (session);</span>
<span class='curline'><a href='../S/5300.html#L3552'>session</a>          3552 lib/handshake.c 			ret = recv_handshake_final(session, FALSE);</span>
<span class='curline'><a href='../S/5300.html#L3564'>session</a>          3564 lib/handshake.c 	session-&gt;internals.initial_negotiation_completed = 1;</span>
<span class='curline'><a href='../S/5300.html#L3566'>session</a>          3566 lib/handshake.c 	return _gnutls_check_id_for_change(session);</span>
<span class='curline'><a href='../S/5300.html#L3605'>session</a>          3605 lib/handshake.c gnutls_handshake_set_max_packet_length(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5300.html#L3608'>session</a>          3608 lib/handshake.c 	session-&gt;internals.max_handshake_data_buffer_size = max;</span>
<span class='curline'><a href='../S/5300.html#L3626'>session</a>          3626 lib/handshake.c gnutls_handshake_get_last_in(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L3628'>session</a>          3628 lib/handshake.c 	return session-&gt;internals.last_handshake_in;</span>
<span class='curline'><a href='../S/5300.html#L3646'>session</a>          3646 lib/handshake.c gnutls_handshake_get_last_out(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5300.html#L3648'>session</a>          3648 lib/handshake.c 	return session-&gt;internals.last_handshake_out;</span>
<span class='curline'><a href='../S/5300.html#L3653'>session</a>          3653 lib/handshake.c int _gnutls_handshake_get_session_hash(gnutls_session_t session, gnutls_datum_t *shash)</span>
<span class='curline'><a href='../S/5300.html#L3655'>session</a>          3655 lib/handshake.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5300.html#L3662'>session</a>          3662 lib/handshake.c 	if (session-&gt;internals.handshake_hash_buffer_client_kx_len == 0 ||</span>
<span class='curline'><a href='../S/5300.html#L3663'>session</a>          3663 lib/handshake.c 	    (session-&gt;internals.handshake_hash_buffer.length &lt;</span>
<span class='curline'><a href='../S/5300.html#L3664'>session</a>          3664 lib/handshake.c 	    session-&gt;internals.handshake_hash_buffer_client_kx_len)) {</span>
<span class='curline'><a href='../S/5300.html#L3669'>session</a>          3669 lib/handshake.c 	    _gnutls_hash_fast((gnutls_digest_algorithm_t)session-&gt;security_parameters.prf-&gt;id,</span>
<span class='curline'><a href='../S/5300.html#L3670'>session</a>          3670 lib/handshake.c 			      session-&gt;internals.handshake_hash_buffer.</span>
<span class='curline'><a href='../S/5300.html#L3672'>session</a>          3672 lib/handshake.c 			      session-&gt;internals.handshake_hash_buffer_client_kx_len,</span>
<span class='curline'><a href='../S/5300.html#L3677'>session</a>          3677 lib/handshake.c 	return _gnutls_set_datum(shash, concat, session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5744.html#L41'>session</a>            41 lib/handshake.h 		if (ret == GNUTLS_E_GOT_APPLICATION_DATA &amp;&amp; session-&gt;internals.initial_negotiation_completed != 0) \</span>
<span class='curline'><a href='../S/5744.html#L43'>session</a>            43 lib/handshake.h 		if (session-&gt;internals.handshake_suspicious_loops &lt; 16) { \</span>
<span class='curline'><a href='../S/5744.html#L45'>session</a>            45 lib/handshake.h 				session-&gt;internals.handshake_suspicious_loops++; \</span>
<span class='curline'><a href='../S/5744.html#L50'>session</a>            50 lib/handshake.h 				session-&gt;internals.handshake_suspicious_loops++; \</span>
<span class='curline'><a href='../S/5744.html#L57'>session</a>            57 lib/handshake.h 		session_invalidate(session); \</span>
<span class='curline'><a href='../S/5744.html#L58'>session</a>            58 lib/handshake.h 		_gnutls_handshake_hash_buffers_clear(session); \</span>
<span class='curline'><a href='../S/5744.html#L67'>session</a>            67 lib/handshake.h 		session_invalidate(session); \</span>
<span class='curline'><a href='../S/5744.html#L68'>session</a>            68 lib/handshake.h 		_gnutls_handshake_hash_buffers_clear(session); \</span>
<span class='curline'><a href='../S/5744.html#L72'>session</a>            72 lib/handshake.h int _gnutls_send_handshake(gnutls_session_t session, mbuffer_st * bufel,</span>
<span class='curline'><a href='../S/5744.html#L74'>session</a>            74 lib/handshake.h int _gnutls_recv_handshake(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5744.html#L79'>session</a>            79 lib/handshake.h _gnutls_send_handshake2(gnutls_session_t session, mbuffer_st * bufel,</span>
<span class='curline'><a href='../S/5744.html#L83'>session</a>            83 lib/handshake.h int _gnutls_gen_server_random(gnutls_session_t session, int version);</span>
<span class='curline'><a href='../S/5744.html#L84'>session</a>            84 lib/handshake.h void _gnutls_set_client_random(gnutls_session_t session, uint8_t * rnd);</span>
<span class='curline'><a href='../S/5744.html#L86'>session</a>            86 lib/handshake.h ssize_t _gnutls_send_change_cipher_spec(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5744.html#L88'>session</a>            88 lib/handshake.h int _gnutls_send_server_hello(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5744.html#L91'>session</a>            91 lib/handshake.h int _gnutls_server_select_suite(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5744.html#L94'>session</a>            94 lib/handshake.h int _gnutls_negotiate_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5744.html#L97'>session</a>            97 lib/handshake.h int _gnutls_user_hello_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5744.html#L100'>session</a>           100 lib/handshake.h void _gnutls_handshake_hash_buffers_clear(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5744.html#L102'>session</a>           102 lib/handshake.h int _gnutls13_handshake_hash_buffers_synth(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5744.html#L106'>session</a>           106 lib/handshake.h #define STATE session-&gt;internals.handshake_state</span>
<span class='curline'><a href='../S/5744.html#L107'>session</a>           107 lib/handshake.h #define FINAL_STATE session-&gt;internals.handshake_final_state</span>
<span class='curline'><a href='../S/5744.html#L116'>session</a>           116 lib/handshake.h inline static int handshake_remaining_time(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5744.html#L118'>session</a>           118 lib/handshake.h 	struct timespec *end = &amp;session-&gt;internals.handshake_abs_timeout;</span>
<span class='curline'><a href='../S/5744.html#L141'>session</a>           141 lib/handshake.h inline static unsigned have_creds_for_tls13(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5744.html#L143'>session</a>           143 lib/handshake.h 	assert(session-&gt;security_parameters.entity == GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5744.html#L144'>session</a>           144 lib/handshake.h 	if (_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE) != NULL ||</span>
<span class='curline'><a href='../S/5744.html#L145'>session</a>           145 lib/handshake.h 	    _gnutls_get_cred(session, GNUTLS_CRD_PSK) != NULL)</span>
<span class='curline'><a href='../S/5744.html#L151'>session</a>           151 lib/handshake.h int _gnutls_handshake_get_session_hash(gnutls_session_t session, gnutls_datum_t *shash);</span>
<span class='curline'><a href='../S/5744.html#L153'>session</a>           153 lib/handshake.h int _gnutls_check_id_for_change(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5744.html#L154'>session</a>           154 lib/handshake.h int _gnutls_check_if_cert_hash_is_same(gnutls_session_t session, gnutls_certificate_credentials_t cred);</span>
<span class='curline'><a href='../S/5744.html#L158'>session</a>           158 lib/handshake.h int _gnutls_call_hook_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5744.html#L163'>session</a>           163 lib/handshake.h int _gnutls_run_verify_callback(gnutls_session_t session, unsigned int side);</span>
<span class='curline'><a href='../S/5744.html#L164'>session</a>           164 lib/handshake.h int _gnutls_recv_finished(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5744.html#L165'>session</a>           165 lib/handshake.h int _gnutls_send_finished(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5744.html#L167'>session</a>           167 lib/handshake.h int _gnutls13_handshake_client(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5744.html#L168'>session</a>           168 lib/handshake.h int _gnutls13_handshake_server(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5744.html#L171'>session</a>           171 lib/handshake.h _gnutls13_recv_hello_retry_request(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5744.html#L175'>session</a>           175 lib/handshake.h _gnutls13_recv_async_handshake(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5633.html#L62'>session</a>            62 lib/hello_ext.c unset_ext_data(gnutls_session_t session, const struct hello_ext_entry_st *, unsigned idx);</span>
<span class='curline'><a href='../S/5633.html#L64'>session</a>            64 lib/hello_ext.c static void unset_resumed_ext_data(gnutls_session_t session, const struct hello_ext_entry_st *, unsigned idx);</span>
<span class='curline'><a href='../S/5633.html#L107'>session</a>           107 lib/hello_ext.c gid_to_ext_entry(gnutls_session_t session, extensions_t id)</span>
<span class='curline'><a href='../S/5633.html#L113'>session</a>           113 lib/hello_ext.c 	for (i=0;i&lt;session-&gt;internals.rexts_size;i++) {</span>
<span class='curline'><a href='../S/5633.html#L114'>session</a>           114 lib/hello_ext.c 		if (session-&gt;internals.rexts[i].gid == id) {</span>
<span class='curline'><a href='../S/5633.html#L115'>session</a>           115 lib/hello_ext.c 			return &amp;session-&gt;internals.rexts[i];</span>
<span class='curline'><a href='../S/5633.html#L123'>session</a>           123 lib/hello_ext.c tls_id_to_ext_entry(gnutls_session_t session, uint16_t tls_id, gnutls_ext_parse_type_t parse_point)</span>
<span class='curline'><a href='../S/5633.html#L128'>session</a>           128 lib/hello_ext.c 	for (i=0;i&lt;session-&gt;internals.rexts_size;i++) {</span>
<span class='curline'><a href='../S/5633.html#L129'>session</a>           129 lib/hello_ext.c 		if (session-&gt;internals.rexts[i].tls_id == tls_id) {</span>
<span class='curline'><a href='../S/5633.html#L130'>session</a>           130 lib/hello_ext.c 			e = &amp;session-&gt;internals.rexts[i];</span>
<span class='curline'><a href='../S/5633.html#L147'>session</a>           147 lib/hello_ext.c 	if (parse_point == GNUTLS_EXT_ANY || (IS_SERVER(session) &amp;&amp; e-&gt;server_parse_point == parse_point) ||</span>
<span class='curline'><a href='../S/5633.html#L148'>session</a>           148 lib/hello_ext.c 	    (!IS_SERVER(session) &amp;&amp; e-&gt;client_parse_point == parse_point)) {</span>
<span class='curline'><a href='../S/5633.html#L182'>session</a>           182 lib/hello_ext.c static unsigned tls_id_to_gid(gnutls_session_t session, unsigned tls_id)</span>
<span class='curline'><a href='../S/5633.html#L186'>session</a>           186 lib/hello_ext.c 	for (i=0; i &lt; session-&gt;internals.rexts_size; i++) {</span>
<span class='curline'><a href='../S/5633.html#L187'>session</a>           187 lib/hello_ext.c 		if (session-&gt;internals.rexts[i].tls_id == tls_id)</span>
<span class='curline'><a href='../S/5633.html#L188'>session</a>           188 lib/hello_ext.c 			return session-&gt;internals.rexts[i].gid;</span>
<span class='curline'><a href='../S/5633.html#L203'>session</a>           203 lib/hello_ext.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5633.html#L214'>session</a>           214 lib/hello_ext.c 	gnutls_session_t session = ctx-&gt;session;</span>
<span class='curline'><a href='../S/5633.html#L220'>session</a>           220 lib/hello_ext.c 	} else if (ctx-&gt;seen_pre_shared_key &amp;&amp; session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5633.html#L226'>session</a>           226 lib/hello_ext.c 	ext = tls_id_to_ext_entry(session, tls_id, ctx-&gt;parse_point);</span>
<span class='curline'><a href='../S/5633.html#L233'>session</a>           233 lib/hello_ext.c 	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5633.html#L245'>session</a>           245 lib/hello_ext.c 	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5633.html#L247'>session</a>           247 lib/hello_ext.c 		    !_gnutls_hello_ext_is_present(session, ext-&gt;gid)) {</span>
<span class='curline'><a href='../S/5633.html#L248'>session</a>           248 lib/hello_ext.c 			_gnutls_debug_log("EXT[%p]: Received unexpected extension '%s/%d'\n", session,</span>
<span class='curline'><a href='../S/5633.html#L255'>session</a>           255 lib/hello_ext.c 		_gnutls_debug_log("EXT[%p]: Received unexpected extension (%s/%d) for '%s'\n", session,</span>
<span class='curline'><a href='../S/5633.html#L261'>session</a>           261 lib/hello_ext.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5633.html#L262'>session</a>           262 lib/hello_ext.c 		ret = _gnutls_hello_ext_save(session, ext-&gt;gid, 1);</span>
<span class='curline'><a href='../S/5633.html#L269'>session</a>           269 lib/hello_ext.c 	     session, ext-&gt;name, (int)tls_id,</span>
<span class='curline'><a href='../S/5633.html#L272'>session</a>           272 lib/hello_ext.c 	_gnutls_ext_set_msg(session, ctx-&gt;msg);</span>
<span class='curline'><a href='../S/5633.html#L273'>session</a>           273 lib/hello_ext.c 	if ((ret = ext-&gt;recv_func(session, data, data_size)) &lt; 0) {</span>
<span class='curline'><a href='../S/5633.html#L283'>session</a>           283 lib/hello_ext.c 		    ("EXT[%p]: Ignoring extension '%s/%d'\n", session,</span>
<span class='curline'><a href='../S/5633.html#L290'>session</a>           290 lib/hello_ext.c _gnutls_parse_hello_extensions(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L300'>session</a>           300 lib/hello_ext.c 	ctx.session = session;</span>
<span class='curline'><a href='../S/5633.html#L318'>session</a>           318 lib/hello_ext.c 	gnutls_session_t session = ctx-&gt;session;</span>
<span class='curline'><a href='../S/5633.html#L326'>session</a>           326 lib/hello_ext.c 	    ((IS_SERVER(session) &amp;&amp; p-&gt;server_parse_point != ctx-&gt;parse_point) ||</span>
<span class='curline'><a href='../S/5633.html#L327'>session</a>           327 lib/hello_ext.c 	     (!IS_SERVER(session) &amp;&amp; p-&gt;client_parse_point != ctx-&gt;parse_point))) {</span>
<span class='curline'><a href='../S/5633.html#L331'>session</a>           331 lib/hello_ext.c 	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5633.html#L346'>session</a>           346 lib/hello_ext.c 		_gnutls_handshake_log("EXT[%p]: Preparing extension (%s/%d) for '%s'\n", session,</span>
<span class='curline'><a href='../S/5633.html#L353'>session</a>           353 lib/hello_ext.c 	ret = _gnutls_hello_ext_is_present(session, p-&gt;gid);</span>
<span class='curline'><a href='../S/5633.html#L355'>session</a>           355 lib/hello_ext.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5633.html#L367'>session</a>           367 lib/hello_ext.c 	_gnutls_ext_set_msg(session, ctx-&gt;msg);</span>
<span class='curline'><a href='../S/5633.html#L368'>session</a>           368 lib/hello_ext.c 	ret = p-&gt;send_func(session, buf);</span>
<span class='curline'><a href='../S/5633.html#L379'>session</a>           379 lib/hello_ext.c 	    session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5633.html#L381'>session</a>           381 lib/hello_ext.c 		_gnutls_hello_ext_save(session, p-&gt;gid, 0);</span>
<span class='curline'><a href='../S/5633.html#L387'>session</a>           387 lib/hello_ext.c 	_gnutls_handshake_log("EXT[%p]: Not sending extension (%s/%d) for '%s'\n", session,</span>
<span class='curline'><a href='../S/5633.html#L394'>session</a>           394 lib/hello_ext.c _gnutls_gen_hello_extensions(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L405'>session</a>           405 lib/hello_ext.c 	ctx.session = session;</span>
<span class='curline'><a href='../S/5633.html#L414'>session</a>           414 lib/hello_ext.c 	_gnutls_ext_set_extensions_offset(session, pos);</span>
<span class='curline'><a href='../S/5633.html#L416'>session</a>           416 lib/hello_ext.c 	for (i=0; i &lt; session-&gt;internals.rexts_size; i++) {</span>
<span class='curline'><a href='../S/5633.html#L417'>session</a>           417 lib/hello_ext.c 		ctx.ext = &amp;session-&gt;internals.rexts[i];</span>
<span class='curline'><a href='../S/5633.html#L418'>session</a>           418 lib/hello_ext.c 		ret = _gnutls_extv_append(buf, session-&gt;internals.rexts[i].tls_id,</span>
<span class='curline'><a href='../S/5633.html#L426'>session</a>           426 lib/hello_ext.c 				     session, ctx.ext-&gt;name, (int)ctx.ext-&gt;tls_id, ret-4);</span>
<span class='curline'><a href='../S/5633.html#L444'>session</a>           444 lib/hello_ext.c 				     session, ctx.ext-&gt;name, (int)ctx.ext-&gt;tls_id, ret-4);</span>
<span class='curline'><a href='../S/5633.html#L476'>session</a>           476 lib/hello_ext.c static int pack_extension(gnutls_session_t session, const hello_ext_entry_st *extp,</span>
<span class='curline'><a href='../S/5633.html#L486'>session</a>           486 lib/hello_ext.c 	    _gnutls_hello_ext_get_priv(session, extp-&gt;gid,</span>
<span class='curline'><a href='../S/5633.html#L511'>session</a>           511 lib/hello_ext.c int _gnutls_hello_ext_pack(gnutls_session_t session, gnutls_buffer_st *packed)</span>
<span class='curline'><a href='../S/5633.html#L523'>session</a>           523 lib/hello_ext.c 		if (session-&gt;internals.used_exts &amp; ((ext_track_t)1 &lt;&lt; i)) {</span>
<span class='curline'><a href='../S/5633.html#L525'>session</a>           525 lib/hello_ext.c 			ext = gid_to_ext_entry(session, i);</span>
<span class='curline'><a href='../S/5633.html#L529'>session</a>           529 lib/hello_ext.c 			ret = pack_extension(session, ext, packed);</span>
<span class='curline'><a href='../S/5633.html#L543'>session</a>           543 lib/hello_ext.c int _gnutls_ext_set_full_client_hello(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L547'>session</a>           547 lib/hello_ext.c 	gnutls_buffer_st *buf = &amp;session-&gt;internals.full_client_hello;</span>
<span class='curline'><a href='../S/5633.html#L561'>session</a>           561 lib/hello_ext.c unsigned _gnutls_ext_get_full_client_hello(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L564'>session</a>           564 lib/hello_ext.c 	gnutls_buffer_st *buf = &amp;session-&gt;internals.full_client_hello;</span>
<span class='curline'><a href='../S/5633.html#L576'>session</a>           576 lib/hello_ext.c _gnutls_ext_set_resumed_session_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L585'>session</a>           585 lib/hello_ext.c 	ext = gid_to_ext_entry(session, id);</span>
<span class='curline'><a href='../S/5633.html#L588'>session</a>           588 lib/hello_ext.c 	if (session-&gt;internals.ext_data[id].resumed_set != 0)</span>
<span class='curline'><a href='../S/5633.html#L589'>session</a>           589 lib/hello_ext.c 		unset_resumed_ext_data(session, ext, id);</span>
<span class='curline'><a href='../S/5633.html#L591'>session</a>           591 lib/hello_ext.c 	session-&gt;internals.ext_data[id].resumed_priv = data;</span>
<span class='curline'><a href='../S/5633.html#L592'>session</a>           592 lib/hello_ext.c 	session-&gt;internals.ext_data[id].resumed_set = 1;</span>
<span class='curline'><a href='../S/5633.html#L596'>session</a>           596 lib/hello_ext.c int _gnutls_hello_ext_unpack(gnutls_session_t session, gnutls_buffer_st * packed)</span>
<span class='curline'><a href='../S/5633.html#L612'>session</a>           612 lib/hello_ext.c 		ext = gid_to_ext_entry(session, id);</span>
<span class='curline'><a href='../S/5633.html#L631'>session</a>           631 lib/hello_ext.c 		_gnutls_ext_set_resumed_session_data(session, id, data);</span>
<span class='curline'><a href='../S/5633.html#L641'>session</a>           641 lib/hello_ext.c unset_ext_data(gnutls_session_t session, const struct hello_ext_entry_st *ext, unsigned idx)</span>
<span class='curline'><a href='../S/5633.html#L643'>session</a>           643 lib/hello_ext.c 	if (session-&gt;internals.ext_data[idx].set == 0)</span>
<span class='curline'><a href='../S/5633.html#L646'>session</a>           646 lib/hello_ext.c 	if (ext &amp;&amp; ext-&gt;deinit_func &amp;&amp; session-&gt;internals.ext_data[idx].priv != NULL)</span>
<span class='curline'><a href='../S/5633.html#L647'>session</a>           647 lib/hello_ext.c 		ext-&gt;deinit_func(session-&gt;internals.ext_data[idx].priv);</span>
<span class='curline'><a href='../S/5633.html#L648'>session</a>           648 lib/hello_ext.c 	session-&gt;internals.ext_data[idx].set = 0;</span>
<span class='curline'><a href='../S/5633.html#L652'>session</a>           652 lib/hello_ext.c _gnutls_hello_ext_unset_priv(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L657'>session</a>           657 lib/hello_ext.c 	ext = gid_to_ext_entry(session, id);</span>
<span class='curline'><a href='../S/5633.html#L659'>session</a>           659 lib/hello_ext.c 		unset_ext_data(session, ext, id);</span>
<span class='curline'><a href='../S/5633.html#L662'>session</a>           662 lib/hello_ext.c static void unset_resumed_ext_data(gnutls_session_t session, const struct hello_ext_entry_st *ext, unsigned idx)</span>
<span class='curline'><a href='../S/5633.html#L664'>session</a>           664 lib/hello_ext.c 	if (session-&gt;internals.ext_data[idx].resumed_set == 0)</span>
<span class='curline'><a href='../S/5633.html#L667'>session</a>           667 lib/hello_ext.c 	if (ext &amp;&amp; ext-&gt;deinit_func &amp;&amp; session-&gt;internals.ext_data[idx].resumed_priv) {</span>
<span class='curline'><a href='../S/5633.html#L668'>session</a>           668 lib/hello_ext.c 		ext-&gt;deinit_func(session-&gt;internals.ext_data[idx].resumed_priv);</span>
<span class='curline'><a href='../S/5633.html#L670'>session</a>           670 lib/hello_ext.c 	session-&gt;internals.ext_data[idx].resumed_set = 0;</span>
<span class='curline'><a href='../S/5633.html#L675'>session</a>           675 lib/hello_ext.c void _gnutls_hello_ext_priv_deinit(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5633.html#L681'>session</a>           681 lib/hello_ext.c 		if (!session-&gt;internals.ext_data[i].set &amp;&amp; !session-&gt;internals.ext_data[i].resumed_set)</span>
<span class='curline'><a href='../S/5633.html#L684'>session</a>           684 lib/hello_ext.c 		ext = gid_to_ext_entry(session, i);</span>
<span class='curline'><a href='../S/5633.html#L686'>session</a>           686 lib/hello_ext.c 			unset_ext_data(session, ext, i);</span>
<span class='curline'><a href='../S/5633.html#L687'>session</a>           687 lib/hello_ext.c 			unset_resumed_ext_data(session, ext, i);</span>
<span class='curline'><a href='../S/5633.html#L697'>session</a>           697 lib/hello_ext.c _gnutls_hello_ext_set_priv(gnutls_session_t session, extensions_t id,</span>
<span class='curline'><a href='../S/5633.html#L704'>session</a>           704 lib/hello_ext.c 	ext = gid_to_ext_entry(session, id);</span>
<span class='curline'><a href='../S/5633.html#L707'>session</a>           707 lib/hello_ext.c 	if (session-&gt;internals.ext_data[id].set != 0) {</span>
<span class='curline'><a href='../S/5633.html#L708'>session</a>           708 lib/hello_ext.c 		unset_ext_data(session, ext, id);</span>
<span class='curline'><a href='../S/5633.html#L710'>session</a>           710 lib/hello_ext.c 	session-&gt;internals.ext_data[id].priv = data;</span>
<span class='curline'><a href='../S/5633.html#L711'>session</a>           711 lib/hello_ext.c 	session-&gt;internals.ext_data[id].set = 1;</span>
<span class='curline'><a href='../S/5633.html#L717'>session</a>           717 lib/hello_ext.c _gnutls_hello_ext_get_priv(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L720'>session</a>           720 lib/hello_ext.c 	if (session-&gt;internals.ext_data[id].set != 0) {</span>
<span class='curline'><a href='../S/5633.html#L722'>session</a>           722 lib/hello_ext.c 		    session-&gt;internals.ext_data[id].priv;</span>
<span class='curline'><a href='../S/5633.html#L730'>session</a>           730 lib/hello_ext.c _gnutls_hello_ext_get_resumed_priv(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L734'>session</a>           734 lib/hello_ext.c 	if (session-&gt;internals.ext_data[id].resumed_set != 0) {</span>
<span class='curline'><a href='../S/5633.html#L736'>session</a>           736 lib/hello_ext.c 		    session-&gt;internals.ext_data[id].resumed_priv;</span>
<span class='curline'><a href='../S/5633.html#L858'>session</a>           858 lib/hello_ext.c gnutls_session_ext_register(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L888'>session</a>           888 lib/hello_ext.c 	for (i=0;i&lt;session-&gt;internals.rexts_size;i++) {</span>
<span class='curline'><a href='../S/5633.html#L889'>session</a>           889 lib/hello_ext.c 		if (session-&gt;internals.rexts[i].tls_id == id) {</span>
<span class='curline'><a href='../S/5633.html#L893'>session</a>           893 lib/hello_ext.c 		if (session-&gt;internals.rexts[i].gid &gt;= gid)</span>
<span class='curline'><a href='../S/5633.html#L894'>session</a>           894 lib/hello_ext.c 			gid = session-&gt;internals.rexts[i].gid + 1;</span>
<span class='curline'><a href='../S/5633.html#L920'>session</a>           920 lib/hello_ext.c 		if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5633.html#L926'>session</a>           926 lib/hello_ext.c 	exts = gnutls_realloc(session-&gt;internals.rexts, (session-&gt;internals.rexts_size+1)*sizeof(*exts));</span>
<span class='curline'><a href='../S/5633.html#L931'>session</a>           931 lib/hello_ext.c 	session-&gt;internals.rexts = exts;</span>
<span class='curline'><a href='../S/5633.html#L933'>session</a>           933 lib/hello_ext.c 	memcpy(&amp;session-&gt;internals.rexts[session-&gt;internals.rexts_size], &amp;tmp_mod, sizeof(hello_ext_entry_st));</span>
<span class='curline'><a href='../S/5633.html#L934'>session</a>           934 lib/hello_ext.c 	session-&gt;internals.rexts_size++;</span>
<span class='curline'><a href='../S/5633.html#L952'>session</a>           952 lib/hello_ext.c gnutls_ext_set_data(gnutls_session_t session, unsigned tls_id,</span>
<span class='curline'><a href='../S/5633.html#L955'>session</a>           955 lib/hello_ext.c 	unsigned id = tls_id_to_gid(session, tls_id);</span>
<span class='curline'><a href='../S/5633.html#L959'>session</a>           959 lib/hello_ext.c 	_gnutls_hello_ext_set_priv(session, id, data);</span>
<span class='curline'><a href='../S/5633.html#L975'>session</a>           975 lib/hello_ext.c gnutls_ext_get_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5633.html#L978'>session</a>           978 lib/hello_ext.c 	unsigned id = tls_id_to_gid(session, tls_id);</span>
<span class='curline'><a href='../S/5633.html#L982'>session</a>           982 lib/hello_ext.c 	return _gnutls_hello_ext_get_priv(session, id, data);</span>
<span class='curline'><a href='../S/5633.html#L1000'>session</a>          1000 lib/hello_ext.c unsigned gnutls_ext_get_current_msg(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5633.html#L1002'>session</a>          1002 lib/hello_ext.c 	return _gnutls_ext_get_msg(session);</span>
<span class='curline'><a href='../S/5633.html#L1016'>session</a>          1016 lib/hello_ext.c const char *gnutls_ext_get_name2(gnutls_session_t session, unsigned int tls_id,</span>
<span class='curline'><a href='../S/5633.html#L1021'>session</a>          1021 lib/hello_ext.c 	ext = tls_id_to_ext_entry(session, tls_id, parse_point);</span>
<span class='curline'><a href='../S/5302.html#L33'>session</a>            33 lib/hello_ext.h int _gnutls_parse_hello_extensions(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L37'>session</a>            37 lib/hello_ext.h int _gnutls_gen_hello_extensions(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L44'>session</a>            44 lib/hello_ext.h void _gnutls_hello_ext_priv_deinit(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5302.html#L48'>session</a>            48 lib/hello_ext.h void _gnutls_hello_ext_unset_priv(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L50'>session</a>            50 lib/hello_ext.h void _gnutls_hello_ext_set_priv(gnutls_session_t session, extensions_t ext,</span>
<span class='curline'><a href='../S/5302.html#L52'>session</a>            52 lib/hello_ext.h int _gnutls_hello_ext_get_priv(gnutls_session_t session, extensions_t ext,</span>
<span class='curline'><a href='../S/5302.html#L54'>session</a>            54 lib/hello_ext.h int _gnutls_hello_ext_get_resumed_priv(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L66'>session</a>            66 lib/hello_ext.h inline static gnutls_ext_flags_t _gnutls_ext_get_msg(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5302.html#L68'>session</a>            68 lib/hello_ext.h 	return session-&gt;internals.ext_msg &amp; GNUTLS_EXT_FLAG_MSG_MASK;</span>
<span class='curline'><a href='../S/5302.html#L71'>session</a>            71 lib/hello_ext.h inline static void _gnutls_ext_set_msg(gnutls_session_t session, gnutls_ext_flags_t msg)</span>
<span class='curline'><a href='../S/5302.html#L73'>session</a>            73 lib/hello_ext.h 	session-&gt;internals.ext_msg = msg;</span>
<span class='curline'><a href='../S/5302.html#L76'>session</a>            76 lib/hello_ext.h inline static void _gnutls_ext_set_extensions_offset(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L79'>session</a>            79 lib/hello_ext.h 	session-&gt;internals.extensions_offset = offset;</span>
<span class='curline'><a href='../S/5302.html#L82'>session</a>            82 lib/hello_ext.h inline static int _gnutls_ext_get_extensions_offset(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5302.html#L84'>session</a>            84 lib/hello_ext.h 	return session-&gt;internals.extensions_offset;</span>
<span class='curline'><a href='../S/5302.html#L87'>session</a>            87 lib/hello_ext.h int _gnutls_ext_set_full_client_hello(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L89'>session</a>            89 lib/hello_ext.h unsigned _gnutls_ext_get_full_client_hello(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L93'>session</a>            93 lib/hello_ext.h int _gnutls_hello_ext_pack(gnutls_session_t session, gnutls_buffer_st * packed);</span>
<span class='curline'><a href='../S/5302.html#L94'>session</a>            94 lib/hello_ext.h int _gnutls_hello_ext_unpack(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L161'>session</a>           161 lib/hello_ext.h _gnutls_hello_ext_is_present(gnutls_session_t session, extensions_t id)</span>
<span class='curline'><a href='../S/5302.html#L163'>session</a>           163 lib/hello_ext.h 	if (session-&gt;internals.used_exts &amp; ((ext_track_t)1 &lt;&lt; id))</span>
<span class='curline'><a href='../S/5302.html#L179'>session</a>           179 lib/hello_ext.h unsigned _gnutls_hello_ext_save(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5302.html#L183'>session</a>           183 lib/hello_ext.h 	if (check_dup &amp;&amp; _gnutls_hello_ext_is_present(session, id)) {</span>
<span class='curline'><a href='../S/5302.html#L187'>session</a>           187 lib/hello_ext.h 	session-&gt;internals.used_exts |= ((ext_track_t)1 &lt;&lt; id);</span>
<span class='curline'><a href='../S/5302.html#L193'>session</a>           193 lib/hello_ext.h void _gnutls_hello_ext_save_sr(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5302.html#L195'>session</a>           195 lib/hello_ext.h 	_gnutls_hello_ext_save(session, GNUTLS_EXTENSION_SAFE_RENEGOTIATION, 1);</span>
<span class='curline'><a href='../S/5263.html#L41'>session</a>            41 lib/hello_ext_lib.c _gnutls_hello_ext_set_datum(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5263.html#L46'>session</a>            46 lib/hello_ext_lib.c 	if (_gnutls_hello_ext_get_priv(session, id, &amp;epriv) &gt;= 0)</span>
<span class='curline'><a href='../S/5263.html#L59'>session</a>            59 lib/hello_ext_lib.c 	_gnutls_hello_ext_set_priv(session, id, epriv);</span>
<span class='curline'><a href='../S/5263.html#L65'>session</a>            65 lib/hello_ext_lib.c _gnutls_hello_ext_get_datum(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5263.html#L71'>session</a>            71 lib/hello_ext_lib.c 	ret = _gnutls_hello_ext_get_priv(session, id, &amp;epriv);</span>
<span class='curline'><a href='../S/5263.html#L82'>session</a>            82 lib/hello_ext_lib.c _gnutls_hello_ext_get_resumed_datum(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5263.html#L88'>session</a>            88 lib/hello_ext_lib.c 	ret = _gnutls_hello_ext_get_resumed_priv(session, id, &amp;epriv);</span>
<span class='curline'><a href='../S/5455.html#L33'>session</a>            33 lib/hello_ext_lib.h _gnutls_hello_ext_set_datum(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5455.html#L36'>session</a>            36 lib/hello_ext_lib.h _gnutls_hello_ext_get_datum(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5455.html#L40'>session</a>            40 lib/hello_ext_lib.h _gnutls_hello_ext_get_resumed_datum(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5455.html#L46'>session</a>            46 lib/hello_ext_lib.h _gnutls_hello_ext_unset_priv(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6008.html#L191'>session</a>           191 lib/includes/gnutls/compat.h *gnutls_session_get_server_random(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6008.html#L194'>session</a>           194 lib/includes/gnutls/compat.h *gnutls_session_get_server_random(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6008.html#L197'>session</a>           197 lib/includes/gnutls/compat.h 	gnutls_session_get_random(session, NULL, &amp;rnd);	/*doc-skip */</span>
<span class='curline'><a href='../S/6008.html#L202'>session</a>           202 lib/includes/gnutls/compat.h *gnutls_session_get_client_random(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6008.html#L205'>session</a>           205 lib/includes/gnutls/compat.h *gnutls_session_get_client_random(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6008.html#L208'>session</a>           208 lib/includes/gnutls/compat.h 	gnutls_session_get_random(session, &amp;rnd, NULL);	/*doc-skip */</span>
<span class='curline'><a href='../S/6008.html#L225'>session</a>           225 lib/includes/gnutls/compat.h gnutls_compression_get(gnutls_session_t session) _GNUTLS_GCC_ATTR_DEPRECATED;</span>
<span class='curline'><a href='../S/6003.html#L40'>session</a>            40 lib/includes/gnutls/dtls.h void gnutls_dtls_set_timeouts(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6003.html#L44'>session</a>            44 lib/includes/gnutls/dtls.h unsigned int gnutls_dtls_get_mtu(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6003.html#L45'>session</a>            45 lib/includes/gnutls/dtls.h unsigned int gnutls_dtls_get_data_mtu(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6003.html#L47'>session</a>            47 lib/includes/gnutls/dtls.h void gnutls_dtls_set_mtu(gnutls_session_t session, unsigned int mtu);</span>
<span class='curline'><a href='../S/6003.html#L48'>session</a>            48 lib/includes/gnutls/dtls.h int gnutls_dtls_set_data_mtu(gnutls_session_t session, unsigned int mtu);</span>
<span class='curline'><a href='../S/6003.html#L50'>session</a>            50 lib/includes/gnutls/dtls.h unsigned int gnutls_dtls_get_timeout(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6003.html#L82'>session</a>            82 lib/includes/gnutls/dtls.h void gnutls_dtls_prestate_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6003.html#L85'>session</a>            85 lib/includes/gnutls/dtls.h unsigned int gnutls_record_get_discarded(gnutls_session_t session);</span>
<span class='curline'><a href='../S/6006.html#L103'>session</a>           103 lib/includes/gnutls/gnutlsxx.h 	class session:private noncopyable {</span>
<span class='curline'><a href='../S/6006.html#L107'>session</a>           107 lib/includes/gnutls/gnutlsxx.h 		session(unsigned int);</span>
<span class='curline'><a href='../S/6006.html#L108'>session</a>           108 lib/includes/gnutls/gnutlsxx.h 		 virtual ~ session();</span>
<span class='curline'><a href='../S/6006.html#L166'>session</a>           166 lib/includes/gnutls/gnutlsxx.h 		void get_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6006.html#L239'>session</a>           239 lib/includes/gnutls/gnutlsxx.h 	class server_session:public session {</span>
<span class='curline'><a href='../S/6006.html#L264'>session</a>           264 lib/includes/gnutls/gnutlsxx.h 	class client_session:public session {</span>
<span class='curline'><a href='../S/6006.html#L283'>session</a>           283 lib/includes/gnutls/gnutlsxx.h 		friend class session;</span>
<span class='curline'><a href='../S/6013.html#L318'>session</a>           318 lib/includes/gnutls/openpgp.h 					     session,</span>
<span class='curline'><a href='../S/6013.html#L326'>session</a>           326 lib/includes/gnutls/openpgp.h gnutls_openpgp_set_recv_key_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6018.html#L300'>session</a>           300 lib/includes/gnutls/pkcs11.h 			  void **session, void **ohandle,</span>
<span class='curline'><a href='../S/6019.html#L40'>session</a>            40 lib/includes/gnutls/socket.h void gnutls_transport_set_fastopen(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5637.html#L52'>session</a>            52 lib/kx.c       static int generate_normal_master(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5637.html#L55'>session</a>            55 lib/kx.c       int _gnutls_generate_master(gnutls_session_t session, int keep_premaster)</span>
<span class='curline'><a href='../S/5637.html#L57'>session</a>            57 lib/kx.c       	if (session-&gt;internals.resumed == RESUME_FALSE)</span>
<span class='curline'><a href='../S/5637.html#L58'>session</a>            58 lib/kx.c       		return generate_normal_master(session, &amp;session-&gt;key.key,</span>
<span class='curline'><a href='../S/5637.html#L60'>session</a>            60 lib/kx.c       	else if (session-&gt;internals.premaster_set) {</span>
<span class='curline'><a href='../S/5637.html#L63'>session</a>            63 lib/kx.c       		    sizeof(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L66'>session</a>            66 lib/kx.c       		    session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L68'>session</a>            68 lib/kx.c       		return generate_normal_master(session, &amp;premaster, 1);</span>
<span class='curline'><a href='../S/5637.html#L85'>session</a>            85 lib/kx.c       gnutls_session_get_keylog_function(const gnutls_session_t session)</span>
<span class='curline'><a href='../S/5637.html#L87'>session</a>            87 lib/kx.c       	return session-&gt;internals.keylog_func;</span>
<span class='curline'><a href='../S/5637.html#L101'>session</a>           101 lib/kx.c       gnutls_session_set_keylog_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5637.html#L104'>session</a>           104 lib/kx.c       	session-&gt;internals.keylog_func = func;</span>
<span class='curline'><a href='../S/5637.html#L108'>session</a>           108 lib/kx.c       _gnutls_call_keylog_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5637.html#L113'>session</a>           113 lib/kx.c       	if (session-&gt;internals.keylog_func) {</span>
<span class='curline'><a href='../S/5637.html#L115'>session</a>           115 lib/kx.c       		return session-&gt;internals.keylog_func(session, label, &amp;secret);</span>
<span class='curline'><a href='../S/5637.html#L121'>session</a>           121 lib/kx.c       _gnutls_nss_keylog_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5637.html#L128'>session</a>           128 lib/kx.c       	if (!session-&gt;internals.handshake_in_progress)</span>
<span class='curline'><a href='../S/5637.html#L131'>session</a>           131 lib/kx.c       	_gnutls_nss_keylog_write(session, label, secret-&gt;data, secret-&gt;size);</span>
<span class='curline'><a href='../S/5637.html#L135'>session</a>           135 lib/kx.c       void _gnutls_nss_keylog_write(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5637.html#L156'>session</a>           156 lib/kx.c       			_gnutls_bin2hex(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L178'>session</a>           178 lib/kx.c       generate_normal_master(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5637.html#L190'>session</a>           190 lib/kx.c       			 _gnutls_bin2hex(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L194'>session</a>           194 lib/kx.c       			 _gnutls_bin2hex(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L198'>session</a>           198 lib/kx.c       	if (session-&gt;security_parameters.ext_master_secret == 0) {</span>
<span class='curline'><a href='../S/5637.html#L200'>session</a>           200 lib/kx.c       		memcpy(rnd, session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5637.html#L203'>session</a>           203 lib/kx.c       		       session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5637.html#L207'>session</a>           207 lib/kx.c       		if (get_num_version(session) == GNUTLS_SSL3) {</span>
<span class='curline'><a href='../S/5637.html#L213'>session</a>           213 lib/kx.c       							 session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L218'>session</a>           218 lib/kx.c       			    _gnutls_PRF(session, premaster-&gt;data, premaster-&gt;size,</span>
<span class='curline'><a href='../S/5637.html#L222'>session</a>           222 lib/kx.c       					session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L228'>session</a>           228 lib/kx.c       		ret = _gnutls_handshake_get_session_hash(session, &amp;shash);</span>
<span class='curline'><a href='../S/5637.html#L232'>session</a>           232 lib/kx.c       		if (get_num_version(session) == GNUTLS_SSL3)</span>
<span class='curline'><a href='../S/5637.html#L237'>session</a>           237 lib/kx.c       		    _gnutls_PRF(session, premaster-&gt;data, premaster-&gt;size,</span>
<span class='curline'><a href='../S/5637.html#L241'>session</a>           241 lib/kx.c       				session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L253'>session</a>           253 lib/kx.c       	ret = _gnutls_call_keylog_func(session, "CLIENT_RANDOM",</span>
<span class='curline'><a href='../S/5637.html#L254'>session</a>           254 lib/kx.c       				       session-&gt;security_parameters.master_secret,</span>
<span class='curline'><a href='../S/5637.html#L261'>session</a>           261 lib/kx.c       			 _gnutls_bin2hex(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5637.html#L272'>session</a>           272 lib/kx.c       int _gnutls_send_server_kx_message(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5637.html#L278'>session</a>           278 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;gnutls_generate_server_kx ==</span>
<span class='curline'><a href='../S/5637.html#L289'>session</a>           289 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L290'>session</a>           290 lib/kx.c       		    gnutls_generate_server_kx(session, &amp;buf);</span>
<span class='curline'><a href='../S/5637.html#L306'>session</a>           306 lib/kx.c       	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_SERVER_KEY_EXCHANGE);</span>
<span class='curline'><a href='../S/5637.html#L316'>session</a>           316 lib/kx.c       int _gnutls_send_server_crt_request(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5637.html#L322'>session</a>           322 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L326'>session</a>           326 lib/kx.c       	if (session-&gt;internals.send_cert_req &lt;= 0)</span>
<span class='curline'><a href='../S/5637.html#L336'>session</a>           336 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L337'>session</a>           337 lib/kx.c       		    gnutls_generate_server_crt_request(session, &amp;buf);</span>
<span class='curline'><a href='../S/5637.html#L347'>session</a>           347 lib/kx.c       	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_CERTIFICATE_REQUEST);</span>
<span class='curline'><a href='../S/5637.html#L358'>session</a>           358 lib/kx.c       int _gnutls_send_client_kx_message(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5637.html#L364'>session</a>           364 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;gnutls_generate_client_kx ==</span>
<span class='curline'><a href='../S/5637.html#L374'>session</a>           374 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L375'>session</a>           375 lib/kx.c       		    gnutls_generate_client_kx(session, &amp;buf);</span>
<span class='curline'><a href='../S/5637.html#L384'>session</a>           384 lib/kx.c       	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_CLIENT_KEY_EXCHANGE);</span>
<span class='curline'><a href='../S/5637.html#L396'>session</a>           396 lib/kx.c       _gnutls_send_client_certificate_verify(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5637.html#L404'>session</a>           404 lib/kx.c       	if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5637.html#L409'>session</a>           409 lib/kx.c       	if (!(session-&gt;internals.hsk_flags &amp; HSK_CRT_ASKED))</span>
<span class='curline'><a href='../S/5637.html#L413'>session</a>           413 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L426'>session</a>           426 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L427'>session</a>           427 lib/kx.c       		    gnutls_generate_client_crt_vrfy(session, &amp;buf);</span>
<span class='curline'><a href='../S/5637.html#L440'>session</a>           440 lib/kx.c       	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_CERTIFICATE_VERIFY);</span>
<span class='curline'><a href='../S/5637.html#L449'>session</a>           449 lib/kx.c       int _gnutls_send_client_certificate(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5637.html#L455'>session</a>           455 lib/kx.c       	if (!(session-&gt;internals.hsk_flags &amp; HSK_CRT_ASKED))</span>
<span class='curline'><a href='../S/5637.html#L458'>session</a>           458 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L468'>session</a>           468 lib/kx.c       		if (get_num_version(session) != GNUTLS_SSL3 ||</span>
<span class='curline'><a href='../S/5637.html#L469'>session</a>           469 lib/kx.c       		    session-&gt;internals.selected_cert_list_length &gt; 0)</span>
<span class='curline'><a href='../S/5637.html#L475'>session</a>           475 lib/kx.c       			    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L476'>session</a>           476 lib/kx.c       			    gnutls_generate_client_certificate(session,</span>
<span class='curline'><a href='../S/5637.html#L493'>session</a>           493 lib/kx.c       	if (get_num_version(session) == GNUTLS_SSL3 &amp;&amp;</span>
<span class='curline'><a href='../S/5637.html#L494'>session</a>           494 lib/kx.c       	    session-&gt;internals.selected_cert_list_length == 0) {</span>
<span class='curline'><a href='../S/5637.html#L497'>session</a>           497 lib/kx.c       		    gnutls_alert_send(session, GNUTLS_AL_WARNING,</span>
<span class='curline'><a href='../S/5637.html#L503'>session</a>           503 lib/kx.c       		return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_CERTIFICATE_PKT);</span>
<span class='curline'><a href='../S/5637.html#L513'>session</a>           513 lib/kx.c       int _gnutls_send_server_certificate(gnutls_session_t session, int again)</span>
<span class='curline'><a href='../S/5637.html#L519'>session</a>           519 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L529'>session</a>           529 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L530'>session</a>           530 lib/kx.c       		    gnutls_generate_server_certificate(session, &amp;buf);</span>
<span class='curline'><a href='../S/5637.html#L540'>session</a>           540 lib/kx.c       	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_CERTIFICATE_PKT);</span>
<span class='curline'><a href='../S/5637.html#L548'>session</a>           548 lib/kx.c       int _gnutls_recv_server_kx_message(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5637.html#L554'>session</a>           554 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;gnutls_process_server_kx !=</span>
<span class='curline'><a href='../S/5637.html#L557'>session</a>           557 lib/kx.c       		if (_gnutls_session_is_psk(session))</span>
<span class='curline'><a href='../S/5637.html#L561'>session</a>           561 lib/kx.c       		    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5637.html#L570'>session</a>           570 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L571'>session</a>           571 lib/kx.c       		    gnutls_process_server_kx(session, buf.data,</span>
<span class='curline'><a href='../S/5637.html#L584'>session</a>           584 lib/kx.c       int _gnutls_recv_server_crt_request(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5637.html#L589'>session</a>           589 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L593'>session</a>           593 lib/kx.c       		    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5637.html#L605'>session</a>           605 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L606'>session</a>           606 lib/kx.c       		    gnutls_process_server_crt_request(session, buf.data,</span>
<span class='curline'><a href='../S/5637.html#L616'>session</a>           616 lib/kx.c       int _gnutls_recv_client_kx_message(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5637.html#L623'>session</a>           623 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;gnutls_process_client_kx !=</span>
<span class='curline'><a href='../S/5637.html#L627'>session</a>           627 lib/kx.c       		    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5637.html#L634'>session</a>           634 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L635'>session</a>           635 lib/kx.c       		    gnutls_process_client_kx(session, buf.data,</span>
<span class='curline'><a href='../S/5637.html#L647'>session</a>           647 lib/kx.c       int _gnutls_recv_client_certificate(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5637.html#L653'>session</a>           653 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L659'>session</a>           659 lib/kx.c       	if (session-&gt;internals.send_cert_req == 0) {</span>
<span class='curline'><a href='../S/5637.html#L663'>session</a>           663 lib/kx.c       	if (session-&gt;internals.send_cert_req == GNUTLS_CERT_REQUIRE)</span>
<span class='curline'><a href='../S/5637.html#L669'>session</a>           669 lib/kx.c       	    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5637.html#L681'>session</a>           681 lib/kx.c       		    get_num_version(session) == GNUTLS_SSL3 &amp;&amp;</span>
<span class='curline'><a href='../S/5637.html#L682'>session</a>           682 lib/kx.c       		    gnutls_alert_get(session) ==</span>
<span class='curline'><a href='../S/5637.html#L715'>session</a>           715 lib/kx.c       	    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L716'>session</a>           716 lib/kx.c       	    gnutls_process_client_certificate(session, buf.data,</span>
<span class='curline'><a href='../S/5637.html#L729'>session</a>           729 lib/kx.c       		session-&gt;internals.hsk_flags |= HSK_CRT_VRFY_EXPECTED;</span>
<span class='curline'><a href='../S/5637.html#L736'>session</a>           736 lib/kx.c       int _gnutls_recv_server_certificate(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5637.html#L741'>session</a>           741 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L745'>session</a>           745 lib/kx.c       		    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5637.html#L754'>session</a>           754 lib/kx.c       		    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L755'>session</a>           755 lib/kx.c       		    gnutls_process_server_certificate(session, buf.data,</span>
<span class='curline'><a href='../S/5637.html#L772'>session</a>           772 lib/kx.c       _gnutls_recv_client_certificate_verify_message(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5637.html#L778'>session</a>           778 lib/kx.c       	if (session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L782'>session</a>           782 lib/kx.c       	if (session-&gt;internals.send_cert_req == 0 ||</span>
<span class='curline'><a href='../S/5637.html#L783'>session</a>           783 lib/kx.c       	    (!(session-&gt;internals.hsk_flags &amp; HSK_CRT_VRFY_EXPECTED))) {</span>
<span class='curline'><a href='../S/5637.html#L788'>session</a>           788 lib/kx.c       	    _gnutls_recv_handshake(session,</span>
<span class='curline'><a href='../S/5637.html#L795'>session</a>           795 lib/kx.c       	    &amp;&amp; session-&gt;internals.send_cert_req == GNUTLS_CERT_REQUIRE) {</span>
<span class='curline'><a href='../S/5637.html#L803'>session</a>           803 lib/kx.c       	    session-&gt;internals.auth_struct-&gt;</span>
<span class='curline'><a href='../S/5637.html#L804'>session</a>           804 lib/kx.c       	    gnutls_process_client_crt_vrfy(session, buf.data, buf.length);</span>
<span class='curline'><a href='../S/5287.html#L26'>session</a>            26 lib/kx.h       int _gnutls_send_server_kx_message(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5287.html#L27'>session</a>            27 lib/kx.h       int _gnutls_send_client_kx_message(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5287.html#L28'>session</a>            28 lib/kx.h       int _gnutls_recv_server_kx_message(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5287.html#L29'>session</a>            29 lib/kx.h       int _gnutls_recv_client_kx_message(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5287.html#L30'>session</a>            30 lib/kx.h       int _gnutls_send_client_certificate_verify(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5287.html#L32'>session</a>            32 lib/kx.h       int _gnutls_send_server_certificate(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5287.html#L33'>session</a>            33 lib/kx.h       int _gnutls_generate_master(gnutls_session_t session, int keep_premaster);</span>
<span class='curline'><a href='../S/5287.html#L34'>session</a>            34 lib/kx.h       int _gnutls_recv_client_certificate(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5287.html#L35'>session</a>            35 lib/kx.h       int _gnutls_recv_server_certificate(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5287.html#L36'>session</a>            36 lib/kx.h       int _gnutls_send_client_certificate(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5287.html#L37'>session</a>            37 lib/kx.h       int _gnutls_recv_server_crt_request(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5287.html#L38'>session</a>            38 lib/kx.h       int _gnutls_send_server_crt_request(gnutls_session_t session, int again);</span>
<span class='curline'><a href='../S/5287.html#L40'>session</a>            40 lib/kx.h       						   session);</span>
<span class='curline'><a href='../S/5287.html#L41'>session</a>            41 lib/kx.h       int _gnutls_call_keylog_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5287.html#L45'>session</a>            45 lib/kx.h       void _gnutls_nss_keylog_write(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5287.html#L48'>session</a>            48 lib/kx.h       int _gnutls_nss_keylog_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5459.html#L140'>session</a>           140 lib/mbuffers.h #define _gnutls_buffer_init_handshake_mbuffer(b) _gnutls_buffer_init_mbuffer(b, HANDSHAKE_HEADER_SIZE(session))</span>
<span class='curline'><a href='../S/5459.html#L164'>session</a>           164 lib/mbuffers.h inline static mbuffer_st *_gnutls_handshake_alloc(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5459.html#L168'>session</a>           168 lib/mbuffers.h 	    _mbuffer_alloc(HANDSHAKE_HEADER_SIZE(session) + maximum);</span>
<span class='curline'><a href='../S/5459.html#L173'>session</a>           173 lib/mbuffers.h 	_mbuffer_set_uhead_size(bufel, HANDSHAKE_HEADER_SIZE(session));</span>
<span class='curline'><a href='../S/5296.html#L56'>session</a>            56 lib/ocsp-api.c gnutls_ocsp_status_request_get(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5296.html#L59'>session</a>            59 lib/ocsp-api.c 	return gnutls_ocsp_status_request_get2(session, 0, response);</span>
<span class='curline'><a href='../S/5296.html#L85'>session</a>            85 lib/ocsp-api.c gnutls_ocsp_status_request_get2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5296.html#L89'>session</a>            89 lib/ocsp-api.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5296.html#L90'>session</a>            90 lib/ocsp-api.c 	cert_auth_info_t info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5296.html#L92'>session</a>            92 lib/ocsp-api.c 	if (!ver-&gt;tls13_sem &amp;&amp; session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5296.html#L622'>session</a>           622 lib/ocsp-api.c gnutls_ocsp_status_request_is_checked(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5296.html#L629'>session</a>           629 lib/ocsp-api.c 		ret = gnutls_ocsp_status_request_get(session, &amp;data);</span>
<span class='curline'><a href='../S/5296.html#L637'>session</a>           637 lib/ocsp-api.c 	return session-&gt;internals.ocsp_check_ok;</span>
<span class='curline'><a href='../S/5621.html#L523'>session</a>           523 lib/openpgp_compat.c gnutls_openpgp_set_recv_key_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5621.html#L804'>session</a>           804 lib/openpgp_compat.c gnutls_openpgp_send_cert(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5621.html#L821'>session</a>           821 lib/openpgp_compat.c int gnutls_certificate_get_peers_subkey_id(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5802.html#L731'>session</a>           731 lib/pkcs11.c   			  void **session, void **ohandle,</span>
<span class='curline'><a href='../S/5802.html#L756'>session</a>           756 lib/pkcs11.c   	*session = (void*)find_data.pks;</span>
<span class='curline'><a href='../S/5265.html#L936'>session</a>           936 lib/pkcs11_privkey.c _dsa_params_generate(struct ck_function_list *module, ck_session_handle_t session,</span>
<span class='curline'><a href='../S/5265.html#L947'>session</a>           947 lib/pkcs11_privkey.c 	rv = pkcs11_generate_key(module, session, &amp;mech, &amp;attr, 1, &amp;key);</span>
<span class='curline'><a href='../S/5265.html#L968'>session</a>           968 lib/pkcs11_privkey.c 	rv = pkcs11_get_attribute_value(module, session, key, &amp;a[*a_val], 3);</span>
<span class='curline'><a href='../S/5788.html#L71'>session</a>            71 lib/prf.c      gnutls_prf_raw(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5788.html#L78'>session</a>            78 lib/prf.c      	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5788.html#L83'>session</a>            83 lib/prf.c      	if (session-&gt;security_parameters.prf == NULL)</span>
<span class='curline'><a href='../S/5788.html#L86'>session</a>            86 lib/prf.c      	ret = _gnutls_prf_raw(session-&gt;security_parameters.prf-&gt;id,</span>
<span class='curline'><a href='../S/5788.html#L87'>session</a>            87 lib/prf.c      			  GNUTLS_MASTER_SIZE, session-&gt;security_parameters.master_secret,</span>
<span class='curline'><a href='../S/5788.html#L97'>session</a>            97 lib/prf.c      		       gnutls_session_t session,</span>
<span class='curline'><a href='../S/5788.html#L109'>session</a>           109 lib/prf.c      				    session-&gt;key.proto.tls13.ap_expkey,</span>
<span class='curline'><a href='../S/5788.html#L163'>session</a>           163 lib/prf.c      gnutls_prf_rfc5705(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5788.html#L168'>session</a>           168 lib/prf.c      	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5788.html#L171'>session</a>           171 lib/prf.c      	if (session-&gt;security_parameters.prf == NULL)</span>
<span class='curline'><a href='../S/5788.html#L175'>session</a>           175 lib/prf.c      		ret = _tls13_derive_exporter(session-&gt;security_parameters.prf,</span>
<span class='curline'><a href='../S/5788.html#L176'>session</a>           176 lib/prf.c      					     session,</span>
<span class='curline'><a href='../S/5788.html#L201'>session</a>           201 lib/prf.c      		ret = gnutls_prf(session, label_size, label, 0,</span>
<span class='curline'><a href='../S/5788.html#L246'>session</a>           246 lib/prf.c      gnutls_prf_early(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5788.html#L251'>session</a>           251 lib/prf.c      	if (session-&gt;internals.initial_negotiation_completed ||</span>
<span class='curline'><a href='../S/5788.html#L252'>session</a>           252 lib/prf.c      	    session-&gt;key.binders[0].prf == NULL)</span>
<span class='curline'><a href='../S/5788.html#L255'>session</a>           255 lib/prf.c      	return _tls13_derive_exporter(session-&gt;key.binders[0].prf, session,</span>
<span class='curline'><a href='../S/5788.html#L298'>session</a>           298 lib/prf.c      gnutls_prf(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5788.html#L307'>session</a>           307 lib/prf.c      	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5788.html#L312'>session</a>           312 lib/prf.c      			return gnutls_prf_rfc5705(session, label_size, label,</span>
<span class='curline'><a href='../S/5788.html#L318'>session</a>           318 lib/prf.c      	if (session-&gt;security_parameters.prf == NULL)</span>
<span class='curline'><a href='../S/5788.html#L328'>session</a>           328 lib/prf.c      	       session-&gt;security_parameters.server_random :</span>
<span class='curline'><a href='../S/5788.html#L329'>session</a>           329 lib/prf.c      	       session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5788.html#L332'>session</a>           332 lib/prf.c      	       server_random_first ? session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5788.html#L333'>session</a>           333 lib/prf.c      	       client_random : session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5788.html#L341'>session</a>           341 lib/prf.c      	    _gnutls_prf_raw(session-&gt;security_parameters.prf-&gt;id,</span>
<span class='curline'><a href='../S/5788.html#L342'>session</a>           342 lib/prf.c      			GNUTLS_MASTER_SIZE, session-&gt;security_parameters.master_secret,</span>
<span class='curline'><a href='../S/5260.html#L641'>session</a>           641 lib/priority.c gnutls_priority_set(gnutls_session_t session, gnutls_priority_t priority)</span>
<span class='curline'><a href='../S/5260.html#L653'>session</a>           653 lib/priority.c 	if (!session-&gt;internals.handshake_in_progress &amp;&amp;</span>
<span class='curline'><a href='../S/5260.html#L654'>session</a>           654 lib/priority.c 	    !session-&gt;internals.initial_negotiation_completed) {</span>
<span class='curline'><a href='../S/5260.html#L655'>session</a>           655 lib/priority.c 		ret = _gnutls_set_current_version(session,</span>
<span class='curline'><a href='../S/5260.html#L663'>session</a>           663 lib/priority.c 	if (session-&gt;internals.priorities)</span>
<span class='curline'><a href='../S/5260.html#L664'>session</a>           664 lib/priority.c 		gnutls_priority_deinit(session-&gt;internals.priorities);</span>
<span class='curline'><a href='../S/5260.html#L667'>session</a>           667 lib/priority.c 	session-&gt;internals.priorities = priority;</span>
<span class='curline'><a href='../S/5260.html#L671'>session</a>           671 lib/priority.c 		session-&gt;internals.flags |= GNUTLS_NO_TICKETS;</span>
<span class='curline'><a href='../S/5260.html#L674'>session</a>           674 lib/priority.c 	ADD_PROFILE_VFLAGS(session, priority-&gt;additional_verify_flags);</span>
<span class='curline'><a href='../S/5260.html#L678'>session</a>           678 lib/priority.c #define COPY_TO_INTERNALS(xx) session-&gt;internals.xx = priority-&gt;_##xx</span>
<span class='curline'><a href='../S/5260.html#L2335'>session</a>          2335 lib/priority.c gnutls_priority_set_direct(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5260.html#L2347'>session</a>          2347 lib/priority.c 	ret = gnutls_priority_set(session, prio);</span>
<span class='curline'><a href='../S/5260.html#L2412'>session</a>          2412 lib/priority.c int gnutls_set_default_priority(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5260.html#L2414'>session</a>          2414 lib/priority.c 	return gnutls_priority_set_direct(session, NULL, NULL);</span>
<span class='curline'><a href='../S/5260.html#L2443'>session</a>          2443 lib/priority.c int gnutls_set_default_priority_append(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5260.html#L2457'>session</a>          2457 lib/priority.c 	ret = gnutls_priority_set(session, prio);</span>
<span class='curline'><a href='../S/5758.html#L290'>session</a>           290 lib/psk.c      static int call_server_callback_legacy(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5758.html#L296'>session</a>           296 lib/psk.c      				_gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5758.html#L300'>session</a>           300 lib/psk.c      	return cred-&gt;pwd_callback_legacy(session, (const char *) username-&gt;data, key);</span>
<span class='curline'><a href='../S/5758.html#L364'>session</a>           364 lib/psk.c      static int call_client_callback_legacy(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5758.html#L372'>session</a>           372 lib/psk.c      				_gnutls_get_cred(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5758.html#L377'>session</a>           377 lib/psk.c      	ret = cred-&gt;get_function_legacy(session, &amp;user_p, key);</span>
<span class='curline'><a href='../S/5758.html#L469'>session</a>           469 lib/psk.c      const char *gnutls_psk_server_get_username(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5758.html#L475'>session</a>           475 lib/psk.c      	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5758.html#L501'>session</a>           501 lib/psk.c      int gnutls_psk_server_get_username2(gnutls_session_t session, gnutls_datum_t *username)</span>
<span class='curline'><a href='../S/5758.html#L507'>session</a>           507 lib/psk.c      	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5758.html#L535'>session</a>           535 lib/psk.c      const char *gnutls_psk_client_get_hint(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5758.html#L541'>session</a>           541 lib/psk.c      	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5334.html#L2086'>session</a>          2086 lib/pubkey.c   int _gnutls_pubkey_compatible_with_sig(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5334.html#L2120'>session</a>          2120 lib/pubkey.c   				_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5334.html#L2136'>session</a>          2136 lib/pubkey.c   				_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5334.html#L2148'>session</a>          2148 lib/pubkey.c   				_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/6000.html#L43'>session</a>            43 lib/range.c    _gnutls_range_max_lh_pad(gnutls_session_t session, ssize_t data_length,</span>
<span class='curline'><a href='../S/6000.html#L53'>session</a>            53 lib/range.c    	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/6000.html#L59'>session</a>            59 lib/range.c    	    _gnutls_epoch_get(session, EPOCH_WRITE_CURRENT,</span>
<span class='curline'><a href='../S/6000.html#L69'>session</a>            69 lib/range.c    		max_pad = max_record_send_size(session, record_params);</span>
<span class='curline'><a href='../S/6000.html#L116'>session</a>           116 lib/range.c    unsigned gnutls_record_can_use_length_hiding(gnutls_session_t session)</span>
<span class='curline'><a href='../S/6000.html#L120'>session</a>           120 lib/range.c    	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/6000.html#L134'>session</a>           134 lib/range.c    	    _gnutls_epoch_get(session, EPOCH_WRITE_CURRENT,</span>
<span class='curline'><a href='../S/6000.html#L169'>session</a>           169 lib/range.c    gnutls_range_split(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6000.html#L180'>session</a>           180 lib/range.c    	    _gnutls_epoch_get(session, EPOCH_WRITE_CURRENT,</span>
<span class='curline'><a href='../S/6000.html#L185'>session</a>           185 lib/range.c    	max_frag = max_record_send_size(session, record_params);</span>
<span class='curline'><a href='../S/6000.html#L201'>session</a>           201 lib/range.c    			    _gnutls_range_max_lh_pad(session, orig_low,</span>
<span class='curline'><a href='../S/6000.html#L248'>session</a>           248 lib/range.c    gnutls_record_send_range(gnutls_session_t session, const void *data,</span>
<span class='curline'><a href='../S/6000.html#L262'>session</a>           262 lib/range.c    	ret = gnutls_record_can_use_length_hiding(session);</span>
<span class='curline'><a href='../S/6000.html#L274'>session</a>           274 lib/range.c    		    gnutls_range_split(session, &amp;cur_range, &amp;cur_range,</span>
<span class='curline'><a href='../S/6000.html#L291'>session</a>           291 lib/range.c    		    _gnutls_send_tlen_int(session, GNUTLS_APPLICATION_DATA,</span>
<span class='curline'><a href='../S/6000.html#L302'>session</a>           302 lib/range.c    			    _gnutls_send_tlen_int(session,</span>
<span class='curline'><a href='../S/5258.html#L85'>session</a>            85 lib/record.c   void gnutls_record_disable_padding(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5258.html#L101'>session</a>           101 lib/record.c   gnutls_transport_set_ptr(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L104'>session</a>           104 lib/record.c   	session-&gt;internals.transport_recv_ptr = ptr;</span>
<span class='curline'><a href='../S/5258.html#L105'>session</a>           105 lib/record.c   	session-&gt;internals.transport_send_ptr = ptr;</span>
<span class='curline'><a href='../S/5258.html#L120'>session</a>           120 lib/record.c   gnutls_transport_set_ptr2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L124'>session</a>           124 lib/record.c   	session-&gt;internals.transport_send_ptr = send_ptr;</span>
<span class='curline'><a href='../S/5258.html#L125'>session</a>           125 lib/record.c   	session-&gt;internals.transport_recv_ptr = recv_ptr;</span>
<span class='curline'><a href='../S/5258.html#L145'>session</a>           145 lib/record.c   gnutls_transport_set_int2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L148'>session</a>           148 lib/record.c   	session-&gt;internals.transport_send_ptr =</span>
<span class='curline'><a href='../S/5258.html#L150'>session</a>           150 lib/record.c   	session-&gt;internals.transport_recv_ptr =</span>
<span class='curline'><a href='../S/5258.html#L171'>session</a>           171 lib/record.c   void gnutls_transport_set_int(gnutls_session_t session, int fd)</span>
<span class='curline'><a href='../S/5258.html#L173'>session</a>           173 lib/record.c   	session-&gt;internals.transport_recv_ptr =</span>
<span class='curline'><a href='../S/5258.html#L175'>session</a>           175 lib/record.c   	session-&gt;internals.transport_send_ptr =</span>
<span class='curline'><a href='../S/5258.html#L190'>session</a>           190 lib/record.c   gnutls_transport_ptr_t gnutls_transport_get_ptr(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5258.html#L192'>session</a>           192 lib/record.c   	return session-&gt;internals.transport_recv_ptr;</span>
<span class='curline'><a href='../S/5258.html#L206'>session</a>           206 lib/record.c   gnutls_transport_get_ptr2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L211'>session</a>           211 lib/record.c   	*recv_ptr = session-&gt;internals.transport_recv_ptr;</span>
<span class='curline'><a href='../S/5258.html#L212'>session</a>           212 lib/record.c   	*send_ptr = session-&gt;internals.transport_send_ptr;</span>
<span class='curline'><a href='../S/5258.html#L228'>session</a>           228 lib/record.c   gnutls_transport_get_int2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L232'>session</a>           232 lib/record.c   	*recv_int = (long) session-&gt;internals.transport_recv_ptr;</span>
<span class='curline'><a href='../S/5258.html#L233'>session</a>           233 lib/record.c   	*send_int = (long) session-&gt;internals.transport_send_ptr;</span>
<span class='curline'><a href='../S/5258.html#L248'>session</a>           248 lib/record.c   int gnutls_transport_get_int(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5258.html#L250'>session</a>           250 lib/record.c   	return (long) session-&gt;internals.transport_recv_ptr;</span>
<span class='curline'><a href='../S/5258.html#L285'>session</a>           285 lib/record.c   int gnutls_bye(gnutls_session_t session, gnutls_close_request_t how)</span>
<span class='curline'><a href='../S/5258.html#L291'>session</a>           291 lib/record.c   		ret = _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/5258.html#L300'>session</a>           300 lib/record.c   		    gnutls_alert_send(session, GNUTLS_AL_WARNING,</span>
<span class='curline'><a href='../S/5258.html#L313'>session</a>           313 lib/record.c   				    _gnutls_recv_int(session, GNUTLS_ALERT,</span>
<span class='curline'><a href='../S/5258.html#L315'>session</a>           315 lib/record.c   						     session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L321'>session</a>           321 lib/record.c   				session-&gt;internals.may_not_read = 1;</span>
<span class='curline'><a href='../S/5258.html#L338'>session</a>           338 lib/record.c   	session-&gt;internals.may_not_write = 1;</span>
<span class='curline'><a href='../S/5258.html#L342'>session</a>           342 lib/record.c   inline static void session_unresumable(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5258.html#L344'>session</a>           344 lib/record.c   	session-&gt;internals.resumable = RESUME_FALSE;</span>
<span class='curline'><a href='../S/5258.html#L349'>session</a>           349 lib/record.c   inline static int session_is_valid(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5258.html#L351'>session</a>           351 lib/record.c   	if (session-&gt;internals.invalid_connection != 0)</span>
<span class='curline'><a href='../S/5258.html#L361'>session</a>           361 lib/record.c   copy_record_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L367'>session</a>           367 lib/record.c   	lver = get_version(session);</span>
<span class='curline'><a href='../S/5258.html#L368'>session</a>           368 lib/record.c   	if (session-&gt;internals.initial_negotiation_completed ||</span>
<span class='curline'><a href='../S/5258.html#L370'>session</a>           370 lib/record.c   	    session-&gt;internals.default_record_version[0] == 0) {</span>
<span class='curline'><a href='../S/5258.html#L383'>session</a>           383 lib/record.c   		version[0] = session-&gt;internals.default_record_version[0];</span>
<span class='curline'><a href='../S/5258.html#L384'>session</a>           384 lib/record.c   		version[1] = session-&gt;internals.default_record_version[1];</span>
<span class='curline'><a href='../S/5258.html#L393'>session</a>           393 lib/record.c   sequence_increment(gnutls_session_t session, uint64_t * value)</span>
<span class='curline'><a href='../S/5258.html#L397'>session</a>           397 lib/record.c   	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L440'>session</a>           440 lib/record.c   _gnutls_send_tlen_int(gnutls_session_t session, content_type_t type,</span>
<span class='curline'><a href='../S/5258.html#L456'>session</a>           456 lib/record.c   	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5258.html#L458'>session</a>           458 lib/record.c   	ret = _gnutls_epoch_get(session, epoch_rel, &amp;record_params);</span>
<span class='curline'><a href='../S/5258.html#L472'>session</a>           472 lib/record.c   	if (session-&gt;internals.record_send_buffer.byte_length == 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L479'>session</a>           479 lib/record.c   		if (session_is_valid(session)</span>
<span class='curline'><a href='../S/5258.html#L480'>session</a>           480 lib/record.c   		    || session-&gt;internals.may_not_write != 0) {</span>
<span class='curline'><a href='../S/5258.html#L485'>session</a>           485 lib/record.c   	max_send_size = max_record_send_size(session, record_params);</span>
<span class='curline'><a href='../S/5258.html#L488'>session</a>           488 lib/record.c   		if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5258.html#L499'>session</a>           499 lib/record.c   	    &amp;&amp; session-&gt;internals.record_send_buffer.byte_length &gt; 0) {</span>
<span class='curline'><a href='../S/5258.html#L500'>session</a>           500 lib/record.c   		ret = _gnutls_io_write_flush(session);</span>
<span class='curline'><a href='../S/5258.html#L506'>session</a>           506 lib/record.c   		retval = session-&gt;internals.record_send_buffer_user_size;</span>
<span class='curline'><a href='../S/5258.html#L513'>session</a>           513 lib/record.c   		cipher_size = MAX_RECORD_SEND_SIZE(session);</span>
<span class='curline'><a href='../S/5258.html#L516'>session</a>           516 lib/record.c   			get_total_headers2(session, record_params));</span>
<span class='curline'><a href='../S/5258.html#L528'>session</a>           528 lib/record.c   		ret = copy_record_version(session, htype, &amp;headers[1]);</span>
<span class='curline'><a href='../S/5258.html#L533'>session</a>           533 lib/record.c   		if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5258.html#L538'>session</a>           538 lib/record.c   		     session, _gnutls_packet2str(type), type,</span>
<span class='curline'><a href='../S/5258.html#L541'>session</a>           541 lib/record.c   		header_size = RECORD_HEADER_SIZE(session);</span>
<span class='curline'><a href='../S/5258.html#L546'>session</a>           546 lib/record.c   		    _gnutls_encrypt(session,</span>
<span class='curline'><a href='../S/5258.html#L559'>session</a>           559 lib/record.c   		session-&gt;internals.record_send_buffer_user_size =</span>
<span class='curline'><a href='../S/5258.html#L565'>session</a>           565 lib/record.c   		    (session, &amp;record_state-&gt;sequence_number) != 0) {</span>
<span class='curline'><a href='../S/5258.html#L566'>session</a>           566 lib/record.c   			session_invalidate(session);</span>
<span class='curline'><a href='../S/5258.html#L573'>session</a>           573 lib/record.c   		ret = _gnutls_io_write_buffered(session, bufel, mflags);</span>
<span class='curline'><a href='../S/5258.html#L586'>session</a>           586 lib/record.c   		session_unresumable(session);</span>
<span class='curline'><a href='../S/5258.html#L587'>session</a>           587 lib/record.c   		session-&gt;internals.may_not_write = 1;</span>
<span class='curline'><a href='../S/5258.html#L591'>session</a>           591 lib/record.c   	session-&gt;internals.record_send_buffer_user_size = 0;</span>
<span class='curline'><a href='../S/5258.html#L595'>session</a>           595 lib/record.c   	     session, (unsigned long)(record_state-&gt;sequence_number),</span>
<span class='curline'><a href='../S/5258.html#L599'>session</a>           599 lib/record.c   	if (vers-&gt;tls13_sem &amp;&amp; !(session-&gt;internals.flags &amp; GNUTLS_NO_AUTO_REKEY) &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L604'>session</a>           604 lib/record.c   			session-&gt;internals.rsend_state = RECORD_SEND_KEY_UPDATE_1;</span>
<span class='curline'><a href='../S/5258.html#L612'>session</a>           612 lib/record.c   check_recv_type(gnutls_session_t session, content_type_t recv_type)</span>
<span class='curline'><a href='../S/5258.html#L623'>session</a>           623 lib/record.c   		_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5258.html#L636'>session</a>           636 lib/record.c   get_data_from_buffers(gnutls_session_t session, content_type_t type,</span>
<span class='curline'><a href='../S/5258.html#L641'>session</a>           641 lib/record.c   	    &amp;&amp; _gnutls_record_buffer_get_size(session) &gt; 0) {</span>
<span class='curline'><a href='../S/5258.html#L644'>session</a>           644 lib/record.c   		    _gnutls_record_buffer_get(type, session, data,</span>
<span class='curline'><a href='../S/5258.html#L647'>session</a>           647 lib/record.c   			if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L665'>session</a>           665 lib/record.c   get_packet_from_buffers(gnutls_session_t session, content_type_t type,</span>
<span class='curline'><a href='../S/5258.html#L668'>session</a>           668 lib/record.c   	if (_gnutls_record_buffer_get_size(session) &gt; 0) {</span>
<span class='curline'><a href='../S/5258.html#L671'>session</a>           671 lib/record.c   			_gnutls_record_buffer_get_packet(type, session, packet);</span>
<span class='curline'><a href='../S/5258.html#L673'>session</a>           673 lib/record.c   			if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L695'>session</a>           695 lib/record.c   record_check_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L699'>session</a>           699 lib/record.c   	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5258.html#L711'>session</a>           711 lib/record.c   	if (!IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L719'>session</a>           719 lib/record.c   				     session, htype, version[0],</span>
<span class='curline'><a href='../S/5258.html#L731'>session</a>           731 lib/record.c   			     session, htype, version[0], version[1]);</span>
<span class='curline'><a href='../S/5258.html#L749'>session</a>           749 lib/record.c   				     session, htype, version[0],</span>
<span class='curline'><a href='../S/5258.html#L758'>session</a>           758 lib/record.c   			     session, htype, version[0], version[1]);</span>
<span class='curline'><a href='../S/5258.html#L764'>session</a>           764 lib/record.c   			     session, htype, version[0], version[1]);</span>
<span class='curline'><a href='../S/5258.html#L773'>session</a>           773 lib/record.c   recv_hello_request(gnutls_session_t session, void *data,</span>
<span class='curline'><a href='../S/5258.html#L778'>session</a>           778 lib/record.c   	if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5258.html#L784'>session</a>           784 lib/record.c   	if (session-&gt;internals.handshake_in_progress)</span>
<span class='curline'><a href='../S/5258.html#L789'>session</a>           789 lib/record.c   		if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5258.html#L790'>session</a>           790 lib/record.c   			session-&gt;internals.dtls.hsk_read_seq++;</span>
<span class='curline'><a href='../S/5258.html#L791'>session</a>           791 lib/record.c   		if (session-&gt;internals.flags &amp; GNUTLS_AUTO_REAUTH) {</span>
<span class='curline'><a href='../S/5258.html#L792'>session</a>           792 lib/record.c   			session-&gt;internals.recv_state = RECV_STATE_REHANDSHAKE;</span>
<span class='curline'><a href='../S/5258.html#L809'>session</a>           809 lib/record.c   record_add_to_buffers(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L816'>session</a>           816 lib/record.c   	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5258.html#L839'>session</a>           839 lib/record.c   		    (session-&gt;internals.handshake_recv_buffer_size != 0 ||</span>
<span class='curline'><a href='../S/5258.html#L840'>session</a>           840 lib/record.c   		     session-&gt;internals.handshake_header_recv_buffer.length != 0)) {</span>
<span class='curline'><a href='../S/5258.html#L845'>session</a>           845 lib/record.c   		_gnutls_record_buffer_put(session, type, seq, bufel);</span>
<span class='curline'><a href='../S/5258.html#L849'>session</a>           849 lib/record.c   		_dtls_async_timer_delete(session);</span>
<span class='curline'><a href='../S/5258.html#L864'>session</a>           864 lib/record.c   			     session, bufel-&gt;msg.data[0],</span>
<span class='curline'><a href='../S/5258.html#L869'>session</a>           869 lib/record.c   			if (!session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L870'>session</a>           870 lib/record.c   			    session-&gt;internals.handshake_in_progress &amp;&amp; STATE == STATE0) { /* handshake hasn't started */</span>
<span class='curline'><a href='../S/5258.html#L875'>session</a>           875 lib/record.c   			session-&gt;internals.last_alert = bufel-&gt;msg.data[1];</span>
<span class='curline'><a href='../S/5258.html#L884'>session</a>           884 lib/record.c   				session-&gt;internals.read_eof = 1;</span>
<span class='curline'><a href='../S/5258.html#L894'>session</a>           894 lib/record.c   					session_unresumable(session);</span>
<span class='curline'><a href='../S/5258.html#L895'>session</a>           895 lib/record.c   					session_invalidate(session);</span>
<span class='curline'><a href='../S/5258.html#L905'>session</a>           905 lib/record.c   			if (!(IS_DTLS(session))) {</span>
<span class='curline'><a href='../S/5258.html#L910'>session</a>           910 lib/record.c   			_gnutls_record_buffer_put(session, recv-&gt;type, seq,</span>
<span class='curline'><a href='../S/5258.html#L917'>session</a>           917 lib/record.c   			ret = _gnutls_heartbeat_handle(session, bufel);</span>
<span class='curline'><a href='../S/5258.html#L922'>session</a>           922 lib/record.c   			if (session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L934'>session</a>           934 lib/record.c   			    session-&gt;internals.initial_negotiation_completed) {</span>
<span class='curline'><a href='../S/5258.html#L935'>session</a>           935 lib/record.c   				_gnutls_record_buffer_put(session, recv-&gt;type,</span>
<span class='curline'><a href='../S/5258.html#L952'>session</a>           952 lib/record.c   				_gnutls_record_buffer_put(session, recv-&gt;type,</span>
<span class='curline'><a href='../S/5258.html#L970'>session</a>           970 lib/record.c   			if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L978'>session</a>           978 lib/record.c   				if (_dtls_is_async(session)</span>
<span class='curline'><a href='../S/5258.html#L979'>session</a>           979 lib/record.c   				    &amp;&amp; _dtls_async_timer_active(session)) {</span>
<span class='curline'><a href='../S/5258.html#L980'>session</a>           980 lib/record.c   					if (session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5258.html#L987'>session</a>           987 lib/record.c   						    (session);</span>
<span class='curline'><a href='../S/5258.html#L989'>session</a>           989 lib/record.c   						session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L994'>session</a>           994 lib/record.c   						    (session);</span>
<span class='curline'><a href='../S/5258.html#L996'>session</a>           996 lib/record.c   							session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L1011'>session</a>          1011 lib/record.c   				_gnutls_record_buffer_put(session, recv-&gt;type, seq, bufel);</span>
<span class='curline'><a href='../S/5258.html#L1013'>session</a>          1013 lib/record.c   				ret = _gnutls13_recv_async_handshake(session);</span>
<span class='curline'><a href='../S/5258.html#L1024'>session</a>          1024 lib/record.c   			if (session-&gt;security_parameters.entity ==</span>
<span class='curline'><a href='../S/5258.html#L1026'>session</a>          1026 lib/record.c   			    &amp;&amp; session-&gt;internals.handshake_in_progress == 0</span>
<span class='curline'><a href='../S/5258.html#L1030'>session</a>          1030 lib/record.c   				_gnutls_record_buffer_put(session,</span>
<span class='curline'><a href='../S/5258.html#L1044'>session</a>          1044 lib/record.c   			    recv_hello_request(session,</span>
<span class='curline'><a href='../S/5258.html#L1052'>session</a>          1052 lib/record.c   			     session, recv-&gt;type,</span>
<span class='curline'><a href='../S/5258.html#L1066'>session</a>          1066 lib/record.c   	if (IS_DTLS(session) &amp;&amp; ret != GNUTLS_E_REHANDSHAKE) {</span>
<span class='curline'><a href='../S/5258.html#L1068'>session</a>          1068 lib/record.c   		RETURN_DTLS_EAGAIN_OR_TIMEOUT(session, ret);</span>
<span class='curline'><a href='../S/5258.html#L1082'>session</a>          1082 lib/record.c   record_read_headers(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L1096'>session</a>          1096 lib/record.c   	    &amp;&amp; !(IS_DTLS(session))) {</span>
<span class='curline'><a href='../S/5258.html#L1120'>session</a>          1120 lib/record.c   		     session, _gnutls_packet2str(record-&gt;type),</span>
<span class='curline'><a href='../S/5258.html#L1135'>session</a>          1135 lib/record.c   		if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L1143'>session</a>          1143 lib/record.c   			record-&gt;epoch = session-&gt;security_parameters.epoch_read;</span>
<span class='curline'><a href='../S/5258.html#L1148'>session</a>          1148 lib/record.c   		     session, (int) record-&gt;version[0],</span>
<span class='curline'><a href='../S/5258.html#L1159'>session</a>          1159 lib/record.c   static int recv_headers(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L1170'>session</a>          1170 lib/record.c   	    RECORD_HEADER_SIZE(session);</span>
<span class='curline'><a href='../S/5258.html#L1173'>session</a>          1173 lib/record.c   	    _gnutls_io_read_buffered(session, record-&gt;header_size, -1, ms);</span>
<span class='curline'><a href='../S/5258.html#L1186'>session</a>          1186 lib/record.c   	ret = _mbuffer_linearize_align16(&amp;session-&gt;internals.record_recv_buffer,</span>
<span class='curline'><a href='../S/5258.html#L1187'>session</a>          1187 lib/record.c   		get_total_headers2(session, record_params));</span>
<span class='curline'><a href='../S/5258.html#L1191'>session</a>          1191 lib/record.c   	_mbuffer_head_get_first(&amp;session-&gt;internals.record_recv_buffer,</span>
<span class='curline'><a href='../S/5258.html#L1193'>session</a>          1193 lib/record.c   	if (raw.size &lt; RECORD_HEADER_SIZE(session))</span>
<span class='curline'><a href='../S/5258.html#L1197'>session</a>          1197 lib/record.c   	record_read_headers(session, raw.data, type, htype, record);</span>
<span class='curline'><a href='../S/5258.html#L1200'>session</a>          1200 lib/record.c   	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L1201'>session</a>          1201 lib/record.c   		if (_gnutls_epoch_is_valid(session, record-&gt;epoch) == 0) {</span>
<span class='curline'><a href='../S/5258.html#L1202'>session</a>          1202 lib/record.c   			_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5258.html#L1215'>session</a>          1215 lib/record.c   	if ((ret = check_recv_type(session, record-&gt;type)) &lt; 0)</span>
<span class='curline'><a href='../S/5258.html#L1222'>session</a>          1222 lib/record.c   	     record_check_version(session, htype, record-&gt;version)) &lt; 0)</span>
<span class='curline'><a href='../S/5258.html#L1225'>session</a>          1225 lib/record.c   	if (record-&gt;length == 0 || record-&gt;length &gt; max_record_recv_size(session)) {</span>
<span class='curline'><a href='../S/5258.html#L1227'>session</a>          1227 lib/record.c   		    (session, "Received packet with illegal length: %u (max: %u)\n",</span>
<span class='curline'><a href='../S/5258.html#L1228'>session</a>          1228 lib/record.c   		     (unsigned int) record-&gt;length, (unsigned)max_record_recv_size(session));</span>
<span class='curline'><a href='../S/5258.html#L1244'>session</a>          1244 lib/record.c   	    ("REC[%p]: Expected Packet %s(%d)\n", session,</span>
<span class='curline'><a href='../S/5258.html#L1247'>session</a>          1247 lib/record.c   	    ("REC[%p]: Received Packet %s(%d) with length: %d\n", session,</span>
<span class='curline'><a href='../S/5258.html#L1264'>session</a>          1264 lib/record.c   _gnutls_recv_in_buffers(gnutls_session_t session, content_type_t type,</span>
<span class='curline'><a href='../S/5258.html#L1277'>session</a>          1277 lib/record.c   	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5258.html#L1286'>session</a>          1286 lib/record.c   	if (session-&gt;internals.read_eof != 0) {</span>
<span class='curline'><a href='../S/5258.html#L1290'>session</a>          1290 lib/record.c   	} else if (session_is_valid(session) != 0</span>
<span class='curline'><a href='../S/5258.html#L1291'>session</a>          1291 lib/record.c   		   || session-&gt;internals.may_not_read != 0)</span>
<span class='curline'><a href='../S/5258.html#L1296'>session</a>          1296 lib/record.c   	    _gnutls_epoch_get(session, EPOCH_READ_CURRENT, &amp;record_params);</span>
<span class='curline'><a href='../S/5258.html#L1307'>session</a>          1307 lib/record.c   	ret = recv_headers(session, record_params, type, htype, &amp;record, (!(session-&gt;internals.flags &amp; GNUTLS_NONBLOCK))?&amp;ms:0);</span>
<span class='curline'><a href='../S/5258.html#L1313'>session</a>          1313 lib/record.c   	if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5258.html#L1321'>session</a>          1321 lib/record.c   	    _gnutls_io_read_buffered(session, record.packet_size,</span>
<span class='curline'><a href='../S/5258.html#L1322'>session</a>          1322 lib/record.c   				     record.type, (!(session-&gt;internals.flags &amp; GNUTLS_NONBLOCK))?&amp;ms:0);</span>
<span class='curline'><a href='../S/5258.html#L1331'>session</a>          1331 lib/record.c   	ret = _mbuffer_linearize_align16(&amp;session-&gt;internals.record_recv_buffer,</span>
<span class='curline'><a href='../S/5258.html#L1332'>session</a>          1332 lib/record.c   		get_total_headers2(session, record_params));</span>
<span class='curline'><a href='../S/5258.html#L1337'>session</a>          1337 lib/record.c   	    _mbuffer_head_get_first(&amp;session-&gt;internals.record_recv_buffer,</span>
<span class='curline'><a href='../S/5258.html#L1348'>session</a>          1348 lib/record.c   		    !session-&gt;internals.handshake_in_progress)</span>
<span class='curline'><a href='../S/5258.html#L1355'>session</a>          1355 lib/record.c   		    _mbuffer_head_pop_first(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L1366'>session</a>          1366 lib/record.c   	ret = max_decrypted_size(session) + MAX_PAD_SIZE + MAX_HASH_SIZE;</span>
<span class='curline'><a href='../S/5258.html#L1381'>session</a>          1381 lib/record.c   	    _gnutls_decrypt(session, &amp;ciphertext, &amp;t,</span>
<span class='curline'><a href='../S/5258.html#L1386'>session</a>          1386 lib/record.c   	_mbuffer_head_remove_bytes(&amp;session-&gt;internals.record_recv_buffer,</span>
<span class='curline'><a href='../S/5258.html#L1389'>session</a>          1389 lib/record.c   	if (session-&gt;security_parameters.entity == GNUTLS_SERVER &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L1390'>session</a>          1390 lib/record.c   	    session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_IN_FLIGHT) {</span>
<span class='curline'><a href='../S/5258.html#L1391'>session</a>          1391 lib/record.c   		if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_ACCEPTED) {</span>
<span class='curline'><a href='../S/5258.html#L1398'>session</a>          1398 lib/record.c   					 session,</span>
<span class='curline'><a href='../S/5258.html#L1407'>session</a>          1407 lib/record.c   					 session,</span>
<span class='curline'><a href='../S/5258.html#L1411'>session</a>          1411 lib/record.c   				    session-&gt;security_parameters.max_early_data_size -</span>
<span class='curline'><a href='../S/5258.html#L1412'>session</a>          1412 lib/record.c   				    session-&gt;internals.early_data_received) {</span>
<span class='curline'><a href='../S/5258.html#L1415'>session</a>          1415 lib/record.c   						 session);</span>
<span class='curline'><a href='../S/5258.html#L1420'>session</a>          1420 lib/record.c   				_mbuffer_enqueue(&amp;session-&gt;internals.early_data_recv_buffer, decrypted);</span>
<span class='curline'><a href='../S/5258.html#L1421'>session</a>          1421 lib/record.c   				session-&gt;internals.early_data_received +=</span>
<span class='curline'><a href='../S/5258.html#L1428'>session</a>          1428 lib/record.c   				if (sequence_increment(session, &amp;record_state-&gt;sequence_number) != 0) {</span>
<span class='curline'><a href='../S/5258.html#L1429'>session</a>          1429 lib/record.c   					session_invalidate(session);</span>
<span class='curline'><a href='../S/5258.html#L1450'>session</a>          1450 lib/record.c   				    session-&gt;security_parameters.max_early_data_size -</span>
<span class='curline'><a href='../S/5258.html#L1451'>session</a>          1451 lib/record.c   				    session-&gt;internals.early_data_received) {</span>
<span class='curline'><a href='../S/5258.html#L1454'>session</a>          1454 lib/record.c   						 session);</span>
<span class='curline'><a href='../S/5258.html#L1460'>session</a>          1460 lib/record.c   						   session,</span>
<span class='curline'><a href='../S/5258.html#L1464'>session</a>          1464 lib/record.c   				session-&gt;internals.early_data_received += record.length;</span>
<span class='curline'><a href='../S/5258.html#L1469'>session</a>          1469 lib/record.c   				session-&gt;internals.hsk_flags &amp;= ~HSK_EARLY_DATA_IN_FLIGHT;</span>
<span class='curline'><a href='../S/5258.html#L1476'>session</a>          1476 lib/record.c   		_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5258.html#L1482'>session</a>          1482 lib/record.c   	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L1486'>session</a>          1486 lib/record.c   		if (likely(!(session-&gt;internals.flags &amp; GNUTLS_NO_REPLAY_PROTECTION))) {</span>
<span class='curline'><a href='../S/5258.html#L1491'>session</a>          1491 lib/record.c   				     session,</span>
<span class='curline'><a href='../S/5258.html#L1501'>session</a>          1501 lib/record.c   		     session,</span>
<span class='curline'><a href='../S/5258.html#L1513'>session</a>          1513 lib/record.c   		     session,</span>
<span class='curline'><a href='../S/5258.html#L1524'>session</a>          1524 lib/record.c   	if (sequence_increment(session, &amp;record_state-&gt;sequence_number) != 0) {</span>
<span class='curline'><a href='../S/5258.html#L1525'>session</a>          1525 lib/record.c   		session_invalidate(session);</span>
<span class='curline'><a href='../S/5258.html#L1551'>session</a>          1551 lib/record.c   	if (_mbuffer_get_udata_size(decrypted) &gt; max_decrypted_size(session)) {</span>
<span class='curline'><a href='../S/5258.html#L1553'>session</a>          1553 lib/record.c   		    (session, "Received packet with illegal length: %u\n",</span>
<span class='curline'><a href='../S/5258.html#L1571'>session</a>          1571 lib/record.c   	    record_add_to_buffers(session, &amp;record, type, htype,</span>
<span class='curline'><a href='../S/5258.html#L1582'>session</a>          1582 lib/record.c   	session-&gt;internals.dtls.packets_dropped++;</span>
<span class='curline'><a href='../S/5258.html#L1586'>session</a>          1586 lib/record.c   	    _mbuffer_head_pop_first(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L1592'>session</a>          1592 lib/record.c   	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L1593'>session</a>          1593 lib/record.c   		session-&gt;internals.dtls.packets_dropped++;</span>
<span class='curline'><a href='../S/5258.html#L1598'>session</a>          1598 lib/record.c   	session_unresumable(session);</span>
<span class='curline'><a href='../S/5258.html#L1599'>session</a>          1599 lib/record.c   	session_invalidate(session);</span>
<span class='curline'><a href='../S/5258.html#L1612'>session</a>          1612 lib/record.c   		session_invalidate(session);</span>
<span class='curline'><a href='../S/5258.html#L1617'>session</a>          1617 lib/record.c   	if (IS_DTLS(session) &amp;&amp; (ret == GNUTLS_E_DECRYPTION_FAILED ||</span>
<span class='curline'><a href='../S/5258.html#L1627'>session</a>          1627 lib/record.c   	session_invalidate(session);</span>
<span class='curline'><a href='../S/5258.html#L1628'>session</a>          1628 lib/record.c   	session_unresumable(session);</span>
<span class='curline'><a href='../S/5258.html#L1639'>session</a>          1639 lib/record.c   check_session_status(gnutls_session_t session, unsigned ms)</span>
<span class='curline'><a href='../S/5258.html#L1643'>session</a>          1643 lib/record.c   	if (session-&gt;internals.read_eof != 0) {</span>
<span class='curline'><a href='../S/5258.html#L1647'>session</a>          1647 lib/record.c   	} else if (session_is_valid(session) != 0</span>
<span class='curline'><a href='../S/5258.html#L1648'>session</a>          1648 lib/record.c   		   || session-&gt;internals.may_not_read != 0) {</span>
<span class='curline'><a href='../S/5258.html#L1653'>session</a>          1653 lib/record.c   	switch (session-&gt;internals.recv_state) {</span>
<span class='curline'><a href='../S/5258.html#L1655'>session</a>          1655 lib/record.c   		session-&gt;internals.recv_state = RECV_STATE_0;</span>
<span class='curline'><a href='../S/5258.html#L1657'>session</a>          1657 lib/record.c   		ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5258.html#L1661'>session</a>          1661 lib/record.c   			session-&gt;internals.recv_state = RECV_STATE_REAUTH;</span>
<span class='curline'><a href='../S/5258.html#L1667'>session</a>          1667 lib/record.c   		session-&gt;internals.recv_state = RECV_STATE_0;</span>
<span class='curline'><a href='../S/5258.html#L1669'>session</a>          1669 lib/record.c   		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5258.html#L1673'>session</a>          1673 lib/record.c   			session-&gt;internals.recv_state = RECV_STATE_REHANDSHAKE;</span>
<span class='curline'><a href='../S/5258.html#L1679'>session</a>          1679 lib/record.c   		ret = _gnutls_recv_in_buffers(session, GNUTLS_HANDSHAKE, -1, ms);</span>
<span class='curline'><a href='../S/5258.html#L1683'>session</a>          1683 lib/record.c   		ret = _gnutls13_recv_async_handshake(session);</span>
<span class='curline'><a href='../S/5258.html#L1694'>session</a>          1694 lib/record.c   		if (session-&gt;security_parameters.entity != GNUTLS_CLIENT ||</span>
<span class='curline'><a href='../S/5258.html#L1695'>session</a>          1695 lib/record.c   		    !(session-&gt;internals.flags &amp; GNUTLS_ENABLE_FALSE_START))</span>
<span class='curline'><a href='../S/5258.html#L1699'>session</a>          1699 lib/record.c   		session-&gt;internals.recv_state = RECV_STATE_FALSE_START_HANDLING;</span>
<span class='curline'><a href='../S/5258.html#L1700'>session</a>          1700 lib/record.c   		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5258.html#L1704'>session</a>          1704 lib/record.c   			session-&gt;internals.recv_state = RECV_STATE_FALSE_START;</span>
<span class='curline'><a href='../S/5258.html#L1708'>session</a>          1708 lib/record.c   		session-&gt;internals.recv_state = RECV_STATE_0;</span>
<span class='curline'><a href='../S/5258.html#L1713'>session</a>          1713 lib/record.c   		if (session-&gt;security_parameters.entity != GNUTLS_SERVER ||</span>
<span class='curline'><a href='../S/5258.html#L1714'>session</a>          1714 lib/record.c   		    !(session-&gt;internals.flags &amp; GNUTLS_ENABLE_EARLY_START))</span>
<span class='curline'><a href='../S/5258.html#L1718'>session</a>          1718 lib/record.c   		session-&gt;internals.recv_state = RECV_STATE_EARLY_START_HANDLING;</span>
<span class='curline'><a href='../S/5258.html#L1719'>session</a>          1719 lib/record.c   		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5258.html#L1723'>session</a>          1723 lib/record.c   			session-&gt;internals.recv_state = RECV_STATE_EARLY_START;</span>
<span class='curline'><a href='../S/5258.html#L1727'>session</a>          1727 lib/record.c   		session-&gt;internals.recv_state = RECV_STATE_0;</span>
<span class='curline'><a href='../S/5258.html#L1730'>session</a>          1730 lib/record.c   		ret = _dtls_retransmit(session);</span>
<span class='curline'><a href='../S/5258.html#L1734'>session</a>          1734 lib/record.c   		session-&gt;internals.recv_state = RECV_STATE_0;</span>
<span class='curline'><a href='../S/5258.html#L1739'>session</a>          1739 lib/record.c   		_dtls_async_timer_check(session);</span>
<span class='curline'><a href='../S/5258.html#L1752'>session</a>          1752 lib/record.c   _gnutls_recv_int(gnutls_session_t session, content_type_t type,</span>
<span class='curline'><a href='../S/5258.html#L1762'>session</a>          1762 lib/record.c   	ret = check_session_status(session, ms);</span>
<span class='curline'><a href='../S/5258.html#L1769'>session</a>          1769 lib/record.c   	ret = get_data_from_buffers(session, type, data, data_size, seq);</span>
<span class='curline'><a href='../S/5258.html#L1773'>session</a>          1773 lib/record.c   	ret = _gnutls_recv_in_buffers(session, type, -1, ms);</span>
<span class='curline'><a href='../S/5258.html#L1777'>session</a>          1777 lib/record.c   	return get_data_from_buffers(session, type, data, data_size, seq);</span>
<span class='curline'><a href='../S/5258.html#L1845'>session</a>          1845 lib/record.c   gnutls_record_discard_queued(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5258.html#L1847'>session</a>          1847 lib/record.c   	size_t ret = session-&gt;internals.record_send_buffer.byte_length;</span>
<span class='curline'><a href='../S/5258.html#L1848'>session</a>          1848 lib/record.c   	_mbuffer_head_clear(&amp;session-&gt;internals.record_send_buffer);</span>
<span class='curline'><a href='../S/5258.html#L1872'>session</a>          1872 lib/record.c   gnutls_record_recv_packet(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L1880'>session</a>          1880 lib/record.c   	ret = check_session_status(session, session-&gt;internals.record_timeout_ms);</span>
<span class='curline'><a href='../S/5258.html#L1884'>session</a>          1884 lib/record.c   	ret = get_packet_from_buffers(session, GNUTLS_APPLICATION_DATA, packet);</span>
<span class='curline'><a href='../S/5258.html#L1888'>session</a>          1888 lib/record.c   	ret = _gnutls_recv_in_buffers(session, GNUTLS_APPLICATION_DATA, -1,</span>
<span class='curline'><a href='../S/5258.html#L1889'>session</a>          1889 lib/record.c   				      session-&gt;internals.record_timeout_ms);</span>
<span class='curline'><a href='../S/5258.html#L1893'>session</a>          1893 lib/record.c   	return get_packet_from_buffers(session, GNUTLS_APPLICATION_DATA, packet);</span>
<span class='curline'><a href='../S/5258.html#L1897'>session</a>          1897 lib/record.c   ssize_t append_data_to_corked(gnutls_session_t session, const void *data, size_t data_size)</span>
<span class='curline'><a href='../S/5258.html#L1901'>session</a>          1901 lib/record.c   	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5258.html#L1902'>session</a>          1902 lib/record.c   		if (data_size + session-&gt;internals.record_presend_buffer.length &gt;</span>
<span class='curline'><a href='../S/5258.html#L1903'>session</a>          1903 lib/record.c   			gnutls_dtls_get_data_mtu(session)) {</span>
<span class='curline'><a href='../S/5258.html#L1909'>session</a>          1909 lib/record.c   	    _gnutls_buffer_append_data(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L1958'>session</a>          1958 lib/record.c   gnutls_record_send(gnutls_session_t session, const void *data,</span>
<span class='curline'><a href='../S/5258.html#L1961'>session</a>          1961 lib/record.c   	return gnutls_record_send2(session, data, data_size, 0, 0);</span>
<span class='curline'><a href='../S/5258.html#L1989'>session</a>          1989 lib/record.c   gnutls_record_send2(gnutls_session_t session, const void *data,</span>
<span class='curline'><a href='../S/5258.html#L1992'>session</a>          1992 lib/record.c   	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5258.html#L1996'>session</a>          1996 lib/record.c   	if (unlikely(!session-&gt;internals.initial_negotiation_completed)) {</span>
<span class='curline'><a href='../S/5258.html#L2000'>session</a>          2000 lib/record.c   		gnutls_mutex_lock(&amp;session-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5258.html#L2004'>session</a>          2004 lib/record.c   		if (!session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L2005'>session</a>          2005 lib/record.c   		    session-&gt;internals.recv_state != RECV_STATE_FALSE_START &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L2006'>session</a>          2006 lib/record.c   		    session-&gt;internals.recv_state != RECV_STATE_FALSE_START_HANDLING &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L2007'>session</a>          2007 lib/record.c   		    session-&gt;internals.recv_state != RECV_STATE_EARLY_START &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L2008'>session</a>          2008 lib/record.c   		    session-&gt;internals.recv_state != RECV_STATE_EARLY_START_HANDLING &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L2009'>session</a>          2009 lib/record.c   		    !(session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_IN_FLIGHT)) {</span>
<span class='curline'><a href='../S/5258.html#L2011'>session</a>          2011 lib/record.c   			gnutls_mutex_unlock(&amp;session-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5258.html#L2014'>session</a>          2014 lib/record.c   		gnutls_mutex_unlock(&amp;session-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5258.html#L2021'>session</a>          2021 lib/record.c   		max_pad = gnutls_record_get_max_size(session) - gnutls_record_overhead_size(session);</span>
<span class='curline'><a href='../S/5258.html#L2026'>session</a>          2026 lib/record.c   	switch(session-&gt;internals.rsend_state) {</span>
<span class='curline'><a href='../S/5258.html#L2028'>session</a>          2028 lib/record.c   			return _gnutls_send_tlen_int(session, GNUTLS_APPLICATION_DATA,</span>
<span class='curline'><a href='../S/5258.html#L2033'>session</a>          2033 lib/record.c   			return append_data_to_corked(session, data, data_size);</span>
<span class='curline'><a href='../S/5258.html#L2035'>session</a>          2035 lib/record.c   			_gnutls_buffer_reset(&amp;session-&gt;internals.record_key_update_buffer);</span>
<span class='curline'><a href='../S/5258.html#L2037'>session</a>          2037 lib/record.c   			ret = _gnutls_buffer_append_data(&amp;session-&gt;internals.record_key_update_buffer,</span>
<span class='curline'><a href='../S/5258.html#L2042'>session</a>          2042 lib/record.c   			session-&gt;internals.rsend_state = RECORD_SEND_KEY_UPDATE_2;</span>
<span class='curline'><a href='../S/5258.html#L2045'>session</a>          2045 lib/record.c   			ret = gnutls_session_key_update(session, 0);</span>
<span class='curline'><a href='../S/5258.html#L2049'>session</a>          2049 lib/record.c   			session-&gt;internals.rsend_state = RECORD_SEND_KEY_UPDATE_3;</span>
<span class='curline'><a href='../S/5258.html#L2052'>session</a>          2052 lib/record.c   			ret = _gnutls_send_int(session, GNUTLS_APPLICATION_DATA,</span>
<span class='curline'><a href='../S/5258.html#L2054'>session</a>          2054 lib/record.c   						session-&gt;internals.record_key_update_buffer.data,</span>
<span class='curline'><a href='../S/5258.html#L2055'>session</a>          2055 lib/record.c   						session-&gt;internals.record_key_update_buffer.length,</span>
<span class='curline'><a href='../S/5258.html#L2057'>session</a>          2057 lib/record.c   			_gnutls_buffer_clear(&amp;session-&gt;internals.record_key_update_buffer);</span>
<span class='curline'><a href='../S/5258.html#L2058'>session</a>          2058 lib/record.c   			session-&gt;internals.rsend_state = RECORD_SEND_NORMAL;</span>
<span class='curline'><a href='../S/5258.html#L2091'>session</a>          2091 lib/record.c   ssize_t gnutls_record_send_early_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5258.html#L2097'>session</a>          2097 lib/record.c   	if (session-&gt;security_parameters.entity != GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5258.html#L2100'>session</a>          2100 lib/record.c   	if (xsum(session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L2103'>session</a>          2103 lib/record.c   	    session-&gt;security_parameters.max_early_data_size)</span>
<span class='curline'><a href='../S/5258.html#L2107'>session</a>          2107 lib/record.c   	    _gnutls_buffer_append_data(&amp;session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L2140'>session</a>          2140 lib/record.c   gnutls_record_recv_early_data(gnutls_session_t session, void *data, size_t data_size)</span>
<span class='curline'><a href='../S/5258.html#L2146'>session</a>          2146 lib/record.c   	if (session-&gt;security_parameters.entity != GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5258.html#L2149'>session</a>          2149 lib/record.c   	bufel = _mbuffer_head_get_first(&amp;session-&gt;internals.early_data_recv_buffer,</span>
<span class='curline'><a href='../S/5258.html#L2158'>session</a>          2158 lib/record.c   	_mbuffer_head_remove_bytes(&amp;session-&gt;internals.early_data_recv_buffer,</span>
<span class='curline'><a href='../S/5258.html#L2175'>session</a>          2175 lib/record.c   void gnutls_record_cork(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5258.html#L2177'>session</a>          2177 lib/record.c   	session-&gt;internals.rsend_state = RECORD_SEND_CORKED;</span>
<span class='curline'><a href='../S/5258.html#L2201'>session</a>          2201 lib/record.c   int gnutls_record_uncork(gnutls_session_t session, unsigned int flags)</span>
<span class='curline'><a href='../S/5258.html#L2205'>session</a>          2205 lib/record.c   	record_send_state_t orig_state = session-&gt;internals.rsend_state;</span>
<span class='curline'><a href='../S/5258.html#L2208'>session</a>          2208 lib/record.c   		session-&gt;internals.rsend_state = RECORD_SEND_NORMAL;</span>
<span class='curline'><a href='../S/5258.html#L2210'>session</a>          2210 lib/record.c   		session-&gt;internals.rsend_state = RECORD_SEND_KEY_UPDATE_1;</span>
<span class='curline'><a href='../S/5258.html#L2214'>session</a>          2214 lib/record.c   	while (session-&gt;internals.record_presend_buffer.length &gt; 0) {</span>
<span class='curline'><a href='../S/5258.html#L2218'>session</a>          2218 lib/record.c   				    gnutls_record_send(session,</span>
<span class='curline'><a href='../S/5258.html#L2219'>session</a>          2219 lib/record.c   						       session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L2222'>session</a>          2222 lib/record.c   						       session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L2229'>session</a>          2229 lib/record.c   			    gnutls_record_send(session,</span>
<span class='curline'><a href='../S/5258.html#L2230'>session</a>          2230 lib/record.c   					       session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L2232'>session</a>          2232 lib/record.c   					       session-&gt;internals.</span>
<span class='curline'><a href='../S/5258.html#L2239'>session</a>          2239 lib/record.c   		session-&gt;internals.record_presend_buffer.data += ret;</span>
<span class='curline'><a href='../S/5258.html#L2240'>session</a>          2240 lib/record.c   		session-&gt;internals.record_presend_buffer.length -= ret;</span>
<span class='curline'><a href='../S/5258.html#L2247'>session</a>          2247 lib/record.c   	session-&gt;internals.rsend_state = orig_state;</span>
<span class='curline'><a href='../S/5258.html#L2278'>session</a>          2278 lib/record.c   gnutls_record_recv(gnutls_session_t session, void *data, size_t data_size)</span>
<span class='curline'><a href='../S/5258.html#L2280'>session</a>          2280 lib/record.c   	if (unlikely(!session-&gt;internals.initial_negotiation_completed)) {</span>
<span class='curline'><a href='../S/5258.html#L2284'>session</a>          2284 lib/record.c   		if (session-&gt;internals.recv_state != RECV_STATE_FALSE_START &amp;&amp;</span>
<span class='curline'><a href='../S/5258.html#L2285'>session</a>          2285 lib/record.c   		    session-&gt;internals.recv_state != RECV_STATE_EARLY_START)</span>
<span class='curline'><a href='../S/5258.html#L2289'>session</a>          2289 lib/record.c   	return _gnutls_recv_int(session, GNUTLS_APPLICATION_DATA,</span>
<span class='curline'><a href='../S/5258.html#L2291'>session</a>          2291 lib/record.c   				session-&gt;internals.record_timeout_ms);</span>
<span class='curline'><a href='../S/5258.html#L2315'>session</a>          2315 lib/record.c   gnutls_record_recv_seq(gnutls_session_t session, void *data,</span>
<span class='curline'><a href='../S/5258.html#L2318'>session</a>          2318 lib/record.c   	return _gnutls_recv_int(session, GNUTLS_APPLICATION_DATA,</span>
<span class='curline'><a href='../S/5258.html#L2320'>session</a>          2320 lib/record.c   				session-&gt;internals.record_timeout_ms);</span>
<span class='curline'><a href='../S/5258.html#L2338'>session</a>          2338 lib/record.c   void gnutls_record_set_timeout(gnutls_session_t session, unsigned int ms)</span>
<span class='curline'><a href='../S/5258.html#L2340'>session</a>          2340 lib/record.c   	session-&gt;internals.record_timeout_ms = ms;</span>
<span class='curline'><a href='../S/5295.html#L30'>session</a>            30 lib/record.h   ssize_t _gnutls_send_tlen_int(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5295.html#L38'>session</a>            38 lib/record.h   _gnutls_send_int(gnutls_session_t session, content_type_t type,</span>
<span class='curline'><a href='../S/5295.html#L43'>session</a>            43 lib/record.h   	return _gnutls_send_tlen_int(session, type, htype, epoch_rel,</span>
<span class='curline'><a href='../S/5295.html#L47'>session</a>            47 lib/record.h   ssize_t _gnutls_recv_int(gnutls_session_t session, content_type_t type,</span>
<span class='curline'><a href='../S/5295.html#L51'>session</a>            51 lib/record.h   inline static unsigned max_record_recv_size(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5295.html#L55'>session</a>            55 lib/record.h   	if (session-&gt;internals.max_recv_size == 0) {</span>
<span class='curline'><a href='../S/5295.html#L56'>session</a>            56 lib/record.h   		size = session-&gt;security_parameters.max_record_recv_size + RECORD_HEADER_SIZE(session);</span>
<span class='curline'><a href='../S/5295.html#L57'>session</a>            57 lib/record.h   		if (session-&gt;internals.allow_large_records != 0)</span>
<span class='curline'><a href='../S/5295.html#L60'>session</a>            60 lib/record.h   		size = session-&gt;internals.max_recv_size;</span>
<span class='curline'><a href='../S/5295.html#L66'>session</a>            66 lib/record.h   inline static unsigned max_decrypted_size(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5295.html#L70'>session</a>            70 lib/record.h   	if (session-&gt;internals.allow_large_records != 0)</span>
<span class='curline'><a href='../S/5295.html#L73'>session</a>            73 lib/record.h   	size += session-&gt;security_parameters.max_record_recv_size;</span>
<span class='curline'><a href='../S/5295.html#L81'>session</a>            81 lib/record.h   unsigned int get_total_headers(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5295.html#L85'>session</a>            85 lib/record.h   	unsigned total = RECORD_HEADER_SIZE(session);</span>
<span class='curline'><a href='../S/5295.html#L87'>session</a>            87 lib/record.h   	ret = _gnutls_epoch_get(session, EPOCH_WRITE_CURRENT, &amp;params);</span>
<span class='curline'><a href='../S/5295.html#L96'>session</a>            96 lib/record.h   unsigned int get_total_headers2(gnutls_session_t session, record_parameters_st *params)</span>
<span class='curline'><a href='../S/5295.html#L98'>session</a>            98 lib/record.h   	unsigned total = RECORD_HEADER_SIZE(session);</span>
<span class='curline'><a href='../S/5295.html#L103'>session</a>           103 lib/record.h   inline static void session_invalidate(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5295.html#L105'>session</a>           105 lib/record.h   	session-&gt;internals.invalid_connection = 1;</span>
<span class='curline'><a href='../S/6037.html#L31'>session</a>            31 lib/secrets.c  int _tls13_init_secret(gnutls_session_t session, const uint8_t *psk, size_t psk_size)</span>
<span class='curline'><a href='../S/6037.html#L33'>session</a>            33 lib/secrets.c  	session-&gt;key.proto.tls13.temp_secret_size = session-&gt;security_parameters.prf-&gt;output_size;</span>
<span class='curline'><a href='../S/6037.html#L35'>session</a>            35 lib/secrets.c  	return _tls13_init_secret2(session-&gt;security_parameters.prf,</span>
<span class='curline'><a href='../S/6037.html#L37'>session</a>            37 lib/secrets.c  				   session-&gt;key.proto.tls13.temp_secret);</span>
<span class='curline'><a href='../S/6037.html#L66'>session</a>            66 lib/secrets.c  int _tls13_update_secret(gnutls_session_t session, const uint8_t *key, size_t key_size)</span>
<span class='curline'><a href='../S/6037.html#L73'>session</a>            73 lib/secrets.c  	salt.data = (void *)session-&gt;key.proto.tls13.temp_secret;</span>
<span class='curline'><a href='../S/6037.html#L74'>session</a>            74 lib/secrets.c  	salt.size = session-&gt;key.proto.tls13.temp_secret_size;</span>
<span class='curline'><a href='../S/6037.html#L76'>session</a>            76 lib/secrets.c  	return gnutls_hkdf_extract(session-&gt;security_parameters.prf-&gt;id,</span>
<span class='curline'><a href='../S/6037.html#L78'>session</a>            78 lib/secrets.c  				   session-&gt;key.proto.tls13.temp_secret);</span>
<span class='curline'><a href='../S/6037.html#L107'>session</a>           107 lib/secrets.c  int _tls13_derive_secret(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6037.html#L113'>session</a>           113 lib/secrets.c  	if (unlikely(session-&gt;security_parameters.prf == NULL))</span>
<span class='curline'><a href='../S/6037.html#L116'>session</a>           116 lib/secrets.c  	return _tls13_derive_secret2(session-&gt;security_parameters.prf, label, label_size, tbh, tbh_size,</span>
<span class='curline'><a href='../S/6037.html#L187'>session</a>           187 lib/secrets.c  int _tls13_expand_secret(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6037.html#L194'>session</a>           194 lib/secrets.c  	if (unlikely(session-&gt;security_parameters.prf == NULL))</span>
<span class='curline'><a href='../S/6037.html#L197'>session</a>           197 lib/secrets.c  	return _tls13_expand_secret2(session-&gt;security_parameters.prf,</span>
<span class='curline'><a href='../S/5267.html#L28'>session</a>            28 lib/secrets.h  int _tls13_init_secret(gnutls_session_t session, const uint8_t *psk, size_t psk_size);</span>
<span class='curline'><a href='../S/5267.html#L29'>session</a>            29 lib/secrets.h  int _tls13_update_secret(gnutls_session_t session, const uint8_t *key, size_t key_size);</span>
<span class='curline'><a href='../S/5267.html#L35'>session</a>            35 lib/secrets.h  int _tls13_derive_secret(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5267.html#L46'>session</a>            46 lib/secrets.h  int _tls13_expand_secret(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5303.html#L48'>session</a>            48 lib/session.c  gnutls_session_get_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5303.html#L55'>session</a>            55 lib/session.c  	ret = gnutls_session_get_data2(session, &amp;psession);</span>
<span class='curline'><a href='../S/5303.html#L122'>session</a>           122 lib/session.c  gnutls_session_get_data2(gnutls_session_t session, gnutls_datum_t *data)</span>
<span class='curline'><a href='../S/5303.html#L124'>session</a>           124 lib/session.c  	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5303.html#L131'>session</a>           131 lib/session.c  	if (vers-&gt;tls13_sem &amp;&amp; !(session-&gt;internals.hsk_flags &amp; HSK_TICKET_RECEIVED)) {</span>
<span class='curline'><a href='../S/5303.html#L132'>session</a>           132 lib/session.c  		unsigned ertt = session-&gt;internals.ertt;</span>
<span class='curline'><a href='../S/5303.html#L139'>session</a>           139 lib/session.c  		if (NO_TIMEOUT_FUNC_SET(session) || (session-&gt;internals.flags &amp; GNUTLS_NONBLOCK)) {</span>
<span class='curline'><a href='../S/5303.html#L140'>session</a>           140 lib/session.c  			if (!(session-&gt;internals.flags &amp; GNUTLS_NONBLOCK))</span>
<span class='curline'><a href='../S/5303.html#L144'>session</a>           144 lib/session.c  			ret = _gnutls_recv_in_buffers(session, GNUTLS_APPLICATION_DATA, -1, ertt);</span>
<span class='curline'><a href='../S/5303.html#L150'>session</a>           150 lib/session.c  		if (!(session-&gt;internals.hsk_flags &amp; HSK_TICKET_RECEIVED)) {</span>
<span class='curline'><a href='../S/5303.html#L160'>session</a>           160 lib/session.c  		if (gnutls_session_is_resumed(session) &amp;&amp; session-&gt;internals.resumption_data.data) {</span>
<span class='curline'><a href='../S/5303.html#L161'>session</a>           161 lib/session.c  			ret = _gnutls_set_datum(data, session-&gt;internals.resumption_data.data, session-&gt;internals.resumption_data.size);</span>
<span class='curline'><a href='../S/5303.html#L169'>session</a>           169 lib/session.c  	if (session-&gt;internals.resumable == RESUME_FALSE)</span>
<span class='curline'><a href='../S/5303.html#L172'>session</a>           172 lib/session.c  	ret = _gnutls_session_pack(session, data);</span>
<span class='curline'><a href='../S/5303.html#L210'>session</a>           210 lib/session.c  gnutls_session_get_id(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5303.html#L215'>session</a>           215 lib/session.c  	*session_id_size = session-&gt;security_parameters.session_id_size;</span>
<span class='curline'><a href='../S/5303.html#L223'>session</a>           223 lib/session.c  	    session-&gt;security_parameters.session_id_size) {</span>
<span class='curline'><a href='../S/5303.html#L227'>session</a>           227 lib/session.c  	memcpy(session_id, &amp;session-&gt;security_parameters.session_id,</span>
<span class='curline'><a href='../S/5303.html#L262'>session</a>           262 lib/session.c  gnutls_session_get_id2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5303.html#L265'>session</a>           265 lib/session.c  	session_id-&gt;size = session-&gt;security_parameters.session_id_size;</span>
<span class='curline'><a href='../S/5303.html#L266'>session</a>           266 lib/session.c  	session_id-&gt;data = session-&gt;security_parameters.session_id;</span>
<span class='curline'><a href='../S/5303.html#L290'>session</a>           290 lib/session.c  gnutls_session_set_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5303.html#L311'>session</a>           311 lib/session.c  	ret = _gnutls_session_unpack(session, &amp;psession);</span>
<span class='curline'><a href='../S/5303.html#L317'>session</a>           317 lib/session.c  	session-&gt;internals.resumption_requested = 1;</span>
<span class='curline'><a href='../S/5303.html#L319'>session</a>           319 lib/session.c  	if (session-&gt;internals.resumption_data.data != NULL)</span>
<span class='curline'><a href='../S/5303.html#L320'>session</a>           320 lib/session.c  		gnutls_free(session-&gt;internals.resumption_data.data);</span>
<span class='curline'><a href='../S/5303.html#L321'>session</a>           321 lib/session.c  	ret = _gnutls_set_datum(&amp;session-&gt;internals.resumption_data, session_data, session_data_size);</span>
<span class='curline'><a href='../S/5303.html#L341'>session</a>           341 lib/session.c  void gnutls_session_force_valid(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5303.html#L343'>session</a>           343 lib/session.c  	session-&gt;internals.invalid_connection = 0;</span>
<span class='curline'><a href='../S/5303.html#L362'>session</a>           362 lib/session.c  char *gnutls_session_get_desc(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5303.html#L375'>session</a>           375 lib/session.c  	const struct gnutls_group_entry_st *group = get_group(session);</span>
<span class='curline'><a href='../S/5303.html#L376'>session</a>           376 lib/session.c  	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5303.html#L378'>session</a>           378 lib/session.c  	if (session-&gt;internals.initial_negotiation_completed == 0)</span>
<span class='curline'><a href='../S/5303.html#L381'>session</a>           381 lib/session.c  	kx = session-&gt;security_parameters.cs-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5303.html#L386'>session</a>           386 lib/session.c  		dh_bits = gnutls_dh_get_prime_bits(session);</span>
<span class='curline'><a href='../S/5303.html#L399'>session</a>           399 lib/session.c  	sign_algo = gnutls_sign_algorithm_get(session);</span>
<span class='curline'><a href='../S/5303.html#L403'>session</a>           403 lib/session.c  		if (session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED) {</span>
<span class='curline'><a href='../S/5303.html#L452'>session</a>           452 lib/session.c  	if (are_alternative_cert_types_allowed(session)) {</span>
<span class='curline'><a href='../S/5303.html#L454'>session</a>           454 lib/session.c  		ctype_client = get_certificate_type(session, GNUTLS_CTYPE_CLIENT);</span>
<span class='curline'><a href='../S/5303.html#L455'>session</a>           455 lib/session.c  		ctype_server = get_certificate_type(session, GNUTLS_CTYPE_SERVER);</span>
<span class='curline'><a href='../S/5303.html#L460'>session</a>           460 lib/session.c  				 gnutls_protocol_get_name(get_num_version(session)),</span>
<span class='curline'><a href='../S/5303.html#L465'>session</a>           465 lib/session.c  				 gnutls_protocol_get_name(get_num_version(session)),</span>
<span class='curline'><a href='../S/5303.html#L471'>session</a>           471 lib/session.c  				 gnutls_protocol_get_name(get_num_version(session)));</span>
<span class='curline'><a href='../S/5303.html#L478'>session</a>           478 lib/session.c  	mac_id = gnutls_mac_get(session);</span>
<span class='curline'><a href='../S/5303.html#L484'>session</a>           484 lib/session.c  			 gnutls_cipher_get_name(gnutls_cipher_get(session)));</span>
<span class='curline'><a href='../S/5303.html#L490'>session</a>           490 lib/session.c  			 gnutls_cipher_get_name(gnutls_cipher_get(session)),</span>
<span class='curline'><a href='../S/5303.html#L514'>session</a>           514 lib/session.c  gnutls_session_set_id(gnutls_session_t session, const gnutls_datum_t * sid)</span>
<span class='curline'><a href='../S/5303.html#L516'>session</a>           516 lib/session.c  	if (session-&gt;security_parameters.entity == GNUTLS_SERVER ||</span>
<span class='curline'><a href='../S/5303.html#L520'>session</a>           520 lib/session.c  	memset(&amp;session-&gt;internals.resumed_security_parameters, 0,</span>
<span class='curline'><a href='../S/5303.html#L521'>session</a>           521 lib/session.c  	       sizeof(session-&gt;internals.resumed_security_parameters));</span>
<span class='curline'><a href='../S/5303.html#L523'>session</a>           523 lib/session.c  	session-&gt;internals.resumed_security_parameters.session_id_size =</span>
<span class='curline'><a href='../S/5303.html#L525'>session</a>           525 lib/session.c  	memcpy(session-&gt;internals.resumed_security_parameters.session_id,</span>
<span class='curline'><a href='../S/6030.html#L54'>session</a>            54 lib/session_pack.c static int unpack_srp_auth_info(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L56'>session</a>            56 lib/session_pack.c static int pack_srp_auth_info(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L59'>session</a>            59 lib/session_pack.c static int unpack_psk_auth_info(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L61'>session</a>            61 lib/session_pack.c static int pack_psk_auth_info(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L64'>session</a>            64 lib/session_pack.c static int unpack_anon_auth_info(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L66'>session</a>            66 lib/session_pack.c static int pack_anon_auth_info(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L69'>session</a>            69 lib/session_pack.c static int unpack_security_parameters(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L71'>session</a>            71 lib/session_pack.c static int pack_security_parameters(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L73'>session</a>            73 lib/session_pack.c static int tls13_unpack_security_parameters(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L75'>session</a>            75 lib/session_pack.c static int tls13_pack_security_parameters(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L88'>session</a>            88 lib/session_pack.c _gnutls_session_pack(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L103'>session</a>           103 lib/session_pack.c 	id = gnutls_auth_get_type(session);</span>
<span class='curline'><a href='../S/6030.html#L106'>session</a>           106 lib/session_pack.c 	BUFFER_APPEND_NUM(&amp;sb, session-&gt;security_parameters.timestamp);</span>
<span class='curline'><a href='../S/6030.html#L107'>session</a>           107 lib/session_pack.c 	BUFFER_APPEND_NUM(&amp;sb, session-&gt;internals.expire_time);</span>
<span class='curline'><a href='../S/6030.html#L113'>session</a>           113 lib/session_pack.c 		ret = pack_srp_auth_info(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L122'>session</a>           122 lib/session_pack.c 		ret = pack_psk_auth_info(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L131'>session</a>           131 lib/session_pack.c 		ret = pack_anon_auth_info(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L139'>session</a>           139 lib/session_pack.c 		ret = pack_certificate_auth_info(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L154'>session</a>           154 lib/session_pack.c 	ret = pack_security_parameters(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L161'>session</a>           161 lib/session_pack.c 	if (session-&gt;security_parameters.pversion-&gt;tls13_sem) {</span>
<span class='curline'><a href='../S/6030.html#L162'>session</a>           162 lib/session_pack.c 		ret = tls13_pack_security_parameters(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L170'>session</a>           170 lib/session_pack.c 	if (!session-&gt;security_parameters.pversion-&gt;tls13_sem) {</span>
<span class='curline'><a href='../S/6030.html#L171'>session</a>           171 lib/session_pack.c 		ret = _gnutls_hello_ext_pack(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L189'>session</a>           189 lib/session_pack.c _gnutls_session_unpack(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L213'>session</a>           213 lib/session_pack.c 	if (session-&gt;key.auth_info != NULL) {</span>
<span class='curline'><a href='../S/6030.html#L214'>session</a>           214 lib/session_pack.c 		_gnutls_free_auth_info(session);</span>
<span class='curline'><a href='../S/6030.html#L224'>session</a>           224 lib/session_pack.c 		       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L233'>session</a>           233 lib/session_pack.c 		ret = unpack_srp_auth_info(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L242'>session</a>           242 lib/session_pack.c 		ret = unpack_psk_auth_info(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L251'>session</a>           251 lib/session_pack.c 		ret = unpack_anon_auth_info(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L259'>session</a>           259 lib/session_pack.c 		ret = unpack_certificate_auth_info(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L275'>session</a>           275 lib/session_pack.c 	ret = unpack_security_parameters(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L281'>session</a>           281 lib/session_pack.c 	if (session-&gt;internals.resumed_security_parameters.pversion-&gt;tls13_sem) {</span>
<span class='curline'><a href='../S/6030.html#L283'>session</a>           283 lib/session_pack.c 		ret = tls13_unpack_security_parameters(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L290'>session</a>           290 lib/session_pack.c 	if (!session-&gt;internals.resumed_security_parameters.pversion-&gt;tls13_sem) {</span>
<span class='curline'><a href='../S/6030.html#L291'>session</a>           291 lib/session_pack.c 		ret = _gnutls_hello_ext_unpack(session, &amp;sb);</span>
<span class='curline'><a href='../S/6030.html#L326'>session</a>           326 lib/session_pack.c tls13_pack_security_parameters(gnutls_session_t session, gnutls_buffer_st *ps)</span>
<span class='curline'><a href='../S/6030.html#L331'>session</a>           331 lib/session_pack.c 	tls13_ticket_st *ticket = &amp;session-&gt;internals.tls13_ticket;</span>
<span class='curline'><a href='../S/6030.html#L356'>session</a>           356 lib/session_pack.c 				  session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L368'>session</a>           368 lib/session_pack.c tls13_unpack_security_parameters(gnutls_session_t session, gnutls_buffer_st *ps)</span>
<span class='curline'><a href='../S/6030.html#L371'>session</a>           371 lib/session_pack.c 	tls13_ticket_st *ticket = &amp;session-&gt;internals.tls13_ticket;</span>
<span class='curline'><a href='../S/6030.html#L400'>session</a>           400 lib/session_pack.c 		if (unlikely(session-&gt;internals.resumed_security_parameters.prf == NULL ||</span>
<span class='curline'><a href='../S/6030.html#L401'>session</a>           401 lib/session_pack.c 		    session-&gt;internals.resumed_security_parameters.prf-&gt;output_size != t.size))</span>
<span class='curline'><a href='../S/6030.html#L404'>session</a>           404 lib/session_pack.c 		ticket-&gt;prf = session-&gt;internals.resumed_security_parameters.prf;</span>
<span class='curline'><a href='../S/6030.html#L408'>session</a>           408 lib/session_pack.c 			       session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L439'>session</a>           439 lib/session_pack.c pack_certificate_auth_info(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L443'>session</a>           443 lib/session_pack.c 	cert_auth_info_t info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/6030.html#L492'>session</a>           492 lib/session_pack.c unpack_certificate_auth_info(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6030.html#L510'>session</a>           510 lib/session_pack.c 	    _gnutls_auth_info_init(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/6030.html#L517'>session</a>           517 lib/session_pack.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/6030.html#L594'>session</a>           594 lib/session_pack.c pack_srp_auth_info(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L596'>session</a>           596 lib/session_pack.c 	srp_server_auth_info_t info = _gnutls_get_auth_info(session, GNUTLS_CRD_SRP);</span>
<span class='curline'><a href='../S/6030.html#L623'>session</a>           623 lib/session_pack.c unpack_srp_auth_info(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L636'>session</a>           636 lib/session_pack.c 	    _gnutls_auth_info_init(session, GNUTLS_CRD_SRP,</span>
<span class='curline'><a href='../S/6030.html#L643'>session</a>           643 lib/session_pack.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_SRP);</span>
<span class='curline'><a href='../S/6030.html#L675'>session</a>           675 lib/session_pack.c pack_anon_auth_info(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L678'>session</a>           678 lib/session_pack.c 	anon_auth_info_t info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/6030.html#L704'>session</a>           704 lib/session_pack.c unpack_anon_auth_info(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L718'>session</a>           718 lib/session_pack.c 	    _gnutls_auth_info_init(session, GNUTLS_CRD_ANON,</span>
<span class='curline'><a href='../S/6030.html#L725'>session</a>           725 lib/session_pack.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/6030.html#L767'>session</a>           767 lib/session_pack.c pack_psk_auth_info(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L775'>session</a>           775 lib/session_pack.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/6030.html#L803'>session</a>           803 lib/session_pack.c unpack_psk_auth_info(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L811'>session</a>           811 lib/session_pack.c 	    _gnutls_auth_info_init(session, GNUTLS_CRD_PSK,</span>
<span class='curline'><a href='../S/6030.html#L818'>session</a>           818 lib/session_pack.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/6030.html#L870'>session</a>           870 lib/session_pack.c pack_security_parameters(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L877'>session</a>           877 lib/session_pack.c 	if (session-&gt;security_parameters.epoch_read</span>
<span class='curline'><a href='../S/6030.html#L878'>session</a>           878 lib/session_pack.c 	    != session-&gt;security_parameters.epoch_write &amp;&amp;</span>
<span class='curline'><a href='../S/6030.html#L879'>session</a>           879 lib/session_pack.c 	    !(session-&gt;internals.hsk_flags &amp; HSK_EARLY_START_USED)) {</span>
<span class='curline'><a href='../S/6030.html#L884'>session</a>           884 lib/session_pack.c 	ret = _gnutls_epoch_get(session, EPOCH_READ_CURRENT, NULL);</span>
<span class='curline'><a href='../S/6030.html#L896'>session</a>           896 lib/session_pack.c 	BUFFER_APPEND_NUM(ps, session-&gt;security_parameters.entity);</span>
<span class='curline'><a href='../S/6030.html#L897'>session</a>           897 lib/session_pack.c 	BUFFER_APPEND_NUM(ps, session-&gt;security_parameters.prf-&gt;id);</span>
<span class='curline'><a href='../S/6030.html#L900'>session</a>           900 lib/session_pack.c 			  session-&gt;security_parameters.client_auth_type);</span>
<span class='curline'><a href='../S/6030.html#L902'>session</a>           902 lib/session_pack.c 			  session-&gt;security_parameters.server_auth_type);</span>
<span class='curline'><a href='../S/6030.html#L904'>session</a>           904 lib/session_pack.c 	BUFFER_APPEND(ps, &amp;session-&gt;security_parameters.session_id_size,</span>
<span class='curline'><a href='../S/6030.html#L906'>session</a>           906 lib/session_pack.c 	BUFFER_APPEND(ps, session-&gt;security_parameters.session_id,</span>
<span class='curline'><a href='../S/6030.html#L907'>session</a>           907 lib/session_pack.c 		      session-&gt;security_parameters.session_id_size);</span>
<span class='curline'><a href='../S/6030.html#L909'>session</a>           909 lib/session_pack.c 	BUFFER_APPEND_NUM(ps, session-&gt;security_parameters.pversion-&gt;id);</span>
<span class='curline'><a href='../S/6030.html#L911'>session</a>           911 lib/session_pack.c 	BUFFER_APPEND_NUM(ps, session-&gt;security_parameters.client_ctype);</span>
<span class='curline'><a href='../S/6030.html#L912'>session</a>           912 lib/session_pack.c 	BUFFER_APPEND_NUM(ps, session-&gt;security_parameters.server_ctype);</span>
<span class='curline'><a href='../S/6030.html#L916'>session</a>           916 lib/session_pack.c 	if (!session-&gt;security_parameters.pversion-&gt;tls13_sem) {</span>
<span class='curline'><a href='../S/6030.html#L917'>session</a>           917 lib/session_pack.c 		BUFFER_APPEND(ps, session-&gt;security_parameters.cs-&gt;id, 2);</span>
<span class='curline'><a href='../S/6030.html#L919'>session</a>           919 lib/session_pack.c 		BUFFER_APPEND_PFX1(ps, session-&gt;security_parameters.master_secret,</span>
<span class='curline'><a href='../S/6030.html#L921'>session</a>           921 lib/session_pack.c 		BUFFER_APPEND_PFX1(ps, session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/6030.html#L923'>session</a>           923 lib/session_pack.c 		BUFFER_APPEND_PFX1(ps, session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/6030.html#L928'>session</a>           928 lib/session_pack.c 		if (session-&gt;internals.hsk_flags &amp; HSK_RECORD_SIZE_LIMIT_NEGOTIATED) {</span>
<span class='curline'><a href='../S/6030.html#L930'>session</a>           930 lib/session_pack.c 					  session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L933'>session</a>           933 lib/session_pack.c 					  session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L937'>session</a>           937 lib/session_pack.c 					  session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L940'>session</a>           940 lib/session_pack.c 					  session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L944'>session</a>           944 lib/session_pack.c 		if (session-&gt;security_parameters.grp) {</span>
<span class='curline'><a href='../S/6030.html#L945'>session</a>           945 lib/session_pack.c 			BUFFER_APPEND_NUM(ps, session-&gt;security_parameters.grp-&gt;id);</span>
<span class='curline'><a href='../S/6030.html#L951'>session</a>           951 lib/session_pack.c 				  session-&gt;security_parameters.server_sign_algo);</span>
<span class='curline'><a href='../S/6030.html#L953'>session</a>           953 lib/session_pack.c 				  session-&gt;security_parameters.client_sign_algo);</span>
<span class='curline'><a href='../S/6030.html#L955'>session</a>           955 lib/session_pack.c 				  session-&gt;security_parameters.ext_master_secret);</span>
<span class='curline'><a href='../S/6030.html#L957'>session</a>           957 lib/session_pack.c 				  session-&gt;security_parameters.etm);</span>
<span class='curline'><a href='../S/6030.html#L968'>session</a>           968 lib/session_pack.c unpack_security_parameters(gnutls_session_t session, gnutls_buffer_st * ps)</span>
<span class='curline'><a href='../S/6030.html#L983'>session</a>           983 lib/session_pack.c 	    session-&gt;internals.resumed_security_parameters.timestamp;</span>
<span class='curline'><a href='../S/6030.html#L984'>session</a>           984 lib/session_pack.c 	memset(&amp;session-&gt;internals.resumed_security_parameters, 0,</span>
<span class='curline'><a href='../S/6030.html#L985'>session</a>           985 lib/session_pack.c 	       sizeof(session-&gt;internals.resumed_security_parameters));</span>
<span class='curline'><a href='../S/6030.html#L986'>session</a>           986 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.timestamp =</span>
<span class='curline'><a href='../S/6030.html#L990'>session</a>           990 lib/session_pack.c 		       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L994'>session</a>           994 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.prf = mac_to_entry(version);</span>
<span class='curline'><a href='../S/6030.html#L995'>session</a>           995 lib/session_pack.c 	if (session-&gt;internals.resumed_security_parameters.prf == NULL)</span>
<span class='curline'><a href='../S/6030.html#L999'>session</a>           999 lib/session_pack.c 		       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1002'>session</a>          1002 lib/session_pack.c 		       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1006'>session</a>          1006 lib/session_pack.c 		   &amp;session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1010'>session</a>          1010 lib/session_pack.c 		   session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1012'>session</a>          1012 lib/session_pack.c 		   session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1016'>session</a>          1016 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.pversion =</span>
<span class='curline'><a href='../S/6030.html#L1018'>session</a>          1018 lib/session_pack.c 	if (session-&gt;internals.resumed_security_parameters.pversion ==</span>
<span class='curline'><a href='../S/6030.html#L1023'>session</a>          1023 lib/session_pack.c 		       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1026'>session</a>          1026 lib/session_pack.c 		       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1029'>session</a>          1029 lib/session_pack.c 	if (!session-&gt;internals.resumed_security_parameters.pversion-&gt;tls13_sem) {</span>
<span class='curline'><a href='../S/6030.html#L1031'>session</a>          1031 lib/session_pack.c 		session-&gt;internals.resumed_security_parameters.cs = ciphersuite_to_entry(cs);</span>
<span class='curline'><a href='../S/6030.html#L1032'>session</a>          1032 lib/session_pack.c 		if (session-&gt;internals.resumed_security_parameters.cs == NULL)</span>
<span class='curline'><a href='../S/6030.html#L1043'>session</a>          1043 lib/session_pack.c 			memcpy(session-&gt;internals.resumed_security_parameters.master_secret, t.data, t.size);</span>
<span class='curline'><a href='../S/6030.html#L1053'>session</a>          1053 lib/session_pack.c 			memcpy(session-&gt;internals.resumed_security_parameters.client_random, t.data, t.size);</span>
<span class='curline'><a href='../S/6030.html#L1063'>session</a>          1063 lib/session_pack.c 			memcpy(session-&gt;internals.resumed_security_parameters.server_random, t.data, t.size);</span>
<span class='curline'><a href='../S/6030.html#L1067'>session</a>          1067 lib/session_pack.c 			       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1070'>session</a>          1070 lib/session_pack.c 			       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1074'>session</a>          1074 lib/session_pack.c 		session-&gt;internals.resumed_security_parameters.grp = _gnutls_id_to_group(ret);</span>
<span class='curline'><a href='../S/6030.html#L1078'>session</a>          1078 lib/session_pack.c 			       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1081'>session</a>          1081 lib/session_pack.c 			       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1084'>session</a>          1084 lib/session_pack.c 			       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1087'>session</a>          1087 lib/session_pack.c 			       session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1090'>session</a>          1090 lib/session_pack.c 		if (session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1092'>session</a>          1092 lib/session_pack.c 		    || session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1125'>session</a>          1125 lib/session_pack.c gnutls_session_set_premaster(gnutls_session_t session, unsigned int entity,</span>
<span class='curline'><a href='../S/6030.html#L1137'>session</a>          1137 lib/session_pack.c 	memset(&amp;session-&gt;internals.resumed_security_parameters, 0,</span>
<span class='curline'><a href='../S/6030.html#L1138'>session</a>          1138 lib/session_pack.c 	       sizeof(session-&gt;internals.resumed_security_parameters));</span>
<span class='curline'><a href='../S/6030.html#L1140'>session</a>          1140 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.entity = entity;</span>
<span class='curline'><a href='../S/6030.html#L1147'>session</a>          1147 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.cs = ciphersuite_to_entry(cs);</span>
<span class='curline'><a href='../S/6030.html#L1148'>session</a>          1148 lib/session_pack.c 	if (session-&gt;internals.resumed_security_parameters.cs == NULL)</span>
<span class='curline'><a href='../S/6030.html#L1151'>session</a>          1151 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.client_ctype =</span>
<span class='curline'><a href='../S/6030.html#L1153'>session</a>          1153 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.server_ctype =</span>
<span class='curline'><a href='../S/6030.html#L1155'>session</a>          1155 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.pversion =</span>
<span class='curline'><a href='../S/6030.html#L1157'>session</a>          1157 lib/session_pack.c 	if (session-&gt;internals.resumed_security_parameters.pversion ==</span>
<span class='curline'><a href='../S/6030.html#L1161'>session</a>          1161 lib/session_pack.c 	if (session-&gt;internals.resumed_security_parameters.pversion-&gt;selectable_prf)</span>
<span class='curline'><a href='../S/6030.html#L1162'>session</a>          1162 lib/session_pack.c 		session-&gt;internals.resumed_security_parameters.prf = mac_to_entry(session-&gt;internals.resumed_security_parameters.cs-&gt;prf);</span>
<span class='curline'><a href='../S/6030.html#L1164'>session</a>          1164 lib/session_pack.c 		session-&gt;internals.resumed_security_parameters.prf = mac_to_entry(GNUTLS_MAC_MD5_SHA1);</span>
<span class='curline'><a href='../S/6030.html#L1165'>session</a>          1165 lib/session_pack.c 	if (session-&gt;internals.resumed_security_parameters.prf == NULL)</span>
<span class='curline'><a href='../S/6030.html#L1171'>session</a>          1171 lib/session_pack.c 	memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1177'>session</a>          1177 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.session_id_size =</span>
<span class='curline'><a href='../S/6030.html#L1179'>session</a>          1179 lib/session_pack.c 	memcpy(session-&gt;internals.resumed_security_parameters.session_id,</span>
<span class='curline'><a href='../S/6030.html#L1182'>session</a>          1182 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1184'>session</a>          1184 lib/session_pack.c 	    session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/6030.html#L1187'>session</a>          1187 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.timestamp =</span>
<span class='curline'><a href='../S/6030.html#L1190'>session</a>          1190 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.grp = 0;</span>
<span class='curline'><a href='../S/6030.html#L1192'>session</a>          1192 lib/session_pack.c 	session-&gt;internals.resumed_security_parameters.post_handshake_auth = 0;</span>
<span class='curline'><a href='../S/6030.html#L1194'>session</a>          1194 lib/session_pack.c 	session-&gt;internals.premaster_set = 1;</span>
<span class='curline'><a href='../S/6040.html#L26'>session</a>            26 lib/session_pack.h int _gnutls_session_pack(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6040.html#L28'>session</a>            28 lib/session_pack.h int _gnutls_session_unpack(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5454.html#L700'>session</a>           700 lib/srp.c      const char *gnutls_srp_server_get_username(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5454.html#L706'>session</a>           706 lib/srp.c      	info = _gnutls_get_auth_info(session, GNUTLS_CRD_SRP);</span>
<span class='curline'><a href='../S/5454.html#L794'>session</a>           794 lib/srp.c      void gnutls_srp_set_prime_bits(gnutls_session_t session, unsigned int bits)</span>
<span class='curline'><a href='../S/5454.html#L796'>session</a>           796 lib/srp.c      	session-&gt;internals.dh_prime_bits = bits;</span>
<span class='curline'><a href='../S/5299.html#L46'>session</a>            46 lib/sslv2_compat.c _gnutls_handshake_select_v2_suite(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5299.html#L55'>session</a>            55 lib/sslv2_compat.c 	    ("HSK[%p]: Parsing a version 2.0 client hello.\n", session);</span>
<span class='curline'><a href='../S/5299.html#L77'>session</a>            77 lib/sslv2_compat.c 	ret = _gnutls_server_select_suite(session, _data, _datalen, 0);</span>
<span class='curline'><a href='../S/5299.html#L89'>session</a>            89 lib/sslv2_compat.c _gnutls_read_client_hello_v2(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5299.html#L105'>session</a>           105 lib/sslv2_compat.c 	    ("HSK[%p]: SSL 2.0 Hello: Client's version: %d.%d\n", session,</span>
<span class='curline'><a href='../S/5299.html#L110'>session</a>           110 lib/sslv2_compat.c 	set_adv_version(session, major, minor);</span>
<span class='curline'><a href='../S/5299.html#L112'>session</a>           112 lib/sslv2_compat.c 	ret = _gnutls_negotiate_version(session, major, minor, 0);</span>
<span class='curline'><a href='../S/5299.html#L118'>session</a>           118 lib/sslv2_compat.c 	vers = get_version(session);</span>
<span class='curline'><a href='../S/5299.html#L153'>session</a>           153 lib/sslv2_compat.c 	ret = _gnutls_user_hello_func(session, major, minor);</span>
<span class='curline'><a href='../S/5299.html#L167'>session</a>           167 lib/sslv2_compat.c 	    _gnutls_handshake_select_v2_suite(session, &amp;data[pos],</span>
<span class='curline'><a href='../S/5299.html#L179'>session</a>           179 lib/sslv2_compat.c 	    (session,</span>
<span class='curline'><a href='../S/5299.html#L180'>session</a>           180 lib/sslv2_compat.c 	     session-&gt;security_parameters.cs-&gt;kx_algorithm) == NULL) {</span>
<span class='curline'><a href='../S/5299.html#L189'>session</a>           189 lib/sslv2_compat.c 	session-&gt;internals.auth_struct =</span>
<span class='curline'><a href='../S/5299.html#L190'>session</a>           190 lib/sslv2_compat.c 	    _gnutls_kx_auth_struct(session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5299.html#L192'>session</a>           192 lib/sslv2_compat.c 	if (session-&gt;internals.auth_struct == NULL) {</span>
<span class='curline'><a href='../S/5299.html#L196'>session</a>           196 lib/sslv2_compat.c 		     session);</span>
<span class='curline'><a href='../S/5299.html#L213'>session</a>           213 lib/sslv2_compat.c 	_gnutls_set_client_random(session, rnd);</span>
<span class='curline'><a href='../S/5299.html#L216'>session</a>           216 lib/sslv2_compat.c 	ret = _gnutls_gen_server_random(session, neg_version);</span>
<span class='curline'><a href='../S/5299.html#L220'>session</a>           220 lib/sslv2_compat.c 	session-&gt;security_parameters.timestamp = gnutls_time(NULL);</span>
<span class='curline'><a href='../S/5299.html#L227'>session</a>           227 lib/sslv2_compat.c 	    _gnutls_server_restore_session(session, session_id,</span>
<span class='curline'><a href='../S/5299.html#L232'>session</a>           232 lib/sslv2_compat.c 		memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5299.html#L234'>session</a>           234 lib/sslv2_compat.c 		       session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5299.html#L236'>session</a>           236 lib/sslv2_compat.c 		memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5299.html#L238'>session</a>           238 lib/sslv2_compat.c 		       session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5299.html#L241'>session</a>           241 lib/sslv2_compat.c 		session-&gt;internals.resumed = RESUME_TRUE;</span>
<span class='curline'><a href='../S/5299.html#L245'>session</a>           245 lib/sslv2_compat.c 			session-&gt;security_parameters.session_id,</span>
<span class='curline'><a href='../S/5299.html#L246'>session</a>           246 lib/sslv2_compat.c 			&amp;session-&gt;security_parameters.session_id_size);</span>
<span class='curline'><a href='../S/5299.html#L250'>session</a>           250 lib/sslv2_compat.c 		session-&gt;internals.resumed = RESUME_FALSE;</span>
<span class='curline'><a href='../S/5286.html#L26'>session</a>            26 lib/sslv2_compat.h int _gnutls_read_client_hello_v2(gnutls_session_t session, uint8_t * data,</span>
<span class='curline'><a href='../S/5625.html#L69'>session</a>            69 lib/state.c    _gnutls_rsa_pms_set_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L81'>session</a>            81 lib/state.c    gnutls_cipher_algorithm_t gnutls_cipher_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L87'>session</a>            87 lib/state.c    	    _gnutls_epoch_get(session, EPOCH_READ_CURRENT, &amp;record_params);</span>
<span class='curline'><a href='../S/5625.html#L113'>session</a>           113 lib/state.c    gnutls_certificate_type_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L115'>session</a>           115 lib/state.c    	return gnutls_certificate_type_get2(session, GNUTLS_CTYPE_OURS);</span>
<span class='curline'><a href='../S/5625.html#L146'>session</a>           146 lib/state.c    gnutls_certificate_type_get2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L151'>session</a>           151 lib/state.c    	return get_certificate_type(session, target);</span>
<span class='curline'><a href='../S/5625.html#L168'>session</a>           168 lib/state.c    gnutls_kx_algorithm_t gnutls_kx_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L170'>session</a>           170 lib/state.c    	if (session-&gt;security_parameters.cs == 0)</span>
<span class='curline'><a href='../S/5625.html#L173'>session</a>           173 lib/state.c    	if (session-&gt;security_parameters.cs-&gt;kx_algorithm == 0) { /* TLS 1.3 */</span>
<span class='curline'><a href='../S/5625.html#L174'>session</a>           174 lib/state.c    		const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5625.html#L175'>session</a>           175 lib/state.c    		const gnutls_group_entry_st *group = get_group(session);</span>
<span class='curline'><a href='../S/5625.html#L178'>session</a>           178 lib/state.c    			if (session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED) {</span>
<span class='curline'><a href='../S/5625.html#L196'>session</a>           196 lib/state.c    	return session-&gt;security_parameters.cs-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5625.html#L208'>session</a>           208 lib/state.c    gnutls_mac_algorithm_t gnutls_mac_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L214'>session</a>           214 lib/state.c    	    _gnutls_epoch_get(session, EPOCH_READ_CURRENT, &amp;record_params);</span>
<span class='curline'><a href='../S/5625.html#L231'>session</a>           231 lib/state.c    gnutls_compression_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L251'>session</a>           251 lib/state.c    gnutls_prf_hash_get(const gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L253'>session</a>           253 lib/state.c    	if (session-&gt;security_parameters.prf == NULL)</span>
<span class='curline'><a href='../S/5625.html#L256'>session</a>           256 lib/state.c    	if (session-&gt;security_parameters.prf-&gt;id &gt;= GNUTLS_MAC_AEAD)</span>
<span class='curline'><a href='../S/5625.html#L259'>session</a>           259 lib/state.c    	return (gnutls_digest_algorithm_t)session-&gt;security_parameters.prf-&gt;id;</span>
<span class='curline'><a href='../S/5625.html#L262'>session</a>           262 lib/state.c    void reset_binders(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L264'>session</a>           264 lib/state.c    	_gnutls_free_temp_key_datum(&amp;session-&gt;key.binders[0].psk);</span>
<span class='curline'><a href='../S/5625.html#L265'>session</a>           265 lib/state.c    	_gnutls_free_temp_key_datum(&amp;session-&gt;key.binders[1].psk);</span>
<span class='curline'><a href='../S/5625.html#L266'>session</a>           266 lib/state.c    	memset(session-&gt;key.binders, 0, sizeof(session-&gt;key.binders));</span>
<span class='curline'><a href='../S/5625.html#L272'>session</a>           272 lib/state.c    static bool _gnutls_has_cert_credentials(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L283'>session</a>           283 lib/state.c    			_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5625.html#L315'>session</a>           315 lib/state.c    _gnutls_session_cert_type_supported(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L324'>session</a>           324 lib/state.c    	if (!is_cert_type_enabled(session, cert_type))</span>
<span class='curline'><a href='../S/5625.html#L329'>session</a>           329 lib/state.c    		if (!_gnutls_has_cert_credentials(session, cert_type))</span>
<span class='curline'><a href='../S/5625.html#L341'>session</a>           341 lib/state.c    					&amp;(session-&gt;internals.priorities-&gt;client_ctype);</span>
<span class='curline'><a href='../S/5625.html#L345'>session</a>           345 lib/state.c    					&amp;(session-&gt;internals.priorities-&gt;server_ctype);</span>
<span class='curline'><a href='../S/5625.html#L367'>session</a>           367 lib/state.c    static void deinit_keys(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L369'>session</a>           369 lib/state.c    	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5625.html#L374'>session</a>           374 lib/state.c    	gnutls_pk_params_release(&amp;session-&gt;key.kshare.ecdhx_params);</span>
<span class='curline'><a href='../S/5625.html#L375'>session</a>           375 lib/state.c    	gnutls_pk_params_release(&amp;session-&gt;key.kshare.ecdh_params);</span>
<span class='curline'><a href='../S/5625.html#L376'>session</a>           376 lib/state.c    	gnutls_pk_params_release(&amp;session-&gt;key.kshare.dh_params);</span>
<span class='curline'><a href='../S/5625.html#L378'>session</a>           378 lib/state.c    	if (!vers-&gt;tls13_sem &amp;&amp; session-&gt;key.binders[0].prf == NULL) {</span>
<span class='curline'><a href='../S/5625.html#L379'>session</a>           379 lib/state.c    		gnutls_pk_params_release(&amp;session-&gt;key.proto.tls12.ecdh.params);</span>
<span class='curline'><a href='../S/5625.html#L380'>session</a>           380 lib/state.c    		gnutls_pk_params_release(&amp;session-&gt;key.proto.tls12.dh.params);</span>
<span class='curline'><a href='../S/5625.html#L381'>session</a>           381 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.ecdh.x);</span>
<span class='curline'><a href='../S/5625.html#L382'>session</a>           382 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.ecdh.y);</span>
<span class='curline'><a href='../S/5625.html#L383'>session</a>           383 lib/state.c    		_gnutls_free_temp_key_datum(&amp;session-&gt;key.proto.tls12.ecdh.raw);</span>
<span class='curline'><a href='../S/5625.html#L385'>session</a>           385 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.dh.client_Y);</span>
<span class='curline'><a href='../S/5625.html#L388'>session</a>           388 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.srp_p);</span>
<span class='curline'><a href='../S/5625.html#L389'>session</a>           389 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.srp_g);</span>
<span class='curline'><a href='../S/5625.html#L390'>session</a>           390 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.srp_key);</span>
<span class='curline'><a href='../S/5625.html#L392'>session</a>           392 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.u);</span>
<span class='curline'><a href='../S/5625.html#L393'>session</a>           393 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.a);</span>
<span class='curline'><a href='../S/5625.html#L394'>session</a>           394 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.x);</span>
<span class='curline'><a href='../S/5625.html#L395'>session</a>           395 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.A);</span>
<span class='curline'><a href='../S/5625.html#L396'>session</a>           396 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.B);</span>
<span class='curline'><a href='../S/5625.html#L397'>session</a>           397 lib/state.c    		zrelease_temp_mpi_key(&amp;session-&gt;key.proto.tls12.srp.b);</span>
<span class='curline'><a href='../S/5625.html#L399'>session</a>           399 lib/state.c    		gnutls_memset(session-&gt;key.proto.tls13.temp_secret, 0,</span>
<span class='curline'><a href='../S/5625.html#L400'>session</a>           400 lib/state.c    			      sizeof(session-&gt;key.proto.tls13.temp_secret));</span>
<span class='curline'><a href='../S/5625.html#L403'>session</a>           403 lib/state.c    	reset_binders(session);</span>
<span class='curline'><a href='../S/5625.html#L404'>session</a>           404 lib/state.c    	_gnutls_free_temp_key_datum(&amp;session-&gt;key.key);</span>
<span class='curline'><a href='../S/5625.html#L409'>session</a>           409 lib/state.c    static void handshake_internal_state_clear1(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L412'>session</a>           412 lib/state.c    	session-&gt;internals.adv_version_major = 0;</span>
<span class='curline'><a href='../S/5625.html#L413'>session</a>           413 lib/state.c    	session-&gt;internals.adv_version_minor = 0;</span>
<span class='curline'><a href='../S/5625.html#L414'>session</a>           414 lib/state.c    	session-&gt;internals.direction = 0;</span>
<span class='curline'><a href='../S/5625.html#L419'>session</a>           419 lib/state.c    	session-&gt;internals.last_handshake_in = -1;</span>
<span class='curline'><a href='../S/5625.html#L420'>session</a>           420 lib/state.c    	session-&gt;internals.last_handshake_out = -1;</span>
<span class='curline'><a href='../S/5625.html#L422'>session</a>           422 lib/state.c    	session-&gt;internals.resumable = RESUME_TRUE;</span>
<span class='curline'><a href='../S/5625.html#L424'>session</a>           424 lib/state.c    	session-&gt;internals.handshake_suspicious_loops = 0;</span>
<span class='curline'><a href='../S/5625.html#L425'>session</a>           425 lib/state.c    	session-&gt;internals.dtls.hsk_read_seq = 0;</span>
<span class='curline'><a href='../S/5625.html#L426'>session</a>           426 lib/state.c    	session-&gt;internals.dtls.hsk_write_seq = 0;</span>
<span class='curline'><a href='../S/5625.html#L428'>session</a>           428 lib/state.c    	session-&gt;internals.cand_ec_group = 0;</span>
<span class='curline'><a href='../S/5625.html#L429'>session</a>           429 lib/state.c    	session-&gt;internals.cand_dh_group = 0;</span>
<span class='curline'><a href='../S/5625.html#L431'>session</a>           431 lib/state.c    	session-&gt;internals.hrr_cs[0] = CS_INVALID_MAJOR;</span>
<span class='curline'><a href='../S/5625.html#L432'>session</a>           432 lib/state.c    	session-&gt;internals.hrr_cs[1] = CS_INVALID_MINOR;</span>
<span class='curline'><a href='../S/5625.html#L439'>session</a>           439 lib/state.c    void _gnutls_handshake_internal_state_clear(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L441'>session</a>           441 lib/state.c    	handshake_internal_state_clear1(session);</span>
<span class='curline'><a href='../S/5625.html#L443'>session</a>           443 lib/state.c    	_gnutls_handshake_hash_buffers_clear(session);</span>
<span class='curline'><a href='../S/5625.html#L444'>session</a>           444 lib/state.c    	deinit_keys(session);</span>
<span class='curline'><a href='../S/5625.html#L446'>session</a>           446 lib/state.c    	_gnutls_epoch_gc(session);</span>
<span class='curline'><a href='../S/5625.html#L448'>session</a>           448 lib/state.c    	session-&gt;internals.handshake_abs_timeout.tv_sec = 0;</span>
<span class='curline'><a href='../S/5625.html#L449'>session</a>           449 lib/state.c    	session-&gt;internals.handshake_abs_timeout.tv_nsec = 0;</span>
<span class='curline'><a href='../S/5625.html#L450'>session</a>           450 lib/state.c    	session-&gt;internals.handshake_in_progress = 0;</span>
<span class='curline'><a href='../S/5625.html#L452'>session</a>           452 lib/state.c    	session-&gt;internals.tfo.connect_addrlen = 0;</span>
<span class='curline'><a href='../S/5625.html#L453'>session</a>           453 lib/state.c    	session-&gt;internals.tfo.connect_only = 0;</span>
<span class='curline'><a href='../S/5625.html#L454'>session</a>           454 lib/state.c    	session-&gt;internals.early_data_received = 0;</span>
<span class='curline'><a href='../S/5625.html#L475'>session</a>           475 lib/state.c    int gnutls_init(gnutls_session_t * session, unsigned int flags)</span>
<span class='curline'><a href='../S/5625.html#L481'>session</a>           481 lib/state.c    	*session = gnutls_calloc(1, sizeof(struct gnutls_session_int));</span>
<span class='curline'><a href='../S/5625.html#L482'>session</a>           482 lib/state.c    	if (*session == NULL)</span>
<span class='curline'><a href='../S/5625.html#L485'>session</a>           485 lib/state.c    	ret = gnutls_mutex_init(&amp;(*session)-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5625.html#L488'>session</a>           488 lib/state.c    		gnutls_free(*session);</span>
<span class='curline'><a href='../S/5625.html#L492'>session</a>           492 lib/state.c    	ret = gnutls_mutex_init(&amp;(*session)-&gt;internals.epoch_lock);</span>
<span class='curline'><a href='../S/5625.html#L495'>session</a>           495 lib/state.c    		gnutls_mutex_deinit(&amp;(*session)-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5625.html#L496'>session</a>           496 lib/state.c    		gnutls_free(*session);</span>
<span class='curline'><a href='../S/5625.html#L500'>session</a>           500 lib/state.c    	ret = _gnutls_epoch_setup_next(*session, 1, NULL);</span>
<span class='curline'><a href='../S/5625.html#L502'>session</a>           502 lib/state.c    		gnutls_mutex_deinit(&amp;(*session)-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5625.html#L503'>session</a>           503 lib/state.c    		gnutls_mutex_deinit(&amp;(*session)-&gt;internals.epoch_lock);</span>
<span class='curline'><a href='../S/5625.html#L504'>session</a>           504 lib/state.c    		gnutls_free(*session);</span>
<span class='curline'><a href='../S/5625.html#L507'>session</a>           507 lib/state.c    	_gnutls_epoch_bump(*session);</span>
<span class='curline'><a href='../S/5625.html#L509'>session</a>           509 lib/state.c    	(*session)-&gt;security_parameters.entity =</span>
<span class='curline'><a href='../S/5625.html#L513'>session</a>           513 lib/state.c    	(*session)-&gt;security_parameters.client_ctype = DEFAULT_CERT_TYPE;</span>
<span class='curline'><a href='../S/5625.html#L514'>session</a>           514 lib/state.c    	(*session)-&gt;security_parameters.server_ctype = DEFAULT_CERT_TYPE;</span>
<span class='curline'><a href='../S/5625.html#L517'>session</a>           517 lib/state.c    	_gnutls_buffer_init(&amp;(*session)-&gt;internals.handshake_hash_buffer);</span>
<span class='curline'><a href='../S/5625.html#L518'>session</a>           518 lib/state.c    	_gnutls_buffer_init(&amp;(*session)-&gt;internals.post_handshake_hash_buffer);</span>
<span class='curline'><a href='../S/5625.html#L519'>session</a>           519 lib/state.c    	_gnutls_buffer_init(&amp;(*session)-&gt;internals.hb_remote_data);</span>
<span class='curline'><a href='../S/5625.html#L520'>session</a>           520 lib/state.c    	_gnutls_buffer_init(&amp;(*session)-&gt;internals.hb_local_data);</span>
<span class='curline'><a href='../S/5625.html#L521'>session</a>           521 lib/state.c    	_gnutls_buffer_init(&amp;(*session)-&gt;internals.record_presend_buffer);</span>
<span class='curline'><a href='../S/5625.html#L522'>session</a>           522 lib/state.c    	_gnutls_buffer_init(&amp;(*session)-&gt;internals.record_key_update_buffer);</span>
<span class='curline'><a href='../S/5625.html#L523'>session</a>           523 lib/state.c    	_gnutls_buffer_init(&amp;(*session)-&gt;internals.reauth_buffer);</span>
<span class='curline'><a href='../S/5625.html#L525'>session</a>           525 lib/state.c    	_mbuffer_head_init(&amp;(*session)-&gt;internals.record_buffer);</span>
<span class='curline'><a href='../S/5625.html#L526'>session</a>           526 lib/state.c    	_mbuffer_head_init(&amp;(*session)-&gt;internals.record_send_buffer);</span>
<span class='curline'><a href='../S/5625.html#L527'>session</a>           527 lib/state.c    	_mbuffer_head_init(&amp;(*session)-&gt;internals.record_recv_buffer);</span>
<span class='curline'><a href='../S/5625.html#L528'>session</a>           528 lib/state.c    	_mbuffer_head_init(&amp;(*session)-&gt;internals.early_data_recv_buffer);</span>
<span class='curline'><a href='../S/5625.html#L529'>session</a>           529 lib/state.c    	_gnutls_buffer_init(&amp;(*session)-&gt;internals.early_data_presend_buffer);</span>
<span class='curline'><a href='../S/5625.html#L531'>session</a>           531 lib/state.c    	_mbuffer_head_init(&amp;(*session)-&gt;internals.handshake_send_buffer);</span>
<span class='curline'><a href='../S/5625.html#L532'>session</a>           532 lib/state.c    	_gnutls_handshake_recv_buffer_init(*session);</span>
<span class='curline'><a href='../S/5625.html#L534'>session</a>           534 lib/state.c    	(*session)-&gt;internals.expire_time = DEFAULT_EXPIRE_TIME;</span>
<span class='curline'><a href='../S/5625.html#L537'>session</a>           537 lib/state.c    	(*session)-&gt;key.totp.last_result = 0;</span>
<span class='curline'><a href='../S/5625.html#L539'>session</a>           539 lib/state.c    	gnutls_handshake_set_max_packet_length((*session),</span>
<span class='curline'><a href='../S/5625.html#L544'>session</a>           544 lib/state.c    	(*session)-&gt;internals.transport_recv_ptr =</span>
<span class='curline'><a href='../S/5625.html#L546'>session</a>           546 lib/state.c    	(*session)-&gt;internals.transport_send_ptr =</span>
<span class='curline'><a href='../S/5625.html#L551'>session</a>           551 lib/state.c    	(*session)-&gt;security_parameters.max_record_recv_size =</span>
<span class='curline'><a href='../S/5625.html#L553'>session</a>           553 lib/state.c    	(*session)-&gt;security_parameters.max_record_send_size =</span>
<span class='curline'><a href='../S/5625.html#L555'>session</a>           555 lib/state.c    	(*session)-&gt;security_parameters.max_user_record_recv_size =</span>
<span class='curline'><a href='../S/5625.html#L557'>session</a>           557 lib/state.c    	(*session)-&gt;security_parameters.max_user_record_send_size =</span>
<span class='curline'><a href='../S/5625.html#L562'>session</a>           562 lib/state.c    	if ((*session)-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5625.html#L563'>session</a>           563 lib/state.c    		(*session)-&gt;security_parameters.max_early_data_size =</span>
<span class='curline'><a href='../S/5625.html#L566'>session</a>           566 lib/state.c    		(*session)-&gt;security_parameters.max_early_data_size =</span>
<span class='curline'><a href='../S/5625.html#L579'>session</a>           579 lib/state.c    			VALGRIND_MAKE_MEM_UNDEFINED((*session)-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5625.html#L582'>session</a>           582 lib/state.c    			VALGRIND_MAKE_MEM_UNDEFINED((*session)-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5625.html#L584'>session</a>           584 lib/state.c    			VALGRIND_MAKE_MEM_UNDEFINED((*session)-&gt;key.session_ticket_key,</span>
<span class='curline'><a href='../S/5625.html#L589'>session</a>           589 lib/state.c    	handshake_internal_state_clear1(*session);</span>
<span class='curline'><a href='../S/5625.html#L594'>session</a>           594 lib/state.c    		gnutls_transport_set_vec_push_function(*session, system_writev_nosignal);</span>
<span class='curline'><a href='../S/5625.html#L597'>session</a>           597 lib/state.c    		gnutls_transport_set_vec_push_function(*session, system_writev);</span>
<span class='curline'><a href='../S/5625.html#L599'>session</a>           599 lib/state.c    	gnutls_transport_set_push_function(*session, system_write);</span>
<span class='curline'><a href='../S/5625.html#L601'>session</a>           601 lib/state.c    	(*session)-&gt;internals.pull_timeout_func = gnutls_system_recv_timeout;</span>
<span class='curline'><a href='../S/5625.html#L602'>session</a>           602 lib/state.c    	(*session)-&gt;internals.pull_func = system_read;</span>
<span class='curline'><a href='../S/5625.html#L603'>session</a>           603 lib/state.c    	(*session)-&gt;internals.errno_func = system_errno;</span>
<span class='curline'><a href='../S/5625.html#L605'>session</a>           605 lib/state.c    	(*session)-&gt;internals.saved_username_size = -1;</span>
<span class='curline'><a href='../S/5625.html#L608'>session</a>           608 lib/state.c    	(*session)-&gt;internals.hb_retrans_timeout_ms = 1000;</span>
<span class='curline'><a href='../S/5625.html#L609'>session</a>           609 lib/state.c    	(*session)-&gt;internals.hb_total_timeout_ms = 60000;</span>
<span class='curline'><a href='../S/5625.html#L612'>session</a>           612 lib/state.c    		(*session)-&gt;internals.dtls.mtu = DTLS_DEFAULT_MTU;</span>
<span class='curline'><a href='../S/5625.html#L613'>session</a>           613 lib/state.c    		(*session)-&gt;internals.transport = GNUTLS_DGRAM;</span>
<span class='curline'><a href='../S/5625.html#L615'>session</a>           615 lib/state.c    		gnutls_dtls_set_timeouts(*session, DTLS_RETRANS_TIMEOUT, 60000);</span>
<span class='curline'><a href='../S/5625.html#L617'>session</a>           617 lib/state.c    		(*session)-&gt;internals.transport = GNUTLS_STREAM;</span>
<span class='curline'><a href='../S/5625.html#L623'>session</a>           623 lib/state.c    		gnutls_ocsp_status_request_enable_client(*session, NULL, 0,</span>
<span class='curline'><a href='../S/5625.html#L632'>session</a>           632 lib/state.c    	(*session)-&gt;internals.flags = flags;</span>
<span class='curline'><a href='../S/5625.html#L635'>session</a>           635 lib/state.c    		(*session)-&gt;internals.flags |= INT_FLAG_NO_TLS13;</span>
<span class='curline'><a href='../S/5625.html#L638'>session</a>           638 lib/state.c    	gnutls_session_set_keylog_function(*session, _gnutls_nss_keylog_func);</span>
<span class='curline'><a href='../S/5625.html#L645'>session</a>           645 lib/state.c    int _gnutls_session_is_resumable(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L647'>session</a>           647 lib/state.c    	return session-&gt;internals.resumable;</span>
<span class='curline'><a href='../S/5625.html#L659'>session</a>           659 lib/state.c    void gnutls_deinit(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L663'>session</a>           663 lib/state.c    	if (session == NULL)</span>
<span class='curline'><a href='../S/5625.html#L667'>session</a>           667 lib/state.c    	_gnutls_free_auth_info(session);</span>
<span class='curline'><a href='../S/5625.html#L669'>session</a>           669 lib/state.c    	_gnutls_handshake_internal_state_clear(session);</span>
<span class='curline'><a href='../S/5625.html#L670'>session</a>           670 lib/state.c    	_gnutls_handshake_io_buffer_clear(session);</span>
<span class='curline'><a href='../S/5625.html#L671'>session</a>           671 lib/state.c    	_gnutls_hello_ext_priv_deinit(session);</span>
<span class='curline'><a href='../S/5625.html#L674'>session</a>           674 lib/state.c    		if (session-&gt;record_parameters[i] != NULL) {</span>
<span class='curline'><a href='../S/5625.html#L675'>session</a>           675 lib/state.c    			_gnutls_epoch_free(session,</span>
<span class='curline'><a href='../S/5625.html#L676'>session</a>           676 lib/state.c    					   session-&gt;record_parameters[i]);</span>
<span class='curline'><a href='../S/5625.html#L677'>session</a>           677 lib/state.c    			session-&gt;record_parameters[i] = NULL;</span>
<span class='curline'><a href='../S/5625.html#L680'>session</a>           680 lib/state.c    	_gnutls_buffer_clear(&amp;session-&gt;internals.handshake_hash_buffer);</span>
<span class='curline'><a href='../S/5625.html#L681'>session</a>           681 lib/state.c    	_gnutls_buffer_clear(&amp;session-&gt;internals.post_handshake_hash_buffer);</span>
<span class='curline'><a href='../S/5625.html#L682'>session</a>           682 lib/state.c    	_gnutls_buffer_clear(&amp;session-&gt;internals.hb_remote_data);</span>
<span class='curline'><a href='../S/5625.html#L683'>session</a>           683 lib/state.c    	_gnutls_buffer_clear(&amp;session-&gt;internals.hb_local_data);</span>
<span class='curline'><a href='../S/5625.html#L684'>session</a>           684 lib/state.c    	_gnutls_buffer_clear(&amp;session-&gt;internals.record_presend_buffer);</span>
<span class='curline'><a href='../S/5625.html#L685'>session</a>           685 lib/state.c    	_gnutls_buffer_clear(&amp;session-&gt;internals.record_key_update_buffer);</span>
<span class='curline'><a href='../S/5625.html#L686'>session</a>           686 lib/state.c    	_gnutls_buffer_clear(&amp;session-&gt;internals.reauth_buffer);</span>
<span class='curline'><a href='../S/5625.html#L688'>session</a>           688 lib/state.c    	_mbuffer_head_clear(&amp;session-&gt;internals.record_buffer);</span>
<span class='curline'><a href='../S/5625.html#L689'>session</a>           689 lib/state.c    	_mbuffer_head_clear(&amp;session-&gt;internals.record_recv_buffer);</span>
<span class='curline'><a href='../S/5625.html#L690'>session</a>           690 lib/state.c    	_mbuffer_head_clear(&amp;session-&gt;internals.record_send_buffer);</span>
<span class='curline'><a href='../S/5625.html#L692'>session</a>           692 lib/state.c    	_mbuffer_head_clear(&amp;session-&gt;internals.early_data_recv_buffer);</span>
<span class='curline'><a href='../S/5625.html#L693'>session</a>           693 lib/state.c    	_gnutls_buffer_clear(&amp;session-&gt;internals.early_data_presend_buffer);</span>
<span class='curline'><a href='../S/5625.html#L695'>session</a>           695 lib/state.c    	_gnutls_free_datum(&amp;session-&gt;internals.resumption_data);</span>
<span class='curline'><a href='../S/5625.html#L696'>session</a>           696 lib/state.c    	_gnutls_free_datum(&amp;session-&gt;internals.dtls.dcookie);</span>
<span class='curline'><a href='../S/5625.html#L698'>session</a>           698 lib/state.c    	for (i = 0; i &lt; session-&gt;internals.rexts_size; i++)</span>
<span class='curline'><a href='../S/5625.html#L699'>session</a>           699 lib/state.c    		gnutls_free(session-&gt;internals.rexts[i].name);</span>
<span class='curline'><a href='../S/5625.html#L700'>session</a>           700 lib/state.c    	gnutls_free(session-&gt;internals.rexts);</span>
<span class='curline'><a href='../S/5625.html#L701'>session</a>           701 lib/state.c    	gnutls_free(session-&gt;internals.post_handshake_cr_context.data);</span>
<span class='curline'><a href='../S/5625.html#L703'>session</a>           703 lib/state.c    	gnutls_free(session-&gt;internals.rsup);</span>
<span class='curline'><a href='../S/5625.html#L705'>session</a>           705 lib/state.c    	gnutls_credentials_clear(session);</span>
<span class='curline'><a href='../S/5625.html#L706'>session</a>           706 lib/state.c    	_gnutls_selected_certs_deinit(session);</span>
<span class='curline'><a href='../S/5625.html#L709'>session</a>           709 lib/state.c    	_gnutls13_session_ticket_unset(session);</span>
<span class='curline'><a href='../S/5625.html#L712'>session</a>           712 lib/state.c    	gnutls_priority_deinit(session-&gt;internals.priorities);</span>
<span class='curline'><a href='../S/5625.html#L715'>session</a>           715 lib/state.c    	gnutls_memset(&amp;session-&gt;key.proto, 0, sizeof(session-&gt;key.proto));</span>
<span class='curline'><a href='../S/5625.html#L718'>session</a>           718 lib/state.c    	gnutls_memset(&amp;session-&gt;key.session_ticket_key, 0,</span>
<span class='curline'><a href='../S/5625.html#L720'>session</a>           720 lib/state.c    	gnutls_memset(&amp;session-&gt;key.previous_ticket_key, 0,</span>
<span class='curline'><a href='../S/5625.html#L722'>session</a>           722 lib/state.c    	gnutls_memset(&amp;session-&gt;key.initial_stek, 0,</span>
<span class='curline'><a href='../S/5625.html#L725'>session</a>           725 lib/state.c    	gnutls_mutex_deinit(&amp;session-&gt;internals.post_negotiation_lock);</span>
<span class='curline'><a href='../S/5625.html#L726'>session</a>           726 lib/state.c    	gnutls_mutex_deinit(&amp;session-&gt;internals.epoch_lock);</span>
<span class='curline'><a href='../S/5625.html#L728'>session</a>           728 lib/state.c    	gnutls_free(session);</span>
<span class='curline'><a href='../S/5625.html#L731'>session</a>           731 lib/state.c    int _gnutls_dh_set_peer_public(gnutls_session_t session, bigint_t public)</span>
<span class='curline'><a href='../S/5625.html#L736'>session</a>           736 lib/state.c    	switch (gnutls_auth_get_type(session)) {</span>
<span class='curline'><a href='../S/5625.html#L740'>session</a>           740 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5625.html#L750'>session</a>           750 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5625.html#L761'>session</a>           761 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5625.html#L784'>session</a>           784 lib/state.c    int _gnutls_dh_set_secret_bits(gnutls_session_t session, unsigned bits)</span>
<span class='curline'><a href='../S/5625.html#L786'>session</a>           786 lib/state.c    	switch (gnutls_auth_get_type(session)) {</span>
<span class='curline'><a href='../S/5625.html#L790'>session</a>           790 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5625.html#L799'>session</a>           799 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5625.html#L809'>session</a>           809 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5625.html#L826'>session</a>           826 lib/state.c    _gnutls_dh_save_group(gnutls_session_t session, bigint_t gen,</span>
<span class='curline'><a href='../S/5625.html#L832'>session</a>           832 lib/state.c    	switch (gnutls_auth_get_type(session)) {</span>
<span class='curline'><a href='../S/5625.html#L836'>session</a>           836 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_ANON);</span>
<span class='curline'><a href='../S/5625.html#L846'>session</a>           846 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_PSK);</span>
<span class='curline'><a href='../S/5625.html#L857'>session</a>           857 lib/state.c    			info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5625.html#L909'>session</a>           909 lib/state.c    gnutls_certificate_send_x509_rdn_sequence(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L912'>session</a>           912 lib/state.c    	session-&gt;internals.ignore_rdn_sequence = status;</span>
<span class='curline'><a href='../S/5625.html#L926'>session</a>           926 lib/state.c    _gnutls_record_set_default_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L930'>session</a>           930 lib/state.c    	session-&gt;internals.default_record_version[0] = major;</span>
<span class='curline'><a href='../S/5625.html#L931'>session</a>           931 lib/state.c    	session-&gt;internals.default_record_version[1] = minor;</span>
<span class='curline'><a href='../S/5625.html#L945'>session</a>           945 lib/state.c    _gnutls_hello_set_default_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L949'>session</a>           949 lib/state.c    	session-&gt;internals.default_hello_version[0] = major;</span>
<span class='curline'><a href='../S/5625.html#L950'>session</a>           950 lib/state.c    	session-&gt;internals.default_hello_version[1] = minor;</span>
<span class='curline'><a href='../S/5625.html#L969'>session</a>           969 lib/state.c    gnutls_handshake_set_private_extensions(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L987'>session</a>           987 lib/state.c    int gnutls_session_is_resumed(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L989'>session</a>           989 lib/state.c    	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5625.html#L990'>session</a>           990 lib/state.c    		const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5625.html#L992'>session</a>           992 lib/state.c    		    session-&gt;internals.resumed != RESUME_FALSE)</span>
<span class='curline'><a href='../S/5625.html#L995'>session</a>           995 lib/state.c    		if (session-&gt;security_parameters.session_id_size &gt; 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5625.html#L996'>session</a>           996 lib/state.c    		    session-&gt;security_parameters.session_id_size ==</span>
<span class='curline'><a href='../S/5625.html#L997'>session</a>           997 lib/state.c    		    session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5625.html#L999'>session</a>           999 lib/state.c    		    &amp;&amp; memcmp(session-&gt;security_parameters.session_id,</span>
<span class='curline'><a href='../S/5625.html#L1000'>session</a>          1000 lib/state.c    			      session-&gt;</span>
<span class='curline'><a href='../S/5625.html#L1003'>session</a>          1003 lib/state.c    			      session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5625.html#L1007'>session</a>          1007 lib/state.c    		if (session-&gt;internals.resumed != RESUME_FALSE)</span>
<span class='curline'><a href='../S/5625.html#L1023'>session</a>          1023 lib/state.c    int gnutls_session_resumption_requested(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1025'>session</a>          1025 lib/state.c    	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5625.html#L1028'>session</a>          1028 lib/state.c    		return session-&gt;internals.resumption_requested;</span>
<span class='curline'><a href='../S/5625.html#L1039'>session</a>          1039 lib/state.c    int _gnutls_session_is_psk(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1043'>session</a>          1043 lib/state.c    	kx = session-&gt;security_parameters.cs-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5625.html#L1058'>session</a>          1058 lib/state.c    int _gnutls_session_is_ecc(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1065'>session</a>          1065 lib/state.c    	kx = session-&gt;security_parameters.cs-&gt;kx_algorithm;</span>
<span class='curline'><a href='../S/5625.html#L1080'>session</a>          1080 lib/state.c    void *gnutls_session_get_ptr(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1082'>session</a>          1082 lib/state.c    	return session-&gt;internals.user_ptr;</span>
<span class='curline'><a href='../S/5625.html#L1094'>session</a>          1094 lib/state.c    void gnutls_session_set_ptr(gnutls_session_t session, void *ptr)</span>
<span class='curline'><a href='../S/5625.html#L1096'>session</a>          1096 lib/state.c    	session-&gt;internals.user_ptr = ptr;</span>
<span class='curline'><a href='../S/5625.html#L1125'>session</a>          1125 lib/state.c        (gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1128'>session</a>          1128 lib/state.c    	session-&gt;internals.verify_callback = func;</span>
<span class='curline'><a href='../S/5625.html#L1150'>session</a>          1150 lib/state.c    int gnutls_record_get_direction(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1152'>session</a>          1152 lib/state.c    	return session-&gt;internals.direction;</span>
<span class='curline'><a href='../S/5625.html#L1166'>session</a>          1166 lib/state.c    _gnutls_rsa_pms_set_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1169'>session</a>          1169 lib/state.c    	session-&gt;internals.rsa_pms_version[0] = major;</span>
<span class='curline'><a href='../S/5625.html#L1170'>session</a>          1170 lib/state.c    	session-&gt;internals.rsa_pms_version[1] = minor;</span>
<span class='curline'><a href='../S/5625.html#L1173'>session</a>          1173 lib/state.c    void _gnutls_session_client_cert_type_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1177'>session</a>          1177 lib/state.c    	    ("HSK[%p]: Selected client certificate type %s (%d)\n", session,</span>
<span class='curline'><a href='../S/5625.html#L1179'>session</a>          1179 lib/state.c    	session-&gt;security_parameters.client_ctype = ct;</span>
<span class='curline'><a href='../S/5625.html#L1182'>session</a>          1182 lib/state.c    void _gnutls_session_server_cert_type_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1186'>session</a>          1186 lib/state.c    	    ("HSK[%p]: Selected server certificate type %s (%d)\n", session,</span>
<span class='curline'><a href='../S/5625.html#L1188'>session</a>          1188 lib/state.c    	session-&gt;security_parameters.server_ctype = ct;</span>
<span class='curline'><a href='../S/5625.html#L1218'>session</a>          1218 lib/state.c    gnutls_handshake_set_post_client_hello_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1221'>session</a>          1221 lib/state.c    	session-&gt;internals.user_hello_func = func;</span>
<span class='curline'><a href='../S/5625.html#L1242'>session</a>          1242 lib/state.c    void gnutls_session_enable_compatibility_mode(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1244'>session</a>          1244 lib/state.c    	ENABLE_COMPAT(&amp;session-&gt;internals);</span>
<span class='curline'><a href='../S/5625.html#L1264'>session</a>          1264 lib/state.c    gnutls_session_channel_binding(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1271'>session</a>          1271 lib/state.c    	if (!session-&gt;internals.initial_negotiation_completed)</span>
<span class='curline'><a href='../S/5625.html#L1274'>session</a>          1274 lib/state.c    	cb-&gt;size = session-&gt;internals.cb_tls_unique_len;</span>
<span class='curline'><a href='../S/5625.html#L1279'>session</a>          1279 lib/state.c    	memcpy(cb-&gt;data, session-&gt;internals.cb_tls_unique, cb-&gt;size);</span>
<span class='curline'><a href='../S/5625.html#L1296'>session</a>          1296 lib/state.c    gnutls_ecc_curve_t gnutls_ecc_curve_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1300'>session</a>          1300 lib/state.c    	e = get_group(session);</span>
<span class='curline'><a href='../S/5625.html#L1318'>session</a>          1318 lib/state.c    gnutls_group_t gnutls_group_get(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1322'>session</a>          1322 lib/state.c    	e = get_group(session);</span>
<span class='curline'><a href='../S/5625.html#L1336'>session</a>          1336 lib/state.c    gnutls_protocol_t gnutls_protocol_get_version(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1338'>session</a>          1338 lib/state.c    	return get_num_version(session);</span>
<span class='curline'><a href='../S/5625.html#L1357'>session</a>          1357 lib/state.c    gnutls_session_get_random(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1361'>session</a>          1361 lib/state.c    		client-&gt;data = session-&gt;security_parameters.client_random;</span>
<span class='curline'><a href='../S/5625.html#L1363'>session</a>          1363 lib/state.c    		    sizeof(session-&gt;security_parameters.client_random);</span>
<span class='curline'><a href='../S/5625.html#L1367'>session</a>          1367 lib/state.c    		server-&gt;data = session-&gt;security_parameters.server_random;</span>
<span class='curline'><a href='../S/5625.html#L1369'>session</a>          1369 lib/state.c    		    sizeof(session-&gt;security_parameters.server_random);</span>
<span class='curline'><a href='../S/5625.html#L1386'>session</a>          1386 lib/state.c    gnutls_session_get_master_secret(gnutls_session_t session, gnutls_datum_t *secret)</span>
<span class='curline'><a href='../S/5625.html#L1388'>session</a>          1388 lib/state.c    	secret-&gt;data = session-&gt;security_parameters.master_secret;</span>
<span class='curline'><a href='../S/5625.html#L1389'>session</a>          1389 lib/state.c    	secret-&gt;size = sizeof(session-&gt;security_parameters.master_secret);</span>
<span class='curline'><a href='../S/5625.html#L1423'>session</a>          1423 lib/state.c    gnutls_handshake_set_random(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1429'>session</a>          1429 lib/state.c    	session-&gt;internals.sc_random_set = 1;</span>
<span class='curline'><a href='../S/5625.html#L1430'>session</a>          1430 lib/state.c    	if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5625.html#L1431'>session</a>          1431 lib/state.c    		memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5625.html#L1434'>session</a>          1434 lib/state.c    		memcpy(session-&gt;internals.resumed_security_parameters.</span>
<span class='curline'><a href='../S/5625.html#L1466'>session</a>          1466 lib/state.c    gnutls_handshake_set_hook_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1471'>session</a>          1471 lib/state.c    	session-&gt;internals.h_hook = func;</span>
<span class='curline'><a href='../S/5625.html#L1472'>session</a>          1472 lib/state.c    	session-&gt;internals.h_type = htype;</span>
<span class='curline'><a href='../S/5625.html#L1473'>session</a>          1473 lib/state.c    	session-&gt;internals.h_post = when;</span>
<span class='curline'><a href='../S/5625.html#L1497'>session</a>          1497 lib/state.c    gnutls_record_get_state(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1514'>session</a>          1514 lib/state.c    	ret = _gnutls_epoch_get(session, epoch, &amp;record_params);</span>
<span class='curline'><a href='../S/5625.html#L1561'>session</a>          1561 lib/state.c    gnutls_record_set_state(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5625.html#L1574'>session</a>          1574 lib/state.c    	ret = _gnutls_epoch_get(session, epoch, &amp;record_params);</span>
<span class='curline'><a href='../S/5625.html#L1588'>session</a>          1588 lib/state.c    	if (IS_DTLS(session)) {</span>
<span class='curline'><a href='../S/5625.html#L1610'>session</a>          1610 lib/state.c    unsigned gnutls_session_get_flags(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5625.html#L1614'>session</a>          1614 lib/state.c    	if (gnutls_safe_renegotiation_status(session))</span>
<span class='curline'><a href='../S/5625.html#L1616'>session</a>          1616 lib/state.c    	if (gnutls_session_ext_master_secret_status(session))</span>
<span class='curline'><a href='../S/5625.html#L1618'>session</a>          1618 lib/state.c    	if (gnutls_session_etm_status(session))</span>
<span class='curline'><a href='../S/5625.html#L1620'>session</a>          1620 lib/state.c    	if (gnutls_heartbeat_allowed(session, GNUTLS_HB_LOCAL_ALLOWED_TO_SEND))</span>
<span class='curline'><a href='../S/5625.html#L1622'>session</a>          1622 lib/state.c    	if (gnutls_heartbeat_allowed(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND))</span>
<span class='curline'><a href='../S/5625.html#L1624'>session</a>          1624 lib/state.c    	if (session-&gt;internals.hsk_flags &amp; HSK_FALSE_START_USED)</span>
<span class='curline'><a href='../S/5625.html#L1626'>session</a>          1626 lib/state.c    	if ((session-&gt;internals.hsk_flags &amp; HSK_EARLY_START_USED) &amp;&amp;</span>
<span class='curline'><a href='../S/5625.html#L1627'>session</a>          1627 lib/state.c    	    (session-&gt;internals.flags &amp; GNUTLS_ENABLE_EARLY_START))</span>
<span class='curline'><a href='../S/5625.html#L1629'>session</a>          1629 lib/state.c    	if (session-&gt;internals.hsk_flags &amp; HSK_USED_FFDHE)</span>
<span class='curline'><a href='../S/5625.html#L1631'>session</a>          1631 lib/state.c    	if (session-&gt;internals.hsk_flags &amp; HSK_TICKET_RECEIVED)</span>
<span class='curline'><a href='../S/5625.html#L1633'>session</a>          1633 lib/state.c    	if (session-&gt;security_parameters.post_handshake_auth)</span>
<span class='curline'><a href='../S/5625.html#L1635'>session</a>          1635 lib/state.c    	if (session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_ACCEPTED)</span>
<span class='curline'><a href='../S/5625.html#L1637'>session</a>          1637 lib/state.c    	if (session-&gt;internals.hsk_flags &amp; HSK_OCSP_REQUESTED)</span>
<span class='curline'><a href='../S/5625.html#L1639'>session</a>          1639 lib/state.c    	if (session-&gt;internals.hsk_flags &amp; HSK_CLIENT_OCSP_REQUESTED)</span>
<span class='curline'><a href='../S/5748.html#L28'>session</a>            28 lib/state.h    void _gnutls_session_client_cert_type_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5748.html#L30'>session</a>            30 lib/state.h    void _gnutls_session_server_cert_type_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5748.html#L34'>session</a>            34 lib/state.h    get_group(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5748.html#L36'>session</a>            36 lib/state.h    	return session-&gt;security_parameters.grp;</span>
<span class='curline'><a href='../S/5748.html#L39'>session</a>            39 lib/state.h    int _gnutls_session_is_ecc(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5748.html#L42'>session</a>            42 lib/state.h    _gnutls_session_group_set(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5748.html#L46'>session</a>            46 lib/state.h    			      session, e-&gt;name, e-&gt;id);</span>
<span class='curline'><a href='../S/5748.html#L47'>session</a>            47 lib/state.h    	session-&gt;security_parameters.grp = e;</span>
<span class='curline'><a href='../S/5748.html#L51'>session</a>            51 lib/state.h    void set_default_version(gnutls_session_t session, const version_entry_st *ver)</span>
<span class='curline'><a href='../S/5748.html#L54'>session</a>            54 lib/state.h    		session-&gt;internals.default_record_version[0] = 3;</span>
<span class='curline'><a href='../S/5748.html#L55'>session</a>            55 lib/state.h    		session-&gt;internals.default_record_version[1] = 1;</span>
<span class='curline'><a href='../S/5748.html#L57'>session</a>            57 lib/state.h    		session-&gt;internals.default_record_version[0] = ver-&gt;major;</span>
<span class='curline'><a href='../S/5748.html#L58'>session</a>            58 lib/state.h    		session-&gt;internals.default_record_version[1] = ver-&gt;minor;</span>
<span class='curline'><a href='../S/5748.html#L63'>session</a>            63 lib/state.h    _gnutls_record_set_default_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5748.html#L68'>session</a>            68 lib/state.h    _gnutls_hello_set_default_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5748.html#L74'>session</a>            74 lib/state.h    #define CHECK_AUTH_TYPE(auth, ret) if (gnutls_auth_get_type(session) != auth) { \</span>
<span class='curline'><a href='../S/5748.html#L80'>session</a>            80 lib/state.h    int _gnutls_session_cert_type_supported(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5748.html#L84'>session</a>            84 lib/state.h    int _gnutls_dh_set_secret_bits(gnutls_session_t session, unsigned bits);</span>
<span class='curline'><a href='../S/5748.html#L86'>session</a>            86 lib/state.h    int _gnutls_dh_set_peer_public(gnutls_session_t session, bigint_t public);</span>
<span class='curline'><a href='../S/5748.html#L87'>session</a>            87 lib/state.h    int _gnutls_dh_save_group(gnutls_session_t session, bigint_t gen,</span>
<span class='curline'><a href='../S/5748.html#L90'>session</a>            90 lib/state.h    static inline int _gnutls_dh_get_min_prime_bits(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5748.html#L92'>session</a>            92 lib/state.h    	if (session-&gt;internals.dh_prime_bits != 0)</span>
<span class='curline'><a href='../S/5748.html#L93'>session</a>            93 lib/state.h    		return session-&gt;internals.dh_prime_bits;</span>
<span class='curline'><a href='../S/5748.html#L96'>session</a>            96 lib/state.h    						   session-&gt;internals.</span>
<span class='curline'><a href='../S/5748.html#L102'>session</a>           102 lib/state.h    int _gnutls_session_is_resumable(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5748.html#L104'>session</a>           104 lib/state.h    int _gnutls_session_is_psk(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5748.html#L106'>session</a>           106 lib/state.h    int _gnutls_openpgp_send_fingerprint(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5748.html#L108'>session</a>           108 lib/state.h    void reset_binders(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5748.html#L111'>session</a>           111 lib/state.h    _gnutls_PRF(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5748.html#L116'>session</a>           116 lib/state.h    	return _gnutls_prf_raw(session-&gt;security_parameters.prf-&gt;id,</span>
<span class='curline'><a href='../S/5638.html#L32'>session</a>            32 lib/stek.c     static int totp_sha3(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5638.html#L66'>session</a>            66 lib/stek.c     static uint64_t T(gnutls_session_t session, time_t t)</span>
<span class='curline'><a href='../S/5638.html#L69'>session</a>            69 lib/stek.c     	unsigned int x = session-&gt;internals.expire_time * STEK_ROTATION_PERIOD_PRODUCT;</span>
<span class='curline'><a href='../S/5638.html#L77'>session</a>            77 lib/stek.c     static int64_t totp_next(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5638.html#L86'>session</a>            86 lib/stek.c     	result = T(session, t);</span>
<span class='curline'><a href='../S/5638.html#L90'>session</a>            90 lib/stek.c     	if (result == session-&gt;key.totp.last_result)</span>
<span class='curline'><a href='../S/5638.html#L96'>session</a>            96 lib/stek.c     static int64_t totp_previous(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5638.html#L100'>session</a>           100 lib/stek.c     	if (session-&gt;key.totp.last_result == 0)</span>
<span class='curline'><a href='../S/5638.html#L102'>session</a>           102 lib/stek.c     	if (!session-&gt;key.totp.was_rotated)</span>
<span class='curline'><a href='../S/5638.html#L105'>session</a>           105 lib/stek.c     	result = session-&gt;key.totp.last_result - 1;</span>
<span class='curline'><a href='../S/5638.html#L112'>session</a>           112 lib/stek.c     static void call_rotation_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5638.html#L117'>session</a>           117 lib/stek.c     	if (session-&gt;key.totp.cb) {</span>
<span class='curline'><a href='../S/5638.html#L120'>session</a>           120 lib/stek.c     		prev_key.data = session-&gt;key.session_ticket_key;</span>
<span class='curline'><a href='../S/5638.html#L123'>session</a>           123 lib/stek.c     		session-&gt;key.totp.cb(&amp;prev_key, &amp;new_key, t);</span>
<span class='curline'><a href='../S/5638.html#L127'>session</a>           127 lib/stek.c     static int rotate(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5638.html#L134'>session</a>           134 lib/stek.c     	t = totp_next(session);</span>
<span class='curline'><a href='../S/5638.html#L136'>session</a>           136 lib/stek.c     		secret.data = session-&gt;key.initial_stek;</span>
<span class='curline'><a href='../S/5638.html#L140'>session</a>           140 lib/stek.c     		if (totp_sha3(session, t, &amp;secret, key) &lt; 0) {</span>
<span class='curline'><a href='../S/5638.html#L146'>session</a>           146 lib/stek.c     		call_rotation_callback(session, key, t);</span>
<span class='curline'><a href='../S/5638.html#L147'>session</a>           147 lib/stek.c     		session-&gt;key.totp.last_result = t;</span>
<span class='curline'><a href='../S/5638.html#L148'>session</a>           148 lib/stek.c     		memcpy(session-&gt;key.session_ticket_key, key, sizeof(key));</span>
<span class='curline'><a href='../S/5638.html#L151'>session</a>           151 lib/stek.c     			VALGRIND_MAKE_MEM_DEFINED(session-&gt;key.session_ticket_key,</span>
<span class='curline'><a href='../S/5638.html#L155'>session</a>           155 lib/stek.c     		session-&gt;key.totp.was_rotated = 1;</span>
<span class='curline'><a href='../S/5638.html#L163'>session</a>           163 lib/stek.c     static int rotate_back_and_peek(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5638.html#L170'>session</a>           170 lib/stek.c     	t = totp_previous(session);</span>
<span class='curline'><a href='../S/5638.html#L174'>session</a>           174 lib/stek.c     	secret.data = session-&gt;key.initial_stek;</span>
<span class='curline'><a href='../S/5638.html#L177'>session</a>           177 lib/stek.c     	if (totp_sha3(session, t, &amp;secret, key) &lt; 0)</span>
<span class='curline'><a href='../S/5638.html#L204'>session</a>           204 lib/stek.c     int _gnutls_get_session_ticket_encryption_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5638.html#L211'>session</a>           211 lib/stek.c     	if (unlikely(session == NULL)) {</span>
<span class='curline'><a href='../S/5638.html#L216'>session</a>           216 lib/stek.c     	if ((retval = rotate(session)) &lt; 0)</span>
<span class='curline'><a href='../S/5638.html#L221'>session</a>           221 lib/stek.c     		key_name-&gt;data = &amp;session-&gt;key.session_ticket_key[NAME_POS];</span>
<span class='curline'><a href='../S/5638.html#L225'>session</a>           225 lib/stek.c     		mac_key-&gt;data = &amp;session-&gt;key.session_ticket_key[MAC_SECRET_POS];</span>
<span class='curline'><a href='../S/5638.html#L229'>session</a>           229 lib/stek.c     		enc_key-&gt;data = &amp;session-&gt;key.session_ticket_key[KEY_POS];</span>
<span class='curline'><a href='../S/5638.html#L253'>session</a>           253 lib/stek.c     int _gnutls_get_session_ticket_decryption_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5638.html#L261'>session</a>           261 lib/stek.c     		.data = session-&gt;key.session_ticket_key,</span>
<span class='curline'><a href='../S/5638.html#L265'>session</a>           265 lib/stek.c     	if (unlikely(session == NULL || ticket_data == NULL || ticket_data-&gt;data == NULL))</span>
<span class='curline'><a href='../S/5638.html#L271'>session</a>           271 lib/stek.c     	if ((retval = rotate(session)) &lt; 0)</span>
<span class='curline'><a href='../S/5638.html#L284'>session</a>           284 lib/stek.c     	key.data = session-&gt;key.previous_ticket_key;</span>
<span class='curline'><a href='../S/5638.html#L290'>session</a>           290 lib/stek.c     	if ((retval = rotate_back_and_peek(session, key.data)) &lt; 0)</span>
<span class='curline'><a href='../S/5638.html#L329'>session</a>           329 lib/stek.c     int _gnutls_initialize_session_ticket_key_rotation(gnutls_session_t session, const gnutls_datum_t *key)</span>
<span class='curline'><a href='../S/5638.html#L331'>session</a>           331 lib/stek.c     	if (unlikely(session == NULL || key == NULL))</span>
<span class='curline'><a href='../S/5638.html#L334'>session</a>           334 lib/stek.c     	if (unlikely(session-&gt;key.totp.last_result != 0))</span>
<span class='curline'><a href='../S/5638.html#L337'>session</a>           337 lib/stek.c     	memcpy(session-&gt;key.initial_stek, key-&gt;data, key-&gt;size);</span>
<span class='curline'><a href='../S/5638.html#L339'>session</a>           339 lib/stek.c     	session-&gt;key.totp.was_rotated = 0;</span>
<span class='curline'><a href='../S/5638.html#L354'>session</a>           354 lib/stek.c     void _gnutls_set_session_ticket_key_rotation_callback(gnutls_session_t session, gnutls_stek_rotation_callback_t cb)</span>
<span class='curline'><a href='../S/5638.html#L356'>session</a>           356 lib/stek.c     	if (session)</span>
<span class='curline'><a href='../S/5638.html#L357'>session</a>           357 lib/stek.c     		session-&gt;key.totp.cb = cb;</span>
<span class='curline'><a href='../S/5644.html#L28'>session</a>            28 lib/stek.h     int _gnutls_get_session_ticket_encryption_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5644.html#L32'>session</a>            32 lib/stek.h     int _gnutls_get_session_ticket_decryption_key(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5644.html#L38'>session</a>            38 lib/stek.h     void _gnutls_set_session_ticket_key_rotation_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5644.html#L41'>session</a>            41 lib/stek.h     int _gnutls_initialize_session_ticket_key_rotation(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5301.html#L100'>session</a>           100 lib/supplemental.c get_supp_func_recv(gnutls_session_t session, gnutls_supplemental_data_format_type_t type)</span>
<span class='curline'><a href='../S/5301.html#L104'>session</a>           104 lib/supplemental.c 	for (i = 0; i &lt; session-&gt;internals.rsup_size; i++) {</span>
<span class='curline'><a href='../S/5301.html#L105'>session</a>           105 lib/supplemental.c 		if (session-&gt;internals.rsup[i].type == type)</span>
<span class='curline'><a href='../S/5301.html#L106'>session</a>           106 lib/supplemental.c 			return session-&gt;internals.rsup[i].supp_recv_func;</span>
<span class='curline'><a href='../S/5301.html#L117'>session</a>           117 lib/supplemental.c static int gen_supplemental(gnutls_session_t session, const gnutls_supplemental_entry_st *supp,</span>
<span class='curline'><a href='../S/5301.html#L131'>session</a>           131 lib/supplemental.c 	ret = supp_send(session, buf);</span>
<span class='curline'><a href='../S/5301.html#L152'>session</a>           152 lib/supplemental.c _gnutls_gen_supplemental(gnutls_session_t session, gnutls_buffer_st * buf)</span>
<span class='curline'><a href='../S/5301.html#L165'>session</a>           165 lib/supplemental.c 	for (i = 0; i &lt; session-&gt;internals.rsup_size; i++) {</span>
<span class='curline'><a href='../S/5301.html#L166'>session</a>           166 lib/supplemental.c 		ret = gen_supplemental(session, &amp;session-&gt;internals.rsup[i], buf);</span>
<span class='curline'><a href='../S/5301.html#L172'>session</a>           172 lib/supplemental.c 		ret = gen_supplemental(session, &amp;suppfunc[i], buf);</span>
<span class='curline'><a href='../S/5301.html#L184'>session</a>           184 lib/supplemental.c 	    ("EXT[%p]: Sending %d bytes of supplemental data\n", session,</span>
<span class='curline'><a href='../S/5301.html#L191'>session</a>           191 lib/supplemental.c _gnutls_parse_supplemental(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5301.html#L222'>session</a>           222 lib/supplemental.c 		     session, supp_data_type, supp_data_length);</span>
<span class='curline'><a href='../S/5301.html#L224'>session</a>           224 lib/supplemental.c 		recv_func = get_supp_func_recv(session, supp_data_type);</span>
<span class='curline'><a href='../S/5301.html#L226'>session</a>           226 lib/supplemental.c 			int ret = recv_func(session, p, supp_data_length);</span>
<span class='curline'><a href='../S/5301.html#L339'>session</a>           339 lib/supplemental.c gnutls_session_supplemental_register(gnutls_session_t session, const char *name,</span>
<span class='curline'><a href='../S/5301.html#L359'>session</a>           359 lib/supplemental.c 	p = gnutls_realloc(session-&gt;internals.rsup,</span>
<span class='curline'><a href='../S/5301.html#L360'>session</a>           360 lib/supplemental.c 			   sizeof(gnutls_supplemental_entry_st)*(session-&gt;internals.rsup_size + 1));</span>
<span class='curline'><a href='../S/5301.html#L364'>session</a>           364 lib/supplemental.c 	session-&gt;internals.rsup = p;</span>
<span class='curline'><a href='../S/5301.html#L366'>session</a>           366 lib/supplemental.c 	memcpy(&amp;session-&gt;internals.rsup[session-&gt;internals.rsup_size], &amp;tmp_entry, sizeof(tmp_entry));</span>
<span class='curline'><a href='../S/5301.html#L367'>session</a>           367 lib/supplemental.c 	session-&gt;internals.rsup_size++;</span>
<span class='curline'><a href='../S/5301.html#L369'>session</a>           369 lib/supplemental.c 	session-&gt;internals.flags |= INT_FLAG_NO_TLS13;</span>
<span class='curline'><a href='../S/5301.html#L386'>session</a>           386 lib/supplemental.c gnutls_supplemental_recv(gnutls_session_t session, unsigned do_recv_supplemental)</span>
<span class='curline'><a href='../S/5301.html#L388'>session</a>           388 lib/supplemental.c 	session-&gt;security_parameters.do_recv_supplemental = do_recv_supplemental;</span>
<span class='curline'><a href='../S/5301.html#L402'>session</a>           402 lib/supplemental.c gnutls_supplemental_send(gnutls_session_t session, unsigned do_send_supplemental)</span>
<span class='curline'><a href='../S/5301.html#L404'>session</a>           404 lib/supplemental.c 	session-&gt;security_parameters.do_send_supplemental = do_send_supplemental;</span>
<span class='curline'><a href='../S/5751.html#L28'>session</a>            28 lib/supplemental.h int _gnutls_parse_supplemental(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5751.html#L30'>session</a>            30 lib/supplemental.h int _gnutls_gen_supplemental(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5817.html#L214'>session</a>           214 lib/system/fastopen.c gnutls_transport_set_fastopen(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5817.html#L218'>session</a>           218 lib/system/fastopen.c 	if (connect_addrlen &gt; (socklen_t)sizeof(session-&gt;internals.tfo.connect_addr)) {</span>
<span class='curline'><a href='../S/5817.html#L223'>session</a>           223 lib/system/fastopen.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5817.html#L228'>session</a>           228 lib/system/fastopen.c 	memcpy(&amp;session-&gt;internals.tfo.connect_addr, connect_addr, connect_addrlen);</span>
<span class='curline'><a href='../S/5817.html#L229'>session</a>           229 lib/system/fastopen.c 	session-&gt;internals.tfo.connect_addrlen = connect_addrlen;</span>
<span class='curline'><a href='../S/5817.html#L230'>session</a>           230 lib/system/fastopen.c 	session-&gt;internals.tfo.fd = fd;</span>
<span class='curline'><a href='../S/5817.html#L232'>session</a>           232 lib/system/fastopen.c 	gnutls_transport_set_pull_function(session, tfo_read);</span>
<span class='curline'><a href='../S/5817.html#L233'>session</a>           233 lib/system/fastopen.c 	gnutls_transport_set_pull_timeout_function(session, tfo_recv_timeout);</span>
<span class='curline'><a href='../S/5817.html#L234'>session</a>           234 lib/system/fastopen.c 	gnutls_transport_set_ptr(session, &amp;session-&gt;internals.tfo);</span>
<span class='curline'><a href='../S/5817.html#L236'>session</a>           236 lib/system/fastopen.c 	session-&gt;internals.tfo.flags = 0;</span>
<span class='curline'><a href='../S/5817.html#L238'>session</a>           238 lib/system/fastopen.c 	if (session-&gt;internals.flags &amp; GNUTLS_NO_SIGNAL)</span>
<span class='curline'><a href='../S/5817.html#L239'>session</a>           239 lib/system/fastopen.c 		session-&gt;internals.tfo.flags |= MSG_NOSIGNAL;</span>
<span class='curline'><a href='../S/5817.html#L243'>session</a>           243 lib/system/fastopen.c 	gnutls_transport_set_vec_push_function(session, NULL);</span>
<span class='curline'><a href='../S/5817.html#L244'>session</a>           244 lib/system/fastopen.c 	gnutls_transport_set_push_function(session, tfo_send);</span>
<span class='curline'><a href='../S/5817.html#L246'>session</a>           246 lib/system/fastopen.c 	gnutls_transport_set_vec_push_function(session, tfo_writev);</span>
<span class='curline'><a href='../S/5813.html#L62'>session</a>            62 lib/system_override.c void gnutls_transport_set_errno(gnutls_session_t session, int err)</span>
<span class='curline'><a href='../S/5813.html#L64'>session</a>            64 lib/system_override.c 	session-&gt;internals.errnum = err;</span>
<span class='curline'><a href='../S/5813.html#L82'>session</a>            82 lib/system_override.c gnutls_transport_set_pull_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5813.html#L85'>session</a>            85 lib/system_override.c 	session-&gt;internals.pull_func = pull_func;</span>
<span class='curline'><a href='../S/5813.html#L123'>session</a>           123 lib/system_override.c gnutls_transport_set_pull_timeout_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5813.html#L126'>session</a>           126 lib/system_override.c 	session-&gt;internals.pull_timeout_func = func;</span>
<span class='curline'><a href='../S/5813.html#L147'>session</a>           147 lib/system_override.c gnutls_transport_set_push_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5813.html#L150'>session</a>           150 lib/system_override.c 	session-&gt;internals.push_func = push_func;</span>
<span class='curline'><a href='../S/5813.html#L151'>session</a>           151 lib/system_override.c 	session-&gt;internals.vec_push_func = NULL;</span>
<span class='curline'><a href='../S/5813.html#L170'>session</a>           170 lib/system_override.c gnutls_transport_set_vec_push_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5813.html#L173'>session</a>           173 lib/system_override.c 	session-&gt;internals.push_func = NULL;</span>
<span class='curline'><a href='../S/5813.html#L174'>session</a>           174 lib/system_override.c 	session-&gt;internals.vec_push_func = vec_func;</span>
<span class='curline'><a href='../S/5813.html#L192'>session</a>           192 lib/system_override.c gnutls_transport_set_errno_function(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5813.html#L195'>session</a>           195 lib/system_override.c 	session-&gt;internals.errno_func = errno_func;</span>
<span class='curline'><a href='../S/5632.html#L43'>session</a>            43 lib/tls-sig.c  int _gnutls_check_key_usage_for_sig(gnutls_session_t session, unsigned key_usage, unsigned our_cert)</span>
<span class='curline'><a href='../S/5632.html#L50'>session</a>            50 lib/tls-sig.c  		allow_key_usage_violation = session-&gt;internals.priorities-&gt;allow_server_key_usage_violation;</span>
<span class='curline'><a href='../S/5632.html#L53'>session</a>            53 lib/tls-sig.c  		allow_key_usage_violation = session-&gt;internals.allow_key_usage_violation;</span>
<span class='curline'><a href='../S/5632.html#L60'>session</a>            60 lib/tls-sig.c  				_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5632.html#L64'>session</a>            64 lib/tls-sig.c  				_gnutls_audit_log(session,</span>
<span class='curline'><a href='../S/5632.html#L76'>session</a>            76 lib/tls-sig.c  _gnutls_handshake_sign_data12(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L86'>session</a>            86 lib/tls-sig.c  	    ("HSK[%p]: signing TLS 1.2 handshake data: using %s\n", session,</span>
<span class='curline'><a href='../S/5632.html#L97'>session</a>            97 lib/tls-sig.c  	memcpy(dconcat.data, session-&gt;security_parameters.client_random, GNUTLS_RANDOM_SIZE);</span>
<span class='curline'><a href='../S/5632.html#L98'>session</a>            98 lib/tls-sig.c  	memcpy(dconcat.data+GNUTLS_RANDOM_SIZE, session-&gt;security_parameters.server_random, GNUTLS_RANDOM_SIZE);</span>
<span class='curline'><a href='../S/5632.html#L113'>session</a>           113 lib/tls-sig.c  _gnutls_handshake_sign_data10(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L143'>session</a>           143 lib/tls-sig.c  	    ("HSK[%p]: signing handshake data: using %s\n", session,</span>
<span class='curline'><a href='../S/5632.html#L152'>session</a>           152 lib/tls-sig.c  	_gnutls_hash(&amp;td_sha, session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5632.html#L154'>session</a>           154 lib/tls-sig.c  	_gnutls_hash(&amp;td_sha, session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5632.html#L176'>session</a>           176 lib/tls-sig.c  _gnutls_handshake_sign_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L182'>session</a>           182 lib/tls-sig.c  	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5632.html#L186'>session</a>           186 lib/tls-sig.c  	*sign_algo = session-&gt;security_parameters.server_sign_algo;</span>
<span class='curline'><a href='../S/5632.html#L194'>session</a>           194 lib/tls-sig.c  	ret = _gnutls_check_key_usage_for_sig(session, key_usage, 1);</span>
<span class='curline'><a href='../S/5632.html#L199'>session</a>           199 lib/tls-sig.c  		return _gnutls_handshake_sign_data12(session, cert, pkey, params, signature, *sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L201'>session</a>           201 lib/tls-sig.c  		return _gnutls_handshake_sign_data10(session, cert, pkey, params, signature, *sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L208'>session</a>           208 lib/tls-sig.c  _gnutls_handshake_verify_data10(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L242'>session</a>           242 lib/tls-sig.c  	_gnutls_hash(&amp;td_sha, session-&gt;security_parameters.client_random,</span>
<span class='curline'><a href='../S/5632.html#L244'>session</a>           244 lib/tls-sig.c  	_gnutls_hash(&amp;td_sha, session-&gt;security_parameters.server_random,</span>
<span class='curline'><a href='../S/5632.html#L263'>session</a>           263 lib/tls-sig.c  _gnutls_handshake_verify_data12(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L272'>session</a>           272 lib/tls-sig.c  	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5632.html#L276'>session</a>           276 lib/tls-sig.c  	    ("HSK[%p]: verify TLS 1.2 handshake data: using %s\n", session,</span>
<span class='curline'><a href='../S/5632.html#L280'>session</a>           280 lib/tls-sig.c  	    _gnutls_pubkey_compatible_with_sig(session,</span>
<span class='curline'><a href='../S/5632.html#L288'>session</a>           288 lib/tls-sig.c  				      session, gnutls_pk_get_name(cert-&gt;pubkey-&gt;params.algo), se-&gt;name);</span>
<span class='curline'><a href='../S/5632.html#L293'>session</a>           293 lib/tls-sig.c  	    _gnutls_session_sign_algo_enabled(session, sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L302'>session</a>           302 lib/tls-sig.c  	memcpy(dconcat.data, session-&gt;security_parameters.client_random, GNUTLS_RANDOM_SIZE);</span>
<span class='curline'><a href='../S/5632.html#L303'>session</a>           303 lib/tls-sig.c  	memcpy(dconcat.data+GNUTLS_RANDOM_SIZE, session-&gt;security_parameters.server_random, GNUTLS_RANDOM_SIZE);</span>
<span class='curline'><a href='../S/5632.html#L320'>session</a>           320 lib/tls-sig.c  _gnutls_handshake_verify_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L329'>session</a>           329 lib/tls-sig.c  	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5632.html#L338'>session</a>           338 lib/tls-sig.c  	ret = _gnutls_check_key_usage_for_sig(session, key_usage, 0);</span>
<span class='curline'><a href='../S/5632.html#L342'>session</a>           342 lib/tls-sig.c  	gnutls_sign_algorithm_set_server(session, sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L345'>session</a>           345 lib/tls-sig.c  		return _gnutls_handshake_verify_data12(session, verify_flags, cert, params, signature, sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L347'>session</a>           347 lib/tls-sig.c  		return _gnutls_handshake_verify_data10(session, verify_flags, cert, params, signature, sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L385'>session</a>           385 lib/tls-sig.c  _gnutls_handshake_verify_crt_vrfy12(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L396'>session</a>           396 lib/tls-sig.c  	ret = _gnutls_session_sign_algo_enabled(session, sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L402'>session</a>           402 lib/tls-sig.c  				      session, gnutls_pk_get_name(cert-&gt;pubkey-&gt;params.algo), se-&gt;name);</span>
<span class='curline'><a href='../S/5632.html#L412'>session</a>           412 lib/tls-sig.c  	dconcat.data = session-&gt;internals.handshake_hash_buffer.data;</span>
<span class='curline'><a href='../S/5632.html#L413'>session</a>           413 lib/tls-sig.c  	dconcat.size = session-&gt;internals.handshake_hash_buffer_prev_len;</span>
<span class='curline'><a href='../S/5632.html#L434'>session</a>           434 lib/tls-sig.c  _gnutls_handshake_verify_crt_vrfy3(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L447'>session</a>           447 lib/tls-sig.c  	ret = _gnutls_generate_master(session, 1);</span>
<span class='curline'><a href='../S/5632.html#L464'>session</a>           464 lib/tls-sig.c  				session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5632.html#L465'>session</a>           465 lib/tls-sig.c  				session-&gt;internals.handshake_hash_buffer_prev_len);</span>
<span class='curline'><a href='../S/5632.html#L468'>session</a>           468 lib/tls-sig.c  						session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5632.html#L485'>session</a>           485 lib/tls-sig.c  		     session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5632.html#L486'>session</a>           486 lib/tls-sig.c  		     session-&gt;internals.handshake_hash_buffer_prev_len);</span>
<span class='curline'><a href='../S/5632.html#L491'>session</a>           491 lib/tls-sig.c  					      session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5632.html#L511'>session</a>           511 lib/tls-sig.c  _gnutls_handshake_verify_crt_vrfy10(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L541'>session</a>           541 lib/tls-sig.c  		     session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5632.html#L542'>session</a>           542 lib/tls-sig.c  		     session-&gt;internals.handshake_hash_buffer_prev_len);</span>
<span class='curline'><a href='../S/5632.html#L562'>session</a>           562 lib/tls-sig.c  _gnutls_handshake_verify_crt_vrfy(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L569'>session</a>           569 lib/tls-sig.c  	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5632.html#L579'>session</a>           579 lib/tls-sig.c  	ret = _gnutls_check_key_usage_for_sig(session, key_usage, 0);</span>
<span class='curline'><a href='../S/5632.html#L584'>session</a>           584 lib/tls-sig.c  			      session,</span>
<span class='curline'><a href='../S/5632.html#L590'>session</a>           590 lib/tls-sig.c  	gnutls_sign_algorithm_set_client(session, sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L594'>session</a>           594 lib/tls-sig.c  		return _gnutls_handshake_verify_crt_vrfy12(session, </span>
<span class='curline'><a href='../S/5632.html#L601'>session</a>           601 lib/tls-sig.c  		return _gnutls_handshake_verify_crt_vrfy3(session,</span>
<span class='curline'><a href='../S/5632.html#L609'>session</a>           609 lib/tls-sig.c  	return _gnutls_handshake_verify_crt_vrfy10(session,</span>
<span class='curline'><a href='../S/5632.html#L620'>session</a>           620 lib/tls-sig.c  _gnutls_handshake_sign_crt_vrfy12(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L630'>session</a>           630 lib/tls-sig.c  	sign_algo = _gnutls_session_get_sign_algo(session, cert, pkey, 1, GNUTLS_KX_UNKNOWN);</span>
<span class='curline'><a href='../S/5632.html#L640'>session</a>           640 lib/tls-sig.c  	gnutls_sign_algorithm_set_client(session, sign_algo);</span>
<span class='curline'><a href='../S/5632.html#L648'>session</a>           648 lib/tls-sig.c  	dconcat.data = session-&gt;internals.handshake_hash_buffer.data;</span>
<span class='curline'><a href='../S/5632.html#L649'>session</a>           649 lib/tls-sig.c  	dconcat.size = session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5632.html#L666'>session</a>           666 lib/tls-sig.c  _gnutls_handshake_sign_crt_vrfy3(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L681'>session</a>           681 lib/tls-sig.c  	    _gnutls_pubkey_compatible_with_sig(session, cert-&gt;pubkey, ver,</span>
<span class='curline'><a href='../S/5632.html#L686'>session</a>           686 lib/tls-sig.c  	ret = _gnutls_generate_master(session, 1);</span>
<span class='curline'><a href='../S/5632.html#L704'>session</a>           704 lib/tls-sig.c  			     session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5632.html#L705'>session</a>           705 lib/tls-sig.c  			     session-&gt;internals.handshake_hash_buffer.</span>
<span class='curline'><a href='../S/5632.html#L710'>session</a>           710 lib/tls-sig.c  							session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5632.html#L726'>session</a>           726 lib/tls-sig.c  		     session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5632.html#L727'>session</a>           727 lib/tls-sig.c  		     session-&gt;internals.handshake_hash_buffer.length);</span>
<span class='curline'><a href='../S/5632.html#L731'>session</a>           731 lib/tls-sig.c  				session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5632.html#L750'>session</a>           750 lib/tls-sig.c  _gnutls_handshake_sign_crt_vrfy10(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L766'>session</a>           766 lib/tls-sig.c  	    _gnutls_pubkey_compatible_with_sig(session, cert-&gt;pubkey, ver,</span>
<span class='curline'><a href='../S/5632.html#L783'>session</a>           783 lib/tls-sig.c  		     session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5632.html#L784'>session</a>           784 lib/tls-sig.c  		     session-&gt;internals.handshake_hash_buffer.length);</span>
<span class='curline'><a href='../S/5632.html#L812'>session</a>           812 lib/tls-sig.c  _gnutls_handshake_sign_crt_vrfy(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5632.html#L818'>session</a>           818 lib/tls-sig.c  	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5632.html#L826'>session</a>           826 lib/tls-sig.c  	ret = _gnutls_check_key_usage_for_sig(session, key_usage, 1);</span>
<span class='curline'><a href='../S/5632.html#L832'>session</a>           832 lib/tls-sig.c  		return _gnutls_handshake_sign_crt_vrfy12(session, cert,</span>
<span class='curline'><a href='../S/5632.html#L838'>session</a>           838 lib/tls-sig.c  		return _gnutls_handshake_sign_crt_vrfy3(session, cert, ver,</span>
<span class='curline'><a href='../S/5632.html#L842'>session</a>           842 lib/tls-sig.c  	return _gnutls_handshake_sign_crt_vrfy10(session, cert, ver,</span>
<span class='curline'><a href='../S/5291.html#L35'>session</a>            35 lib/tls-sig.h  int _gnutls_check_key_usage_for_sig(gnutls_session_t session, unsigned key_usage,</span>
<span class='curline'><a href='../S/5291.html#L38'>session</a>            38 lib/tls-sig.h  int _gnutls_handshake_sign_crt_vrfy(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5291.html#L43'>session</a>            43 lib/tls-sig.h  int _gnutls_handshake_sign_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5291.html#L50'>session</a>            50 lib/tls-sig.h  int _gnutls_handshake_verify_crt_vrfy(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5291.html#L56'>session</a>            56 lib/tls-sig.h  int _gnutls_handshake_verify_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5747.html#L41'>session</a>            41 lib/tls13-sig.c _gnutls13_handshake_verify_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5747.html#L49'>session</a>            49 lib/tls13-sig.c 	const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5747.html#L56'>session</a>            56 lib/tls13-sig.c 	    ("HSK[%p]: verifying TLS 1.3 handshake data using %s\n", session,</span>
<span class='curline'><a href='../S/5747.html#L60'>session</a>            60 lib/tls13-sig.c 	    _gnutls_pubkey_compatible_with_sig(session,</span>
<span class='curline'><a href='../S/5747.html#L68'>session</a>            68 lib/tls13-sig.c 				      session, gnutls_pk_get_name(cert-&gt;pubkey-&gt;params.algo), se-&gt;name);</span>
<span class='curline'><a href='../S/5747.html#L73'>session</a>            73 lib/tls13-sig.c 	    _gnutls_session_sign_algo_enabled(session, se-&gt;id);</span>
<span class='curline'><a href='../S/5747.html#L82'>session</a>            82 lib/tls13-sig.c 	ret = _gnutls_check_key_usage_for_sig(session, key_usage, 0);</span>
<span class='curline'><a href='../S/5747.html#L107'>session</a>           107 lib/tls13-sig.c 	ret = gnutls_hash_fast(MAC_TO_DIG(session-&gt;security_parameters.prf-&gt;id),</span>
<span class='curline'><a href='../S/5747.html#L108'>session</a>           108 lib/tls13-sig.c 			       session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5747.html#L109'>session</a>           109 lib/tls13-sig.c 			       session-&gt;internals.handshake_hash_buffer_prev_len,</span>
<span class='curline'><a href='../S/5747.html#L116'>session</a>           116 lib/tls13-sig.c 	ret = _gnutls_buffer_append_data(&amp;buf, prefix, session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5747.html#L144'>session</a>           144 lib/tls13-sig.c _gnutls13_handshake_sign_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5747.html#L163'>session</a>           163 lib/tls13-sig.c 	    ("HSK[%p]: signing TLS 1.3 handshake data: using %s and PRF: %s\n", session, se-&gt;name,</span>
<span class='curline'><a href='../S/5747.html#L164'>session</a>           164 lib/tls13-sig.c 	     session-&gt;security_parameters.prf-&gt;name);</span>
<span class='curline'><a href='../S/5747.html#L189'>session</a>           189 lib/tls13-sig.c 	ret = gnutls_hash_fast(MAC_TO_DIG(session-&gt;security_parameters.prf-&gt;id),</span>
<span class='curline'><a href='../S/5747.html#L190'>session</a>           190 lib/tls13-sig.c 			       session-&gt;internals.handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5747.html#L191'>session</a>           191 lib/tls13-sig.c 			       session-&gt;internals.handshake_hash_buffer.length,</span>
<span class='curline'><a href='../S/5747.html#L198'>session</a>           198 lib/tls13-sig.c 	ret = _gnutls_buffer_append_data(&amp;buf, tmp, session-&gt;security_parameters.prf-&gt;output_size);</span>
<span class='curline'><a href='../S/5982.html#L29'>session</a>            29 lib/tls13-sig.h _gnutls13_handshake_verify_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5982.html#L37'>session</a>            37 lib/tls13-sig.h _gnutls13_handshake_sign_data(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5767.html#L114'>session</a>           114 lib/tls13/anti_replay.c gnutls_anti_replay_enable(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5767.html#L117'>session</a>           117 lib/tls13/anti_replay.c 	if (unlikely(session-&gt;security_parameters.entity != GNUTLS_SERVER)) {</span>
<span class='curline'><a href='../S/5767.html#L122'>session</a>           122 lib/tls13/anti_replay.c 	session-&gt;internals.anti_replay = anti_replay;</span>
<span class='curline'><a href='../S/5773.html#L33'>session</a>            33 lib/tls13/certificate.c static int parse_cert_list(gnutls_session_t session, uint8_t * data, size_t data_size);</span>
<span class='curline'><a href='../S/5773.html#L35'>session</a>            35 lib/tls13/certificate.c int _gnutls13_recv_certificate(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5773.html#L41'>session</a>            41 lib/tls13/certificate.c 	if (!session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5773.html#L42'>session</a>            42 lib/tls13/certificate.c 	    session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED)</span>
<span class='curline'><a href='../S/5773.html#L45'>session</a>            45 lib/tls13/certificate.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER) {</span>
<span class='curline'><a href='../S/5773.html#L47'>session</a>            47 lib/tls13/certificate.c 		if (session-&gt;internals.send_cert_req == 0)</span>
<span class='curline'><a href='../S/5773.html#L50'>session</a>            50 lib/tls13/certificate.c 		if (session-&gt;internals.send_cert_req != GNUTLS_CERT_REQUIRE)</span>
<span class='curline'><a href='../S/5773.html#L54'>session</a>            54 lib/tls13/certificate.c 	ret = _gnutls_recv_handshake(session, GNUTLS_HANDSHAKE_CERTIFICATE_PKT, 0, &amp;buf);</span>
<span class='curline'><a href='../S/5773.html#L56'>session</a>            56 lib/tls13/certificate.c 		if (ret == GNUTLS_E_UNEXPECTED_HANDSHAKE_PACKET &amp;&amp; session-&gt;internals.send_cert_req)</span>
<span class='curline'><a href='../S/5773.html#L68'>session</a>            68 lib/tls13/certificate.c 	if (session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5773.html#L69'>session</a>            69 lib/tls13/certificate.c 	    session-&gt;internals.post_handshake_cr_context.size &gt; 0) {</span>
<span class='curline'><a href='../S/5773.html#L79'>session</a>            79 lib/tls13/certificate.c 		if (context.size != session-&gt;internals.post_handshake_cr_context.size ||</span>
<span class='curline'><a href='../S/5773.html#L80'>session</a>            80 lib/tls13/certificate.c 		    memcmp(context.data, session-&gt;internals.post_handshake_cr_context.data,</span>
<span class='curline'><a href='../S/5773.html#L99'>session</a>            99 lib/tls13/certificate.c 	_gnutls_handshake_log("HSK[%p]: parsing certificate message\n", session);</span>
<span class='curline'><a href='../S/5773.html#L101'>session</a>           101 lib/tls13/certificate.c 	ret = parse_cert_list(session, buf.data, buf.length);</span>
<span class='curline'><a href='../S/5773.html#L106'>session</a>           106 lib/tls13/certificate.c 			else if (session-&gt;security_parameters.entity ==</span>
<span class='curline'><a href='../S/5773.html#L114'>session</a>           114 lib/tls13/certificate.c 	session-&gt;internals.hsk_flags |= HSK_CRT_VRFY_EXPECTED;</span>
<span class='curline'><a href='../S/5773.html#L126'>session</a>           126 lib/tls13/certificate.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5773.html#L134'>session</a>           134 lib/tls13/certificate.c 	gnutls_session_t session = ctx-&gt;session;</span>
<span class='curline'><a href='../S/5773.html#L139'>session</a>           139 lib/tls13/certificate.c 	assert(session-&gt;internals.selected_ocsp_func != NULL ||</span>
<span class='curline'><a href='../S/5773.html#L140'>session</a>           140 lib/tls13/certificate.c 	       session-&gt;internals.selected_ocsp_length != 0);</span>
<span class='curline'><a href='../S/5773.html#L144'>session</a>           144 lib/tls13/certificate.c 	if (session-&gt;internals.selected_ocsp_length == 1 &amp;&amp; ctx-&gt;cert_index != 0)</span>
<span class='curline'><a href='../S/5773.html#L147'>session</a>           147 lib/tls13/certificate.c 	if (session-&gt;internals.selected_ocsp_length &gt; 0) {</span>
<span class='curline'><a href='../S/5773.html#L148'>session</a>           148 lib/tls13/certificate.c 		if (ctx-&gt;cert_index &lt; session-&gt;internals.selected_ocsp_length) {</span>
<span class='curline'><a href='../S/5773.html#L149'>session</a>           149 lib/tls13/certificate.c 			if ((session-&gt;internals.selected_ocsp[ctx-&gt;cert_index].exptime != 0 &amp;&amp;</span>
<span class='curline'><a href='../S/5773.html#L150'>session</a>           150 lib/tls13/certificate.c 			    gnutls_time(0) &gt;= session-&gt;internals.selected_ocsp[ctx-&gt;cert_index].exptime) ||</span>
<span class='curline'><a href='../S/5773.html#L151'>session</a>           151 lib/tls13/certificate.c 			    session-&gt;internals.selected_ocsp[ctx-&gt;cert_index].response.data == NULL) {</span>
<span class='curline'><a href='../S/5773.html#L155'>session</a>           155 lib/tls13/certificate.c 			resp.data = session-&gt;internals.selected_ocsp[ctx-&gt;cert_index].response.data;</span>
<span class='curline'><a href='../S/5773.html#L156'>session</a>           156 lib/tls13/certificate.c 			resp.size = session-&gt;internals.selected_ocsp[ctx-&gt;cert_index].response.size;</span>
<span class='curline'><a href='../S/5773.html#L161'>session</a>           161 lib/tls13/certificate.c 	} else if (session-&gt;internals.selected_ocsp_func) {</span>
<span class='curline'><a href='../S/5773.html#L163'>session</a>           163 lib/tls13/certificate.c 			ret = session-&gt;internals.selected_ocsp_func(session, session-&gt;internals.selected_ocsp_func_ptr, &amp;resp);</span>
<span class='curline'><a href='../S/5773.html#L196'>session</a>           196 lib/tls13/certificate.c int _gnutls13_send_certificate(gnutls_session_t session, unsigned again)</span>
<span class='curline'><a href='../S/5773.html#L210'>session</a>           210 lib/tls13/certificate.c 		if (!session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5773.html#L211'>session</a>           211 lib/tls13/certificate.c 		    session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED)</span>
<span class='curline'><a href='../S/5773.html#L214'>session</a>           214 lib/tls13/certificate.c 		if (session-&gt;security_parameters.entity == GNUTLS_SERVER &amp;&amp;</span>
<span class='curline'><a href='../S/5773.html#L215'>session</a>           215 lib/tls13/certificate.c 		    session-&gt;internals.resumed)</span>
<span class='curline'><a href='../S/5773.html#L219'>session</a>           219 lib/tls13/certificate.c 		    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5773.html#L225'>session</a>           225 lib/tls13/certificate.c 		if (session-&gt;security_parameters.entity == GNUTLS_CLIENT &amp;&amp;</span>
<span class='curline'><a href='../S/5773.html#L226'>session</a>           226 lib/tls13/certificate.c 		    !(session-&gt;internals.hsk_flags &amp; HSK_CRT_ASKED)) {</span>
<span class='curline'><a href='../S/5773.html#L230'>session</a>           230 lib/tls13/certificate.c 		ret = _gnutls_get_selected_cert(session, &amp;apr_cert_list,</span>
<span class='curline'><a href='../S/5773.html#L239'>session</a>           239 lib/tls13/certificate.c 		if (session-&gt;security_parameters.entity == GNUTLS_CLIENT) {</span>
<span class='curline'><a href='../S/5773.html#L241'>session</a>           241 lib/tls13/certificate.c 								session-&gt;internals.post_handshake_cr_context.data,</span>
<span class='curline'><a href='../S/5773.html#L242'>session</a>           242 lib/tls13/certificate.c 								session-&gt;internals.post_handshake_cr_context.size);</span>
<span class='curline'><a href='../S/5773.html#L274'>session</a>           274 lib/tls13/certificate.c 			if ((session-&gt;internals.selected_ocsp_length &gt; 0 ||</span>
<span class='curline'><a href='../S/5773.html#L275'>session</a>           275 lib/tls13/certificate.c 			     session-&gt;internals.selected_ocsp_func) &amp;&amp;</span>
<span class='curline'><a href='../S/5773.html#L276'>session</a>           276 lib/tls13/certificate.c 			     (((session-&gt;internals.hsk_flags &amp; HSK_OCSP_REQUESTED) &amp;&amp; IS_SERVER(session)) ||</span>
<span class='curline'><a href='../S/5773.html#L277'>session</a>           277 lib/tls13/certificate.c 			     ((session-&gt;internals.hsk_flags &amp; HSK_CLIENT_OCSP_REQUESTED) &amp;&amp; !IS_SERVER(session)))) {</span>
<span class='curline'><a href='../S/5773.html#L288'>session</a>           288 lib/tls13/certificate.c 				ctx.session = session;</span>
<span class='curline'><a href='../S/5773.html#L318'>session</a>           318 lib/tls13/certificate.c 	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_CERTIFICATE_PKT);</span>
<span class='curline'><a href='../S/5773.html#L326'>session</a>           326 lib/tls13/certificate.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5773.html#L334'>session</a>           334 lib/tls13/certificate.c 	gnutls_session_t session = ctx-&gt;session;</span>
<span class='curline'><a href='../S/5773.html#L339'>session</a>           339 lib/tls13/certificate.c 		if (!_gnutls_hello_ext_is_present(session, ext_mod_status_request.gid)) {</span>
<span class='curline'><a href='../S/5773.html#L346'>session</a>           346 lib/tls13/certificate.c 		ret = _gnutls_parse_ocsp_response(session, data, data_size, ctx-&gt;ocsp);</span>
<span class='curline'><a href='../S/5773.html#L362'>session</a>           362 lib/tls13/certificate.c parse_cert_list(gnutls_session_t session, uint8_t * data, size_t data_size)</span>
<span class='curline'><a href='../S/5773.html#L378'>session</a>           378 lib/tls13/certificate.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5773.html#L385'>session</a>           385 lib/tls13/certificate.c 	     _gnutls_auth_info_init(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5773.html#L396'>session</a>           396 lib/tls13/certificate.c 	info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5773.html#L463'>session</a>           463 lib/tls13/certificate.c 	ctx.session = session;</span>
<span class='curline'><a href='../S/5768.html#L26'>session</a>            26 lib/tls13/certificate.h int _gnutls13_recv_certificate(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5768.html#L27'>session</a>            27 lib/tls13/certificate.h int _gnutls13_send_certificate(gnutls_session_t session, unsigned again);</span>
<span class='curline'><a href='../S/5770.html#L40'>session</a>            40 lib/tls13/certificate_request.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5770.html#L63'>session</a>            63 lib/tls13/certificate_request.c 	gnutls_session_t session = ctx-&gt;session;</span>
<span class='curline'><a href='../S/5770.html#L71'>session</a>            71 lib/tls13/certificate_request.c 		const version_entry_st *ver = get_version(session);</span>
<span class='curline'><a href='../S/5770.html#L91'>session</a>            91 lib/tls13/certificate_request.c 		ret = _gnutls_sign_algorithm_parse_data(session, data, data_size);</span>
<span class='curline'><a href='../S/5770.html#L118'>session</a>           118 lib/tls13/certificate_request.c 		session-&gt;internals.hsk_flags |= HSK_CLIENT_OCSP_REQUESTED;</span>
<span class='curline'><a href='../S/5770.html#L136'>session</a>           136 lib/tls13/certificate_request.c int _gnutls13_recv_certificate_request_int(gnutls_session_t session, gnutls_buffer_st *buf)</span>
<span class='curline'><a href='../S/5770.html#L144'>session</a>           144 lib/tls13/certificate_request.c 	_gnutls_handshake_log("HSK[%p]: parsing certificate request\n", session);</span>
<span class='curline'><a href='../S/5770.html#L146'>session</a>           146 lib/tls13/certificate_request.c 	if (unlikely(session-&gt;security_parameters.entity == GNUTLS_SERVER))</span>
<span class='curline'><a href='../S/5770.html#L150'>session</a>           150 lib/tls13/certificate_request.c 	if (!session-&gt;internals.initial_negotiation_completed) {</span>
<span class='curline'><a href='../S/5770.html#L166'>session</a>           166 lib/tls13/certificate_request.c 		gnutls_free(session-&gt;internals.post_handshake_cr_context.data);</span>
<span class='curline'><a href='../S/5770.html#L167'>session</a>           167 lib/tls13/certificate_request.c 		ret = _gnutls_set_datum(&amp;session-&gt;internals.post_handshake_cr_context,</span>
<span class='curline'><a href='../S/5770.html#L174'>session</a>           174 lib/tls13/certificate_request.c 	ctx.session = session;</span>
<span class='curline'><a href='../S/5770.html#L184'>session</a>           184 lib/tls13/certificate_request.c 	session-&gt;internals.hsk_flags |= HSK_CRT_ASKED;</span>
<span class='curline'><a href='../S/5770.html#L186'>session</a>           186 lib/tls13/certificate_request.c 	ret = _gnutls_select_client_cert(session, ctx.rdn, ctx.rdn_size,</span>
<span class='curline'><a href='../S/5770.html#L191'>session</a>           191 lib/tls13/certificate_request.c 	ret = _gnutls_get_selected_cert(session, &amp;apr_cert_list,</span>
<span class='curline'><a href='../S/5770.html#L199'>session</a>           199 lib/tls13/certificate_request.c 		algo = _gnutls_session_get_sign_algo(session, &amp;apr_cert_list[0], apr_pkey, 0, GNUTLS_KX_UNKNOWN);</span>
<span class='curline'><a href='../S/5770.html#L201'>session</a>           201 lib/tls13/certificate_request.c 			_gnutls_handshake_log("HSK[%p]: rejecting client auth because of no suitable signature algorithm\n", session);</span>
<span class='curline'><a href='../S/5770.html#L202'>session</a>           202 lib/tls13/certificate_request.c 			_gnutls_selected_certs_deinit(session);</span>
<span class='curline'><a href='../S/5770.html#L206'>session</a>           206 lib/tls13/certificate_request.c 		gnutls_sign_algorithm_set_client(session, algo);</span>
<span class='curline'><a href='../S/5770.html#L212'>session</a>           212 lib/tls13/certificate_request.c int _gnutls13_recv_certificate_request(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5770.html#L217'>session</a>           217 lib/tls13/certificate_request.c 	if (!session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5770.html#L218'>session</a>           218 lib/tls13/certificate_request.c 	    session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED)</span>
<span class='curline'><a href='../S/5770.html#L221'>session</a>           221 lib/tls13/certificate_request.c 	if (unlikely(session-&gt;security_parameters.entity != GNUTLS_CLIENT))</span>
<span class='curline'><a href='../S/5770.html#L224'>session</a>           224 lib/tls13/certificate_request.c 	ret = _gnutls_recv_handshake(session, GNUTLS_HANDSHAKE_CERTIFICATE_REQUEST, 1, &amp;buf);</span>
<span class='curline'><a href='../S/5770.html#L234'>session</a>           234 lib/tls13/certificate_request.c 	ret = _gnutls13_recv_certificate_request_int(session, &amp;buf);</span>
<span class='curline'><a href='../S/5770.html#L243'>session</a>           243 lib/tls13/certificate_request.c 	gnutls_session_t session = ctx;</span>
<span class='curline'><a href='../S/5770.html#L246'>session</a>           246 lib/tls13/certificate_request.c 	if (session-&gt;internals.ignore_rdn_sequence != 0)</span>
<span class='curline'><a href='../S/5770.html#L250'>session</a>           250 lib/tls13/certificate_request.c 	    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5770.html#L274'>session</a>           274 lib/tls13/certificate_request.c int _gnutls13_send_certificate_request(gnutls_session_t session, unsigned again)</span>
<span class='curline'><a href='../S/5770.html#L285'>session</a>           285 lib/tls13/certificate_request.c 		if (!session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5770.html#L286'>session</a>           286 lib/tls13/certificate_request.c 		    session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED)</span>
<span class='curline'><a href='../S/5770.html#L289'>session</a>           289 lib/tls13/certificate_request.c 		if (session-&gt;internals.send_cert_req == 0)</span>
<span class='curline'><a href='../S/5770.html#L293'>session</a>           293 lib/tls13/certificate_request.c 		    _gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5770.html#L301'>session</a>           301 lib/tls13/certificate_request.c 		if (session-&gt;internals.initial_negotiation_completed) { /* reauth */</span>
<span class='curline'><a href='../S/5770.html#L308'>session</a>           308 lib/tls13/certificate_request.c 			gnutls_free(session-&gt;internals.post_handshake_cr_context.data);</span>
<span class='curline'><a href='../S/5770.html#L309'>session</a>           309 lib/tls13/certificate_request.c 			ret = _gnutls_set_datum(&amp;session-&gt;internals.post_handshake_cr_context,</span>
<span class='curline'><a href='../S/5770.html#L317'>session</a>           317 lib/tls13/certificate_request.c 							        session-&gt;internals.post_handshake_cr_context.data,</span>
<span class='curline'><a href='../S/5770.html#L318'>session</a>           318 lib/tls13/certificate_request.c 							        session-&gt;internals.post_handshake_cr_context.size);</span>
<span class='curline'><a href='../S/5770.html#L335'>session</a>           335 lib/tls13/certificate_request.c 		ret = _gnutls_extv_append(&amp;buf, ext_mod_sig.tls_id, session,</span>
<span class='curline'><a href='../S/5770.html#L342'>session</a>           342 lib/tls13/certificate_request.c 		ret = _gnutls_extv_append(&amp;buf, EXTID_CERTIFICATE_AUTHORITIES, session,</span>
<span class='curline'><a href='../S/5770.html#L351'>session</a>           351 lib/tls13/certificate_request.c 		ret = _gnutls_extv_append(&amp;buf, ext_mod_status_request.tls_id, session,</span>
<span class='curline'><a href='../S/5770.html#L357'>session</a>           357 lib/tls13/certificate_request.c 		session-&gt;internals.hsk_flags |= HSK_CLIENT_OCSP_REQUESTED;</span>
<span class='curline'><a href='../S/5770.html#L368'>session</a>           368 lib/tls13/certificate_request.c 		session-&gt;internals.hsk_flags |= HSK_CRT_REQ_SENT;</span>
<span class='curline'><a href='../S/5770.html#L371'>session</a>           371 lib/tls13/certificate_request.c 	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_CERTIFICATE_REQUEST);</span>
<span class='curline'><a href='../S/5765.html#L26'>session</a>            26 lib/tls13/certificate_request.h int _gnutls13_recv_certificate_request(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5765.html#L27'>session</a>            27 lib/tls13/certificate_request.h int _gnutls13_recv_certificate_request_int(gnutls_session_t session, gnutls_buffer_st *buf);</span>
<span class='curline'><a href='../S/5765.html#L29'>session</a>            29 lib/tls13/certificate_request.h int _gnutls13_send_certificate_request(gnutls_session_t session, unsigned again);</span>
<span class='curline'><a href='../S/5777.html#L43'>session</a>            43 lib/tls13/certificate_verify.c int _gnutls13_recv_certificate_verify(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5777.html#L52'>session</a>            52 lib/tls13/certificate_verify.c 	cert_auth_info_t info = _gnutls_get_auth_info(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5777.html#L60'>session</a>            60 lib/tls13/certificate_verify.c 	if (!(session-&gt;internals.hsk_flags &amp; HSK_CRT_VRFY_EXPECTED))</span>
<span class='curline'><a href='../S/5777.html#L63'>session</a>            63 lib/tls13/certificate_verify.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5777.html#L67'>session</a>            67 lib/tls13/certificate_verify.c 		_gnutls_get_cred(session, GNUTLS_CRD_CERTIFICATE);</span>
<span class='curline'><a href='../S/5777.html#L73'>session</a>            73 lib/tls13/certificate_verify.c 	ret = _gnutls_recv_handshake(session, GNUTLS_HANDSHAKE_CERTIFICATE_VERIFY, 0, &amp;buf);</span>
<span class='curline'><a href='../S/5777.html#L77'>session</a>            77 lib/tls13/certificate_verify.c 	_gnutls_handshake_log("HSK[%p]: Parsing certificate verify\n", session);</span>
<span class='curline'><a href='../S/5777.html#L85'>session</a>            85 lib/tls13/certificate_verify.c 	se = _gnutls_tls_aid_to_sign_entry(buf.data[0], buf.data[1], get_version(session));</span>
<span class='curline'><a href='../S/5777.html#L93'>session</a>            93 lib/tls13/certificate_verify.c 		gnutls_sign_algorithm_set_client(session, se-&gt;id);</span>
<span class='curline'><a href='../S/5777.html#L95'>session</a>            95 lib/tls13/certificate_verify.c 		gnutls_sign_algorithm_set_server(session, se-&gt;id);</span>
<span class='curline'><a href='../S/5777.html#L116'>session</a>           116 lib/tls13/certificate_verify.c 	cert_type = get_certificate_type(session, GNUTLS_CTYPE_PEERS);</span>
<span class='curline'><a href='../S/5777.html#L125'>session</a>           125 lib/tls13/certificate_verify.c 	vflags = cred-&gt;verify_flags | session-&gt;internals.additional_verify_flags;</span>
<span class='curline'><a href='../S/5777.html#L127'>session</a>           127 lib/tls13/certificate_verify.c 	ret = _gnutls13_handshake_verify_data(session, vflags, &amp;peer_cert,</span>
<span class='curline'><a href='../S/5777.html#L148'>session</a>           148 lib/tls13/certificate_verify.c int _gnutls13_send_certificate_verify(gnutls_session_t session, unsigned again)</span>
<span class='curline'><a href='../S/5777.html#L162'>session</a>           162 lib/tls13/certificate_verify.c 		if (!session-&gt;internals.initial_negotiation_completed &amp;&amp;</span>
<span class='curline'><a href='../S/5777.html#L163'>session</a>           163 lib/tls13/certificate_verify.c 		    session-&gt;internals.hsk_flags &amp; HSK_PSK_SELECTED)</span>
<span class='curline'><a href='../S/5777.html#L166'>session</a>           166 lib/tls13/certificate_verify.c 		if (session-&gt;security_parameters.entity == GNUTLS_SERVER &amp;&amp;</span>
<span class='curline'><a href='../S/5777.html#L167'>session</a>           167 lib/tls13/certificate_verify.c 		    session-&gt;internals.resumed)</span>
<span class='curline'><a href='../S/5777.html#L170'>session</a>           170 lib/tls13/certificate_verify.c 		if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5777.html#L173'>session</a>           173 lib/tls13/certificate_verify.c 		ret = _gnutls_get_selected_cert(session, &amp;apr_cert_list,</span>
<span class='curline'><a href='../S/5777.html#L191'>session</a>           191 lib/tls13/certificate_verify.c 			algo = _gnutls_session_get_sign_algo(session, &amp;apr_cert_list[0], apr_pkey, 0, GNUTLS_KX_UNKNOWN);</span>
<span class='curline'><a href='../S/5777.html#L195'>session</a>           195 lib/tls13/certificate_verify.c 			gnutls_sign_algorithm_set_server(session, algo);</span>
<span class='curline'><a href='../S/5777.html#L199'>session</a>           199 lib/tls13/certificate_verify.c 			algo = gnutls_sign_algorithm_get_client(session);</span>
<span class='curline'><a href='../S/5777.html#L206'>session</a>           206 lib/tls13/certificate_verify.c 		ret = _gnutls13_handshake_sign_data(session, &amp;apr_cert_list[0], apr_pkey,</span>
<span class='curline'><a href='../S/5777.html#L235'>session</a>           235 lib/tls13/certificate_verify.c 	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_CERTIFICATE_VERIFY);</span>
<span class='curline'><a href='../S/5762.html#L26'>session</a>            26 lib/tls13/certificate_verify.h int _gnutls13_recv_certificate_verify(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5762.html#L27'>session</a>            27 lib/tls13/certificate_verify.h int _gnutls13_send_certificate_verify(gnutls_session_t session, unsigned again);</span>
<span class='curline'><a href='../S/5761.html#L27'>session</a>            27 lib/tls13/early_data.c int _gnutls13_send_early_data(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5761.html#L31'>session</a>            31 lib/tls13/early_data.c 	if (!(session-&gt;security_parameters.entity == GNUTLS_CLIENT &amp;&amp;</span>
<span class='curline'><a href='../S/5761.html#L32'>session</a>            32 lib/tls13/early_data.c 	      session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_IN_FLIGHT))</span>
<span class='curline'><a href='../S/5761.html#L35'>session</a>            35 lib/tls13/early_data.c 	while (session-&gt;internals.early_data_presend_buffer.length &gt; 0) {</span>
<span class='curline'><a href='../S/5761.html#L37'>session</a>            37 lib/tls13/early_data.c 			gnutls_record_send(session,</span>
<span class='curline'><a href='../S/5761.html#L38'>session</a>            38 lib/tls13/early_data.c 					   session-&gt;internals.</span>
<span class='curline'><a href='../S/5761.html#L40'>session</a>            40 lib/tls13/early_data.c 					   session-&gt;internals.</span>
<span class='curline'><a href='../S/5761.html#L46'>session</a>            46 lib/tls13/early_data.c 		session-&gt;internals.early_data_presend_buffer.data += ret;</span>
<span class='curline'><a href='../S/5761.html#L47'>session</a>            47 lib/tls13/early_data.c 		session-&gt;internals.early_data_presend_buffer.length -= ret;</span>
<span class='curline'><a href='../S/5761.html#L54'>session</a>            54 lib/tls13/early_data.c int _gnutls13_send_end_of_early_data(gnutls_session_t session, unsigned again)</span>
<span class='curline'><a href='../S/5761.html#L60'>session</a>            60 lib/tls13/early_data.c 	if (!(session-&gt;security_parameters.entity == GNUTLS_CLIENT &amp;&amp;</span>
<span class='curline'><a href='../S/5761.html#L61'>session</a>            61 lib/tls13/early_data.c 	      session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_ACCEPTED))</span>
<span class='curline'><a href='../S/5761.html#L72'>session</a>            72 lib/tls13/early_data.c 	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_END_OF_EARLY_DATA);</span>
<span class='curline'><a href='../S/5761.html#L75'>session</a>            75 lib/tls13/early_data.c int _gnutls13_recv_end_of_early_data(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5761.html#L80'>session</a>            80 lib/tls13/early_data.c 	if (!(session-&gt;security_parameters.entity == GNUTLS_SERVER &amp;&amp;</span>
<span class='curline'><a href='../S/5761.html#L81'>session</a>            81 lib/tls13/early_data.c 	      session-&gt;internals.hsk_flags &amp; HSK_EARLY_DATA_ACCEPTED))</span>
<span class='curline'><a href='../S/5761.html#L84'>session</a>            84 lib/tls13/early_data.c 	ret = _gnutls_recv_handshake(session, GNUTLS_HANDSHAKE_END_OF_EARLY_DATA, 0, &amp;buf);</span>
<span class='curline'><a href='../S/5761.html#L94'>session</a>            94 lib/tls13/early_data.c 	session-&gt;internals.hsk_flags &amp;= ~HSK_EARLY_DATA_IN_FLIGHT;</span>
<span class='curline'><a href='../S/5763.html#L26'>session</a>            26 lib/tls13/early_data.h int _gnutls13_send_end_of_early_data(gnutls_session_t session, unsigned again);</span>
<span class='curline'><a href='../S/5763.html#L27'>session</a>            27 lib/tls13/early_data.h int _gnutls13_recv_end_of_early_data(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5763.html#L28'>session</a>            28 lib/tls13/early_data.h int _gnutls13_send_early_data(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5771.html#L30'>session</a>            30 lib/tls13/encrypted_extensions.c int _gnutls13_recv_encrypted_extensions(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5771.html#L35'>session</a>            35 lib/tls13/encrypted_extensions.c 	ret = _gnutls_recv_handshake(session, GNUTLS_HANDSHAKE_ENCRYPTED_EXTENSIONS, 0, &amp;buf);</span>
<span class='curline'><a href='../S/5771.html#L39'>session</a>            39 lib/tls13/encrypted_extensions.c 	_gnutls_handshake_log("HSK[%p]: parsing encrypted extensions\n", session);</span>
<span class='curline'><a href='../S/5771.html#L40'>session</a>            40 lib/tls13/encrypted_extensions.c 	ret = _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_EE, GNUTLS_EXT_ANY,</span>
<span class='curline'><a href='../S/5771.html#L50'>session</a>            50 lib/tls13/encrypted_extensions.c int _gnutls13_send_encrypted_extensions(gnutls_session_t session, unsigned again)</span>
<span class='curline'><a href='../S/5771.html#L61'>session</a>            61 lib/tls13/encrypted_extensions.c 		ret = _gnutls_gen_hello_extensions(session, &amp;buf, GNUTLS_EXT_FLAG_EE, GNUTLS_EXT_ANY);</span>
<span class='curline'><a href='../S/5771.html#L70'>session</a>            70 lib/tls13/encrypted_extensions.c 	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_ENCRYPTED_EXTENSIONS);</span>
<span class='curline'><a href='../S/5769.html#L26'>session</a>            26 lib/tls13/encrypted_extensions.h int _gnutls13_recv_encrypted_extensions(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5769.html#L27'>session</a>            27 lib/tls13/encrypted_extensions.h int _gnutls13_send_encrypted_extensions(gnutls_session_t session, unsigned again);</span>
<span class='curline'><a href='../S/5778.html#L65'>session</a>            65 lib/tls13/finished.c int _gnutls13_recv_finished(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5778.html#L73'>session</a>            73 lib/tls13/finished.c 	if (unlikely(session-&gt;security_parameters.prf == NULL))</span>
<span class='curline'><a href='../S/5778.html#L76'>session</a>            76 lib/tls13/finished.c 	hash_size = session-&gt;security_parameters.prf-&gt;output_size;</span>
<span class='curline'><a href='../S/5778.html#L78'>session</a>            78 lib/tls13/finished.c 	if (!session-&gt;internals.initial_negotiation_completed) {</span>
<span class='curline'><a href='../S/5778.html#L79'>session</a>            79 lib/tls13/finished.c 		if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5778.html#L80'>session</a>            80 lib/tls13/finished.c 			base_key = session-&gt;key.proto.tls13.hs_skey;</span>
<span class='curline'><a href='../S/5778.html#L82'>session</a>            82 lib/tls13/finished.c 			base_key = session-&gt;key.proto.tls13.hs_ckey;</span>
<span class='curline'><a href='../S/5778.html#L84'>session</a>            84 lib/tls13/finished.c 		if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5778.html#L85'>session</a>            85 lib/tls13/finished.c 			base_key = session-&gt;key.proto.tls13.ap_skey;</span>
<span class='curline'><a href='../S/5778.html#L87'>session</a>            87 lib/tls13/finished.c 			base_key = session-&gt;key.proto.tls13.ap_ckey;</span>
<span class='curline'><a href='../S/5778.html#L90'>session</a>            90 lib/tls13/finished.c 	ret = _gnutls13_compute_finished(session-&gt;security_parameters.prf,</span>
<span class='curline'><a href='../S/5778.html#L92'>session</a>            92 lib/tls13/finished.c 			&amp;session-&gt;internals.handshake_hash_buffer,</span>
<span class='curline'><a href='../S/5778.html#L99'>session</a>            99 lib/tls13/finished.c 	ret = _gnutls_recv_handshake(session, GNUTLS_HANDSHAKE_FINISHED, 0, &amp;buf);</span>
<span class='curline'><a href='../S/5778.html#L103'>session</a>           103 lib/tls13/finished.c 	_gnutls_handshake_log("HSK[%p]: parsing finished\n", session);</span>
<span class='curline'><a href='../S/5778.html#L129'>session</a>           129 lib/tls13/finished.c int _gnutls13_send_finished(gnutls_session_t session, unsigned again)</span>
<span class='curline'><a href='../S/5778.html#L138'>session</a>           138 lib/tls13/finished.c 		if (unlikely(session-&gt;security_parameters.prf == NULL))</span>
<span class='curline'><a href='../S/5778.html#L141'>session</a>           141 lib/tls13/finished.c 		hash_size = session-&gt;security_parameters.prf-&gt;output_size;</span>
<span class='curline'><a href='../S/5778.html#L143'>session</a>           143 lib/tls13/finished.c 		if (!session-&gt;internals.initial_negotiation_completed) {</span>
<span class='curline'><a href='../S/5778.html#L144'>session</a>           144 lib/tls13/finished.c 			if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5778.html#L145'>session</a>           145 lib/tls13/finished.c 				base_key = session-&gt;key.proto.tls13.hs_ckey;</span>
<span class='curline'><a href='../S/5778.html#L147'>session</a>           147 lib/tls13/finished.c 				base_key = session-&gt;key.proto.tls13.hs_skey;</span>
<span class='curline'><a href='../S/5778.html#L149'>session</a>           149 lib/tls13/finished.c 			if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)</span>
<span class='curline'><a href='../S/5778.html#L150'>session</a>           150 lib/tls13/finished.c 				base_key = session-&gt;key.proto.tls13.ap_ckey;</span>
<span class='curline'><a href='../S/5778.html#L152'>session</a>           152 lib/tls13/finished.c 				base_key = session-&gt;key.proto.tls13.ap_skey;</span>
<span class='curline'><a href='../S/5778.html#L155'>session</a>           155 lib/tls13/finished.c 		ret = _gnutls13_compute_finished(session-&gt;security_parameters.prf,</span>
<span class='curline'><a href='../S/5778.html#L157'>session</a>           157 lib/tls13/finished.c 				&amp;session-&gt;internals.handshake_hash_buffer,</span>
<span class='curline'><a href='../S/5778.html#L164'>session</a>           164 lib/tls13/finished.c 		_gnutls_handshake_log("HSK[%p]: sending finished\n", session);</span>
<span class='curline'><a href='../S/5778.html#L166'>session</a>           166 lib/tls13/finished.c 		bufel = _gnutls_handshake_alloc(session, hash_size);</span>
<span class='curline'><a href='../S/5778.html#L178'>session</a>           178 lib/tls13/finished.c 	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_FINISHED);</span>
<span class='curline'><a href='../S/5779.html#L30'>session</a>            30 lib/tls13/finished.h int _gnutls13_recv_finished(gnutls_session_t session);</span>
<span class='curline'><a href='../S/5779.html#L31'>session</a>            31 lib/tls13/finished.h int _gnutls13_send_finished(gnutls_session_t session, unsigned again);</span>
<span class='curline'><a href='../S/5782.html#L32'>session</a>            32 lib/tls13/hello_retry.c int _gnutls13_send_hello_retry_request(gnutls_session_t session, unsigned again)</span>
<span class='curline'><a href='../S/5782.html#L41'>session</a>            41 lib/tls13/hello_retry.c 		ver = get_version(session);</span>
<span class='curline'><a href='../S/5782.html#L42'>session</a>            42 lib/tls13/hello_retry.c 		if (unlikely(ver == NULL || session-&gt;security_parameters.cs == NULL))</span>
<span class='curline'><a href='../S/5782.html#L62'>session</a>            62 lib/tls13/hello_retry.c 							session-&gt;security_parameters.session_id,</span>
<span class='curline'><a href='../S/5782.html#L63'>session</a>            63 lib/tls13/hello_retry.c 							session-&gt;security_parameters.session_id_size);</span>
<span class='curline'><a href='../S/5782.html#L69'>session</a>            69 lib/tls13/hello_retry.c 		ret = _gnutls_buffer_append_data(&amp;buf, session-&gt;security_parameters.cs-&gt;id, 2);</span>
<span class='curline'><a href='../S/5782.html#L82'>session</a>            82 lib/tls13/hello_retry.c 		ret = _gnutls_gen_hello_extensions(session, &amp;buf,</span>
<span class='curline'><a href='../S/5782.html#L91'>session</a>            91 lib/tls13/hello_retry.c 		session-&gt;internals.used_exts = 0;</span>
<span class='curline'><a href='../S/5782.html#L93'>session</a>            93 lib/tls13/hello_retry.c 		reset_binders(session);</span>
<span class='curline'><a href='../S/5782.html#L98'>session</a>            98 lib/tls13/hello_retry.c 	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_HELLO_RETRY_REQUEST);</span>
<span class='curline'><a href='../S/5782.html#L106'>session</a>           106 lib/tls13/hello_retry.c _gnutls13_recv_hello_retry_request(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5782.html#L117'>session</a>           117 lib/tls13/hello_retry.c 	if (IS_DTLS(session))</span>
<span class='curline'><a href='../S/5782.html#L120'>session</a>           120 lib/tls13/hello_retry.c 	if (session-&gt;internals.hsk_flags &amp; HSK_HRR_RECEIVED)</span>
<span class='curline'><a href='../S/5782.html#L123'>session</a>           123 lib/tls13/hello_retry.c 	session-&gt;internals.hsk_flags |= HSK_HRR_RECEIVED;</span>
<span class='curline'><a href='../S/5782.html#L154'>session</a>           154 lib/tls13/hello_retry.c 	_gnutls_handshake_log("EXT[%p]: Hello Retry Request with %s\n", session, cs-&gt;name);</span>
<span class='curline'><a href='../S/5782.html#L155'>session</a>           155 lib/tls13/hello_retry.c 	memcpy(session-&gt;internals.hrr_cs, cs-&gt;id, 2);</span>
<span class='curline'><a href='../S/5782.html#L169'>session</a>           169 lib/tls13/hello_retry.c 	ret = _gnutls13_handshake_hash_buffers_synth(session, prf, 1);</span>
<span class='curline'><a href='../S/5782.html#L180'>session</a>           180 lib/tls13/hello_retry.c 	    _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_HRR,</span>
<span class='curline'><a href='../S/5782.html#L187'>session</a>           187 lib/tls13/hello_retry.c 	ret = _gnutls_parse_hello_extensions(session, GNUTLS_EXT_FLAG_HRR, GNUTLS_EXT_ANY,</span>
<span class='curline'><a href='../S/5782.html#L192'>session</a>           192 lib/tls13/hello_retry.c 	session-&gt;internals.used_exts = 0;</span>
<span class='curline'><a href='../S/5776.html#L26'>session</a>            26 lib/tls13/hello_retry.h int _gnutls13_send_hello_retry_request(gnutls_session_t session, unsigned again);</span>
<span class='curline'><a href='../S/5774.html#L34'>session</a>            34 lib/tls13/key_update.c static int update_keys(gnutls_session_t session, hs_stage_t stage)</span>
<span class='curline'><a href='../S/5774.html#L38'>session</a>            38 lib/tls13/key_update.c 	ret = _tls13_update_secret(session, session-&gt;key.proto.tls13.temp_secret,</span>
<span class='curline'><a href='../S/5774.html#L39'>session</a>            39 lib/tls13/key_update.c 				   session-&gt;key.proto.tls13.temp_secret_size);</span>
<span class='curline'><a href='../S/5774.html#L43'>session</a>            43 lib/tls13/key_update.c 	_gnutls_epoch_bump(session);</span>
<span class='curline'><a href='../S/5774.html#L44'>session</a>            44 lib/tls13/key_update.c 	ret = _gnutls_epoch_dup(session, EPOCH_READ_CURRENT);</span>
<span class='curline'><a href='../S/5774.html#L50'>session</a>            50 lib/tls13/key_update.c 	if (session-&gt;internals.recv_state == RECV_STATE_EARLY_START) {</span>
<span class='curline'><a href='../S/5774.html#L51'>session</a>            51 lib/tls13/key_update.c 		ret = _tls13_write_connection_state_init(session, stage);</span>
<span class='curline'><a href='../S/5774.html#L53'>session</a>            53 lib/tls13/key_update.c 		ret = _tls13_connection_state_init(session, stage);</span>
<span class='curline'><a href='../S/5774.html#L61'>session</a>            61 lib/tls13/key_update.c int _gnutls13_recv_key_update(gnutls_session_t session, gnutls_buffer_st *buf)</span>
<span class='curline'><a href='../S/5774.html#L72'>session</a>            72 lib/tls13/key_update.c 	if (session-&gt;internals.key_update_count == 0 ||</span>
<span class='curline'><a href='../S/5774.html#L73'>session</a>            73 lib/tls13/key_update.c 	    timespec_sub_ms(&amp;now, &amp;session-&gt;internals.last_key_update) &gt;</span>
<span class='curline'><a href='../S/5774.html#L75'>session</a>            75 lib/tls13/key_update.c 		session-&gt;internals.last_key_update = now;</span>
<span class='curline'><a href='../S/5774.html#L76'>session</a>            76 lib/tls13/key_update.c 		session-&gt;internals.key_update_count = 0;</span>
<span class='curline'><a href='../S/5774.html#L79'>session</a>            79 lib/tls13/key_update.c 	if (unlikely(++session-&gt;internals.key_update_count &gt;</span>
<span class='curline'><a href='../S/5774.html#L87'>session</a>            87 lib/tls13/key_update.c 	_gnutls_epoch_gc(session);</span>
<span class='curline'><a href='../S/5774.html#L90'>session</a>            90 lib/tls13/key_update.c 			      session, (unsigned)buf-&gt;data[0]);</span>
<span class='curline'><a href='../S/5774.html#L95'>session</a>            95 lib/tls13/key_update.c 		ret = update_keys(session, STAGE_UPD_PEERS);</span>
<span class='curline'><a href='../S/5774.html#L101'>session</a>           101 lib/tls13/key_update.c 		if (session-&gt;internals.hsk_flags &amp; HSK_KEY_UPDATE_ASKED) {</span>
<span class='curline'><a href='../S/5774.html#L108'>session</a>           108 lib/tls13/key_update.c 		ret = update_keys(session, STAGE_UPD_PEERS);</span>
<span class='curline'><a href='../S/5774.html#L116'>session</a>           116 lib/tls13/key_update.c 		if (session-&gt;internals.rsend_state == RECORD_SEND_NORMAL)</span>
<span class='curline'><a href='../S/5774.html#L117'>session</a>           117 lib/tls13/key_update.c 			session-&gt;internals.rsend_state = RECORD_SEND_KEY_UPDATE_1;</span>
<span class='curline'><a href='../S/5774.html#L118'>session</a>           118 lib/tls13/key_update.c 		else if (session-&gt;internals.rsend_state == RECORD_SEND_CORKED)</span>
<span class='curline'><a href='../S/5774.html#L119'>session</a>           119 lib/tls13/key_update.c 			session-&gt;internals.rsend_state = RECORD_SEND_CORKED_TO_KU;</span>
<span class='curline'><a href='../S/5774.html#L126'>session</a>           126 lib/tls13/key_update.c 	session-&gt;internals.hsk_flags &amp;= ~(unsigned)(HSK_KEY_UPDATE_ASKED);</span>
<span class='curline'><a href='../S/5774.html#L131'>session</a>           131 lib/tls13/key_update.c int _gnutls13_send_key_update(gnutls_session_t session, unsigned again, unsigned flags /* GNUTLS_KU_* */)</span>
<span class='curline'><a href='../S/5774.html#L141'>session</a>           141 lib/tls13/key_update.c 			session-&gt;internals.hsk_flags |= HSK_KEY_UPDATE_ASKED;</span>
<span class='curline'><a href='../S/5774.html#L147'>session</a>           147 lib/tls13/key_update.c 		_gnutls_handshake_log("HSK[%p]: sending key update (%u)\n", session, (unsigned)val);</span>
<span class='curline'><a href='../S/5774.html#L149'>session</a>           149 lib/tls13/key_update.c 		bufel = _gnutls_handshake_alloc(session, 1);</span>
<span class='curline'><a href='../S/5774.html#L162'>session</a>           162 lib/tls13/key_update.c 	return _gnutls_send_handshake(session, bufel, GNUTLS_HANDSHAKE_KEY_UPDATE);</span>
<span class='curline'><a href='../S/5774.html#L191'>session</a>           191 lib/tls13/key_update.c int gnutls_session_key_update(gnutls_session_t session, unsigned flags)</span>
<span class='curline'><a href='../S/5774.html#L194'>session</a>           194 lib/tls13/key_update.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5774.html#L200'>session</a>           200 lib/tls13/key_update.c 	    _gnutls13_send_key_update(session, AGAIN(STATE150), flags);</span>
<span class='curline'><a href='../S/5774.html#L209'>session</a>           209 lib/tls13/key_update.c 	_gnutls_epoch_gc(session);</span>
<span class='curline'><a href='../S/5774.html#L212'>session</a>           212 lib/tls13/key_update.c 	ret = update_keys(session, STAGE_UPD_OURS);</span>
<span class='curline'><a href='../S/5772.html#L26'>session</a>            26 lib/tls13/key_update.h int _gnutls13_recv_key_update(gnutls_session_t session, gnutls_buffer_st *buf);</span>
<span class='curline'><a href='../S/5772.html#L27'>session</a>            27 lib/tls13/key_update.h int _gnutls13_send_key_update(gnutls_session_t session, unsigned again, unsigned flags);</span>
<span class='curline'><a href='../S/5764.html#L62'>session</a>            62 lib/tls13/post_handshake.c int _gnutls13_reauth_client(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5764.html#L67'>session</a>            67 lib/tls13/post_handshake.c 	if (!session-&gt;internals.initial_negotiation_completed)</span>
<span class='curline'><a href='../S/5764.html#L70'>session</a>            70 lib/tls13/post_handshake.c 	if (!(session-&gt;internals.flags &amp; GNUTLS_POST_HANDSHAKE_AUTH))</span>
<span class='curline'><a href='../S/5764.html#L73'>session</a>            73 lib/tls13/post_handshake.c 	if (session-&gt;internals.reauth_buffer.length == 0)</span>
<span class='curline'><a href='../S/5764.html#L80'>session</a>            80 lib/tls13/post_handshake.c 		_gnutls_buffer_reset(&amp;session-&gt;internals.handshake_hash_buffer);</span>
<span class='curline'><a href='../S/5764.html#L81'>session</a>            81 lib/tls13/post_handshake.c 		ret = gnutls_buffer_append_data(&amp;session-&gt;internals.handshake_hash_buffer,</span>
<span class='curline'><a href='../S/5764.html#L82'>session</a>            82 lib/tls13/post_handshake.c 						session-&gt;internals.post_handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5764.html#L83'>session</a>            83 lib/tls13/post_handshake.c 						session-&gt;internals.post_handshake_hash_buffer.length);</span>
<span class='curline'><a href='../S/5764.html#L89'>session</a>            89 lib/tls13/post_handshake.c 		ret = gnutls_buffer_append_data(&amp;session-&gt;internals.handshake_hash_buffer,</span>
<span class='curline'><a href='../S/5764.html#L90'>session</a>            90 lib/tls13/post_handshake.c 						session-&gt;internals.reauth_buffer.data,</span>
<span class='curline'><a href='../S/5764.html#L91'>session</a>            91 lib/tls13/post_handshake.c 						session-&gt;internals.reauth_buffer.length);</span>
<span class='curline'><a href='../S/5764.html#L95'>session</a>            95 lib/tls13/post_handshake.c 		session-&gt;internals.handshake_hash_buffer_prev_len = session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5764.html#L98'>session</a>            98 lib/tls13/post_handshake.c 		ret = _gnutls_buffer_pop_prefix32(&amp;session-&gt;internals.reauth_buffer, &amp;tmp, 0);</span>
<span class='curline'><a href='../S/5764.html#L104'>session</a>           104 lib/tls13/post_handshake.c 		ret = _gnutls13_recv_certificate_request_int(session,</span>
<span class='curline'><a href='../S/5764.html#L105'>session</a>           105 lib/tls13/post_handshake.c 							     &amp;session-&gt;internals.reauth_buffer);</span>
<span class='curline'><a href='../S/5764.html#L110'>session</a>           110 lib/tls13/post_handshake.c 		ret = _gnutls13_send_certificate(session, AGAIN(REAUTH_STATE2));</span>
<span class='curline'><a href='../S/5764.html#L115'>session</a>           115 lib/tls13/post_handshake.c 		ret = _gnutls13_send_certificate_verify(session, AGAIN(REAUTH_STATE3));</span>
<span class='curline'><a href='../S/5764.html#L120'>session</a>           120 lib/tls13/post_handshake.c 		ret = _gnutls13_send_finished(session, AGAIN(REAUTH_STATE4));</span>
<span class='curline'><a href='../S/5764.html#L128'>session</a>           128 lib/tls13/post_handshake.c 	_gnutls_handshake_hash_buffers_clear(session);</span>
<span class='curline'><a href='../S/5764.html#L129'>session</a>           129 lib/tls13/post_handshake.c 	_gnutls_buffer_reset(&amp;session-&gt;internals.reauth_buffer);</span>
<span class='curline'><a href='../S/5764.html#L140'>session</a>           140 lib/tls13/post_handshake.c int _gnutls13_reauth_server(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5764.html#L144'>session</a>           144 lib/tls13/post_handshake.c 	if (session-&gt;security_parameters.post_handshake_auth == 0 ||</span>
<span class='curline'><a href='../S/5764.html#L145'>session</a>           145 lib/tls13/post_handshake.c 	    (!(session-&gt;internals.flags &amp; GNUTLS_POST_HANDSHAKE_AUTH)))</span>
<span class='curline'><a href='../S/5764.html#L148'>session</a>           148 lib/tls13/post_handshake.c 	if (session-&gt;internals.send_cert_req == 0) {</span>
<span class='curline'><a href='../S/5764.html#L156'>session</a>           156 lib/tls13/post_handshake.c 		_gnutls_buffer_reset(&amp;session-&gt;internals.handshake_hash_buffer);</span>
<span class='curline'><a href='../S/5764.html#L157'>session</a>           157 lib/tls13/post_handshake.c 		ret = gnutls_buffer_append_data(&amp;session-&gt;internals.handshake_hash_buffer,</span>
<span class='curline'><a href='../S/5764.html#L158'>session</a>           158 lib/tls13/post_handshake.c 						session-&gt;internals.post_handshake_hash_buffer.data,</span>
<span class='curline'><a href='../S/5764.html#L159'>session</a>           159 lib/tls13/post_handshake.c 						session-&gt;internals.post_handshake_hash_buffer.length);</span>
<span class='curline'><a href='../S/5764.html#L163'>session</a>           163 lib/tls13/post_handshake.c 		session-&gt;internals.handshake_hash_buffer_prev_len = session-&gt;internals.handshake_hash_buffer.length;</span>
<span class='curline'><a href='../S/5764.html#L167'>session</a>           167 lib/tls13/post_handshake.c 		ret = _gnutls13_send_certificate_request(session, AGAIN(REAUTH_STATE1));</span>
<span class='curline'><a href='../S/5764.html#L173'>session</a>           173 lib/tls13/post_handshake.c 		ret = _gnutls13_recv_certificate(session);</span>
<span class='curline'><a href='../S/5764.html#L178'>session</a>           178 lib/tls13/post_handshake.c 		ret = _gnutls13_recv_certificate_verify(session);</span>
<span class='curline'><a href='../S/5764.html#L183'>session</a>           183 lib/tls13/post_handshake.c 		ret = _gnutls_run_verify_callback(session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5764.html#L189'>session</a>           189 lib/tls13/post_handshake.c 		ret = _gnutls13_recv_finished(session);</span>
<span class='curline'><a href='../S/5764.html#L197'>session</a>           197 lib/tls13/post_handshake.c 	_gnutls_handshake_hash_buffers_clear(session);</span>
<span class='curline'><a href='../S/5764.html#L241'>session</a>           241 lib/tls13/post_handshake.c int gnutls_reauth(gnutls_session_t session, unsigned int flags)</span>
<span class='curline'><a href='../S/5764.html#L243'>session</a>           243 lib/tls13/post_handshake.c 	const version_entry_st *vers = get_version(session);</span>
<span class='curline'><a href='../S/5764.html#L248'>session</a>           248 lib/tls13/post_handshake.c 	if (session-&gt;security_parameters.entity == GNUTLS_SERVER)</span>
<span class='curline'><a href='../S/5764.html#L249'>session</a>           249 lib/tls13/post_handshake.c 		return _gnutls13_reauth_server(session);</span>
<span class='curline'><a href='../S/5764.html#L251'>session</a>           251 lib/tls13/post_handshake.c 		return _gnutls13_reauth_client(session);</span>
<span class='curline'><a href='../S/5766.html#L37'>session</a>            37 lib/tls13/session_ticket.c pack_ticket(gnutls_session_t session, tls13_ticket_st *ticket, gnutls_datum_t *packed)</span>
<span class='curline'><a href='../S/5766.html#L43'>session</a>            43 lib/tls13/session_ticket.c 	ret = _gnutls_session_pack(session, &amp;state);</span>
<span class='curline'><a href='../S/5766.html#L96'>session</a>            96 lib/tls13/session_ticket.c unpack_ticket(gnutls_session_t session, gnutls_datum_t *packed, tls13_ticket_st *data)</span>
<span class='curline'><a href='../S/5766.html#L178'>session</a>           178 lib/tls13/session_ticket.c 	ret = _gnutls_session_unpack(session, &amp;state);</span>
<span class='curline'><a href='../S/5766.html#L196'>session</a>           196 lib/tls13/session_ticket.c generate_session_ticket(gnutls_session_t session, tls13_ticket_st *ticket)</span>
<span class='curline'><a href='../S/5766.html#L204'>session</a>           204 lib/tls13/session_ticket.c 	if (session-&gt;internals.resumed != RESUME_FALSE) {</span>
<span class='curline'><a href='../S/5766.html#L207'>session</a>           207 lib/tls13/session_ticket.c 		if (now.tv_sec &gt;= session-&gt;security_parameters.timestamp + session-&gt;internals.expire_time)</span>
<span class='curline'><a href='../S/5766.html#L210'>session</a>           210 lib/tls13/session_ticket.c 			ticket-&gt;lifetime = session-&gt;security_parameters.timestamp +</span>
<span class='curline'><a href='../S/5766.html#L211'>session</a>           211 lib/tls13/session_ticket.c 					   session-&gt;internals.expire_time - now.tv_sec;</span>
<span class='curline'><a href='../S/5766.html#L214'>session</a>           214 lib/tls13/session_ticket.c 		ticket-&gt;lifetime = session-&gt;internals.expire_time;</span>
<span class='curline'><a href='../S/5766.html#L232'>session</a>           232 lib/tls13/session_ticket.c 	ticket-&gt;prf = session-&gt;security_parameters.prf;</span>
<span class='curline'><a href='../S/5766.html#L242'>session</a>           242 lib/tls13/session_ticket.c 	       session-&gt;key.proto.tls13.ap_rms,</span>
<span class='curline'><a href='../S/5766.html#L245'>session</a>           245 lib/tls13/session_ticket.c 	ret = pack_ticket(session, &amp;ticket_data, &amp;packed);</span>
<span class='curline'><a href='../S/5766.html#L249'>session</a>           249 lib/tls13/session_ticket.c 	ret = _gnutls_encrypt_session_ticket(session, &amp;packed, &amp;ticket-&gt;ticket);</span>
<span class='curline'><a href='../S/5766.html#L259'>session</a>           259 lib/tls13/session_ticket.c 	gnutls_session_t session = ctx;</span>
<span class='curline'><a href='../S/5766.html#L262'>session</a>           262 lib/tls13/session_ticket.c 	if (!(session-&gt;internals.flags &amp; GNUTLS_ENABLE_EARLY_DATA))</span>
<span class='curline'><a href='../S/5766.html#L266'>session</a>           266 lib/tls13/session_ticket.c 					   session-&gt;security_parameters.</span>
<span class='curline'><a href='../S/5766.html#L274'>session</a>           274 lib/tls13/session_ticket.c int _gnutls13_send_session_ticket(gnutls_session_t session, unsigned nr, unsigned again)</span>
<span class='curline'><a href='../S/5766.html#L283'>session</a>           283 lib/tls13/session_ticket.c 	if (unlikely(session-&gt;security_parameters.entity == GNUTLS_CLIENT))</span>
<span class='curline'><a href='../S/5766.html#L287'>session</a>           287 lib/tls13/session_ticket.c 	if (session-&gt;internals.flags &amp; GNUTLS_NO_TICKETS)</span>
<span class='curline'><a href='../S/5766.html#L293'>session</a>           293 lib/tls13/session_ticket.c 	if (session-&gt;internals.hsk_flags &amp; HSK_PSK_KE_MODE_INVALID)</span>
<span class='curline'><a href='../S/5766.html#L307'>session</a>           307 lib/tls13/session_ticket.c 			ret = generate_session_ticket(session, &amp;ticket);</span>
<span class='curline'><a href='../S/5766.html#L353'>session</a>           353 lib/tls13/session_ticket.c 			ret = _gnutls_extv_append(&amp;buf, ext_mod_early_data.tls_id, session,</span>
<span class='curline'><a href='../S/5766.html#L368'>session</a>           368 lib/tls13/session_ticket.c 			ret = _gnutls_send_handshake2(session, bufel,</span>
<span class='curline'><a href='../S/5766.html#L375'>session</a>           375 lib/tls13/session_ticket.c 			session-&gt;internals.hsk_flags |= HSK_TLS13_TICKET_SENT;</span>
<span class='curline'><a href='../S/5766.html#L379'>session</a>           379 lib/tls13/session_ticket.c 	ret = _gnutls_handshake_io_write_flush(session);</span>
<span class='curline'><a href='../S/5766.html#L393'>session</a>           393 lib/tls13/session_ticket.c 	gnutls_session_t session = ctx;</span>
<span class='curline'><a href='../S/5766.html#L397'>session</a>           397 lib/tls13/session_ticket.c 		session-&gt;security_parameters.max_early_data_size =</span>
<span class='curline'><a href='../S/5766.html#L403'>session</a>           403 lib/tls13/session_ticket.c int _gnutls13_recv_session_ticket(gnutls_session_t session, gnutls_buffer_st *buf)</span>
<span class='curline'><a href='../S/5766.html#L407'>session</a>           407 lib/tls13/session_ticket.c 	tls13_ticket_st *ticket = &amp;session-&gt;internals.tls13_ticket;</span>
<span class='curline'><a href='../S/5766.html#L417'>session</a>           417 lib/tls13/session_ticket.c 	_gnutls_handshake_log("HSK[%p]: parsing session ticket message\n", session);</span>
<span class='curline'><a href='../S/5766.html#L452'>session</a>           452 lib/tls13/session_ticket.c 	ret = _gnutls_extv_parse(session, parse_nst_extension, buf-&gt;data, buf-&gt;length);</span>
<span class='curline'><a href='../S/5766.html#L466'>session</a>           466 lib/tls13/session_ticket.c int _gnutls13_unpack_session_ticket(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5766.html#L477'>session</a>           477 lib/tls13/session_ticket.c 	ret = _gnutls_decrypt_session_ticket(session, data, &amp;decrypted);</span>
<span class='curline'><a href='../S/5766.html#L482'>session</a>           482 lib/tls13/session_ticket.c 	ret = unpack_ticket(session, &amp;decrypted, ticket_data);</span>
<span class='curline'><a href='../S/5766.html#L487'>session</a>           487 lib/tls13/session_ticket.c 	ret = _gnutls_check_resumed_params(session);</span>
<span class='curline'><a href='../S/5781.html#L26'>session</a>            26 lib/tls13/session_ticket.h int _gnutls13_recv_session_ticket(gnutls_session_t session, gnutls_buffer_st *buf);</span>
<span class='curline'><a href='../S/5781.html#L27'>session</a>            27 lib/tls13/session_ticket.h int _gnutls13_send_session_ticket(gnutls_session_t session, unsigned nr, unsigned again);</span>
<span class='curline'><a href='../S/5781.html#L29'>session</a>            29 lib/tls13/session_ticket.h int _gnutls13_unpack_session_ticket(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5781.html#L46'>session</a>            46 lib/tls13/session_ticket.h void _gnutls13_session_ticket_unset(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5781.html#L48'>session</a>            48 lib/tls13/session_ticket.h 	if (session-&gt;internals.tls13_ticket.ticket.data != NULL)</span>
<span class='curline'><a href='../S/5781.html#L49'>session</a>            49 lib/tls13/session_ticket.h 		tls13_ticket_deinit(&amp;session-&gt;internals.tls13_ticket);</span>
<span class='curline'><a href='../S/5640.html#L29'>session</a>            29 lib/x509.h     int _gnutls_x509_cert_verify_peers(gnutls_session_t session,</span>
<span class='curline'><a href='../S/6443.html#L930'>session</a>           930 libdane/dane.c 			gnutls_session_t session,</span>
<span class='curline'><a href='../S/6443.html#L940'>session</a>           940 libdane/dane.c 	cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/6443.html#L945'>session</a>           945 libdane/dane.c 	type = gnutls_certificate_type_get(session);</span>
<span class='curline'><a href='../S/6443.html#L974'>session</a>           974 libdane/dane.c 		ret = gnutls_credentials_get(session, GNUTLS_CRD_CERTIFICATE, (void**)&amp;sc);</span>
<span class='curline'><a href='../S/6441.html#L181'>session</a>           181 libdane/includes/gnutls/dane.h 			    gnutls_session_t session,</span>
<span class='curline'><a href='../S/3997.html#L312'>session</a>           312 src/cli-debug.c 		ret = tls_tests[i].func(hd.session);</span>
<span class='curline'><a href='../S/4009.html#L120'>session</a>           120 src/cli.c      static int cert_verify_ocsp(gnutls_session_t session);</span>
<span class='curline'><a href='../S/4009.html#L324'>session</a>           324 src/cli.c      static void try_save_cert(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4009.html#L333'>session</a>           333 src/cli.c      	cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/4009.html#L361'>session</a>           361 src/cli.c      static void try_save_ocsp_status(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4009.html#L364'>session</a>           364 src/cli.c      	gnutls_certificate_get_peers(session, &amp;cert_num);</span>
<span class='curline'><a href='../S/4009.html#L395'>session</a>           395 src/cli.c      		int ret = gnutls_ocsp_status_request_get2(session, i, &amp;oresp);</span>
<span class='curline'><a href='../S/4009.html#L439'>session</a>           439 src/cli.c      static int cert_verify_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4009.html#L466'>session</a>           466 src/cli.c      		try_save_cert(session);</span>
<span class='curline'><a href='../S/4009.html#L475'>session</a>           475 src/cli.c      		try_save_ocsp_status(session);</span>
<span class='curline'><a href='../S/4009.html#L479'>session</a>           479 src/cli.c      	print_cert_info(session, verbose, print_cert);</span>
<span class='curline'><a href='../S/4009.html#L482'>session</a>           482 src/cli.c      		rc = cert_verify(session, host, GNUTLS_KP_TLS_WWW_SERVER);</span>
<span class='curline'><a href='../S/4009.html#L490'>session</a>           490 src/cli.c      		else if (ENABLED_OPT(OCSP) &amp;&amp; gnutls_ocsp_status_request_is_checked(session, 0) == 0) {	/* off-line verification succeeded. Try OCSP */</span>
<span class='curline'><a href='../S/4009.html#L491'>session</a>           491 src/cli.c      			rc = cert_verify_ocsp(session);</span>
<span class='curline'><a href='../S/4009.html#L519'>session</a>           519 src/cli.c      		rc = dane_verify_session_crt(NULL, session, host,</span>
<span class='curline'><a href='../S/4009.html#L555'>session</a>           555 src/cli.c      		cert = gnutls_certificate_get_peers(session, &amp;list_size);</span>
<span class='curline'><a href='../S/4009.html#L628'>session</a>           628 src/cli.c      cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4009.html#L665'>session</a>           665 src/cli.c      	cert_type = gnutls_certificate_type_get2(session, GNUTLS_CTYPE_CLIENT);</span>
<span class='curline'><a href='../S/4009.html#L714'>session</a>           714 src/cli.c      	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4009.html#L717'>session</a>           717 src/cli.c      		gnutls_init(&amp;session, GNUTLS_DATAGRAM | init_flags);</span>
<span class='curline'><a href='../S/4009.html#L719'>session</a>           719 src/cli.c      			gnutls_dtls_set_mtu(session, mtu);</span>
<span class='curline'><a href='../S/4009.html#L721'>session</a>           721 src/cli.c      		gnutls_init(&amp;session, init_flags);</span>
<span class='curline'><a href='../S/4009.html#L724'>session</a>           724 src/cli.c      		ret = gnutls_set_default_priority(session);</span>
<span class='curline'><a href='../S/4009.html#L731'>session</a>           731 src/cli.c      		ret = gnutls_priority_set_direct(session, priorities, &amp;err);</span>
<span class='curline'><a href='../S/4009.html#L749'>session</a>           749 src/cli.c      			gnutls_server_name_set(session, GNUTLS_NAME_DNS, sni_host, strlen(sni_host));</span>
<span class='curline'><a href='../S/4009.html#L751'>session</a>           751 src/cli.c      			gnutls_server_name_set(session, GNUTLS_NAME_DNS,</span>
<span class='curline'><a href='../S/4009.html#L757'>session</a>           757 src/cli.c      		gnutls_dh_set_prime_bits(session, OPT_VALUE_DH_BITS);</span>
<span class='curline'><a href='../S/4009.html#L784'>session</a>           784 src/cli.c      		gnutls_alpn_set_protocols(session, p, proto_n, 0);</span>
<span class='curline'><a href='../S/4009.html#L788'>session</a>           788 src/cli.c      	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anon_cred);</span>
<span class='curline'><a href='../S/4009.html#L790'>session</a>           790 src/cli.c      		gnutls_credentials_set(session, GNUTLS_CRD_SRP, srp_cred);</span>
<span class='curline'><a href='../S/4009.html#L792'>session</a>           792 src/cli.c      		gnutls_credentials_set(session, GNUTLS_CRD_PSK, psk_cred);</span>
<span class='curline'><a href='../S/4009.html#L793'>session</a>           793 src/cli.c      	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4009.html#L801'>session</a>           801 src/cli.c      		if (gnutls_record_set_max_size(session, record_max_size) &lt;</span>
<span class='curline'><a href='../S/4009.html#L813'>session</a>           813 src/cli.c      		gnutls_heartbeat_enable(session,</span>
<span class='curline'><a href='../S/4009.html#L819'>session</a>           819 src/cli.c      		    gnutls_srtp_set_profile_direct(session,</span>
<span class='curline'><a href='../S/4009.html#L835'>session</a>           835 src/cli.c      	return session;</span>
<span class='curline'><a href='../S/4009.html#L866'>session</a>           866 src/cli.c      		alert = gnutls_alert_get(hd-&gt;session);</span>
<span class='curline'><a href='../S/4009.html#L924'>session</a>           924 src/cli.c      			if (gnutls_record_check_pending(hd-&gt;session))</span>
<span class='curline'><a href='../S/4009.html#L976'>session</a>           976 src/cli.c      		ret = gnutls_session_key_update(hd-&gt;session, peer?GNUTLS_KU_PEER:0);</span>
<span class='curline'><a href='../S/4009.html#L994'>session</a>           994 src/cli.c      	if (gnutls_session_is_resumed(hd-&gt;session) == 0) {</span>
<span class='curline'><a href='../S/4009.html#L997'>session</a>           997 src/cli.c      			ret = gnutls_session_get_data2(hd-&gt;session, &amp;rdata);</span>
<span class='curline'><a href='../S/4009.html#L1002'>session</a>          1002 src/cli.c      			if ((gnutls_protocol_get_version(hd-&gt;session) != GNUTLS_TLS1_3) ||</span>
<span class='curline'><a href='../S/4009.html#L1003'>session</a>          1003 src/cli.c      					((gnutls_session_get_flags(hd-&gt;session) &amp;</span>
<span class='curline'><a href='../S/4009.html#L1048'>session</a>          1048 src/cli.c      	if (gnutls_session_is_resumed(hd-&gt;session) != 0)</span>
<span class='curline'><a href='../S/4009.html#L1231'>session</a>          1231 src/cli.c      print_other_info(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4009.html#L1240'>session</a>          1240 src/cli.c      	peers = gnutls_certificate_get_peers(session, &amp;list_size);</span>
<span class='curline'><a href='../S/4009.html#L1246'>session</a>          1246 src/cli.c      		ret = gnutls_ocsp_status_request_get2(session, i, &amp;oresp);</span>
<span class='curline'><a href='../S/4009.html#L1367'>session</a>          1367 src/cli.c      		print_other_info(hd.session);</span>
<span class='curline'><a href='../S/4009.html#L1465'>session</a>          1465 src/cli.c      						ret = gnutls_bye(hd.session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4009.html#L1509'>session</a>          1509 src/cli.c      								   session))</span>
<span class='curline'><a href='../S/4009.html#L1797'>session</a>          1797 src/cli.c      				ret = gnutls_reauth(socket-&gt;session, 0);</span>
<span class='curline'><a href='../S/4009.html#L1815'>session</a>          1815 src/cli.c      		gnutls_transport_set_fastopen(socket-&gt;session, socket-&gt;fd,</span>
<span class='curline'><a href='../S/4009.html#L1820'>session</a>          1820 src/cli.c      		set_read_funcs(socket-&gt;session);</span>
<span class='curline'><a href='../S/4009.html#L1824'>session</a>          1824 src/cli.c      		gnutls_handshake_set_timeout(socket-&gt;session,</span>
<span class='curline'><a href='../S/4009.html#L1826'>session</a>          1826 src/cli.c      		ret = gnutls_handshake(socket-&gt;session);</span>
<span class='curline'><a href='../S/4009.html#L1836'>session</a>          1836 src/cli.c      		print_info(socket-&gt;session, verbose, HAVE_OPT(X509CERTFILE)?P_WAIT_FOR_CERT:0);</span>
<span class='curline'><a href='../S/4009.html#L1838'>session</a>          1838 src/cli.c      			print_key_material(socket-&gt;session,</span>
<span class='curline'><a href='../S/4009.html#L1844'>session</a>          1844 src/cli.c      		gnutls_alert_send_appropriate(socket-&gt;session, ret);</span>
<span class='curline'><a href='../S/4009.html#L1851'>session</a>          1851 src/cli.c      srp_username_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4009.html#L1865'>session</a>          1865 src/cli.c      psk_callback(gnutls_session_t session, char **username,</span>
<span class='curline'><a href='../S/4009.html#L1868'>session</a>          1868 src/cli.c      	const char *hint = gnutls_psk_client_get_hint(session);</span>
<span class='curline'><a href='../S/4009.html#L2071'>session</a>          2071 src/cli.c      static int cert_verify_ocsp(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4009.html#L2084'>session</a>          2084 src/cli.c      	cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/4179.html#L118'>session</a>           118 src/common.c   print_x509_info(gnutls_session_t session, FILE *out, int flag, int print_cert, int print_crt_status)</span>
<span class='curline'><a href='../S/4179.html#L125'>session</a>           125 src/common.c   	cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/4179.html#L186'>session</a>           186 src/common.c   print_rawpk_info(gnutls_session_t session, FILE *out, int flag, int print_cert, int print_crt_status)</span>
<span class='curline'><a href='../S/4179.html#L194'>session</a>           194 src/common.c   	cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/4179.html#L237'>session</a>           237 src/common.c   int cert_verify(gnutls_session_t session, const char *hostname, const char *purpose)</span>
<span class='curline'><a href='../S/4179.html#L260'>session</a>           260 src/common.c   	rc = gnutls_certificate_verify_peers(session, data, elements, &amp;status);</span>
<span class='curline'><a href='../S/4179.html#L272'>session</a>           272 src/common.c   	type = gnutls_certificate_type_get(session);</span>
<span class='curline'><a href='../S/4179.html#L295'>session</a>           295 src/common.c   print_dh_info(gnutls_session_t session, const char *str, int print)</span>
<span class='curline'><a href='../S/4179.html#L309'>session</a>           309 src/common.c   	group = gnutls_group_get(session);</span>
<span class='curline'><a href='../S/4179.html#L316'>session</a>           316 src/common.c   	       gnutls_dh_get_prime_bits(session));</span>
<span class='curline'><a href='../S/4179.html#L318'>session</a>           318 src/common.c   	       gnutls_dh_get_secret_bits(session));</span>
<span class='curline'><a href='../S/4179.html#L320'>session</a>           320 src/common.c   	       gnutls_dh_get_peers_public_bits(session));</span>
<span class='curline'><a href='../S/4179.html#L322'>session</a>           322 src/common.c   	ret = gnutls_dh_get_group(session, &amp;raw_gen, &amp;raw_prime);</span>
<span class='curline'><a href='../S/4179.html#L381'>session</a>           381 src/common.c   static void print_ecdh_info(gnutls_session_t session, const char *str, int print)</span>
<span class='curline'><a href='../S/4179.html#L390'>session</a>           390 src/common.c   	curve = gnutls_ecc_curve_get(session);</span>
<span class='curline'><a href='../S/4179.html#L398'>session</a>           398 src/common.c   int print_info(gnutls_session_t session, int verbose, int flags)</span>
<span class='curline'><a href='../S/4179.html#L411'>session</a>           411 src/common.c   	desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/4179.html#L416'>session</a>           416 src/common.c   	gnutls_session_get_id(session, session_id, &amp;session_id_size);</span>
<span class='curline'><a href='../S/4179.html#L424'>session</a>           424 src/common.c   	kx = gnutls_kx_get(session);</span>
<span class='curline'><a href='../S/4179.html#L426'>session</a>           426 src/common.c   	cred = gnutls_auth_get_type(session);</span>
<span class='curline'><a href='../S/4179.html#L431'>session</a>           431 src/common.c   			print_ecdh_info(session, "Anonymous ", verbose);</span>
<span class='curline'><a href='../S/4179.html#L433'>session</a>           433 src/common.c   			print_dh_info(session, "Anonymous ", verbose);</span>
<span class='curline'><a href='../S/4179.html#L441'>session</a>           441 src/common.c   		if (gnutls_srp_server_get_username(session) != NULL)</span>
<span class='curline'><a href='../S/4179.html#L443'>session</a>           443 src/common.c   			       gnutls_srp_server_get_username(session));</span>
<span class='curline'><a href='../S/4179.html#L450'>session</a>           450 src/common.c   		if (gnutls_psk_client_get_hint(session) != NULL)</span>
<span class='curline'><a href='../S/4179.html#L452'>session</a>           452 src/common.c   			       gnutls_psk_client_get_hint(session));</span>
<span class='curline'><a href='../S/4179.html#L455'>session</a>           455 src/common.c   		if (gnutls_psk_server_get_username(session) != NULL)</span>
<span class='curline'><a href='../S/4179.html#L457'>session</a>           457 src/common.c   			       gnutls_psk_server_get_username(session));</span>
<span class='curline'><a href='../S/4179.html#L459'>session</a>           459 src/common.c   			print_dh_info(session, "Ephemeral ", verbose);</span>
<span class='curline'><a href='../S/4179.html#L461'>session</a>           461 src/common.c   			print_ecdh_info(session, "Ephemeral ", verbose);</span>
<span class='curline'><a href='../S/4179.html#L475'>session</a>           475 src/common.c   			    (session, dns, &amp;dns_size, &amp;type, 0) == 0) {</span>
<span class='curline'><a href='../S/4179.html#L481'>session</a>           481 src/common.c   		if ((flags &amp; P_WAIT_FOR_CERT) &amp;&amp; gnutls_certificate_get_ours(session) == 0)</span>
<span class='curline'><a href='../S/4179.html#L485'>session</a>           485 src/common.c   			print_cert_info(session, verbose, (flags&amp;P_PRINT_CERT));</span>
<span class='curline'><a href='../S/4179.html#L488'>session</a>           488 src/common.c   			print_dh_info(session, "Ephemeral ", verbose);</span>
<span class='curline'><a href='../S/4179.html#L491'>session</a>           491 src/common.c   			print_ecdh_info(session, "Ephemeral ", verbose);</span>
<span class='curline'><a href='../S/4179.html#L496'>session</a>           496 src/common.c   		version = gnutls_protocol_get_version(session);</span>
<span class='curline'><a href='../S/4179.html#L506'>session</a>           506 src/common.c   		if (gnutls_sign_algorithm_get(session) != GNUTLS_SIGN_UNKNOWN) {</span>
<span class='curline'><a href='../S/4179.html#L509'>session</a>           509 src/common.c   			       (gnutls_sign_algorithm_get(session)));</span>
<span class='curline'><a href='../S/4179.html#L513'>session</a>           513 src/common.c   		if (gnutls_sign_algorithm_get_client(session) !=</span>
<span class='curline'><a href='../S/4179.html#L517'>session</a>           517 src/common.c   			       (gnutls_sign_algorithm_get_client(session)));</span>
<span class='curline'><a href='../S/4179.html#L521'>session</a>           521 src/common.c   		tmp = SU(gnutls_cipher_get_name(gnutls_cipher_get(session)));</span>
<span class='curline'><a href='../S/4179.html#L524'>session</a>           524 src/common.c   		tmp = SU(gnutls_mac_get_name(gnutls_mac_get(session)));</span>
<span class='curline'><a href='../S/4179.html#L529'>session</a>           529 src/common.c   	if (gnutls_session_ext_master_secret_status(session)!=0)</span>
<span class='curline'><a href='../S/4179.html#L531'>session</a>           531 src/common.c   	if (gnutls_safe_renegotiation_status(session)!=0)</span>
<span class='curline'><a href='../S/4179.html#L533'>session</a>           533 src/common.c   	if (gnutls_session_etm_status(session)!=0)</span>
<span class='curline'><a href='../S/4179.html#L536'>session</a>           536 src/common.c   	if (gnutls_ocsp_status_request_is_checked(session, GNUTLS_OCSP_SR_IS_AVAIL)!=0) {</span>
<span class='curline'><a href='../S/4179.html#L537'>session</a>           537 src/common.c   		log_msg(stdout, " OCSP status request%s,", gnutls_ocsp_status_request_is_checked(session,0)!=0?"":"[ignored]");</span>
<span class='curline'><a href='../S/4179.html#L543'>session</a>           543 src/common.c   	rc = gnutls_srtp_get_selected_profile(session, &amp;srtp_profile);</span>
<span class='curline'><a href='../S/4179.html#L550'>session</a>           550 src/common.c   	rc = gnutls_alpn_get_selected_protocol(session, &amp;p);</span>
<span class='curline'><a href='../S/4179.html#L558'>session</a>           558 src/common.c   		rc = gnutls_session_channel_binding(session,</span>
<span class='curline'><a href='../S/4179.html#L580'>session</a>           580 src/common.c   void print_cert_info(gnutls_session_t session, int verbose, int print_cert)</span>
<span class='curline'><a href='../S/4179.html#L582'>session</a>           582 src/common.c   	print_cert_info2(session, verbose, stdout, print_cert);</span>
<span class='curline'><a href='../S/4179.html#L585'>session</a>           585 src/common.c   void print_cert_info2(gnutls_session_t session, int verbose, FILE *out, int print_cert)</span>
<span class='curline'><a href='../S/4179.html#L594'>session</a>           594 src/common.c   	if (gnutls_certificate_client_get_request_status(session) != 0) {</span>
<span class='curline'><a href='../S/4179.html#L599'>session</a>           599 src/common.c   	switch (gnutls_certificate_type_get2(session, GNUTLS_CTYPE_PEERS)) {</span>
<span class='curline'><a href='../S/4179.html#L601'>session</a>           601 src/common.c   		print_x509_info(session, out, flag, print_cert, print_crt_status);</span>
<span class='curline'><a href='../S/4179.html#L604'>session</a>           604 src/common.c   		print_rawpk_info(session, out, flag, print_cert, print_crt_status);</span>
<span class='curline'><a href='../S/4179.html#L936'>session</a>           936 src/common.c   print_key_material(gnutls_session_t session, const char *label, size_t size)</span>
<span class='curline'><a href='../S/4179.html#L950'>session</a>           950 src/common.c   	ret = gnutls_prf_rfc5705(session, strlen(label), label,</span>
<span class='curline'><a href='../S/4179.html#L972'>session</a>           972 src/common.c   int check_command(gnutls_session_t session, const char *str, unsigned no_cli_cert)</span>
<span class='curline'><a href='../S/4179.html#L985'>session</a>           985 src/common.c   			gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/4179.html#L992'>session</a>           992 src/common.c   				gnutls_certificate_server_set_request(session, GNUTLS_CERT_REQUIRE);</span>
<span class='curline'><a href='../S/4179.html#L997'>session</a>           997 src/common.c   				ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/4179.html#L1010'>session</a>          1010 src/common.c   			    gnutls_heartbeat_ping(session, 300, 5,</span>
<span class='curline'><a href='../S/4260.html#L72'>session</a>            72 src/common.h   int cert_verify(gnutls_session_t session, const char *hostname, const char *purpose);</span>
<span class='curline'><a href='../S/4260.html#L77'>session</a>            77 src/common.h   int check_command(gnutls_session_t session, const char *str, unsigned no_cli_cert);</span>
<span class='curline'><a href='../S/4260.html#L137'>session</a>           137 src/common.h   void set_read_funcs(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4260.html#L139'>session</a>           139 src/common.h   	gnutls_transport_set_push_function(session, system_write);</span>
<span class='curline'><a href='../S/4260.html#L140'>session</a>           140 src/common.h   	gnutls_transport_set_pull_function(session, system_read);</span>
<span class='curline'><a href='../S/4260.html#L141'>session</a>           141 src/common.h   	gnutls_transport_set_pull_timeout_function(session, system_recv_timeout);</span>
<span class='curline'><a href='../S/4253.html#L594'>session</a>           594 src/danetool.c static int cert_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4253.html#L603'>session</a>           603 src/danetool.c 	cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/4253.html#L609'>session</a>           609 src/danetool.c 	priv = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/4253.html#L633'>session</a>           633 src/danetool.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4253.html#L640'>session</a>           640 src/danetool.c 	ret = gnutls_init(&amp;session, (udp?GNUTLS_DATAGRAM:0)|GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4253.html#L646'>session</a>           646 src/danetool.c 	gnutls_session_set_ptr(session, &amp;priv);</span>
<span class='curline'><a href='../S/4253.html#L648'>session</a>           648 src/danetool.c 	ret = gnutls_set_default_priority(session);</span>
<span class='curline'><a href='../S/4253.html#L656'>session</a>           656 src/danetool.c 		gnutls_server_name_set(session, GNUTLS_NAME_DNS, hostname, strlen(hostname));</span>
<span class='curline'><a href='../S/4253.html#L658'>session</a>           658 src/danetool.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4253.html#L660'>session</a>           660 src/danetool.c 	return session;</span>
<span class='curline'><a href='../S/4253.html#L668'>session</a>           668 src/danetool.c 		ret = gnutls_handshake(socket-&gt;session);</span>
<span class='curline'><a href='../S/4253.html#L730'>session</a>           730 src/danetool.c 	priv = gnutls_session_get_ptr(hd.session);</span>
<span class='curline'><a href='../S/3984.html#L260'>session</a>           260 src/serv.c     get_params(gnutls_session_t session, gnutls_params_type_t type,</span>
<span class='curline'><a href='../S/3984.html#L279'>session</a>           279 src/serv.c     static int cert_verify_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/3984.html#L281'>session</a>           281 src/serv.c     listener_item * j = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/3984.html#L285'>session</a>           285 src/serv.c     	if (gnutls_auth_get_type(session) == GNUTLS_CRD_CERTIFICATE) {</span>
<span class='curline'><a href='../S/3984.html#L286'>session</a>           286 src/serv.c     		if (!require_cert &amp;&amp; gnutls_certificate_get_peers(session, &amp;size) == NULL)</span>
<span class='curline'><a href='../S/3984.html#L290'>session</a>           290 src/serv.c     			if (cert_verify(session, NULL, NULL) == 0) {</span>
<span class='curline'><a href='../S/3984.html#L292'>session</a>           292 src/serv.c     					ret = gnutls_alert_send(session, GNUTLS_AL_FATAL, GNUTLS_A_ACCESS_DENIED);</span>
<span class='curline'><a href='../S/3984.html#L309'>session</a>           309 src/serv.c     post_client_hello(gnutls_session_t session)</span>
<span class='curline'><a href='../S/3984.html#L323'>session</a>           323 src/serv.c     		ret = gnutls_server_name_get(session, name, &amp;len, &amp;type, i);</span>
<span class='curline'><a href='../S/3984.html#L371'>session</a>           371 src/serv.c     		ret = gnutls_alert_send(session,</span>
<span class='curline'><a href='../S/3984.html#L385'>session</a>           385 src/serv.c     	gnutls_session_t session;</span>
<span class='curline'><a href='../S/3984.html#L401'>session</a>           401 src/serv.c     	gnutls_init(&amp;session, flags);</span>
<span class='curline'><a href='../S/3984.html#L405'>session</a>           405 src/serv.c     	gnutls_handshake_set_private_extensions(session, 1);</span>
<span class='curline'><a href='../S/3984.html#L407'>session</a>           407 src/serv.c     	gnutls_handshake_set_timeout(session,</span>
<span class='curline'><a href='../S/3984.html#L411'>session</a>           411 src/serv.c     		gnutls_db_set_retrieve_function(session, wrap_db_fetch);</span>
<span class='curline'><a href='../S/3984.html#L412'>session</a>           412 src/serv.c     		gnutls_db_set_remove_function(session, wrap_db_delete);</span>
<span class='curline'><a href='../S/3984.html#L413'>session</a>           413 src/serv.c     		gnutls_db_set_store_function(session, wrap_db_store);</span>
<span class='curline'><a href='../S/3984.html#L414'>session</a>           414 src/serv.c     		gnutls_db_set_ptr(session, NULL);</span>
<span class='curline'><a href='../S/3984.html#L418'>session</a>           418 src/serv.c     		gnutls_session_ticket_enable_server(session,</span>
<span class='curline'><a href='../S/3984.html#L422'>session</a>           422 src/serv.c     		gnutls_anti_replay_enable(session, anti_replay);</span>
<span class='curline'><a href='../S/3984.html#L424'>session</a>           424 src/serv.c     			ret = gnutls_record_set_max_early_data_size(session, OPT_VALUE_MAXEARLYDATA);</span>
<span class='curline'><a href='../S/3984.html#L433'>session</a>           433 src/serv.c     		gnutls_handshake_set_post_client_hello_function(session,</span>
<span class='curline'><a href='../S/3984.html#L437'>session</a>           437 src/serv.c     		ret = gnutls_set_default_priority(session);</span>
<span class='curline'><a href='../S/3984.html#L443'>session</a>           443 src/serv.c     		ret = gnutls_priority_set_direct(session, priorities, &amp;err);</span>
<span class='curline'><a href='../S/3984.html#L462'>session</a>           462 src/serv.c     	ret = gnutls_alpn_set_protocols(session, alpn, alpn_size, HAVE_OPT(ALPN_FATAL)?GNUTLS_ALPN_MANDATORY:0);</span>
<span class='curline'><a href='../S/3984.html#L470'>session</a>           470 src/serv.c     	gnutls_credentials_set(session, GNUTLS_CRD_ANON, dh_cred);</span>
<span class='curline'><a href='../S/3984.html#L474'>session</a>           474 src/serv.c     		gnutls_credentials_set(session, GNUTLS_CRD_SRP, srp_cred);</span>
<span class='curline'><a href='../S/3984.html#L477'>session</a>           477 src/serv.c     		gnutls_credentials_set(session, GNUTLS_CRD_PSK, psk_cred);</span>
<span class='curline'><a href='../S/3984.html#L483'>session</a>           483 src/serv.c     		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/3984.html#L488'>session</a>           488 src/serv.c     		gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/3984.html#L492'>session</a>           492 src/serv.c     			gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/3984.html#L495'>session</a>           495 src/serv.c     			gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/3984.html#L501'>session</a>           501 src/serv.c     		if (gnutls_record_set_max_recv_size(session, record_max_size) &lt;</span>
<span class='curline'><a href='../S/3984.html#L511'>session</a>           511 src/serv.c     		gnutls_heartbeat_enable(session,</span>
<span class='curline'><a href='../S/3984.html#L517'>session</a>           517 src/serv.c     		    gnutls_srtp_set_profile_direct(session,</span>
<span class='curline'><a href='../S/3984.html#L533'>session</a>           533 src/serv.c     	return session;</span>
<span class='curline'><a href='../S/3984.html#L547'>session</a>           547 src/serv.c     static char *peer_print_info(gnutls_session_t session, int *ret_length,</span>
<span class='curline'><a href='../S/3984.html#L576'>session</a>           576 src/serv.c     	if (gnutls_certificate_type_get2(session, GNUTLS_CTYPE_CLIENT) == GNUTLS_CRT_X509) {</span>
<span class='curline'><a href='../S/3984.html#L581'>session</a>           581 src/serv.c     		    gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/3984.html#L626'>session</a>           626 src/serv.c     	version = gnutls_protocol_get_version(session);</span>
<span class='curline'><a href='../S/3984.html#L630'>session</a>           630 src/serv.c     	gnutls_session_get_id(session, sesid, &amp;sesid_size);</span>
<span class='curline'><a href='../S/3984.html#L648'>session</a>           648 src/serv.c     		    (session, dns, &amp;dns_size, &amp;type, 0) == 0) {</span>
<span class='curline'><a href='../S/3984.html#L655'>session</a>           655 src/serv.c     	kx_alg = gnutls_kx_get(session);</span>
<span class='curline'><a href='../S/3984.html#L662'>session</a>           662 src/serv.c     			 gnutls_srp_server_get_username(session));</span>
<span class='curline'><a href='../S/3984.html#L667'>session</a>           667 src/serv.c     	if (kx_alg == GNUTLS_KX_PSK &amp;&amp; gnutls_psk_server_get_username(session)) {</span>
<span class='curline'><a href='../S/3984.html#L670'>session</a>           670 src/serv.c     			 gnutls_psk_server_get_username(session));</span>
<span class='curline'><a href='../S/3984.html#L686'>session</a>           686 src/serv.c     	desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/3984.html#L694'>session</a>           694 src/serv.c     	if (gnutls_auth_get_type(session) == GNUTLS_CRD_CERTIFICATE &amp;&amp;</span>
<span class='curline'><a href='../S/3984.html#L695'>session</a>           695 src/serv.c     	    gnutls_certificate_type_get2(session, GNUTLS_CTYPE_CLIENT) != GNUTLS_CRT_X509) {</span>
<span class='curline'><a href='../S/3984.html#L698'>session</a>           698 src/serv.c     		    (gnutls_certificate_type_get2(session, GNUTLS_CTYPE_CLIENT));</span>
<span class='curline'><a href='../S/3984.html#L717'>session</a>           717 src/serv.c     				 gnutls_dh_get_prime_bits(session));</span>
<span class='curline'><a href='../S/3984.html#L725'>session</a>           725 src/serv.c     				 gnutls_dh_get_prime_bits(session));</span>
<span class='curline'><a href='../S/3984.html#L729'>session</a>           729 src/serv.c     		tmp = gnutls_compression_get_name(gnutls_compression_get(session));</span>
<span class='curline'><a href='../S/3984.html#L736'>session</a>           736 src/serv.c     						   gnutls_cipher_get(session),</span>
<span class='curline'><a href='../S/3984.html#L737'>session</a>           737 src/serv.c     						   gnutls_mac_get(session));</span>
<span class='curline'><a href='../S/3984.html#L745'>session</a>           745 src/serv.c     	tmp = gnutls_cipher_get_name(gnutls_cipher_get(session));</span>
<span class='curline'><a href='../S/3984.html#L751'>session</a>           751 src/serv.c     	tmp = gnutls_mac_get_name(gnutls_mac_get(session));</span>
<span class='curline'><a href='../S/3984.html#L775'>session</a>           775 src/serv.c     static char *peer_print_data(gnutls_session_t session, int *ret_length)</span>
<span class='curline'><a href='../S/3984.html#L1033'>session</a>          1033 src/serv.c     get_response(gnutls_session_t session, char *request,</span>
<span class='curline'><a href='../S/3984.html#L1056'>session</a>          1056 src/serv.c     			*response = peer_print_info(session, response_length, h);</span>
<span class='curline'><a href='../S/3984.html#L1058'>session</a>          1058 src/serv.c     			*response = peer_print_data(session, response_length);</span>
<span class='curline'><a href='../S/3984.html#L1064'>session</a>          1064 src/serv.c     		ret = check_command(session, request, disable_client_cert);</span>
<span class='curline'><a href='../S/3984.html#L1083'>session</a>          1083 src/serv.c     				ret = gnutls_alert_send_appropriate(session, ret);</span>
<span class='curline'><a href='../S/3984.html#L1108'>session</a>          1108 src/serv.c     static void check_alert(gnutls_session_t session, int ret)</span>
<span class='curline'><a href='../S/3984.html#L1112'>session</a>          1112 src/serv.c     		int last_alert = gnutls_alert_get(session);</span>
<span class='curline'><a href='../S/3984.html#L1128'>session</a>          1128 src/serv.c     static void tls_audit_log_func(gnutls_session_t session, const char *str)</span>
<span class='curline'><a href='../S/3984.html#L1130'>session</a>          1130 src/serv.c     	fprintf(stderr, "|&lt;%p&gt;| %s", session, str);</span>
<span class='curline'><a href='../S/3995.html#L60'>session</a>            60 src/socket.c   			    gnutls_record_recv(socket-&gt;session, buffer,</span>
<span class='curline'><a href='../S/3995.html#L63'>session</a>            63 src/socket.c   				gnutls_heartbeat_pong(socket-&gt;session, 0);</span>
<span class='curline'><a href='../S/3995.html#L83'>session</a>            83 src/socket.c   		gnutls_record_set_timeout(socket-&gt;session, ms);</span>
<span class='curline'><a href='../S/3995.html#L87'>session</a>            87 src/socket.c   		gnutls_record_set_timeout(socket-&gt;session, 0);</span>
<span class='curline'><a href='../S/3995.html#L109'>session</a>           109 src/socket.c   				    gnutls_record_send(socket-&gt;session,</span>
<span class='curline'><a href='../S/3995.html#L115'>session</a>           115 src/socket.c   							     session,</span>
<span class='curline'><a href='../S/3995.html#L360'>session</a>           360 src/socket.c   	if (socket-&gt;secure &amp;&amp; socket-&gt;session) {</span>
<span class='curline'><a href='../S/3995.html#L363'>session</a>           363 src/socket.c   				ret = gnutls_bye(socket-&gt;session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/3995.html#L372'>session</a>           372 src/socket.c   	if (socket-&gt;session) {</span>
<span class='curline'><a href='../S/3995.html#L373'>session</a>           373 src/socket.c   		gnutls_deinit(socket-&gt;session);</span>
<span class='curline'><a href='../S/3995.html#L374'>session</a>           374 src/socket.c   		socket-&gt;session = NULL;</span>
<span class='curline'><a href='../S/3995.html#L565'>session</a>           565 src/socket.c   			hd-&gt;session = init_tls_session(hostname);</span>
<span class='curline'><a href='../S/3995.html#L566'>session</a>           566 src/socket.c   			if (hd-&gt;session == NULL) {</span>
<span class='curline'><a href='../S/3995.html#L572'>session</a>           572 src/socket.c   		if (hd-&gt;session) {</span>
<span class='curline'><a href='../S/3995.html#L574'>session</a>           574 src/socket.c   				ret = gnutls_record_send_early_data(hd-&gt;session, hd-&gt;edata.data, hd-&gt;edata.size);</span>
<span class='curline'><a href='../S/3995.html#L581'>session</a>           581 src/socket.c   				gnutls_session_set_data(hd-&gt;session, hd-&gt;rdata.data, hd-&gt;rdata.size);</span>
<span class='curline'><a href='../S/3995.html#L590'>session</a>           590 src/socket.c   			gnutls_transport_set_push_function(hd-&gt;session, wrap_push);</span>
<span class='curline'><a href='../S/3995.html#L591'>session</a>           591 src/socket.c   			gnutls_transport_set_pull_function(hd-&gt;session, wrap_pull);</span>
<span class='curline'><a href='../S/3995.html#L592'>session</a>           592 src/socket.c   			gnutls_transport_set_pull_timeout_function(hd-&gt;session, wrap_pull_timeout_func);</span>
<span class='curline'><a href='../S/3995.html#L593'>session</a>           593 src/socket.c   			gnutls_transport_set_ptr(hd-&gt;session, hd);</span>
<span class='curline'><a href='../S/3995.html#L599'>session</a>           599 src/socket.c   				gnutls_deinit(hd-&gt;session);</span>
<span class='curline'><a href='../S/3995.html#L600'>session</a>           600 src/socket.c   				hd-&gt;session = NULL;</span>
<span class='curline'><a href='../S/4182.html#L18'>session</a>            18 src/socket.h   	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4004.html#L38'>session</a>            38 src/tests.c    void _gnutls_record_set_default_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4004.html#L42'>session</a>            42 src/tests.c    void _gnutls_hello_set_default_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4004.html#L69'>session</a>            69 src/tests.c    static int test_do_handshake(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L74'>session</a>            74 src/tests.c    		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L82'>session</a>            82 src/tests.c    			alert = gnutls_alert_get(session);</span>
<span class='curline'><a href='../S/4004.html#L91'>session</a>            91 src/tests.c    	gnutls_session_get_data(session, NULL, &amp;session_data_size);</span>
<span class='curline'><a href='../S/4004.html#L103'>session</a>           103 src/tests.c    	gnutls_session_get_data(session, session_data, &amp;session_data_size);</span>
<span class='curline'><a href='../S/4004.html#L106'>session</a>           106 src/tests.c    	gnutls_session_get_id(session, session_id, &amp;session_id_size);</span>
<span class='curline'><a href='../S/4004.html#L148'>session</a>           148 src/tests.c    __gnutls_priority_set_direct(gnutls_session_t session, const char *str, int line)</span>
<span class='curline'><a href='../S/4004.html#L151'>session</a>           151 src/tests.c    	int ret = gnutls_priority_set_direct(session, str, &amp;err);</span>
<span class='curline'><a href='../S/4004.html#L167'>session</a>           167 src/tests.c    test_code_t test_server(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L179'>session</a>           179 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L181'>session</a>           181 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L183'>session</a>           183 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L187'>session</a>           187 src/tests.c    	gnutls_record_send(session, snd_buf, sizeof(snd_buf) - 1);</span>
<span class='curline'><a href='../S/4004.html#L188'>session</a>           188 src/tests.c    	ret = gnutls_record_recv(session, buf, sizeof(buf) - 1);</span>
<span class='curline'><a href='../S/4004.html#L212'>session</a>           212 src/tests.c    test_code_t test_dhe(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L220'>session</a>           220 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L222'>session</a>           222 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L224'>session</a>           224 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L226'>session</a>           226 src/tests.c    	gnutls_dh_get_pubkey(session, &amp;pubkey);</span>
<span class='curline'><a href='../S/4004.html#L233'>session</a>           233 src/tests.c    test_code_t test_rfc7919(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L241'>session</a>           241 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L243'>session</a>           243 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L245'>session</a>           245 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L247'>session</a>           247 src/tests.c    	if (ret != TEST_FAILED &amp;&amp; (gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_RFC7919))</span>
<span class='curline'><a href='../S/4004.html#L255'>session</a>           255 src/tests.c    test_code_t test_ecdhe(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L266'>session</a>           266 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L268'>session</a>           268 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L270'>session</a>           270 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L279'>session</a>           279 src/tests.c    test_code_t test_vko_gost_12(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L290'>session</a>           290 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L292'>session</a>           292 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L294'>session</a>           294 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L303'>session</a>           303 src/tests.c    test_code_t test_rsa(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L314'>session</a>           314 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L316'>session</a>           316 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L318'>session</a>           318 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L327'>session</a>           327 src/tests.c    test_code_t test_ecdhe_curve(gnutls_session_t session, const char *curve, unsigned id)</span>
<span class='curline'><a href='../S/4004.html#L339'>session</a>           339 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L341'>session</a>           341 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L343'>session</a>           343 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L348'>session</a>           348 src/tests.c    	if (gnutls_ecc_curve_get(session) != id)</span>
<span class='curline'><a href='../S/4004.html#L354'>session</a>           354 src/tests.c    test_code_t test_ecdhe_secp256r1(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L356'>session</a>           356 src/tests.c    	return test_ecdhe_curve(session, "+CURVE-SECP256R1", GNUTLS_ECC_CURVE_SECP256R1);</span>
<span class='curline'><a href='../S/4004.html#L359'>session</a>           359 src/tests.c    test_code_t test_ecdhe_secp384r1(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L361'>session</a>           361 src/tests.c    	return test_ecdhe_curve(session, "+CURVE-SECP384R1", GNUTLS_ECC_CURVE_SECP384R1);</span>
<span class='curline'><a href='../S/4004.html#L364'>session</a>           364 src/tests.c    test_code_t test_ecdhe_secp521r1(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L366'>session</a>           366 src/tests.c    	return test_ecdhe_curve(session, "+CURVE-SECP521R1", GNUTLS_ECC_CURVE_SECP521R1);</span>
<span class='curline'><a href='../S/4004.html#L369'>session</a>           369 src/tests.c    test_code_t test_ecdhe_x25519(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L371'>session</a>           371 src/tests.c    	return test_ecdhe_curve(session, "+CURVE-X25519", GNUTLS_ECC_CURVE_X25519);</span>
<span class='curline'><a href='../S/4004.html#L374'>session</a>           374 src/tests.c    test_code_t test_rfc7507(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L393'>session</a>           393 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L395'>session</a>           395 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L397'>session</a>           397 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L408'>session</a>           408 src/tests.c    test_code_t test_safe_renegotiation(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L418'>session</a>           418 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L420'>session</a>           420 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L422'>session</a>           422 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L428'>session</a>           428 src/tests.c    test_code_t test_ocsp_status(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L439'>session</a>           439 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L441'>session</a>           441 src/tests.c    	gnutls_ocsp_status_request_enable_client(session, NULL, 0, NULL);</span>
<span class='curline'><a href='../S/4004.html#L443'>session</a>           443 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L445'>session</a>           445 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L450'>session</a>           450 src/tests.c    	ret = gnutls_ocsp_status_request_get(session, &amp;resp);</span>
<span class='curline'><a href='../S/4004.html#L460'>session</a>           460 src/tests.c    test_code_t test_ext_master_secret(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L470'>session</a>           470 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L472'>session</a>           472 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L474'>session</a>           474 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L479'>session</a>           479 src/tests.c    	if (gnutls_session_ext_master_secret_status(session) != 0)</span>
<span class='curline'><a href='../S/4004.html#L485'>session</a>           485 src/tests.c    test_code_t test_etm(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L495'>session</a>           495 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L497'>session</a>           497 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L499'>session</a>           499 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L504'>session</a>           504 src/tests.c    	if (gnutls_session_etm_status(session) != 0)</span>
<span class='curline'><a href='../S/4004.html#L510'>session</a>           510 src/tests.c    test_code_t test_safe_renegotiation_scsv(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L520'>session</a>           520 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L522'>session</a>           522 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L524'>session</a>           524 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L529'>session</a>           529 src/tests.c    test_code_t test_dhe_group(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L544'>session</a>           544 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L546'>session</a>           546 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L548'>session</a>           548 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L550'>session</a>           550 src/tests.c    	ret2 = gnutls_dh_get_group(session, &amp;gen, &amp;prime);</span>
<span class='curline'><a href='../S/4004.html#L571'>session</a>           571 src/tests.c    		gnutls_dh_get_pubkey(session, &amp;pubkey2);</span>
<span class='curline'><a href='../S/4004.html#L610'>session</a>           610 src/tests.c    test_code_t test_ssl3(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L616'>session</a>           616 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L618'>session</a>           618 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L620'>session</a>           620 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L627'>session</a>           627 src/tests.c    test_code_t test_ssl3_with_extensions(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L633'>session</a>           633 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L635'>session</a>           635 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L637'>session</a>           637 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L652'>session</a>           652 src/tests.c    test_code_t test_ssl3_unknown_ciphersuites(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L658'>session</a>           658 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L660'>session</a>           660 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L662'>session</a>           662 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L675'>session</a>           675 src/tests.c    test_code_t test_bye(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L689'>session</a>           689 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L691'>session</a>           691 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L693'>session</a>           693 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L697'>session</a>           697 src/tests.c    	ret = gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4004.html#L705'>session</a>           705 src/tests.c    	setsockopt((int) gnutls_transport_get_ptr(session), SOL_SOCKET,</span>
<span class='curline'><a href='../S/4004.html#L710'>session</a>           710 src/tests.c    		ret = gnutls_record_recv(session, data, sizeof(data));</span>
<span class='curline'><a href='../S/4004.html#L732'>session</a>           732 src/tests.c    test_code_t test_aes(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L739'>session</a>           739 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L741'>session</a>           741 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L743'>session</a>           743 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L747'>session</a>           747 src/tests.c    test_code_t test_aes_gcm(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L755'>session</a>           755 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L757'>session</a>           757 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L759'>session</a>           759 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L763'>session</a>           763 src/tests.c    test_code_t test_aes_ccm(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L771'>session</a>           771 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L773'>session</a>           773 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L775'>session</a>           775 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L779'>session</a>           779 src/tests.c    test_code_t test_aes_ccm_8(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L787'>session</a>           787 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L789'>session</a>           789 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L791'>session</a>           791 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L795'>session</a>           795 src/tests.c    test_code_t test_camellia_cbc(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L805'>session</a>           805 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L808'>session</a>           808 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L810'>session</a>           810 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L814'>session</a>           814 src/tests.c    test_code_t test_camellia_gcm(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L824'>session</a>           824 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L826'>session</a>           826 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L828'>session</a>           828 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L832'>session</a>           832 src/tests.c    test_code_t test_unknown_ciphersuites(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L840'>session</a>           840 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L842'>session</a>           842 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L844'>session</a>           844 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L848'>session</a>           848 src/tests.c    test_code_t test_md5(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L859'>session</a>           859 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L861'>session</a>           861 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L863'>session</a>           863 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L867'>session</a>           867 src/tests.c    test_code_t test_sha(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L875'>session</a>           875 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L876'>session</a>           876 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L878'>session</a>           878 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L882'>session</a>           882 src/tests.c    test_code_t test_sha256(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L890'>session</a>           890 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L891'>session</a>           891 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L893'>session</a>           893 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L898'>session</a>           898 src/tests.c    test_code_t test_gost_imit(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L909'>session</a>           909 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L910'>session</a>           910 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L912'>session</a>           912 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L917'>session</a>           917 src/tests.c    test_code_t test_3des(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L924'>session</a>           924 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L925'>session</a>           925 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L927'>session</a>           927 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L931'>session</a>           931 src/tests.c    test_code_t test_arcfour(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L941'>session</a>           941 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L942'>session</a>           942 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L944'>session</a>           944 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L948'>session</a>           948 src/tests.c    test_code_t test_chacha20(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L958'>session</a>           958 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L959'>session</a>           959 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L961'>session</a>           961 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L966'>session</a>           966 src/tests.c    test_code_t test_gost_cnt(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L976'>session</a>           976 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L977'>session</a>           977 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L979'>session</a>           979 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L984'>session</a>           984 src/tests.c    test_code_t test_tls1(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L991'>session</a>           991 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L993'>session</a>           993 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L995'>session</a>           995 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1003'>session</a>          1003 src/tests.c    test_code_t test_tls1_nossl3(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1013'>session</a>          1013 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1015'>session</a>          1015 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1017'>session</a>          1017 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1027'>session</a>          1027 src/tests.c    test_code_t test_record_padding(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1034'>session</a>          1034 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1036'>session</a>          1036 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1037'>session</a>          1037 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1044'>session</a>          1044 src/tests.c    		_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1046'>session</a>          1046 src/tests.c    		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1047'>session</a>          1047 src/tests.c    		ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1058'>session</a>          1058 src/tests.c    test_code_t test_no_extensions(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1071'>session</a>          1071 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1072'>session</a>          1072 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1073'>session</a>          1073 src/tests.c    	gnutls_record_set_max_size(session, 4096);</span>
<span class='curline'><a href='../S/4004.html#L1075'>session</a>          1075 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1082'>session</a>          1082 src/tests.c    		_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1084'>session</a>          1084 src/tests.c    		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1085'>session</a>          1085 src/tests.c    		ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1096'>session</a>          1096 src/tests.c    test_code_t test_known_protocols(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1105'>session</a>          1105 src/tests.c    test_code_t test_tls1_2(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1112'>session</a>          1112 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1114'>session</a>          1114 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1116'>session</a>          1116 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1124'>session</a>          1124 src/tests.c    test_code_t test_tls1_3(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1131'>session</a>          1131 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1133'>session</a>          1133 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1135'>session</a>          1135 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1143'>session</a>          1143 src/tests.c    test_code_t test_tls1_1(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1150'>session</a>          1150 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1152'>session</a>          1152 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1154'>session</a>          1154 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1162'>session</a>          1162 src/tests.c    test_code_t test_tls1_1_fallback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1172'>session</a>          1172 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1174'>session</a>          1174 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1176'>session</a>          1176 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1180'>session</a>          1180 src/tests.c    	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1)</span>
<span class='curline'><a href='../S/4004.html#L1182'>session</a>          1182 src/tests.c    	else if (gnutls_protocol_get_version(session) == GNUTLS_SSL3)</span>
<span class='curline'><a href='../S/4004.html#L1189'>session</a>          1189 src/tests.c    test_code_t test_tls1_6_fallback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1199'>session</a>          1199 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1201'>session</a>          1201 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1202'>session</a>          1202 src/tests.c    	_gnutls_hello_set_default_version(session, 3, 7);</span>
<span class='curline'><a href='../S/4004.html#L1204'>session</a>          1204 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1208'>session</a>          1208 src/tests.c    	ext_text = gnutls_protocol_get_name(gnutls_protocol_get_version(session));</span>
<span class='curline'><a href='../S/4004.html#L1215'>session</a>          1215 src/tests.c    test_code_t test_tls_disable0(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1224'>session</a>          1224 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1226'>session</a>          1226 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1228'>session</a>          1228 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1239'>session</a>          1239 src/tests.c    test_code_t test_tls_disable1(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1249'>session</a>          1249 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1251'>session</a>          1251 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1253'>session</a>          1253 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1261'>session</a>          1261 src/tests.c    test_code_t test_tls_disable2(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1271'>session</a>          1271 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1273'>session</a>          1273 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1275'>session</a>          1275 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1284'>session</a>          1284 src/tests.c    test_code_t test_rsa_pms(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1296'>session</a>          1296 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1297'>session</a>          1297 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1299'>session</a>          1299 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1303'>session</a>          1303 src/tests.c    	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1)</span>
<span class='curline'><a href='../S/4004.html#L1308'>session</a>          1308 src/tests.c    test_code_t test_max_record_size(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1318'>session</a>          1318 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1319'>session</a>          1319 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1320'>session</a>          1320 src/tests.c    	gnutls_record_set_max_size(session, 512);</span>
<span class='curline'><a href='../S/4004.html#L1322'>session</a>          1322 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1326'>session</a>          1326 src/tests.c    	ret = gnutls_record_get_max_size(session);</span>
<span class='curline'><a href='../S/4004.html#L1333'>session</a>          1333 src/tests.c    test_code_t test_heartbeat_extension(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1341'>session</a>          1341 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1342'>session</a>          1342 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1343'>session</a>          1343 src/tests.c    	gnutls_record_set_max_size(session, 4096);</span>
<span class='curline'><a href='../S/4004.html#L1345'>session</a>          1345 src/tests.c    	gnutls_heartbeat_enable(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND);</span>
<span class='curline'><a href='../S/4004.html#L1346'>session</a>          1346 src/tests.c    	test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1348'>session</a>          1348 src/tests.c    	switch (gnutls_heartbeat_allowed(session, GNUTLS_HB_LOCAL_ALLOWED_TO_SEND)) {</span>
<span class='curline'><a href='../S/4004.html#L1356'>session</a>          1356 src/tests.c    test_code_t test_small_records(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1363'>session</a>          1363 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1364'>session</a>          1364 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1365'>session</a>          1365 src/tests.c    	gnutls_record_set_max_size(session, 512);</span>
<span class='curline'><a href='../S/4004.html#L1367'>session</a>          1367 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1371'>session</a>          1371 src/tests.c    test_code_t test_version_rollback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1387'>session</a>          1387 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1388'>session</a>          1388 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1389'>session</a>          1389 src/tests.c    	_gnutls_record_set_default_version(session, 3, 0);</span>
<span class='curline'><a href='../S/4004.html#L1391'>session</a>          1391 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1396'>session</a>          1396 src/tests.c    	    &amp;&amp; gnutls_protocol_get_version(session) == GNUTLS_SSL3)</span>
<span class='curline'><a href='../S/4004.html#L1406'>session</a>          1406 src/tests.c    test_code_t test_version_oob(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1415'>session</a>          1415 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1416'>session</a>          1416 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1417'>session</a>          1417 src/tests.c    	_gnutls_record_set_default_version(session, 5, 5);</span>
<span class='curline'><a href='../S/4004.html#L1419'>session</a>          1419 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1423'>session</a>          1423 src/tests.c    void _gnutls_rsa_pms_set_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4004.html#L1426'>session</a>          1426 src/tests.c    test_code_t test_rsa_pms_version_check(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1437'>session</a>          1437 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1438'>session</a>          1438 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1439'>session</a>          1439 src/tests.c    	_gnutls_rsa_pms_set_version(session, 5, 5);	/* use SSL 5.5 version */</span>
<span class='curline'><a href='../S/4004.html#L1441'>session</a>          1441 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1447'>session</a>          1447 src/tests.c    test_code_t test_anonymous(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1455'>session</a>          1455 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1456'>session</a>          1456 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anon_cred);</span>
<span class='curline'><a href='../S/4004.html#L1458'>session</a>          1458 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1461'>session</a>          1461 src/tests.c    		gnutls_dh_get_pubkey(session, &amp;pubkey);</span>
<span class='curline'><a href='../S/4004.html#L1467'>session</a>          1467 src/tests.c    test_code_t test_session_resume2(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1473'>session</a>          1473 src/tests.c    	if (session == NULL)</span>
<span class='curline'><a href='../S/4004.html#L1479'>session</a>          1479 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1481'>session</a>          1481 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1482'>session</a>          1482 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anon_cred);</span>
<span class='curline'><a href='../S/4004.html#L1484'>session</a>          1484 src/tests.c    	gnutls_session_set_data(session, session_data, session_data_size);</span>
<span class='curline'><a href='../S/4004.html#L1489'>session</a>          1489 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1496'>session</a>          1496 src/tests.c    	gnutls_session_get_id(session, session_id, &amp;session_id_size);</span>
<span class='curline'><a href='../S/4004.html#L1501'>session</a>          1501 src/tests.c    	if (gnutls_session_is_resumed(session))</span>
<span class='curline'><a href='../S/4004.html#L1513'>session</a>          1513 src/tests.c    test_code_t test_certificate(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1526'>session</a>          1526 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1528'>session</a>          1528 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1530'>session</a>          1530 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1537'>session</a>          1537 src/tests.c    		print_cert_info2(session, GNUTLS_CRT_PRINT_FULL, fp, verbose);</span>
<span class='curline'><a href='../S/4004.html#L1545'>session</a>          1545 src/tests.c    test_code_t test_chain_order(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1559'>session</a>          1559 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1561'>session</a>          1561 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1563'>session</a>          1563 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1567'>session</a>          1567 src/tests.c    	if (gnutls_certificate_type_get(session) != GNUTLS_CRT_X509)</span>
<span class='curline'><a href='../S/4004.html#L1570'>session</a>          1570 src/tests.c    	cert_list = gnutls_certificate_get_peers(session, &amp;cert_list_size);</span>
<span class='curline'><a href='../S/4004.html#L1622'>session</a>          1622 src/tests.c    cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4004.html#L1666'>session</a>          1666 src/tests.c    test_code_t test_server_cas(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1677'>session</a>          1677 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1679'>session</a>          1679 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1682'>session</a>          1682 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1696'>session</a>          1696 src/tests.c    test_do_handshake_and_send_record(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1703'>session</a>          1703 src/tests.c    	ret = test_do_handshake(session);</span>
<span class='curline'><a href='../S/4004.html#L1707'>session</a>          1707 src/tests.c    	gnutls_record_send(session, snd_buf, sizeof(snd_buf) - 1);</span>
<span class='curline'><a href='../S/4004.html#L1708'>session</a>          1708 src/tests.c    	ret = gnutls_record_recv(session, buf, sizeof(buf) - 1);</span>
<span class='curline'><a href='../S/4004.html#L1718'>session</a>          1718 src/tests.c    test_code_t test_send_record(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1725'>session</a>          1725 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1726'>session</a>          1726 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1728'>session</a>          1728 src/tests.c    	ret = test_do_handshake_and_send_record(session);</span>
<span class='curline'><a href='../S/4004.html#L1734'>session</a>          1734 src/tests.c    test_code_t test_send_record_with_allow_small_records(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4004.html#L1746'>session</a>          1746 src/tests.c    	_gnutls_priority_set_direct(session, prio_str);</span>
<span class='curline'><a href='../S/4004.html#L1747'>session</a>          1747 src/tests.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4004.html#L1749'>session</a>          1749 src/tests.c    	ret = test_do_handshake_and_send_record(session);</span>
<span class='curline'><a href='../S/3990.html#L28'>session</a>            28 src/tests.h    test_code_t test_chain_order(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L50'>session</a>            50 src/tests.h    test_code_t test_tls1_nossl3(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L74'>session</a>            74 src/tests.h    test_code_t test_rsa_pms_version_check(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L75'>session</a>            75 src/tests.h    test_code_t test_version_oob(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L76'>session</a>            76 src/tests.h    test_code_t test_send_record(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L77'>session</a>            77 src/tests.h    test_code_t test_send_record_with_allow_small_records(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L78'>session</a>            78 src/tests.h    int _test_srp_username_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/3990.html#L81'>session</a>            81 src/tests.h    test_code_t test_rsa(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L82'>session</a>            82 src/tests.h    test_code_t test_ecdhe_x25519(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L83'>session</a>            83 src/tests.h    test_code_t test_ecdhe_secp521r1(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L84'>session</a>            84 src/tests.h    test_code_t test_ecdhe_secp384r1(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L85'>session</a>            85 src/tests.h    test_code_t test_ecdhe_secp256r1(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L86'>session</a>            86 src/tests.h    test_code_t test_ecdhe(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L87'>session</a>            87 src/tests.h    test_code_t test_aes_gcm(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L88'>session</a>            88 src/tests.h    test_code_t test_aes_ccm(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L89'>session</a>            89 src/tests.h    test_code_t test_aes_ccm_8(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L90'>session</a>            90 src/tests.h    test_code_t test_sha256(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L93'>session</a>            93 src/tests.h    test_code_t test_vko_gost_12(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L94'>session</a>            94 src/tests.h    test_code_t test_gost_cnt(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3990.html#L95'>session</a>            95 src/tests.h    test_code_t test_gost_imit(gnutls_session_t session);</span>
<span class='curline'><a href='../S/3992.html#L45'>session</a>            45 src/udp-serv.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/3992.html#L75'>session</a>            75 src/udp-serv.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/3992.html#L151'>session</a>           151 src/udp-serv.c 		session = initialize_session(1);</span>
<span class='curline'><a href='../S/3992.html#L153'>session</a>           153 src/udp-serv.c 			gnutls_dtls_prestate_set(session, &amp;prestate);</span>
<span class='curline'><a href='../S/3992.html#L156'>session</a>           156 src/udp-serv.c 			gnutls_dtls_set_mtu(session, mtu);</span>
<span class='curline'><a href='../S/3992.html#L158'>session</a>           158 src/udp-serv.c 		priv.session = session;</span>
<span class='curline'><a href='../S/3992.html#L163'>session</a>           163 src/udp-serv.c 		gnutls_transport_set_ptr(session, &amp;priv);</span>
<span class='curline'><a href='../S/3992.html#L164'>session</a>           164 src/udp-serv.c 		gnutls_transport_set_push_function(session, push_func);</span>
<span class='curline'><a href='../S/3992.html#L165'>session</a>           165 src/udp-serv.c 		gnutls_transport_set_pull_function(session, pull_func);</span>
<span class='curline'><a href='../S/3992.html#L166'>session</a>           166 src/udp-serv.c 		gnutls_transport_set_pull_timeout_function(session,</span>
<span class='curline'><a href='../S/3992.html#L170'>session</a>           170 src/udp-serv.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/3992.html#L178'>session</a>           178 src/udp-serv.c 			gnutls_deinit(session);</span>
<span class='curline'><a href='../S/3992.html#L185'>session</a>           185 src/udp-serv.c 				    gnutls_record_recv_seq(session, buffer,</span>
<span class='curline'><a href='../S/3992.html#L190'>session</a>           190 src/udp-serv.c 					gnutls_heartbeat_pong(session, 0);</span>
<span class='curline'><a href='../S/3992.html#L200'>session</a>           200 src/udp-serv.c 					ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/3992.html#L225'>session</a>           225 src/udp-serv.c 			if (check_command(session, buffer, disable_client_cert) == 0) {</span>
<span class='curline'><a href='../S/3992.html#L228'>session</a>           228 src/udp-serv.c 				    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/3992.html#L238'>session</a>           238 src/udp-serv.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/3992.html#L315'>session</a>           315 src/udp-serv.c 	gnutls_transport_set_errno(priv-&gt;session, EAGAIN);</span>
<span class='curline'><a href='../S/5241.html#L74'>session</a>            74 tests/alerts.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5241.html#L89'>session</a>            89 tests/alerts.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5241.html#L92'>session</a>            92 tests/alerts.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/5241.html#L100'>session</a>           100 tests/alerts.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5241.html#L102'>session</a>           102 tests/alerts.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5241.html#L107'>session</a>           107 tests/alerts.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5241.html#L123'>session</a>           123 tests/alerts.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5241.html#L125'>session</a>           125 tests/alerts.c 	ret = gnutls_alert_send(session, GNUTLS_AL_WARNING, GNUTLS_A_USER_CANCELED);</span>
<span class='curline'><a href='../S/5241.html#L131'>session</a>           131 tests/alerts.c 	ret = gnutls_alert_send(session, GNUTLS_AL_FATAL, GNUTLS_A_DECRYPT_ERROR);</span>
<span class='curline'><a href='../S/5241.html#L139'>session</a>           139 tests/alerts.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5241.html#L161'>session</a>           161 tests/alerts.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5241.html#L180'>session</a>           180 tests/alerts.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5241.html#L185'>session</a>           185 tests/alerts.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/5241.html#L191'>session</a>           191 tests/alerts.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5241.html#L193'>session</a>           193 tests/alerts.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5241.html#L196'>session</a>           196 tests/alerts.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5241.html#L201'>session</a>           201 tests/alerts.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5241.html#L212'>session</a>           212 tests/alerts.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5241.html#L216'>session</a>           216 tests/alerts.c 			ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/5241.html#L224'>session</a>           224 tests/alerts.c 	    gnutls_alert_get(session) != GNUTLS_A_USER_CANCELED) {</span>
<span class='curline'><a href='../S/5241.html#L230'>session</a>           230 tests/alerts.c 			ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/5241.html#L238'>session</a>           238 tests/alerts.c 	    gnutls_alert_get(session) != GNUTLS_A_DECRYPT_ERROR) {</span>
<span class='curline'><a href='../S/5241.html#L243'>session</a>           243 tests/alerts.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4361.html#L71'>session</a>            71 tests/alpn-server-prec.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4361.html#L88'>session</a>            88 tests/alpn-server-prec.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4361.html#L91'>session</a>            91 tests/alpn-server-prec.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4361.html#L103'>session</a>           103 tests/alpn-server-prec.c 		ret = gnutls_alpn_set_protocols(session, t, 3, 0);</span>
<span class='curline'><a href='../S/4361.html#L112'>session</a>           112 tests/alpn-server-prec.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4361.html#L114'>session</a>           114 tests/alpn-server-prec.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4361.html#L119'>session</a>           119 tests/alpn-server-prec.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4361.html#L135'>session</a>           135 tests/alpn-server-prec.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4361.html#L137'>session</a>           137 tests/alpn-server-prec.c 	ret = gnutls_alpn_get_selected_protocol(session, &amp;proto);</span>
<span class='curline'><a href='../S/4361.html#L149'>session</a>           149 tests/alpn-server-prec.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4361.html#L153'>session</a>           153 tests/alpn-server-prec.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4361.html#L172'>session</a>           172 tests/alpn-server-prec.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4361.html#L188'>session</a>           188 tests/alpn-server-prec.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4361.html#L193'>session</a>           193 tests/alpn-server-prec.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4361.html#L202'>session</a>           202 tests/alpn-server-prec.c 	ret = gnutls_alpn_set_protocols(session, t, 2, GNUTLS_ALPN_SERVER_PRECEDENCE);</span>
<span class='curline'><a href='../S/4361.html#L208'>session</a>           208 tests/alpn-server-prec.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4361.html#L210'>session</a>           210 tests/alpn-server-prec.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4361.html#L213'>session</a>           213 tests/alpn-server-prec.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4361.html#L218'>session</a>           218 tests/alpn-server-prec.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4361.html#L229'>session</a>           229 tests/alpn-server-prec.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4361.html#L231'>session</a>           231 tests/alpn-server-prec.c 	ret = gnutls_alpn_get_selected_protocol(session, &amp;selected);</span>
<span class='curline'><a href='../S/4361.html#L248'>session</a>           248 tests/alpn-server-prec.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4361.html#L251'>session</a>           251 tests/alpn-server-prec.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4343.html#L68'>session</a>            68 tests/anonself.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4343.html#L83'>session</a>            83 tests/anonself.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4343.html#L86'>session</a>            86 tests/anonself.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4343.html#L92'>session</a>            92 tests/anonself.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4343.html#L94'>session</a>            94 tests/anonself.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4343.html#L98'>session</a>            98 tests/anonself.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4343.html#L110'>session</a>           110 tests/anonself.c 		print_dh_params_info(session);</span>
<span class='curline'><a href='../S/4343.html#L115'>session</a>           115 tests/anonself.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4343.html#L117'>session</a>           117 tests/anonself.c 	ret = gnutls_record_send(session, MSG, sizeof(MSG)-1);</span>
<span class='curline'><a href='../S/4343.html#L123'>session</a>           123 tests/anonself.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4343.html#L148'>session</a>           148 tests/anonself.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4343.html#L154'>session</a>           154 tests/anonself.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4343.html#L169'>session</a>           169 tests/anonself.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4343.html#L191'>session</a>           191 tests/anonself.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/4343.html#L193'>session</a>           193 tests/anonself.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4343.html#L195'>session</a>           195 tests/anonself.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4343.html#L196'>session</a>           196 tests/anonself.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4343.html#L198'>session</a>           198 tests/anonself.c 	gnutls_dh_set_prime_bits(session, DH_BITS);</span>
<span class='curline'><a href='../S/4343.html#L200'>session</a>           200 tests/anonself.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4343.html#L201'>session</a>           201 tests/anonself.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4343.html#L204'>session</a>           204 tests/anonself.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4343.html#L215'>session</a>           215 tests/anonself.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4343.html#L218'>session</a>           218 tests/anonself.c 		print_dh_params_info(session);</span>
<span class='curline'><a href='../S/4343.html#L221'>session</a>           221 tests/anonself.c 		ret = gnutls_record_recv_packet(session, &amp;packet);</span>
<span class='curline'><a href='../S/4343.html#L238'>session</a>           238 tests/anonself.c 			gnutls_record_send(session, pdata.data,</span>
<span class='curline'><a href='../S/4343.html#L245'>session</a>           245 tests/anonself.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4343.html#L248'>session</a>           248 tests/anonself.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4923.html#L75'>session</a>            75 tests/cert-status.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4923.html#L86'>session</a>            86 tests/cert-status.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4923.html#L89'>session</a>            89 tests/cert-status.c 	    gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4923.html#L96'>session</a>            96 tests/cert-status.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4923.html#L98'>session</a>            98 tests/cert-status.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4923.html#L103'>session</a>           103 tests/cert-status.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4923.html#L121'>session</a>           121 tests/cert-status.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4923.html#L125'>session</a>           125 tests/cert-status.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4923.html#L137'>session</a>           137 tests/cert-status.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4923.html#L145'>session</a>           145 tests/cert-status.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4923.html#L147'>session</a>           147 tests/cert-status.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4923.html#L160'>session</a>           160 tests/cert-status.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4923.html#L162'>session</a>           162 tests/cert-status.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4923.html#L163'>session</a>           163 tests/cert-status.c 	gnutls_certificate_server_set_request(session, status);</span>
<span class='curline'><a href='../S/4923.html#L166'>session</a>           166 tests/cert-status.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4923.html#L186'>session</a>           186 tests/cert-status.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4923.html#L189'>session</a>           189 tests/cert-status.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5092.html#L220'>session</a>           220 tests/cipher-alignment.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5092.html#L239'>session</a>           239 tests/cipher-alignment.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5092.html#L241'>session</a>           241 tests/cipher-alignment.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5092.html#L245'>session</a>           245 tests/cipher-alignment.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/5092.html#L247'>session</a>           247 tests/cipher-alignment.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5092.html#L251'>session</a>           251 tests/cipher-alignment.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5092.html#L264'>session</a>           264 tests/cipher-alignment.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5092.html#L268'>session</a>           268 tests/cipher-alignment.c 		print_info(session);</span>
<span class='curline'><a href='../S/5092.html#L270'>session</a>           270 tests/cipher-alignment.c 	ret = gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5092.html#L281'>session</a>           281 tests/cipher-alignment.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5092.html#L289'>session</a>           289 tests/cipher-alignment.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5092.html#L294'>session</a>           294 tests/cipher-alignment.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5092.html#L318'>session</a>           318 tests/cipher-alignment.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5092.html#L324'>session</a>           324 tests/cipher-alignment.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5092.html#L383'>session</a>           383 tests/cipher-alignment.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5092.html#L403'>session</a>           403 tests/cipher-alignment.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5092.html#L408'>session</a>           408 tests/cipher-alignment.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5092.html#L410'>session</a>           410 tests/cipher-alignment.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5092.html#L412'>session</a>           412 tests/cipher-alignment.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5092.html#L413'>session</a>           413 tests/cipher-alignment.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5092.html#L416'>session</a>           416 tests/cipher-alignment.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5092.html#L425'>session</a>           425 tests/cipher-alignment.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5092.html#L430'>session</a>           430 tests/cipher-alignment.c 		print_info(session);</span>
<span class='curline'><a href='../S/5092.html#L434'>session</a>           434 tests/cipher-alignment.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5092.html#L447'>session</a>           447 tests/cipher-alignment.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5092.html#L453'>session</a>           453 tests/cipher-alignment.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5092.html#L456'>session</a>           456 tests/cipher-alignment.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4375.html#L78'>session</a>            78 tests/client-fastopen.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4375.html#L91'>session</a>            91 tests/client-fastopen.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4375.html#L92'>session</a>            92 tests/client-fastopen.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4375.html#L95'>session</a>            95 tests/client-fastopen.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4375.html#L97'>session</a>            97 tests/client-fastopen.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4375.html#L99'>session</a>            99 tests/client-fastopen.c 	gnutls_transport_set_fastopen(session, fd, connect_addr, connect_addrlen, 0);</span>
<span class='curline'><a href='../S/4375.html#L104'>session</a>           104 tests/client-fastopen.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4375.html#L119'>session</a>           119 tests/client-fastopen.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4375.html#L122'>session</a>           122 tests/client-fastopen.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4375.html#L135'>session</a>           135 tests/client-fastopen.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4375.html#L144'>session</a>           144 tests/client-fastopen.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4375.html#L166'>session</a>           166 tests/client-fastopen.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4375.html#L185'>session</a>           185 tests/client-fastopen.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4375.html#L186'>session</a>           186 tests/client-fastopen.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4375.html#L191'>session</a>           191 tests/client-fastopen.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4375.html#L193'>session</a>           193 tests/client-fastopen.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4375.html#L195'>session</a>           195 tests/client-fastopen.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4375.html#L198'>session</a>           198 tests/client-fastopen.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4375.html#L203'>session</a>           203 tests/client-fastopen.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4375.html#L214'>session</a>           214 tests/client-fastopen.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4375.html#L221'>session</a>           221 tests/client-fastopen.c 		ret = gnutls_record_send(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4375.html#L226'>session</a>           226 tests/client-fastopen.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4375.html#L232'>session</a>           232 tests/client-fastopen.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4375.html#L238'>session</a>           238 tests/client-fastopen.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4415.html#L413'>session</a>           413 tests/client-sign-md5-rep.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4415.html#L432'>session</a>           432 tests/client-sign-md5-rep.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4415.html#L437'>session</a>           437 tests/client-sign-md5-rep.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:-KX-ALL:+DHE-RSA:+AES-128-GCM", NULL);</span>
<span class='curline'><a href='../S/4415.html#L438'>session</a>           438 tests/client-sign-md5-rep.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4415.html#L439'>session</a>           439 tests/client-sign-md5-rep.c 	gnutls_server_name_set(session, GNUTLS_NAME_DNS, "localhost", strlen("localhost"));</span>
<span class='curline'><a href='../S/4415.html#L441'>session</a>           441 tests/client-sign-md5-rep.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4415.html#L443'>session</a>           443 tests/client-sign-md5-rep.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4415.html#L445'>session</a>           445 tests/client-sign-md5-rep.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4415.html#L452'>session</a>           452 tests/client-sign-md5-rep.c 	gnutls_alert_send_appropriate(session, ret);</span>
<span class='curline'><a href='../S/4415.html#L455'>session</a>           455 tests/client-sign-md5-rep.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4437.html#L91'>session</a>            91 tests/custom-urls-override.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4437.html#L97'>session</a>            97 tests/custom-urls-override.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4437.html#L100'>session</a>           100 tests/custom-urls-override.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4437.html#L102'>session</a>           102 tests/custom-urls-override.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4437.html#L104'>session</a>           104 tests/custom-urls-override.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4437.html#L109'>session</a>           109 tests/custom-urls-override.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4437.html#L125'>session</a>           125 tests/custom-urls-override.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4437.html#L127'>session</a>           127 tests/custom-urls-override.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4437.html#L131'>session</a>           131 tests/custom-urls-override.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4437.html#L150'>session</a>           150 tests/custom-urls-override.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4437.html#L165'>session</a>           165 tests/custom-urls-override.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4437.html#L170'>session</a>           170 tests/custom-urls-override.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4437.html#L172'>session</a>           172 tests/custom-urls-override.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4437.html#L174'>session</a>           174 tests/custom-urls-override.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4437.html#L177'>session</a>           177 tests/custom-urls-override.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4437.html#L182'>session</a>           182 tests/custom-urls-override.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4437.html#L193'>session</a>           193 tests/custom-urls-override.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4437.html#L202'>session</a>           202 tests/custom-urls-override.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4437.html#L205'>session</a>           205 tests/custom-urls-override.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5240.html#L88'>session</a>            88 tests/custom-urls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5240.html#L94'>session</a>            94 tests/custom-urls.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5240.html#L97'>session</a>            97 tests/custom-urls.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5240.html#L99'>session</a>            99 tests/custom-urls.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5240.html#L101'>session</a>           101 tests/custom-urls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5240.html#L106'>session</a>           106 tests/custom-urls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5240.html#L122'>session</a>           122 tests/custom-urls.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5240.html#L124'>session</a>           124 tests/custom-urls.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5240.html#L128'>session</a>           128 tests/custom-urls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5240.html#L147'>session</a>           147 tests/custom-urls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5240.html#L169'>session</a>           169 tests/custom-urls.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5240.html#L174'>session</a>           174 tests/custom-urls.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5240.html#L176'>session</a>           176 tests/custom-urls.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5240.html#L178'>session</a>           178 tests/custom-urls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5240.html#L181'>session</a>           181 tests/custom-urls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5240.html#L186'>session</a>           186 tests/custom-urls.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5240.html#L197'>session</a>           197 tests/custom-urls.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5240.html#L201'>session</a>           201 tests/custom-urls.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5240.html#L204'>session</a>           204 tests/custom-urls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5040.html#L68'>session</a>            68 tests/dhepskself.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5040.html#L85'>session</a>            85 tests/dhepskself.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5040.html#L88'>session</a>            88 tests/dhepskself.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:+DHE-PSK", NULL);</span>
<span class='curline'><a href='../S/5040.html#L92'>session</a>            92 tests/dhepskself.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/5040.html#L94'>session</a>            94 tests/dhepskself.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5040.html#L98'>session</a>            98 tests/dhepskself.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5040.html#L109'>session</a>           109 tests/dhepskself.c 	print_dh_params_info(session);</span>
<span class='curline'><a href='../S/5040.html#L111'>session</a>           111 tests/dhepskself.c 	gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5040.html#L113'>session</a>           113 tests/dhepskself.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5040.html#L131'>session</a>           131 tests/dhepskself.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5040.html#L137'>session</a>           137 tests/dhepskself.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5040.html#L154'>session</a>           154 tests/dhepskself.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5040.html#L156'>session</a>           156 tests/dhepskself.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5040.html#L161'>session</a>           161 tests/dhepskself.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:+DHE-PSK", NULL);</span>
<span class='curline'><a href='../S/5040.html#L163'>session</a>           163 tests/dhepskself.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5040.html#L164'>session</a>           164 tests/dhepskself.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, server_pskcred);</span>
<span class='curline'><a href='../S/5040.html#L166'>session</a>           166 tests/dhepskself.c 	return session;</span>
<span class='curline'><a href='../S/5040.html#L185'>session</a>           185 tests/dhepskself.c pskfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/5040.html#L201'>session</a>           201 tests/dhepskself.c gnutls_session_t session;</span>
<span class='curline'><a href='../S/5040.html#L222'>session</a>           222 tests/dhepskself.c 	session = initialize_tls_session();</span>
<span class='curline'><a href='../S/5040.html#L224'>session</a>           224 tests/dhepskself.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5040.html#L225'>session</a>           225 tests/dhepskself.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5040.html#L228'>session</a>           228 tests/dhepskself.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5040.html#L236'>session</a>           236 tests/dhepskself.c 	print_dh_params_info(session);</span>
<span class='curline'><a href='../S/5040.html#L243'>session</a>           243 tests/dhepskself.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5040.html#L256'>session</a>           256 tests/dhepskself.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5040.html#L262'>session</a>           262 tests/dhepskself.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5040.html#L265'>session</a>           265 tests/dhepskself.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4951.html#L77'>session</a>            77 tests/dhex509self.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4951.html#L99'>session</a>            99 tests/dhex509self.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4951.html#L102'>session</a>           102 tests/dhex509self.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:-KX-ALL:+DHE-RSA", NULL);</span>
<span class='curline'><a href='../S/4951.html#L106'>session</a>           106 tests/dhex509self.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4951.html#L108'>session</a>           108 tests/dhex509self.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4951.html#L112'>session</a>           112 tests/dhex509self.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4951.html#L125'>session</a>           125 tests/dhex509self.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4951.html#L129'>session</a>           129 tests/dhex509self.c 		print_info(session);</span>
<span class='curline'><a href='../S/4951.html#L131'>session</a>           131 tests/dhex509self.c 	print_dh_params_info(session);</span>
<span class='curline'><a href='../S/4951.html#L133'>session</a>           133 tests/dhex509self.c 	ret = gnutls_credentials_get(session, GNUTLS_CRD_CERTIFICATE, (void**)&amp;tst_cred);</span>
<span class='curline'><a href='../S/4951.html#L141'>session</a>           141 tests/dhex509self.c 	ret = gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4951.html#L152'>session</a>           152 tests/dhex509self.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4951.html#L160'>session</a>           160 tests/dhex509self.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4951.html#L165'>session</a>           165 tests/dhex509self.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4951.html#L189'>session</a>           189 tests/dhex509self.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4951.html#L195'>session</a>           195 tests/dhex509self.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4951.html#L213'>session</a>           213 tests/dhex509self.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4951.html#L215'>session</a>           215 tests/dhex509self.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4951.html#L220'>session</a>           220 tests/dhex509self.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:-KX-ALL:+DHE-RSA", NULL);</span>
<span class='curline'><a href='../S/4951.html#L221'>session</a>           221 tests/dhex509self.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4951.html#L223'>session</a>           223 tests/dhex509self.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4951.html#L230'>session</a>           230 tests/dhex509self.c 	gnutls_dh_set_prime_bits(session, DH_BITS);</span>
<span class='curline'><a href='../S/4951.html#L232'>session</a>           232 tests/dhex509self.c 	return session;</span>
<span class='curline'><a href='../S/4951.html#L247'>session</a>           247 tests/dhex509self.c gnutls_session_t session;</span>
<span class='curline'><a href='../S/4951.html#L279'>session</a>           279 tests/dhex509self.c 	session = initialize_tls_session();</span>
<span class='curline'><a href='../S/4951.html#L281'>session</a>           281 tests/dhex509self.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4951.html#L282'>session</a>           282 tests/dhex509self.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4951.html#L285'>session</a>           285 tests/dhex509self.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4951.html#L294'>session</a>           294 tests/dhex509self.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4951.html#L299'>session</a>           299 tests/dhex509self.c 		print_info(session);</span>
<span class='curline'><a href='../S/4951.html#L301'>session</a>           301 tests/dhex509self.c 	print_dh_params_info(session);</span>
<span class='curline'><a href='../S/4951.html#L305'>session</a>           305 tests/dhex509self.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4951.html#L316'>session</a>           316 tests/dhex509self.c 			gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/4951.html#L323'>session</a>           323 tests/dhex509self.c 			ret = gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/4951.html#L330'>session</a>           330 tests/dhex509self.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4951.html#L342'>session</a>           342 tests/dhex509self.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4951.html#L349'>session</a>           349 tests/dhex509self.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4951.html#L352'>session</a>           352 tests/dhex509self.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4527.html#L81'>session</a>            81 tests/dtls-client-with-seccomp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4527.html#L100'>session</a>           100 tests/dtls-client-with-seccomp.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4527.html#L101'>session</a>           101 tests/dtls-client-with-seccomp.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4527.html#L102'>session</a>           102 tests/dtls-client-with-seccomp.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4527.html#L105'>session</a>           105 tests/dtls-client-with-seccomp.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4527.html#L109'>session</a>           109 tests/dtls-client-with-seccomp.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4527.html#L111'>session</a>           111 tests/dtls-client-with-seccomp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4527.html#L112'>session</a>           112 tests/dtls-client-with-seccomp.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4527.html#L117'>session</a>           117 tests/dtls-client-with-seccomp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4527.html#L133'>session</a>           133 tests/dtls-client-with-seccomp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4527.html#L136'>session</a>           136 tests/dtls-client-with-seccomp.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4527.html#L149'>session</a>           149 tests/dtls-client-with-seccomp.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4527.html#L158'>session</a>           158 tests/dtls-client-with-seccomp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4527.html#L183'>session</a>           183 tests/dtls-client-with-seccomp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4527.html#L202'>session</a>           202 tests/dtls-client-with-seccomp.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4527.html#L203'>session</a>           203 tests/dtls-client-with-seccomp.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4527.html#L204'>session</a>           204 tests/dtls-client-with-seccomp.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4527.html#L209'>session</a>           209 tests/dtls-client-with-seccomp.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4527.html#L213'>session</a>           213 tests/dtls-client-with-seccomp.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4527.html#L215'>session</a>           215 tests/dtls-client-with-seccomp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4527.html#L216'>session</a>           216 tests/dtls-client-with-seccomp.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4527.html#L219'>session</a>           219 tests/dtls-client-with-seccomp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4527.html#L224'>session</a>           224 tests/dtls-client-with-seccomp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4527.html#L235'>session</a>           235 tests/dtls-client-with-seccomp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4527.html#L242'>session</a>           242 tests/dtls-client-with-seccomp.c 		ret = gnutls_record_send(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4527.html#L247'>session</a>           247 tests/dtls-client-with-seccomp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4527.html#L253'>session</a>           253 tests/dtls-client-with-seccomp.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4527.html#L259'>session</a>           259 tests/dtls-client-with-seccomp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5091.html#L80'>session</a>            80 tests/dtls-etm.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5091.html#L95'>session</a>            95 tests/dtls-etm.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5091.html#L98'>session</a>            98 tests/dtls-etm.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5091.html#L102'>session</a>           102 tests/dtls-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5091.html#L103'>session</a>           103 tests/dtls-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5091.html#L105'>session</a>           105 tests/dtls-etm.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5091.html#L110'>session</a>           110 tests/dtls-etm.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5091.html#L126'>session</a>           126 tests/dtls-etm.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5091.html#L128'>session</a>           128 tests/dtls-etm.c 	if (etm != 0 &amp;&amp; gnutls_session_etm_status(session) == 0) {</span>
<span class='curline'><a href='../S/5091.html#L131'>session</a>           131 tests/dtls-etm.c 	} else if (etm == 0 &amp;&amp; gnutls_session_etm_status(session) != 0) {</span>
<span class='curline'><a href='../S/5091.html#L136'>session</a>           136 tests/dtls-etm.c 	if (etm != 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) == 0)) {</span>
<span class='curline'><a href='../S/5091.html#L139'>session</a>           139 tests/dtls-etm.c 	} else if (etm == 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) != 0)) {</span>
<span class='curline'><a href='../S/5091.html#L146'>session</a>           146 tests/dtls-etm.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5091.html#L163'>session</a>           163 tests/dtls-etm.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5091.html#L169'>session</a>           169 tests/dtls-etm.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5091.html#L191'>session</a>           191 tests/dtls-etm.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5091.html#L213'>session</a>           213 tests/dtls-etm.c 	gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5091.html#L218'>session</a>           218 tests/dtls-etm.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5091.html#L220'>session</a>           220 tests/dtls-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5091.html#L221'>session</a>           221 tests/dtls-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5091.html#L223'>session</a>           223 tests/dtls-etm.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5091.html#L226'>session</a>           226 tests/dtls-etm.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5091.html#L230'>session</a>           230 tests/dtls-etm.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5091.html#L236'>session</a>           236 tests/dtls-etm.c 	if (etm != 0 &amp;&amp; gnutls_session_etm_status(session) == 0) {</span>
<span class='curline'><a href='../S/5091.html#L239'>session</a>           239 tests/dtls-etm.c 	} else if (etm == 0 &amp;&amp; gnutls_session_etm_status(session) != 0) {</span>
<span class='curline'><a href='../S/5091.html#L244'>session</a>           244 tests/dtls-etm.c 	if (etm != 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) == 0)) {</span>
<span class='curline'><a href='../S/5091.html#L247'>session</a>           247 tests/dtls-etm.c 	} else if (etm == 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) != 0)) {</span>
<span class='curline'><a href='../S/5091.html#L258'>session</a>           258 tests/dtls-etm.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5091.html#L263'>session</a>           263 tests/dtls-etm.c 			    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5091.html#L280'>session</a>           280 tests/dtls-etm.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5091.html#L283'>session</a>           283 tests/dtls-etm.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4952.html#L40'>session</a>            40 tests/dtls-handshake-versions.c void _gnutls_hello_set_default_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4359.html#L78'>session</a>            78 tests/dtls-pthread.c 	gnutls_session_t session = arg;</span>
<span class='curline'><a href='../S/4359.html#L86'>session</a>            86 tests/dtls-pthread.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4359.html#L91'>session</a>            91 tests/dtls-pthread.c 			ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4359.html#L105'>session</a>           105 tests/dtls-pthread.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4359.html#L123'>session</a>           123 tests/dtls-pthread.c void do_thread_stuff(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4359.html#L132'>session</a>           132 tests/dtls-pthread.c 	ret = pthread_create(&amp;id, NULL, recv_thread, session);</span>
<span class='curline'><a href='../S/4359.html#L139'>session</a>           139 tests/dtls-pthread.c 			ret = gnutls_record_send(session, MSG, sizeof(MSG)-1);</span>
<span class='curline'><a href='../S/4359.html#L147'>session</a>           147 tests/dtls-pthread.c 		ret = gnutls_record_send(session, MSG2, sizeof(MSG2)-1);</span>
<span class='curline'><a href='../S/4359.html#L159'>session</a>           159 tests/dtls-pthread.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4359.html#L163'>session</a>           163 tests/dtls-pthread.c static void do_reflect_stuff(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4359.html#L171'>session</a>           171 tests/dtls-pthread.c 			ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4359.html#L187'>session</a>           187 tests/dtls-pthread.c 			ret = gnutls_record_send(session, buf, buf_size);</span>
<span class='curline'><a href='../S/4359.html#L197'>session</a>           197 tests/dtls-pthread.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4359.html#L205'>session</a>           205 tests/dtls-pthread.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4359.html#L221'>session</a>           221 tests/dtls-pthread.c 	assert(gnutls_init(&amp;session, flags|GNUTLS_DATAGRAM) &gt;= 0);</span>
<span class='curline'><a href='../S/4359.html#L222'>session</a>           222 tests/dtls-pthread.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4359.html#L223'>session</a>           223 tests/dtls-pthread.c 	gnutls_dtls_set_timeouts(session, 6 * 1000, 60 * 1000);</span>
<span class='curline'><a href='../S/4359.html#L225'>session</a>           225 tests/dtls-pthread.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4359.html#L227'>session</a>           227 tests/dtls-pthread.c 	assert(gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred)&gt;=0);</span>
<span class='curline'><a href='../S/4359.html#L229'>session</a>           229 tests/dtls-pthread.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4359.html#L232'>session</a>           232 tests/dtls-pthread.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4359.html#L244'>session</a>           244 tests/dtls-pthread.c 		do_thread_stuff(session);</span>
<span class='curline'><a href='../S/4359.html#L246'>session</a>           246 tests/dtls-pthread.c 		do_reflect_stuff(session);</span>
<span class='curline'><a href='../S/4359.html#L250'>session</a>           250 tests/dtls-pthread.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4359.html#L261'>session</a>           261 tests/dtls-pthread.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4359.html#L278'>session</a>           278 tests/dtls-pthread.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM)&gt;=0);</span>
<span class='curline'><a href='../S/4359.html#L279'>session</a>           279 tests/dtls-pthread.c 	gnutls_dtls_set_timeouts(session, 5 * 1000, 60 * 1000);</span>
<span class='curline'><a href='../S/4359.html#L280'>session</a>           280 tests/dtls-pthread.c 	gnutls_dtls_set_mtu(session, 400);</span>
<span class='curline'><a href='../S/4359.html#L282'>session</a>           282 tests/dtls-pthread.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4359.html#L284'>session</a>           284 tests/dtls-pthread.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4359.html#L286'>session</a>           286 tests/dtls-pthread.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4359.html#L289'>session</a>           289 tests/dtls-pthread.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4359.html#L293'>session</a>           293 tests/dtls-pthread.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4359.html#L303'>session</a>           303 tests/dtls-pthread.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4359.html#L306'>session</a>           306 tests/dtls-pthread.c 		do_thread_stuff(session);</span>
<span class='curline'><a href='../S/4359.html#L308'>session</a>           308 tests/dtls-pthread.c 		do_reflect_stuff(session);</span>
<span class='curline'><a href='../S/4359.html#L312'>session</a>           312 tests/dtls-pthread.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5153.html#L85'>session</a>            85 tests/dtls-rehandshake-anon.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5153.html#L100'>session</a>           100 tests/dtls-rehandshake-anon.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5153.html#L101'>session</a>           101 tests/dtls-rehandshake-anon.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5153.html#L104'>session</a>           104 tests/dtls-rehandshake-anon.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5153.html#L110'>session</a>           110 tests/dtls-rehandshake-anon.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5153.html#L112'>session</a>           112 tests/dtls-rehandshake-anon.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5153.html#L113'>session</a>           113 tests/dtls-rehandshake-anon.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5153.html#L118'>session</a>           118 tests/dtls-rehandshake-anon.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5153.html#L134'>session</a>           134 tests/dtls-rehandshake-anon.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5153.html#L141'>session</a>           141 tests/dtls-rehandshake-anon.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5153.html#L152'>session</a>           152 tests/dtls-rehandshake-anon.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5153.html#L168'>session</a>           168 tests/dtls-rehandshake-anon.c 				ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5153.html#L180'>session</a>           180 tests/dtls-rehandshake-anon.c 		ret = gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5153.html#L182'>session</a>           182 tests/dtls-rehandshake-anon.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5153.html#L188'>session</a>           188 tests/dtls-rehandshake-anon.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5153.html#L214'>session</a>           214 tests/dtls-rehandshake-anon.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5153.html#L226'>session</a>           226 tests/dtls-rehandshake-anon.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5153.html#L227'>session</a>           227 tests/dtls-rehandshake-anon.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5153.html#L232'>session</a>           232 tests/dtls-rehandshake-anon.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5153.html#L236'>session</a>           236 tests/dtls-rehandshake-anon.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5153.html#L238'>session</a>           238 tests/dtls-rehandshake-anon.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5153.html#L239'>session</a>           239 tests/dtls-rehandshake-anon.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5153.html#L242'>session</a>           242 tests/dtls-rehandshake-anon.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5153.html#L247'>session</a>           247 tests/dtls-rehandshake-anon.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5153.html#L258'>session</a>           258 tests/dtls-rehandshake-anon.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5153.html#L266'>session</a>           266 tests/dtls-rehandshake-anon.c 		ret = gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/5153.html#L276'>session</a>           276 tests/dtls-rehandshake-anon.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5153.html#L291'>session</a>           291 tests/dtls-rehandshake-anon.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5153.html#L306'>session</a>           306 tests/dtls-rehandshake-anon.c 					ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5153.html#L321'>session</a>           321 tests/dtls-rehandshake-anon.c 				    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5153.html#L331'>session</a>           331 tests/dtls-rehandshake-anon.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5153.html#L334'>session</a>           334 tests/dtls-rehandshake-anon.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5034.html#L89'>session</a>            89 tests/dtls-rehandshake-cert-2.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5034.html#L103'>session</a>           103 tests/dtls-rehandshake-cert-2.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5034.html#L104'>session</a>           104 tests/dtls-rehandshake-cert-2.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5034.html#L107'>session</a>           107 tests/dtls-rehandshake-cert-2.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5034.html#L111'>session</a>           111 tests/dtls-rehandshake-cert-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5034.html#L112'>session</a>           112 tests/dtls-rehandshake-cert-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, clientx509cred);</span>
<span class='curline'><a href='../S/5034.html#L114'>session</a>           114 tests/dtls-rehandshake-cert-2.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5034.html#L115'>session</a>           115 tests/dtls-rehandshake-cert-2.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5034.html#L120'>session</a>           120 tests/dtls-rehandshake-cert-2.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5034.html#L136'>session</a>           136 tests/dtls-rehandshake-cert-2.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5034.html#L140'>session</a>           140 tests/dtls-rehandshake-cert-2.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5034.html#L149'>session</a>           149 tests/dtls-rehandshake-cert-2.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5034.html#L160'>session</a>           160 tests/dtls-rehandshake-cert-2.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5034.html#L174'>session</a>           174 tests/dtls-rehandshake-cert-2.c 				ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5034.html#L186'>session</a>           186 tests/dtls-rehandshake-cert-2.c 		ret = gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5034.html#L188'>session</a>           188 tests/dtls-rehandshake-cert-2.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5034.html#L194'>session</a>           194 tests/dtls-rehandshake-cert-2.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5034.html#L220'>session</a>           220 tests/dtls-rehandshake-cert-2.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5034.html#L236'>session</a>           236 tests/dtls-rehandshake-cert-2.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5034.html#L237'>session</a>           237 tests/dtls-rehandshake-cert-2.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5034.html#L243'>session</a>           243 tests/dtls-rehandshake-cert-2.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5034.html#L247'>session</a>           247 tests/dtls-rehandshake-cert-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5034.html#L248'>session</a>           248 tests/dtls-rehandshake-cert-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, serverx509cred);</span>
<span class='curline'><a href='../S/5034.html#L250'>session</a>           250 tests/dtls-rehandshake-cert-2.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5034.html#L251'>session</a>           251 tests/dtls-rehandshake-cert-2.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5034.html#L254'>session</a>           254 tests/dtls-rehandshake-cert-2.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5034.html#L259'>session</a>           259 tests/dtls-rehandshake-cert-2.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5034.html#L270'>session</a>           270 tests/dtls-rehandshake-cert-2.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5034.html#L272'>session</a>           272 tests/dtls-rehandshake-cert-2.c 	if (gnutls_kx_get(session) != GNUTLS_KX_ANON_ECDH) {</span>
<span class='curline'><a href='../S/5034.html#L282'>session</a>           282 tests/dtls-rehandshake-cert-2.c 		ret = gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/5034.html#L291'>session</a>           291 tests/dtls-rehandshake-cert-2.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5034.html#L306'>session</a>           306 tests/dtls-rehandshake-cert-2.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5034.html#L320'>session</a>           320 tests/dtls-rehandshake-cert-2.c 					ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5034.html#L335'>session</a>           335 tests/dtls-rehandshake-cert-2.c 				    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5034.html#L342'>session</a>           342 tests/dtls-rehandshake-cert-2.c 	if (gnutls_kx_get(session) != GNUTLS_KX_ECDHE_RSA) {</span>
<span class='curline'><a href='../S/5034.html#L348'>session</a>           348 tests/dtls-rehandshake-cert-2.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5034.html#L351'>session</a>           351 tests/dtls-rehandshake-cert-2.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4575.html#L111'>session</a>           111 tests/dtls-rehandshake-cert-3.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4575.html#L125'>session</a>           125 tests/dtls-rehandshake-cert-3.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4575.html#L126'>session</a>           126 tests/dtls-rehandshake-cert-3.c 	gnutls_dtls_set_mtu(session, MTU);</span>
<span class='curline'><a href='../S/4575.html#L129'>session</a>           129 tests/dtls-rehandshake-cert-3.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4575.html#L133'>session</a>           133 tests/dtls-rehandshake-cert-3.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4575.html#L134'>session</a>           134 tests/dtls-rehandshake-cert-3.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, clientx509cred);</span>
<span class='curline'><a href='../S/4575.html#L136'>session</a>           136 tests/dtls-rehandshake-cert-3.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4575.html#L137'>session</a>           137 tests/dtls-rehandshake-cert-3.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4575.html#L138'>session</a>           138 tests/dtls-rehandshake-cert-3.c 	gnutls_dtls_set_timeouts(session, 2000, 30 * 1000);</span>
<span class='curline'><a href='../S/4575.html#L143'>session</a>           143 tests/dtls-rehandshake-cert-3.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4575.html#L159'>session</a>           159 tests/dtls-rehandshake-cert-3.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4575.html#L163'>session</a>           163 tests/dtls-rehandshake-cert-3.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4575.html#L168'>session</a>           168 tests/dtls-rehandshake-cert-3.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4575.html#L181'>session</a>           181 tests/dtls-rehandshake-cert-3.c 				ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4575.html#L193'>session</a>           193 tests/dtls-rehandshake-cert-3.c 		ret = gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4575.html#L195'>session</a>           195 tests/dtls-rehandshake-cert-3.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4575.html#L201'>session</a>           201 tests/dtls-rehandshake-cert-3.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4575.html#L227'>session</a>           227 tests/dtls-rehandshake-cert-3.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4575.html#L243'>session</a>           243 tests/dtls-rehandshake-cert-3.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4575.html#L244'>session</a>           244 tests/dtls-rehandshake-cert-3.c 	gnutls_dtls_set_mtu(session, MTU);</span>
<span class='curline'><a href='../S/4575.html#L250'>session</a>           250 tests/dtls-rehandshake-cert-3.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4575.html#L254'>session</a>           254 tests/dtls-rehandshake-cert-3.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4575.html#L255'>session</a>           255 tests/dtls-rehandshake-cert-3.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, serverx509cred);</span>
<span class='curline'><a href='../S/4575.html#L257'>session</a>           257 tests/dtls-rehandshake-cert-3.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4575.html#L258'>session</a>           258 tests/dtls-rehandshake-cert-3.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4575.html#L261'>session</a>           261 tests/dtls-rehandshake-cert-3.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4575.html#L266'>session</a>           266 tests/dtls-rehandshake-cert-3.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4575.html#L277'>session</a>           277 tests/dtls-rehandshake-cert-3.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4575.html#L279'>session</a>           279 tests/dtls-rehandshake-cert-3.c 	if (gnutls_kx_get(session) != GNUTLS_KX_ANON_ECDH) {</span>
<span class='curline'><a href='../S/4575.html#L288'>session</a>           288 tests/dtls-rehandshake-cert-3.c 	ret = gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/4575.html#L297'>session</a>           297 tests/dtls-rehandshake-cert-3.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4575.html#L311'>session</a>           311 tests/dtls-rehandshake-cert-3.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4575.html#L327'>session</a>           327 tests/dtls-rehandshake-cert-3.c 				    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4575.html#L334'>session</a>           334 tests/dtls-rehandshake-cert-3.c 	if (gnutls_kx_get(session) != GNUTLS_KX_ECDHE_RSA) {</span>
<span class='curline'><a href='../S/4575.html#L340'>session</a>           340 tests/dtls-rehandshake-cert-3.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4575.html#L343'>session</a>           343 tests/dtls-rehandshake-cert-3.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5106.html#L88'>session</a>            88 tests/dtls-rehandshake-cert.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5106.html#L101'>session</a>           101 tests/dtls-rehandshake-cert.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5106.html#L102'>session</a>           102 tests/dtls-rehandshake-cert.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5106.html#L106'>session</a>           106 tests/dtls-rehandshake-cert.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5106.html#L110'>session</a>           110 tests/dtls-rehandshake-cert.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5106.html#L113'>session</a>           113 tests/dtls-rehandshake-cert.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5106.html#L114'>session</a>           114 tests/dtls-rehandshake-cert.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5106.html#L119'>session</a>           119 tests/dtls-rehandshake-cert.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5106.html#L135'>session</a>           135 tests/dtls-rehandshake-cert.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5106.html#L142'>session</a>           142 tests/dtls-rehandshake-cert.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5106.html#L153'>session</a>           153 tests/dtls-rehandshake-cert.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5106.html#L169'>session</a>           169 tests/dtls-rehandshake-cert.c 				ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5106.html#L181'>session</a>           181 tests/dtls-rehandshake-cert.c 		ret = gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5106.html#L183'>session</a>           183 tests/dtls-rehandshake-cert.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5106.html#L189'>session</a>           189 tests/dtls-rehandshake-cert.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5106.html#L215'>session</a>           215 tests/dtls-rehandshake-cert.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5106.html#L230'>session</a>           230 tests/dtls-rehandshake-cert.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5106.html#L231'>session</a>           231 tests/dtls-rehandshake-cert.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5106.html#L237'>session</a>           237 tests/dtls-rehandshake-cert.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5106.html#L241'>session</a>           241 tests/dtls-rehandshake-cert.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5106.html#L244'>session</a>           244 tests/dtls-rehandshake-cert.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5106.html#L245'>session</a>           245 tests/dtls-rehandshake-cert.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5106.html#L248'>session</a>           248 tests/dtls-rehandshake-cert.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5106.html#L253'>session</a>           253 tests/dtls-rehandshake-cert.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5106.html#L264'>session</a>           264 tests/dtls-rehandshake-cert.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5106.html#L272'>session</a>           272 tests/dtls-rehandshake-cert.c 		ret = gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/5106.html#L282'>session</a>           282 tests/dtls-rehandshake-cert.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5106.html#L297'>session</a>           297 tests/dtls-rehandshake-cert.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5106.html#L312'>session</a>           312 tests/dtls-rehandshake-cert.c 					ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5106.html#L327'>session</a>           327 tests/dtls-rehandshake-cert.c 				    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5106.html#L337'>session</a>           337 tests/dtls-rehandshake-cert.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5106.html#L340'>session</a>           340 tests/dtls-rehandshake-cert.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4602.html#L73'>session</a>            73 tests/dtls-session-ticket-lost.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4602.html#L82'>session</a>            82 tests/dtls-session-ticket-lost.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_DATAGRAM)&gt;=0);</span>
<span class='curline'><a href='../S/4602.html#L84'>session</a>            84 tests/dtls-session-ticket-lost.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4602.html#L86'>session</a>            86 tests/dtls-session-ticket-lost.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4602.html#L88'>session</a>            88 tests/dtls-session-ticket-lost.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4602.html#L91'>session</a>            91 tests/dtls-session-ticket-lost.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4602.html#L102'>session</a>           102 tests/dtls-session-ticket-lost.c 	gnutls_record_set_timeout(session, 30*1000);</span>
<span class='curline'><a href='../S/4602.html#L105'>session</a>           105 tests/dtls-session-ticket-lost.c 		ret = gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4602.html#L110'>session</a>           110 tests/dtls-session-ticket-lost.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4602.html#L137'>session</a>           137 tests/dtls-session-ticket-lost.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4602.html#L153'>session</a>           153 tests/dtls-session-ticket-lost.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_DATAGRAM)&gt;=0);</span>
<span class='curline'><a href='../S/4602.html#L156'>session</a>           156 tests/dtls-session-ticket-lost.c 	assert(gnutls_session_ticket_enable_server(session, &amp;skey) &gt;= 0);</span>
<span class='curline'><a href='../S/4602.html#L158'>session</a>           158 tests/dtls-session-ticket-lost.c 	gnutls_transport_set_push_function(session, server_push);</span>
<span class='curline'><a href='../S/4602.html#L160'>session</a>           160 tests/dtls-session-ticket-lost.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4602.html#L162'>session</a>           162 tests/dtls-session-ticket-lost.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4602.html#L164'>session</a>           164 tests/dtls-session-ticket-lost.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4602.html#L167'>session</a>           167 tests/dtls-session-ticket-lost.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4602.html#L178'>session</a>           178 tests/dtls-session-ticket-lost.c 	gnutls_record_set_timeout(session, 30*1000);</span>
<span class='curline'><a href='../S/4602.html#L182'>session</a>           182 tests/dtls-session-ticket-lost.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4602.html#L189'>session</a>           189 tests/dtls-session-ticket-lost.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4505.html#L81'>session</a>            81 tests/dtls-with-seccomp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4505.html#L94'>session</a>            94 tests/dtls-with-seccomp.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4505.html#L95'>session</a>            95 tests/dtls-with-seccomp.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4505.html#L96'>session</a>            96 tests/dtls-with-seccomp.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4505.html#L98'>session</a>            98 tests/dtls-with-seccomp.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4505.html#L100'>session</a>           100 tests/dtls-with-seccomp.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4505.html#L102'>session</a>           102 tests/dtls-with-seccomp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4505.html#L103'>session</a>           103 tests/dtls-with-seccomp.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4505.html#L108'>session</a>           108 tests/dtls-with-seccomp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4505.html#L124'>session</a>           124 tests/dtls-with-seccomp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4505.html#L127'>session</a>           127 tests/dtls-with-seccomp.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4505.html#L140'>session</a>           140 tests/dtls-with-seccomp.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4505.html#L149'>session</a>           149 tests/dtls-with-seccomp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4505.html#L174'>session</a>           174 tests/dtls-with-seccomp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4505.html#L199'>session</a>           199 tests/dtls-with-seccomp.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4505.html#L200'>session</a>           200 tests/dtls-with-seccomp.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4505.html#L201'>session</a>           201 tests/dtls-with-seccomp.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4505.html#L203'>session</a>           203 tests/dtls-with-seccomp.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4505.html#L205'>session</a>           205 tests/dtls-with-seccomp.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4505.html#L207'>session</a>           207 tests/dtls-with-seccomp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4505.html#L208'>session</a>           208 tests/dtls-with-seccomp.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4505.html#L211'>session</a>           211 tests/dtls-with-seccomp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4505.html#L216'>session</a>           216 tests/dtls-with-seccomp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4505.html#L227'>session</a>           227 tests/dtls-with-seccomp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4505.html#L234'>session</a>           234 tests/dtls-with-seccomp.c 		ret = gnutls_record_send(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4505.html#L239'>session</a>           239 tests/dtls-with-seccomp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4505.html#L245'>session</a>           245 tests/dtls-with-seccomp.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4505.html#L251'>session</a>           251 tests/dtls-with-seccomp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5058.html#L268'>session</a>           268 tests/dtls/dtls-stress.c static void auditfn(gnutls_session_t session, const char *s)</span>
<span class='curline'><a href='../S/5058.html#L668'>session</a>           668 tests/dtls/dtls-stress.c gnutls_session_t session;</span>
<span class='curline'><a href='../S/5058.html#L699'>session</a>           699 tests/dtls/dtls-stress.c 	gnutls_init(&amp;session,</span>
<span class='curline'><a href='../S/5058.html#L702'>session</a>           702 tests/dtls/dtls-stress.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5058.html#L705'>session</a>           705 tests/dtls/dtls-stress.c 	gnutls_transport_set_int(session, sock);</span>
<span class='curline'><a href='../S/5058.html#L708'>session</a>           708 tests/dtls/dtls-stress.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, cred);</span>
<span class='curline'><a href='../S/5058.html#L710'>session</a>           710 tests/dtls/dtls-stress.c 			gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/5058.html#L716'>session</a>           716 tests/dtls/dtls-stress.c 		gnutls_credentials_set(session, GNUTLS_CRD_ANON, acred);</span>
<span class='curline'><a href='../S/5058.html#L720'>session</a>           720 tests/dtls/dtls-stress.c 		gnutls_credentials_set(session, GNUTLS_CRD_ANON, acred);</span>
<span class='curline'><a href='../S/5058.html#L723'>session</a>           723 tests/dtls/dtls-stress.c 	gnutls_dtls_set_mtu(session, 1400);</span>
<span class='curline'><a href='../S/5058.html#L724'>session</a>           724 tests/dtls/dtls-stress.c 	gnutls_dtls_set_timeouts(session, retransmit_milliseconds,</span>
<span class='curline'><a href='../S/5058.html#L743'>session</a>           743 tests/dtls/dtls-stress.c 			err = process_error(gnutls_handshake(session));</span>
<span class='curline'><a href='../S/5058.html#L745'>session</a>           745 tests/dtls/dtls-stress.c 				int t = gnutls_dtls_get_timeout(session);</span>
<span class='curline'><a href='../S/5058.html#L751'>session</a>           751 tests/dtls/dtls-stress.c 		ret = gnutls_session_get_data2(session, &amp;data);</span>
<span class='curline'><a href='../S/5058.html#L755'>session</a>           755 tests/dtls/dtls-stress.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5058.html#L758'>session</a>           758 tests/dtls/dtls-stress.c 		gnutls_session_set_data(session, data.data, data.size);</span>
<span class='curline'><a href='../S/5058.html#L767'>session</a>           767 tests/dtls/dtls-stress.c 	gnutls_transport_set_push_function(session, writefn);</span>
<span class='curline'><a href='../S/5058.html#L771'>session</a>           771 tests/dtls/dtls-stress.c 		err = process_error(gnutls_handshake(session));</span>
<span class='curline'><a href='../S/5058.html#L773'>session</a>           773 tests/dtls/dtls-stress.c 			int t = gnutls_dtls_get_timeout(session);</span>
<span class='curline'><a href='../S/5058.html#L790'>session</a>           790 tests/dtls/dtls-stress.c 					  (session, buffer, sizeof(buffer)));</span>
<span class='curline'><a href='../S/5058.html#L795'>session</a>           795 tests/dtls/dtls-stress.c 		die_on_error(gnutls_record_send(session, buffer, len));</span>
<span class='curline'><a href='../S/5058.html#L802'>session</a>           802 tests/dtls/dtls-stress.c 		die_on_error(gnutls_record_send(session, line, strlen(line)));</span>
<span class='curline'><a href='../S/5058.html#L810'>session</a>           810 tests/dtls/dtls-stress.c 				  (session, buffer, sizeof(buffer)));</span>
<span class='curline'><a href='../S/5058.html#L867'>session</a>           867 tests/dtls/dtls-stress.c 		gnutls_db_set_retrieve_function(session, db_fetch);</span>
<span class='curline'><a href='../S/5058.html#L868'>session</a>           868 tests/dtls/dtls-stress.c 		gnutls_db_set_store_function(session, db_store);</span>
<span class='curline'><a href='../S/5058.html#L869'>session</a>           869 tests/dtls/dtls-stress.c 		gnutls_db_set_remove_function(session, db_delete);</span>
<span class='curline'><a href='../S/5058.html#L870'>session</a>           870 tests/dtls/dtls-stress.c 		gnutls_db_set_ptr(session, NULL);</span>
<span class='curline'><a href='../S/5058.html#L873'>session</a>           873 tests/dtls/dtls-stress.c 			err = process_error(gnutls_handshake(session));</span>
<span class='curline'><a href='../S/5058.html#L875'>session</a>           875 tests/dtls/dtls-stress.c 				int t = gnutls_dtls_get_timeout(session);</span>
<span class='curline'><a href='../S/5058.html#L881'>session</a>           881 tests/dtls/dtls-stress.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5058.html#L884'>session</a>           884 tests/dtls/dtls-stress.c 		gnutls_db_set_retrieve_function(session, db_fetch);</span>
<span class='curline'><a href='../S/5058.html#L885'>session</a>           885 tests/dtls/dtls-stress.c 		gnutls_db_set_store_function(session, db_store);</span>
<span class='curline'><a href='../S/5058.html#L886'>session</a>           886 tests/dtls/dtls-stress.c 		gnutls_db_set_remove_function(session, db_delete);</span>
<span class='curline'><a href='../S/5058.html#L887'>session</a>           887 tests/dtls/dtls-stress.c 		gnutls_db_set_ptr(session, NULL);</span>
<span class='curline'><a href='../S/5058.html#L894'>session</a>           894 tests/dtls/dtls-stress.c 	gnutls_transport_set_push_function(session, writefn);</span>
<span class='curline'><a href='../S/5058.html#L900'>session</a>           900 tests/dtls/dtls-stress.c 		err = process_error(gnutls_handshake(session));</span>
<span class='curline'><a href='../S/5058.html#L902'>session</a>           902 tests/dtls/dtls-stress.c 			int t = gnutls_dtls_get_timeout(session);</span>
<span class='curline'><a href='../S/5058.html#L917'>session</a>           917 tests/dtls/dtls-stress.c 		die_on_error(gnutls_record_send(session, line, strlen(line)));</span>
<span class='curline'><a href='../S/5058.html#L925'>session</a>           925 tests/dtls/dtls-stress.c 				  (session, buffer, sizeof(buffer)));</span>
<span class='curline'><a href='../S/5058.html#L942'>session</a>           942 tests/dtls/dtls-stress.c 					  (session, buffer, sizeof(buffer)));</span>
<span class='curline'><a href='../S/5058.html#L947'>session</a>           947 tests/dtls/dtls-stress.c 		die_on_error(gnutls_record_send(session, buffer, len));</span>
<span class='curline'><a href='../S/4506.html#L68'>session</a>            68 tests/dtls_hello_random_value.c static int hello_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4506.html#L77'>session</a>            77 tests/dtls_hello_random_value.c 			gnutls_session_get_random(session, &amp;tmp, NULL);</span>
<span class='curline'><a href='../S/4506.html#L95'>session</a>            95 tests/dtls_hello_random_value.c 			gnutls_session_get_random(session, &amp;tmp, NULL);</span>
<span class='curline'><a href='../S/4506.html#L105'>session</a>           105 tests/dtls_hello_random_value.c 		gnutls_session_get_random(session, NULL, &amp;tmp);</span>
<span class='curline'><a href='../S/4506.html#L124'>session</a>           124 tests/dtls_hello_random_value.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4506.html#L135'>session</a>           135 tests/dtls_hello_random_value.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_DATAGRAM)&gt;=0);</span>
<span class='curline'><a href='../S/4506.html#L138'>session</a>           138 tests/dtls_hello_random_value.c 		assert(gnutls_set_default_priority(session) &gt;= 0);</span>
<span class='curline'><a href='../S/4506.html#L140'>session</a>           140 tests/dtls_hello_random_value.c 		assert(gnutls_priority_set_direct(session, priority, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4506.html#L143'>session</a>           143 tests/dtls_hello_random_value.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4506.html#L146'>session</a>           146 tests/dtls_hello_random_value.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4506.html#L147'>session</a>           147 tests/dtls_hello_random_value.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4506.html#L148'>session</a>           148 tests/dtls_hello_random_value.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4506.html#L150'>session</a>           150 tests/dtls_hello_random_value.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4506.html#L153'>session</a>           153 tests/dtls_hello_random_value.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4506.html#L166'>session</a>           166 tests/dtls_hello_random_value.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4506.html#L169'>session</a>           169 tests/dtls_hello_random_value.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4506.html#L192'>session</a>           192 tests/dtls_hello_random_value.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4506.html#L251'>session</a>           251 tests/dtls_hello_random_value.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_DATAGRAM)&gt;=0);</span>
<span class='curline'><a href='../S/4506.html#L252'>session</a>           252 tests/dtls_hello_random_value.c 	assert(session != NULL);</span>
<span class='curline'><a href='../S/4506.html#L255'>session</a>           255 tests/dtls_hello_random_value.c 		assert(gnutls_set_default_priority(session) &gt;= 0);</span>
<span class='curline'><a href='../S/4506.html#L257'>session</a>           257 tests/dtls_hello_random_value.c 		assert(gnutls_priority_set_direct(session, priority, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4506.html#L260'>session</a>           260 tests/dtls_hello_random_value.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4506.html#L263'>session</a>           263 tests/dtls_hello_random_value.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4506.html#L264'>session</a>           264 tests/dtls_hello_random_value.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4506.html#L265'>session</a>           265 tests/dtls_hello_random_value.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4506.html#L267'>session</a>           267 tests/dtls_hello_random_value.c 	gnutls_dtls_prestate_set(session, &amp;prestate);</span>
<span class='curline'><a href='../S/4506.html#L269'>session</a>           269 tests/dtls_hello_random_value.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4506.html#L279'>session</a>           279 tests/dtls_hello_random_value.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4506.html#L281'>session</a>           281 tests/dtls_hello_random_value.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4607.html#L135'>session</a>           135 tests/duplicate-extensions.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4607.html#L154'>session</a>           154 tests/duplicate-extensions.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4607.html#L159'>session</a>           159 tests/duplicate-extensions.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.0:+VERS-TLS1.1:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4607.html#L160'>session</a>           160 tests/duplicate-extensions.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4607.html#L162'>session</a>           162 tests/duplicate-extensions.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4607.html#L164'>session</a>           164 tests/duplicate-extensions.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4607.html#L166'>session</a>           166 tests/duplicate-extensions.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4607.html#L173'>session</a>           173 tests/duplicate-extensions.c 	gnutls_alert_send_appropriate(session, ret);</span>
<span class='curline'><a href='../S/4607.html#L176'>session</a>           176 tests/duplicate-extensions.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4955.html#L52'>session</a>            52 tests/eagain-auto-auth.c static int cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4981.html#L179'>session</a>           179 tests/eagain-common.h #define RETURN_RND_EAGAIN(session) \</span>
<span class='curline'><a href='../S/4981.html#L183'>session</a>           183 tests/eagain-common.h       gnutls_transport_set_errno (session, EAGAIN); \</span>
<span class='curline'><a href='../S/4981.html#L187'>session</a>           187 tests/eagain-common.h #define RETURN_RND_EAGAIN(session)</span>
<span class='curline'><a href='../S/4981.html#L342'>session</a>           342 tests/eagain-common.h inline static int record_send_loop(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4981.html#L358'>session</a>           358 tests/eagain-common.h 	ret = gnutls_record_send(session, data, sizeofdata);</span>
<span class='curline'><a href='../S/4981.html#L361'>session</a>           361 tests/eagain-common.h 		    gnutls_record_send(session, retry_data,</span>
<span class='curline'><a href='../S/4510.html#L39'>session</a>            39 tests/empty_retrieve_function.c static int cert_cb1(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4510.html#L50'>session</a>            50 tests/empty_retrieve_function.c static int cert_cb2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4510.html#L66'>session</a>            66 tests/empty_retrieve_function.c static int cert_cb3(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4503.html#L79'>session</a>            79 tests/fallback-scsv.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4503.html#L92'>session</a>            92 tests/fallback-scsv.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4503.html#L95'>session</a>            95 tests/fallback-scsv.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4503.html#L97'>session</a>            97 tests/fallback-scsv.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4503.html#L99'>session</a>            99 tests/fallback-scsv.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4503.html#L104'>session</a>           104 tests/fallback-scsv.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4503.html#L124'>session</a>           124 tests/fallback-scsv.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4503.html#L128'>session</a>           128 tests/fallback-scsv.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4503.html#L145'>session</a>           145 tests/fallback-scsv.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4503.html#L151'>session</a>           151 tests/fallback-scsv.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4503.html#L172'>session</a>           172 tests/fallback-scsv.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4503.html#L191'>session</a>           191 tests/fallback-scsv.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4503.html#L196'>session</a>           196 tests/fallback-scsv.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4503.html#L198'>session</a>           198 tests/fallback-scsv.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4503.html#L200'>session</a>           200 tests/fallback-scsv.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4503.html#L203'>session</a>           203 tests/fallback-scsv.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4503.html#L218'>session</a>           218 tests/fallback-scsv.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4503.html#L230'>session</a>           230 tests/fallback-scsv.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4503.html#L235'>session</a>           235 tests/fallback-scsv.c 			    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4503.html#L252'>session</a>           252 tests/fallback-scsv.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4503.html#L255'>session</a>           255 tests/fallback-scsv.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5036.html#L24'>session</a>            24 tests/fips-override-test.c static void audit_log_func(gnutls_session_t session, const char *str)</span>
<span class='curline'><a href='../S/4978.html#L31'>session</a>            31 tests/fips-test.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4978.html#L98'>session</a>            98 tests/fips-test.c 	ret = gnutls_init(&amp;session, 0);</span>
<span class='curline'><a href='../S/4978.html#L102'>session</a>           102 tests/fips-test.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4978.html#L150'>session</a>           150 tests/fips-test.c 	ret = gnutls_init(&amp;session, 0);</span>
<span class='curline'><a href='../S/4417.html#L106'>session</a>           106 tests/gnutls_ext_raw_parse.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4417.html#L136'>session</a>           136 tests/gnutls_ext_raw_parse.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4417.html#L149'>session</a>           149 tests/gnutls_ext_raw_parse.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4417.html#L150'>session</a>           150 tests/gnutls_ext_raw_parse.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4417.html#L153'>session</a>           153 tests/gnutls_ext_raw_parse.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4417.html#L155'>session</a>           155 tests/gnutls_ext_raw_parse.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4417.html#L157'>session</a>           157 tests/gnutls_ext_raw_parse.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4417.html#L158'>session</a>           158 tests/gnutls_ext_raw_parse.c 	assert(gnutls_server_name_set(session, GNUTLS_NAME_DNS, HOSTNAME, strlen(HOSTNAME))&gt;=0);</span>
<span class='curline'><a href='../S/4417.html#L163'>session</a>           163 tests/gnutls_ext_raw_parse.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4417.html#L182'>session</a>           182 tests/gnutls_ext_raw_parse.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4417.html#L184'>session</a>           184 tests/gnutls_ext_raw_parse.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4417.html#L190'>session</a>           190 tests/gnutls_ext_raw_parse.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4417.html#L201'>session</a>           201 tests/gnutls_ext_raw_parse.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4417.html#L218'>session</a>           218 tests/gnutls_ext_raw_parse.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4417.html#L219'>session</a>           219 tests/gnutls_ext_raw_parse.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4417.html#L221'>session</a>           221 tests/gnutls_ext_raw_parse.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/4417.html#L228'>session</a>           228 tests/gnutls_ext_raw_parse.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4417.html#L230'>session</a>           230 tests/gnutls_ext_raw_parse.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4417.html#L232'>session</a>           232 tests/gnutls_ext_raw_parse.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4417.html#L235'>session</a>           235 tests/gnutls_ext_raw_parse.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4417.html#L248'>session</a>           248 tests/gnutls_ext_raw_parse.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4417.html#L253'>session</a>           253 tests/gnutls_ext_raw_parse.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4417.html#L257'>session</a>           257 tests/gnutls_ext_raw_parse.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4328.html#L105'>session</a>           105 tests/gnutls_ext_raw_parse_dtls.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4328.html#L122'>session</a>           122 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4328.html#L135'>session</a>           135 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4328.html#L136'>session</a>           136 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4328.html#L138'>session</a>           138 tests/gnutls_ext_raw_parse_dtls.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-DTLS1.2", NULL)&gt;= 0);</span>
<span class='curline'><a href='../S/4328.html#L140'>session</a>           140 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4328.html#L142'>session</a>           142 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4328.html#L143'>session</a>           143 tests/gnutls_ext_raw_parse_dtls.c 	assert(gnutls_server_name_set(session, GNUTLS_NAME_DNS, HOSTNAME, strlen(HOSTNAME))&gt;=0);</span>
<span class='curline'><a href='../S/4328.html#L148'>session</a>           148 tests/gnutls_ext_raw_parse_dtls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4328.html#L167'>session</a>           167 tests/gnutls_ext_raw_parse_dtls.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4328.html#L169'>session</a>           169 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4328.html#L175'>session</a>           175 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4328.html#L186'>session</a>           186 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4328.html#L203'>session</a>           203 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4328.html#L204'>session</a>           204 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4328.html#L206'>session</a>           206 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/4328.html#L210'>session</a>           210 tests/gnutls_ext_raw_parse_dtls.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-DTLS1.2", NULL)&gt;= 0);</span>
<span class='curline'><a href='../S/4328.html#L212'>session</a>           212 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4328.html#L214'>session</a>           214 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4328.html#L217'>session</a>           217 tests/gnutls_ext_raw_parse_dtls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4328.html#L230'>session</a>           230 tests/gnutls_ext_raw_parse_dtls.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4328.html#L235'>session</a>           235 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4328.html#L239'>session</a>           239 tests/gnutls_ext_raw_parse_dtls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4438.html#L64'>session</a>            64 tests/handshake-large-cert.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4438.html#L77'>session</a>            77 tests/handshake-large-cert.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4438.html#L79'>session</a>            79 tests/handshake-large-cert.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4438.html#L83'>session</a>            83 tests/handshake-large-cert.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4438.html#L86'>session</a>            86 tests/handshake-large-cert.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4438.html#L87'>session</a>            87 tests/handshake-large-cert.c 	gnutls_handshake_set_timeout(session, 60 * 1000);</span>
<span class='curline'><a href='../S/4438.html#L90'>session</a>            90 tests/handshake-large-cert.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4438.html#L101'>session</a>           101 tests/handshake-large-cert.c 		ret = gnutls_record_recv(session, buf, 1);</span>
<span class='curline'><a href='../S/4438.html#L107'>session</a>           107 tests/handshake-large-cert.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4438.html#L150'>session</a>           150 tests/handshake-large-cert.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4438.html#L176'>session</a>           176 tests/handshake-large-cert.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/4438.html#L178'>session</a>           178 tests/handshake-large-cert.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4438.html#L180'>session</a>           180 tests/handshake-large-cert.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4438.html#L183'>session</a>           183 tests/handshake-large-cert.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4438.html#L184'>session</a>           184 tests/handshake-large-cert.c 	gnutls_handshake_set_timeout(session, 60 * 1000);</span>
<span class='curline'><a href='../S/4438.html#L187'>session</a>           187 tests/handshake-large-cert.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4438.html#L192'>session</a>           192 tests/handshake-large-cert.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4438.html#L200'>session</a>           200 tests/handshake-large-cert.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4438.html#L203'>session</a>           203 tests/handshake-large-cert.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4549.html#L75'>session</a>            75 tests/handshake-large-packet.c static int ext_recv_client_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/4549.html#L85'>session</a>            85 tests/handshake-large-packet.c static int ext_send_client_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/4549.html#L96'>session</a>            96 tests/handshake-large-packet.c static int ext_recv_server_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/4549.html#L101'>session</a>           101 tests/handshake-large-packet.c static int ext_send_server_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/4549.html#L116'>session</a>           116 tests/handshake-large-packet.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4549.html#L130'>session</a>           130 tests/handshake-large-packet.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4549.html#L133'>session</a>           133 tests/handshake-large-packet.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4549.html#L137'>session</a>           137 tests/handshake-large-packet.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4549.html#L140'>session</a>           140 tests/handshake-large-packet.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4549.html#L141'>session</a>           141 tests/handshake-large-packet.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4549.html#L143'>session</a>           143 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_client1", TLSEXT_TYPE1, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L144'>session</a>           144 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_client2", TLSEXT_TYPE2, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L145'>session</a>           145 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_client3", TLSEXT_TYPE3, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L146'>session</a>           146 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_client4", TLSEXT_TYPE4, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L147'>session</a>           147 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_client5", TLSEXT_TYPE5, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L152'>session</a>           152 tests/handshake-large-packet.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4549.html#L167'>session</a>           167 tests/handshake-large-packet.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4549.html#L172'>session</a>           172 tests/handshake-large-packet.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4549.html#L183'>session</a>           183 tests/handshake-large-packet.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4549.html#L199'>session</a>           199 tests/handshake-large-packet.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4549.html#L204'>session</a>           204 tests/handshake-large-packet.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4549.html#L206'>session</a>           206 tests/handshake-large-packet.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4549.html#L209'>session</a>           209 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_server1", TLSEXT_TYPE1, GNUTLS_EXT_TLS, ext_recv_server_params, ext_send_server_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L210'>session</a>           210 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_server2", TLSEXT_TYPE2, GNUTLS_EXT_TLS, ext_recv_server_params, ext_send_server_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L211'>session</a>           211 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_server3", TLSEXT_TYPE3, GNUTLS_EXT_TLS, ext_recv_server_params, ext_send_server_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L212'>session</a>           212 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_server4", TLSEXT_TYPE4, GNUTLS_EXT_TLS, ext_recv_server_params, ext_send_server_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L213'>session</a>           213 tests/handshake-large-packet.c 	gnutls_session_ext_register(session, "ext_server5", TLSEXT_TYPE5, GNUTLS_EXT_TLS, ext_recv_server_params, ext_send_server_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4549.html#L215'>session</a>           215 tests/handshake-large-packet.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4549.html#L216'>session</a>           216 tests/handshake-large-packet.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4549.html#L219'>session</a>           219 tests/handshake-large-packet.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4549.html#L224'>session</a>           224 tests/handshake-large-packet.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4549.html#L237'>session</a>           237 tests/handshake-large-packet.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4549.html#L240'>session</a>           240 tests/handshake-large-packet.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4935.html#L69'>session</a>            69 tests/handshake-timeout.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4935.html#L82'>session</a>            82 tests/handshake-timeout.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4935.html#L83'>session</a>            83 tests/handshake-timeout.c 	gnutls_handshake_set_timeout(session, tmo_ms);</span>
<span class='curline'><a href='../S/4935.html#L86'>session</a>            86 tests/handshake-timeout.c 	gnutls_priority_set_direct(session, "NORMAL:+ANON-ECDH:-VERS-ALL:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4935.html#L90'>session</a>            90 tests/handshake-timeout.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4935.html#L92'>session</a>            92 tests/handshake-timeout.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4935.html#L97'>session</a>            97 tests/handshake-timeout.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4935.html#L101'>session</a>           101 tests/handshake-timeout.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4935.html#L129'>session</a>           129 tests/handshake-timeout.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4935.html#L143'>session</a>           143 tests/handshake-timeout.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4935.html#L148'>session</a>           148 tests/handshake-timeout.c 	gnutls_priority_set_direct(session, "NORMAL:+ANON-ECDH:-VERS-ALL:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4935.html#L150'>session</a>           150 tests/handshake-timeout.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4935.html#L152'>session</a>           152 tests/handshake-timeout.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4935.html#L162'>session</a>           162 tests/handshake-timeout.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4935.html#L167'>session</a>           167 tests/handshake-timeout.c 			gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4935.html#L170'>session</a>           170 tests/handshake-timeout.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4526.html#L39'>session</a>            39 tests/handshake-versions.c void _gnutls_hello_set_default_version(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4950.html#L93'>session</a>            93 tests/key-material-dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4950.html#L117'>session</a>           117 tests/key-material-dtls.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4950.html#L120'>session</a>           120 tests/key-material-dtls.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4950.html#L131'>session</a>           131 tests/key-material-dtls.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4950.html#L133'>session</a>           133 tests/key-material-dtls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4950.html#L138'>session</a>           138 tests/key-material-dtls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4950.html#L153'>session</a>           153 tests/key-material-dtls.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4950.html#L155'>session</a>           155 tests/key-material-dtls.c 	ret = gnutls_cipher_get(session);</span>
<span class='curline'><a href='../S/4950.html#L161'>session</a>           161 tests/key-material-dtls.c 	ret = gnutls_mac_get(session);</span>
<span class='curline'><a href='../S/4950.html#L172'>session</a>           172 tests/key-material-dtls.c 	ret = gnutls_prf(session, 13, "key expansion", 1, 0, NULL, block_size,</span>
<span class='curline'><a href='../S/4950.html#L182'>session</a>           182 tests/key-material-dtls.c 	ret = gnutls_record_get_state(session, 0, &amp;mac_key, &amp;iv, &amp;cipher_key, wseq_number);</span>
<span class='curline'><a href='../S/4950.html#L195'>session</a>           195 tests/key-material-dtls.c 	ret = gnutls_record_get_state(session, 1, &amp;read_mac_key, &amp;read_iv, &amp;read_cipher_key, rseq_number);</span>
<span class='curline'><a href='../S/4950.html#L238'>session</a>           238 tests/key-material-dtls.c 		ret = gnutls_record_send(session, "hello", 5);</span>
<span class='curline'><a href='../S/4950.html#L245'>session</a>           245 tests/key-material-dtls.c 	ret = gnutls_record_get_state(session, 0, NULL, NULL, NULL, wseq_number);</span>
<span class='curline'><a href='../S/4950.html#L259'>session</a>           259 tests/key-material-dtls.c 	ret = gnutls_record_get_state(session, 1, NULL, NULL, NULL, rseq_number);</span>
<span class='curline'><a href='../S/4950.html#L271'>session</a>           271 tests/key-material-dtls.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4950.html#L275'>session</a>           275 tests/key-material-dtls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4950.html#L285'>session</a>           285 tests/key-material-dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4950.html#L306'>session</a>           306 tests/key-material-dtls.c 	gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4950.html#L311'>session</a>           311 tests/key-material-dtls.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4950.html#L319'>session</a>           319 tests/key-material-dtls.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4950.html#L321'>session</a>           321 tests/key-material-dtls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4950.html#L324'>session</a>           324 tests/key-material-dtls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4950.html#L329'>session</a>           329 tests/key-material-dtls.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4950.html#L340'>session</a>           340 tests/key-material-dtls.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4950.html#L343'>session</a>           343 tests/key-material-dtls.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4950.html#L352'>session</a>           352 tests/key-material-dtls.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4950.html#L355'>session</a>           355 tests/key-material-dtls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5116.html#L81'>session</a>            81 tests/key-material-set-dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5116.html#L102'>session</a>           102 tests/key-material-set-dtls.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5116.html#L103'>session</a>           103 tests/key-material-set-dtls.c 	gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/5116.html#L106'>session</a>           106 tests/key-material-set-dtls.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5116.html#L117'>session</a>           117 tests/key-material-set-dtls.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5116.html#L119'>session</a>           119 tests/key-material-set-dtls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5116.html#L124'>session</a>           124 tests/key-material-set-dtls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5116.html#L139'>session</a>           139 tests/key-material-set-dtls.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5116.html#L141'>session</a>           141 tests/key-material-set-dtls.c 	ret = gnutls_cipher_get(session);</span>
<span class='curline'><a href='../S/5116.html#L147'>session</a>           147 tests/key-material-set-dtls.c 	ret = gnutls_mac_get(session);</span>
<span class='curline'><a href='../S/5116.html#L154'>session</a>           154 tests/key-material-set-dtls.c 	ret = gnutls_record_get_state(session, 0, NULL, NULL, NULL, wseq_number);</span>
<span class='curline'><a href='../S/5116.html#L161'>session</a>           161 tests/key-material-set-dtls.c 	ret = gnutls_record_get_state(session, 1, NULL, NULL, NULL, rseq_number);</span>
<span class='curline'><a href='../S/5116.html#L170'>session</a>           170 tests/key-material-set-dtls.c 		ret = gnutls_record_send(session, "hello", 5);</span>
<span class='curline'><a href='../S/5116.html#L175'>session</a>           175 tests/key-material-set-dtls.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5116.html#L181'>session</a>           181 tests/key-material-set-dtls.c 	ret = gnutls_record_send(session, "reset", 5);</span>
<span class='curline'><a href='../S/5116.html#L186'>session</a>           186 tests/key-material-set-dtls.c 	ret = gnutls_record_set_state(session, 0, wseq_number);</span>
<span class='curline'><a href='../S/5116.html#L193'>session</a>           193 tests/key-material-set-dtls.c 	ret = gnutls_record_set_state(session, 1, rseq_number);</span>
<span class='curline'><a href='../S/5116.html#L200'>session</a>           200 tests/key-material-set-dtls.c 	ret = gnutls_record_send(session, "ping", 4);</span>
<span class='curline'><a href='../S/5116.html#L205'>session</a>           205 tests/key-material-set-dtls.c 	ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5116.html#L214'>session</a>           214 tests/key-material-set-dtls.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5116.html#L218'>session</a>           218 tests/key-material-set-dtls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5116.html#L228'>session</a>           228 tests/key-material-set-dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5116.html#L251'>session</a>           251 tests/key-material-set-dtls.c 	gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5116.html#L252'>session</a>           252 tests/key-material-set-dtls.c 	gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/5116.html#L257'>session</a>           257 tests/key-material-set-dtls.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5116.html#L265'>session</a>           265 tests/key-material-set-dtls.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5116.html#L267'>session</a>           267 tests/key-material-set-dtls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5116.html#L270'>session</a>           270 tests/key-material-set-dtls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5116.html#L275'>session</a>           275 tests/key-material-set-dtls.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5116.html#L286'>session</a>           286 tests/key-material-set-dtls.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5116.html#L289'>session</a>           289 tests/key-material-set-dtls.c 	ret = gnutls_record_get_state(session, 0, NULL, NULL, NULL, wseq_number);</span>
<span class='curline'><a href='../S/5116.html#L294'>session</a>           294 tests/key-material-set-dtls.c 	ret = gnutls_record_get_state(session, 1, NULL, NULL, NULL, rseq_number);</span>
<span class='curline'><a href='../S/5116.html#L300'>session</a>           300 tests/key-material-set-dtls.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5116.html#L309'>session</a>           309 tests/key-material-set-dtls.c 			ret = gnutls_record_send(session, buf, ret);</span>
<span class='curline'><a href='../S/5116.html#L317'>session</a>           317 tests/key-material-set-dtls.c 	ret = gnutls_record_set_state(session, 0, wseq_number);</span>
<span class='curline'><a href='../S/5116.html#L322'>session</a>           322 tests/key-material-set-dtls.c 	ret = gnutls_record_set_state(session, 1, rseq_number);</span>
<span class='curline'><a href='../S/5116.html#L327'>session</a>           327 tests/key-material-set-dtls.c 	ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5116.html#L330'>session</a>           330 tests/key-material-set-dtls.c 		ret = gnutls_record_send(session, "pong", 4);</span>
<span class='curline'><a href='../S/5116.html#L339'>session</a>           339 tests/key-material-set-dtls.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5116.html#L342'>session</a>           342 tests/key-material-set-dtls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4362.html#L184'>session</a>           184 tests/key-usage-ecdhe-rsa.c cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5126.html#L223'>session</a>           223 tests/key-usage-rsa.c cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4386.html#L76'>session</a>            76 tests/keylog-func.c keylog_func(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4386.html#L80'>session</a>            80 tests/keylog-func.c 	unsigned int *call_count = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/4386.html#L106'>session</a>           106 tests/keylog-func.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4386.html#L125'>session</a>           125 tests/keylog-func.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4386.html#L127'>session</a>           127 tests/keylog-func.c 	gnutls_session_set_ptr(session, &amp;call_count);</span>
<span class='curline'><a href='../S/4386.html#L130'>session</a>           130 tests/keylog-func.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/4386.html#L137'>session</a>           137 tests/keylog-func.c 	ret = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4386.html#L142'>session</a>           142 tests/keylog-func.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4386.html#L144'>session</a>           144 tests/keylog-func.c 	gnutls_session_set_keylog_function(session, keylog_func);</span>
<span class='curline'><a href='../S/4386.html#L145'>session</a>           145 tests/keylog-func.c 	assert(gnutls_session_get_keylog_function(session) == keylog_func);</span>
<span class='curline'><a href='../S/4386.html#L150'>session</a>           150 tests/keylog-func.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4386.html#L164'>session</a>           164 tests/keylog-func.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4386.html#L166'>session</a>           166 tests/keylog-func.c 	gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4386.html#L169'>session</a>           169 tests/keylog-func.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4386.html#L191'>session</a>           191 tests/keylog-func.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4386.html#L195'>session</a>           195 tests/keylog-func.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4386.html#L206'>session</a>           206 tests/keylog-func.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4386.html#L221'>session</a>           221 tests/keylog-func.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4386.html#L223'>session</a>           223 tests/keylog-func.c 	gnutls_session_set_ptr(session, &amp;call_count);</span>
<span class='curline'><a href='../S/4386.html#L228'>session</a>           228 tests/keylog-func.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4386.html#L239'>session</a>           239 tests/keylog-func.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4386.html#L242'>session</a>           242 tests/keylog-func.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4386.html#L244'>session</a>           244 tests/keylog-func.c 	gnutls_session_set_keylog_function(session, keylog_func);</span>
<span class='curline'><a href='../S/4386.html#L247'>session</a>           247 tests/keylog-func.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4386.html#L252'>session</a>           252 tests/keylog-func.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4386.html#L263'>session</a>           263 tests/keylog-func.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4386.html#L268'>session</a>           268 tests/keylog-func.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4386.html#L279'>session</a>           279 tests/keylog-func.c 		gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4386.html#L289'>session</a>           289 tests/keylog-func.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4386.html#L292'>session</a>           292 tests/keylog-func.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5127.html#L110'>session</a>           110 tests/long-session-id.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5127.html#L124'>session</a>           124 tests/long-session-id.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5127.html#L127'>session</a>           127 tests/long-session-id.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5127.html#L129'>session</a>           129 tests/long-session-id.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5127.html#L131'>session</a>           131 tests/long-session-id.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5127.html#L136'>session</a>           136 tests/long-session-id.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5127.html#L140'>session</a>           140 tests/long-session-id.c 	r = gnutls_ecc_curve_get(session);</span>
<span class='curline'><a href='../S/5127.html#L157'>session</a>           157 tests/long-session-id.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5136.html#L73'>session</a>            73 tests/mini-alpn.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5136.html#L90'>session</a>            90 tests/mini-alpn.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5136.html#L93'>session</a>            93 tests/mini-alpn.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5136.html#L105'>session</a>           105 tests/mini-alpn.c 		ret = gnutls_alpn_set_protocols(session, t, 3, 0);</span>
<span class='curline'><a href='../S/5136.html#L114'>session</a>           114 tests/mini-alpn.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5136.html#L116'>session</a>           116 tests/mini-alpn.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5136.html#L121'>session</a>           121 tests/mini-alpn.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5136.html#L137'>session</a>           137 tests/mini-alpn.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5136.html#L139'>session</a>           139 tests/mini-alpn.c 	ret = gnutls_alpn_get_selected_protocol(session, &amp;proto);</span>
<span class='curline'><a href='../S/5136.html#L151'>session</a>           151 tests/mini-alpn.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5136.html#L155'>session</a>           155 tests/mini-alpn.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5136.html#L174'>session</a>           174 tests/mini-alpn.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5136.html#L190'>session</a>           190 tests/mini-alpn.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5136.html#L195'>session</a>           195 tests/mini-alpn.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5136.html#L204'>session</a>           204 tests/mini-alpn.c 	ret = gnutls_alpn_set_protocols(session, t, 2, 0);</span>
<span class='curline'><a href='../S/5136.html#L210'>session</a>           210 tests/mini-alpn.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5136.html#L212'>session</a>           212 tests/mini-alpn.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5136.html#L215'>session</a>           215 tests/mini-alpn.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5136.html#L220'>session</a>           220 tests/mini-alpn.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5136.html#L231'>session</a>           231 tests/mini-alpn.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5136.html#L233'>session</a>           233 tests/mini-alpn.c 	ret = gnutls_alpn_get_selected_protocol(session, &amp;selected);</span>
<span class='curline'><a href='../S/5136.html#L250'>session</a>           250 tests/mini-alpn.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5136.html#L253'>session</a>           253 tests/mini-alpn.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5038.html#L188'>session</a>           188 tests/mini-chain-unsorted.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5038.html#L202'>session</a>           202 tests/mini-chain-unsorted.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5038.html#L206'>session</a>           206 tests/mini-chain-unsorted.c 	    gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5038.html#L216'>session</a>           216 tests/mini-chain-unsorted.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5038.html#L218'>session</a>           218 tests/mini-chain-unsorted.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5038.html#L223'>session</a>           223 tests/mini-chain-unsorted.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5038.html#L241'>session</a>           241 tests/mini-chain-unsorted.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5038.html#L245'>session</a>           245 tests/mini-chain-unsorted.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5038.html#L260'>session</a>           260 tests/mini-chain-unsorted.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5038.html#L268'>session</a>           268 tests/mini-chain-unsorted.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5038.html#L273'>session</a>           273 tests/mini-chain-unsorted.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5038.html#L290'>session</a>           290 tests/mini-chain-unsorted.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5038.html#L292'>session</a>           292 tests/mini-chain-unsorted.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5038.html#L295'>session</a>           295 tests/mini-chain-unsorted.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5038.html#L306'>session</a>           306 tests/mini-chain-unsorted.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5038.html#L308'>session</a>           308 tests/mini-chain-unsorted.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4530.html#L92'>session</a>            92 tests/mini-dtls-discard.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4530.html#L106'>session</a>           106 tests/mini-dtls-discard.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4530.html#L107'>session</a>           107 tests/mini-dtls-discard.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4530.html#L108'>session</a>           108 tests/mini-dtls-discard.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4530.html#L111'>session</a>           111 tests/mini-dtls-discard.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4530.html#L115'>session</a>           115 tests/mini-dtls-discard.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4530.html#L117'>session</a>           117 tests/mini-dtls-discard.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4530.html#L122'>session</a>           122 tests/mini-dtls-discard.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4530.html#L138'>session</a>           138 tests/mini-dtls-discard.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4530.html#L140'>session</a>           140 tests/mini-dtls-discard.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4530.html#L142'>session</a>           142 tests/mini-dtls-discard.c 		ret = gnutls_record_send(session, TXT1, TXT1_SIZE);</span>
<span class='curline'><a href='../S/4530.html#L145'>session</a>           145 tests/mini-dtls-discard.c 			gnutls_record_discard_queued(session);</span>
<span class='curline'><a href='../S/4530.html#L151'>session</a>           151 tests/mini-dtls-discard.c 		ret = gnutls_record_send(session, TXT2, TXT2_SIZE);</span>
<span class='curline'><a href='../S/4530.html#L154'>session</a>           154 tests/mini-dtls-discard.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4530.html#L158'>session</a>           158 tests/mini-dtls-discard.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4530.html#L183'>session</a>           183 tests/mini-dtls-discard.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4530.html#L196'>session</a>           196 tests/mini-dtls-discard.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4530.html#L197'>session</a>           197 tests/mini-dtls-discard.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4530.html#L198'>session</a>           198 tests/mini-dtls-discard.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4530.html#L203'>session</a>           203 tests/mini-dtls-discard.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4530.html#L205'>session</a>           205 tests/mini-dtls-discard.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4530.html#L207'>session</a>           207 tests/mini-dtls-discard.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4530.html#L210'>session</a>           210 tests/mini-dtls-discard.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4530.html#L215'>session</a>           215 tests/mini-dtls-discard.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4530.html#L226'>session</a>           226 tests/mini-dtls-discard.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4530.html#L232'>session</a>           232 tests/mini-dtls-discard.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4530.html#L242'>session</a>           242 tests/mini-dtls-discard.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4530.html#L251'>session</a>           251 tests/mini-dtls-discard.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4530.html#L254'>session</a>           254 tests/mini-dtls-discard.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4372.html#L112'>session</a>           112 tests/mini-dtls-fork.c void do_fork_stuff(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4372.html#L126'>session</a>           126 tests/mini-dtls-fork.c 				(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4372.html#L129'>session</a>           129 tests/mini-dtls-fork.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4372.html#L139'>session</a>           139 tests/mini-dtls-fork.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4372.html#L149'>session</a>           149 tests/mini-dtls-fork.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4372.html#L155'>session</a>           155 tests/mini-dtls-fork.c 		ret = gnutls_record_send(session, MSG, sizeof(MSG)-1);</span>
<span class='curline'><a href='../S/4372.html#L161'>session</a>           161 tests/mini-dtls-fork.c 		ret = gnutls_record_send(session, MSG2, sizeof(MSG2)-1);</span>
<span class='curline'><a href='../S/4372.html#L167'>session</a>           167 tests/mini-dtls-fork.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4372.html#L171'>session</a>           171 tests/mini-dtls-fork.c static void do_reflect_stuff(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4372.html#L178'>session</a>           178 tests/mini-dtls-fork.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4372.html#L192'>session</a>           192 tests/mini-dtls-fork.c 		ret = gnutls_record_send(session, buf, buf_size);</span>
<span class='curline'><a href='../S/4372.html#L201'>session</a>           201 tests/mini-dtls-fork.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4372.html#L208'>session</a>           208 tests/mini-dtls-fork.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4372.html#L223'>session</a>           223 tests/mini-dtls-fork.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4372.html#L224'>session</a>           224 tests/mini-dtls-fork.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4372.html#L225'>session</a>           225 tests/mini-dtls-fork.c 	gnutls_dtls_set_timeouts(session, 6 * 1000, 60 * 1000);</span>
<span class='curline'><a href='../S/4372.html#L229'>session</a>           229 tests/mini-dtls-fork.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4372.html#L235'>session</a>           235 tests/mini-dtls-fork.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4372.html#L237'>session</a>           237 tests/mini-dtls-fork.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4372.html#L242'>session</a>           242 tests/mini-dtls-fork.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4372.html#L256'>session</a>           256 tests/mini-dtls-fork.c 		do_fork_stuff(session);</span>
<span class='curline'><a href='../S/4372.html#L258'>session</a>           258 tests/mini-dtls-fork.c 		do_reflect_stuff(session);</span>
<span class='curline'><a href='../S/4372.html#L262'>session</a>           262 tests/mini-dtls-fork.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4372.html#L275'>session</a>           275 tests/mini-dtls-fork.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4372.html#L294'>session</a>           294 tests/mini-dtls-fork.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4372.html#L295'>session</a>           295 tests/mini-dtls-fork.c 	gnutls_dtls_set_timeouts(session, 5 * 1000, 60 * 1000);</span>
<span class='curline'><a href='../S/4372.html#L296'>session</a>           296 tests/mini-dtls-fork.c 	gnutls_dtls_set_mtu(session, 400);</span>
<span class='curline'><a href='../S/4372.html#L301'>session</a>           301 tests/mini-dtls-fork.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4372.html#L305'>session</a>           305 tests/mini-dtls-fork.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4372.html#L307'>session</a>           307 tests/mini-dtls-fork.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4372.html#L310'>session</a>           310 tests/mini-dtls-fork.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4372.html#L314'>session</a>           314 tests/mini-dtls-fork.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4372.html#L325'>session</a>           325 tests/mini-dtls-fork.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4372.html#L328'>session</a>           328 tests/mini-dtls-fork.c 		do_fork_stuff(session);</span>
<span class='curline'><a href='../S/4372.html#L330'>session</a>           330 tests/mini-dtls-fork.c 		do_reflect_stuff(session);</span>
<span class='curline'><a href='../S/4372.html#L334'>session</a>           334 tests/mini-dtls-fork.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5089.html#L78'>session</a>            78 tests/mini-dtls-heartbeat.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5089.html#L95'>session</a>            95 tests/mini-dtls-heartbeat.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5089.html#L96'>session</a>            96 tests/mini-dtls-heartbeat.c 	gnutls_heartbeat_enable(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND);</span>
<span class='curline'><a href='../S/5089.html#L97'>session</a>            97 tests/mini-dtls-heartbeat.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5089.html#L100'>session</a>           100 tests/mini-dtls-heartbeat.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5089.html#L106'>session</a>           106 tests/mini-dtls-heartbeat.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5089.html#L108'>session</a>           108 tests/mini-dtls-heartbeat.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5089.html#L113'>session</a>           113 tests/mini-dtls-heartbeat.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5089.html#L129'>session</a>           129 tests/mini-dtls-heartbeat.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5089.html#L134'>session</a>           134 tests/mini-dtls-heartbeat.c 			    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/5089.html#L141'>session</a>           141 tests/mini-dtls-heartbeat.c 				ret2 = gnutls_heartbeat_pong(session, 0);</span>
<span class='curline'><a href='../S/5089.html#L159'>session</a>           159 tests/mini-dtls-heartbeat.c 			    gnutls_heartbeat_ping(session, 256, 5,</span>
<span class='curline'><a href='../S/5089.html#L174'>session</a>           174 tests/mini-dtls-heartbeat.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5089.html#L178'>session</a>           178 tests/mini-dtls-heartbeat.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5089.html#L189'>session</a>           189 tests/mini-dtls-heartbeat.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5089.html#L191'>session</a>           191 tests/mini-dtls-heartbeat.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5089.html#L192'>session</a>           192 tests/mini-dtls-heartbeat.c 	gnutls_heartbeat_enable(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND);</span>
<span class='curline'><a href='../S/5089.html#L193'>session</a>           193 tests/mini-dtls-heartbeat.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5089.html#L198'>session</a>           198 tests/mini-dtls-heartbeat.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5089.html#L202'>session</a>           202 tests/mini-dtls-heartbeat.c 	return session;</span>
<span class='curline'><a href='../S/5089.html#L218'>session</a>           218 tests/mini-dtls-heartbeat.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5089.html#L231'>session</a>           231 tests/mini-dtls-heartbeat.c 	session = initialize_tls_session();</span>
<span class='curline'><a href='../S/5089.html#L232'>session</a>           232 tests/mini-dtls-heartbeat.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5089.html#L234'>session</a>           234 tests/mini-dtls-heartbeat.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5089.html#L237'>session</a>           237 tests/mini-dtls-heartbeat.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5089.html#L242'>session</a>           242 tests/mini-dtls-heartbeat.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5089.html#L253'>session</a>           253 tests/mini-dtls-heartbeat.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5089.html#L261'>session</a>           261 tests/mini-dtls-heartbeat.c 			    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/5089.html#L268'>session</a>           268 tests/mini-dtls-heartbeat.c 				ret2 = gnutls_heartbeat_pong(session, 0);</span>
<span class='curline'><a href='../S/5089.html#L281'>session</a>           281 tests/mini-dtls-heartbeat.c 			    gnutls_heartbeat_ping(session, 256, 5,</span>
<span class='curline'><a href='../S/5089.html#L298'>session</a>           298 tests/mini-dtls-heartbeat.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5089.html#L301'>session</a>           301 tests/mini-dtls-heartbeat.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4972.html#L84'>session</a>            84 tests/mini-dtls-hello-verify-48.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4972.html#L98'>session</a>            98 tests/mini-dtls-hello-verify-48.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4972.html#L99'>session</a>            99 tests/mini-dtls-hello-verify-48.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4972.html#L100'>session</a>           100 tests/mini-dtls-hello-verify-48.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4972.html#L103'>session</a>           103 tests/mini-dtls-hello-verify-48.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4972.html#L109'>session</a>           109 tests/mini-dtls-hello-verify-48.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4972.html#L111'>session</a>           111 tests/mini-dtls-hello-verify-48.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4972.html#L112'>session</a>           112 tests/mini-dtls-hello-verify-48.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4972.html#L117'>session</a>           117 tests/mini-dtls-hello-verify-48.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4972.html#L131'>session</a>           131 tests/mini-dtls-hello-verify-48.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4972.html#L179'>session</a>           179 tests/mini-dtls-hello-verify-48.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4972.html#L199'>session</a>           199 tests/mini-dtls-hello-verify-48.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4972.html#L200'>session</a>           200 tests/mini-dtls-hello-verify-48.c 	gnutls_handshake_set_timeout(session, SERV_TIMEOUT * 1000);</span>
<span class='curline'><a href='../S/4972.html#L201'>session</a>           201 tests/mini-dtls-hello-verify-48.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4972.html#L206'>session</a>           206 tests/mini-dtls-hello-verify-48.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4972.html#L210'>session</a>           210 tests/mini-dtls-hello-verify-48.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4972.html#L212'>session</a>           212 tests/mini-dtls-hello-verify-48.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4972.html#L213'>session</a>           213 tests/mini-dtls-hello-verify-48.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4972.html#L269'>session</a>           269 tests/mini-dtls-hello-verify-48.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4358.html#L85'>session</a>            85 tests/mini-dtls-hello-verify.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4358.html#L99'>session</a>            99 tests/mini-dtls-hello-verify.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4358.html#L100'>session</a>           100 tests/mini-dtls-hello-verify.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4358.html#L101'>session</a>           101 tests/mini-dtls-hello-verify.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4358.html#L104'>session</a>           104 tests/mini-dtls-hello-verify.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4358.html#L110'>session</a>           110 tests/mini-dtls-hello-verify.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4358.html#L112'>session</a>           112 tests/mini-dtls-hello-verify.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4358.html#L113'>session</a>           113 tests/mini-dtls-hello-verify.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4358.html#L118'>session</a>           118 tests/mini-dtls-hello-verify.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4358.html#L134'>session</a>           134 tests/mini-dtls-hello-verify.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4358.html#L137'>session</a>           137 tests/mini-dtls-hello-verify.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4358.html#L150'>session</a>           150 tests/mini-dtls-hello-verify.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4358.html#L156'>session</a>           156 tests/mini-dtls-hello-verify.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4358.html#L186'>session</a>           186 tests/mini-dtls-hello-verify.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4358.html#L205'>session</a>           205 tests/mini-dtls-hello-verify.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4358.html#L206'>session</a>           206 tests/mini-dtls-hello-verify.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4358.html#L207'>session</a>           207 tests/mini-dtls-hello-verify.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4358.html#L212'>session</a>           212 tests/mini-dtls-hello-verify.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4358.html#L216'>session</a>           216 tests/mini-dtls-hello-verify.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4358.html#L218'>session</a>           218 tests/mini-dtls-hello-verify.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4358.html#L219'>session</a>           219 tests/mini-dtls-hello-verify.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4358.html#L264'>session</a>           264 tests/mini-dtls-hello-verify.c 	gnutls_dtls_prestate_set(session, &amp;prestate);</span>
<span class='curline'><a href='../S/4358.html#L267'>session</a>           267 tests/mini-dtls-hello-verify.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4358.html#L272'>session</a>           272 tests/mini-dtls-hello-verify.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4358.html#L283'>session</a>           283 tests/mini-dtls-hello-verify.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4358.html#L289'>session</a>           289 tests/mini-dtls-hello-verify.c 		ret = gnutls_record_send(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4358.html#L294'>session</a>           294 tests/mini-dtls-hello-verify.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4358.html#L303'>session</a>           303 tests/mini-dtls-hello-verify.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4358.html#L306'>session</a>           306 tests/mini-dtls-hello-verify.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4423.html#L75'>session</a>            75 tests/mini-dtls-large.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4423.html#L92'>session</a>            92 tests/mini-dtls-large.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4423.html#L93'>session</a>            93 tests/mini-dtls-large.c 	gnutls_heartbeat_enable(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND);</span>
<span class='curline'><a href='../S/4423.html#L94'>session</a>            94 tests/mini-dtls-large.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4423.html#L97'>session</a>            97 tests/mini-dtls-large.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4423.html#L103'>session</a>           103 tests/mini-dtls-large.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4423.html#L105'>session</a>           105 tests/mini-dtls-large.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4423.html#L110'>session</a>           110 tests/mini-dtls-large.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4423.html#L126'>session</a>           126 tests/mini-dtls-large.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4423.html#L129'>session</a>           129 tests/mini-dtls-large.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4423.html#L140'>session</a>           140 tests/mini-dtls-large.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4423.html#L159'>session</a>           159 tests/mini-dtls-large.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4423.html#L172'>session</a>           172 tests/mini-dtls-large.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4423.html#L173'>session</a>           173 tests/mini-dtls-large.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4423.html#L178'>session</a>           178 tests/mini-dtls-large.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4423.html#L182'>session</a>           182 tests/mini-dtls-large.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4423.html#L184'>session</a>           184 tests/mini-dtls-large.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4423.html#L187'>session</a>           187 tests/mini-dtls-large.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4423.html#L192'>session</a>           192 tests/mini-dtls-large.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4423.html#L203'>session</a>           203 tests/mini-dtls-large.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4423.html#L212'>session</a>           212 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L213'>session</a>           213 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session) + 12);</span>
<span class='curline'><a href='../S/4423.html#L220'>session</a>           220 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L221'>session</a>           221 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session) + 5048);</span>
<span class='curline'><a href='../S/4423.html#L228'>session</a>           228 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L229'>session</a>           229 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session));</span>
<span class='curline'><a href='../S/4423.html#L235'>session</a>           235 tests/mini-dtls-large.c 	gnutls_dtls_set_mtu(session, MAX_MTU);</span>
<span class='curline'><a href='../S/4423.html#L237'>session</a>           237 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L238'>session</a>           238 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session) + 12);</span>
<span class='curline'><a href='../S/4423.html#L245'>session</a>           245 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L246'>session</a>           246 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session) + 5048);</span>
<span class='curline'><a href='../S/4423.html#L253'>session</a>           253 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L254'>session</a>           254 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session));</span>
<span class='curline'><a href='../S/4423.html#L261'>session</a>           261 tests/mini-dtls-large.c 	gnutls_record_cork(session);</span>
<span class='curline'><a href='../S/4423.html#L264'>session</a>           264 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L265'>session</a>           265 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session));</span>
<span class='curline'><a href='../S/4423.html#L271'>session</a>           271 tests/mini-dtls-large.c 	ret = gnutls_record_uncork(session, 0);</span>
<span class='curline'><a href='../S/4423.html#L277'>session</a>           277 tests/mini-dtls-large.c 	gnutls_record_cork(session);</span>
<span class='curline'><a href='../S/4423.html#L280'>session</a>           280 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L281'>session</a>           281 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session) - 16);</span>
<span class='curline'><a href='../S/4423.html#L288'>session</a>           288 tests/mini-dtls-large.c 	    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4423.html#L289'>session</a>           289 tests/mini-dtls-large.c 				gnutls_dtls_get_data_mtu(session));</span>
<span class='curline'><a href='../S/4423.html#L295'>session</a>           295 tests/mini-dtls-large.c 	ret = gnutls_record_uncork(session, GNUTLS_RECORD_WAIT);</span>
<span class='curline'><a href='../S/4423.html#L303'>session</a>           303 tests/mini-dtls-large.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4423.html#L306'>session</a>           306 tests/mini-dtls-large.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4453.html#L115'>session</a>           115 tests/mini-dtls-lowmtu.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4453.html#L130'>session</a>           130 tests/mini-dtls-lowmtu.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4453.html#L134'>session</a>           134 tests/mini-dtls-lowmtu.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4453.html#L138'>session</a>           138 tests/mini-dtls-lowmtu.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4453.html#L139'>session</a>           139 tests/mini-dtls-lowmtu.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4453.html#L141'>session</a>           141 tests/mini-dtls-lowmtu.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4453.html#L146'>session</a>           146 tests/mini-dtls-lowmtu.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4453.html#L161'>session</a>           161 tests/mini-dtls-lowmtu.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4453.html#L165'>session</a>           165 tests/mini-dtls-lowmtu.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4453.html#L182'>session</a>           182 tests/mini-dtls-lowmtu.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4453.html#L188'>session</a>           188 tests/mini-dtls-lowmtu.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4453.html#L210'>session</a>           210 tests/mini-dtls-lowmtu.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4453.html#L231'>session</a>           231 tests/mini-dtls-lowmtu.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4453.html#L232'>session</a>           232 tests/mini-dtls-lowmtu.c 	gnutls_dtls_set_mtu(session, 104);</span>
<span class='curline'><a href='../S/4453.html#L237'>session</a>           237 tests/mini-dtls-lowmtu.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4453.html#L239'>session</a>           239 tests/mini-dtls-lowmtu.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4453.html#L240'>session</a>           240 tests/mini-dtls-lowmtu.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4453.html#L242'>session</a>           242 tests/mini-dtls-lowmtu.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4453.html#L245'>session</a>           245 tests/mini-dtls-lowmtu.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4453.html#L250'>session</a>           250 tests/mini-dtls-lowmtu.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4453.html#L261'>session</a>           261 tests/mini-dtls-lowmtu.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4453.html#L262'>session</a>           262 tests/mini-dtls-lowmtu.c 	mtu = gnutls_dtls_get_mtu(session);</span>
<span class='curline'><a href='../S/4453.html#L266'>session</a>           266 tests/mini-dtls-lowmtu.c 		    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4453.html#L267'>session</a>           267 tests/mini-dtls-lowmtu.c 					gnutls_dtls_get_data_mtu(session));</span>
<span class='curline'><a href='../S/4453.html#L278'>session</a>           278 tests/mini-dtls-lowmtu.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4453.html#L281'>session</a>           281 tests/mini-dtls-lowmtu.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4346.html#L134'>session</a>           134 tests/mini-dtls-mtu.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4346.html#L149'>session</a>           149 tests/mini-dtls-mtu.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4346.html#L150'>session</a>           150 tests/mini-dtls-mtu.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4346.html#L151'>session</a>           151 tests/mini-dtls-mtu.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4346.html#L154'>session</a>           154 tests/mini-dtls-mtu.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4346.html#L160'>session</a>           160 tests/mini-dtls-mtu.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4346.html#L162'>session</a>           162 tests/mini-dtls-mtu.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4346.html#L163'>session</a>           163 tests/mini-dtls-mtu.c 	gnutls_transport_set_pull_function(session, client_pull);</span>
<span class='curline'><a href='../S/4346.html#L164'>session</a>           164 tests/mini-dtls-mtu.c 	gnutls_transport_set_pull_timeout_function(session, client_pull_timeout);</span>
<span class='curline'><a href='../S/4346.html#L169'>session</a>           169 tests/mini-dtls-mtu.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4346.html#L185'>session</a>           185 tests/mini-dtls-mtu.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4346.html#L187'>session</a>           187 tests/mini-dtls-mtu.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4346.html#L191'>session</a>           191 tests/mini-dtls-mtu.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4346.html#L214'>session</a>           214 tests/mini-dtls-mtu.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4346.html#L231'>session</a>           231 tests/mini-dtls-mtu.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4346.html#L232'>session</a>           232 tests/mini-dtls-mtu.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4346.html#L233'>session</a>           233 tests/mini-dtls-mtu.c 	gnutls_dtls_set_mtu(session, SERVER_MTU);</span>
<span class='curline'><a href='../S/4346.html#L238'>session</a>           238 tests/mini-dtls-mtu.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4346.html#L242'>session</a>           242 tests/mini-dtls-mtu.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4346.html#L244'>session</a>           244 tests/mini-dtls-mtu.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4346.html#L247'>session</a>           247 tests/mini-dtls-mtu.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4346.html#L252'>session</a>           252 tests/mini-dtls-mtu.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4346.html#L263'>session</a>           263 tests/mini-dtls-mtu.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4346.html#L267'>session</a>           267 tests/mini-dtls-mtu.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4346.html#L270'>session</a>           270 tests/mini-dtls-mtu.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4528.html#L147'>session</a>           147 tests/mini-dtls-record-asym.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4528.html#L165'>session</a>           165 tests/mini-dtls-record-asym.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4528.html#L166'>session</a>           166 tests/mini-dtls-record-asym.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4528.html#L167'>session</a>           167 tests/mini-dtls-record-asym.c 	gnutls_dtls_set_timeouts(session, 6 * 1000, 60 * 1000);</span>
<span class='curline'><a href='../S/4528.html#L171'>session</a>           171 tests/mini-dtls-record-asym.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4528.html#L177'>session</a>           177 tests/mini-dtls-record-asym.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4528.html#L179'>session</a>           179 tests/mini-dtls-record-asym.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4528.html#L184'>session</a>           184 tests/mini-dtls-record-asym.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4528.html#L186'>session</a>           186 tests/mini-dtls-record-asym.c 		if (ret == GNUTLS_E_AGAIN &amp;&amp; gnutls_record_get_direction(session) == 0) {</span>
<span class='curline'><a href='../S/4528.html#L215'>session</a>           215 tests/mini-dtls-record-asym.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4528.html#L217'>session</a>           217 tests/mini-dtls-record-asym.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4528.html#L221'>session</a>           221 tests/mini-dtls-record-asym.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4528.html#L244'>session</a>           244 tests/mini-dtls-record-asym.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4528.html#L263'>session</a>           263 tests/mini-dtls-record-asym.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4528.html#L264'>session</a>           264 tests/mini-dtls-record-asym.c 	gnutls_dtls_set_timeouts(session, 5 * 1000, 60 * 1000);</span>
<span class='curline'><a href='../S/4528.html#L265'>session</a>           265 tests/mini-dtls-record-asym.c 	gnutls_dtls_set_mtu(session, 400);</span>
<span class='curline'><a href='../S/4528.html#L267'>session</a>           267 tests/mini-dtls-record-asym.c 		gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4528.html#L272'>session</a>           272 tests/mini-dtls-record-asym.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4528.html#L276'>session</a>           276 tests/mini-dtls-record-asym.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4528.html#L278'>session</a>           278 tests/mini-dtls-record-asym.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4528.html#L281'>session</a>           281 tests/mini-dtls-record-asym.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4528.html#L285'>session</a>           285 tests/mini-dtls-record-asym.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4528.html#L296'>session</a>           296 tests/mini-dtls-record-asym.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4528.html#L300'>session</a>           300 tests/mini-dtls-record-asym.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4528.html#L303'>session</a>           303 tests/mini-dtls-record-asym.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4936.html#L174'>session</a>           174 tests/mini-dtls-record.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4936.html#L197'>session</a>           197 tests/mini-dtls-record.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4936.html#L198'>session</a>           198 tests/mini-dtls-record.c 	gnutls_dtls_set_timeouts(session, 50 * 1000, 600 * 1000);</span>
<span class='curline'><a href='../S/4936.html#L199'>session</a>           199 tests/mini-dtls-record.c 	gnutls_heartbeat_enable(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND);</span>
<span class='curline'><a href='../S/4936.html#L200'>session</a>           200 tests/mini-dtls-record.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4936.html#L203'>session</a>           203 tests/mini-dtls-record.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4936.html#L209'>session</a>           209 tests/mini-dtls-record.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4936.html#L211'>session</a>           211 tests/mini-dtls-record.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4936.html#L216'>session</a>           216 tests/mini-dtls-record.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4936.html#L229'>session</a>           229 tests/mini-dtls-record.c 	gnutls_record_send(session, buffer, 1);</span>
<span class='curline'><a href='../S/4936.html#L234'>session</a>           234 tests/mini-dtls-record.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4936.html#L237'>session</a>           237 tests/mini-dtls-record.c 		    gnutls_record_recv_seq(session, buffer, sizeof(buffer),</span>
<span class='curline'><a href='../S/4936.html#L264'>session</a>           264 tests/mini-dtls-record.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4936.html#L268'>session</a>           268 tests/mini-dtls-record.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4936.html#L287'>session</a>           287 tests/mini-dtls-record.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4936.html#L300'>session</a>           300 tests/mini-dtls-record.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4936.html#L301'>session</a>           301 tests/mini-dtls-record.c 	gnutls_dtls_set_timeouts(session, 50 * 1000, 600 * 1000);</span>
<span class='curline'><a href='../S/4936.html#L302'>session</a>           302 tests/mini-dtls-record.c 	gnutls_transport_set_push_function(session, odd_push);</span>
<span class='curline'><a href='../S/4936.html#L303'>session</a>           303 tests/mini-dtls-record.c 	gnutls_heartbeat_enable(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND);</span>
<span class='curline'><a href='../S/4936.html#L304'>session</a>           304 tests/mini-dtls-record.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4936.html#L309'>session</a>           309 tests/mini-dtls-record.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4936.html#L312'>session</a>           312 tests/mini-dtls-record.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4936.html#L314'>session</a>           314 tests/mini-dtls-record.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4936.html#L317'>session</a>           317 tests/mini-dtls-record.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4936.html#L322'>session</a>           322 tests/mini-dtls-record.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4936.html#L333'>session</a>           333 tests/mini-dtls-record.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4936.html#L335'>session</a>           335 tests/mini-dtls-record.c 	gnutls_record_recv(session, &amp;c, 1);</span>
<span class='curline'><a href='../S/4936.html#L338'>session</a>           338 tests/mini-dtls-record.c 			ret = gnutls_record_send(session, &amp;c, 1);</span>
<span class='curline'><a href='../S/4936.html#L349'>session</a>           349 tests/mini-dtls-record.c 	gnutls_transport_set_push_function(session, n_push);</span>
<span class='curline'><a href='../S/4936.html#L351'>session</a>           351 tests/mini-dtls-record.c 		ret = gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4936.html#L356'>session</a>           356 tests/mini-dtls-record.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5042.html#L76'>session</a>            76 tests/mini-dtls-srtp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5042.html#L95'>session</a>            95 tests/mini-dtls-srtp.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5042.html#L96'>session</a>            96 tests/mini-dtls-srtp.c 	gnutls_heartbeat_enable(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND);</span>
<span class='curline'><a href='../S/5042.html#L97'>session</a>            97 tests/mini-dtls-srtp.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5042.html#L100'>session</a>           100 tests/mini-dtls-srtp.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5042.html#L105'>session</a>           105 tests/mini-dtls-srtp.c 		    gnutls_srtp_set_profile_direct(session,</span>
<span class='curline'><a href='../S/5042.html#L110'>session</a>           110 tests/mini-dtls-srtp.c 		    gnutls_srtp_set_profile_direct(session,</span>
<span class='curline'><a href='../S/5042.html#L121'>session</a>           121 tests/mini-dtls-srtp.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5042.html#L123'>session</a>           123 tests/mini-dtls-srtp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5042.html#L128'>session</a>           128 tests/mini-dtls-srtp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5042.html#L144'>session</a>           144 tests/mini-dtls-srtp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5042.html#L147'>session</a>           147 tests/mini-dtls-srtp.c 	    gnutls_srtp_get_keys(session, km, sizeof(km), &amp;cli_key,</span>
<span class='curline'><a href='../S/5042.html#L173'>session</a>           173 tests/mini-dtls-srtp.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5042.html#L177'>session</a>           177 tests/mini-dtls-srtp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5042.html#L196'>session</a>           196 tests/mini-dtls-srtp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5042.html#L213'>session</a>           213 tests/mini-dtls-srtp.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5042.html#L214'>session</a>           214 tests/mini-dtls-srtp.c 	gnutls_heartbeat_enable(session, GNUTLS_HB_PEER_ALLOWED_TO_SEND);</span>
<span class='curline'><a href='../S/5042.html#L215'>session</a>           215 tests/mini-dtls-srtp.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5042.html#L220'>session</a>           220 tests/mini-dtls-srtp.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5042.html#L226'>session</a>           226 tests/mini-dtls-srtp.c 		    gnutls_srtp_set_profile_direct(session,</span>
<span class='curline'><a href='../S/5042.html#L231'>session</a>           231 tests/mini-dtls-srtp.c 		    gnutls_srtp_set_profile_direct(session,</span>
<span class='curline'><a href='../S/5042.html#L239'>session</a>           239 tests/mini-dtls-srtp.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5042.html#L241'>session</a>           241 tests/mini-dtls-srtp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5042.html#L244'>session</a>           244 tests/mini-dtls-srtp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5042.html#L249'>session</a>           249 tests/mini-dtls-srtp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5042.html#L260'>session</a>           260 tests/mini-dtls-srtp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5042.html#L263'>session</a>           263 tests/mini-dtls-srtp.c 	    gnutls_srtp_get_keys(session, km, sizeof(km), &amp;cli_key,</span>
<span class='curline'><a href='../S/5042.html#L290'>session</a>           290 tests/mini-dtls-srtp.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5042.html#L293'>session</a>           293 tests/mini-dtls-srtp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4545.html#L90'>session</a>            90 tests/mini-dtls0-9.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4545.html#L103'>session</a>           103 tests/mini-dtls0-9.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4545.html#L104'>session</a>           104 tests/mini-dtls0-9.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4545.html#L105'>session</a>           105 tests/mini-dtls0-9.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4545.html#L108'>session</a>           108 tests/mini-dtls0-9.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4545.html#L112'>session</a>           112 tests/mini-dtls0-9.c 	ret = gnutls_session_set_premaster(session, GNUTLS_CLIENT,</span>
<span class='curline'><a href='../S/4545.html#L121'>session</a>           121 tests/mini-dtls0-9.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4545.html#L123'>session</a>           123 tests/mini-dtls0-9.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4545.html#L124'>session</a>           124 tests/mini-dtls0-9.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4545.html#L129'>session</a>           129 tests/mini-dtls0-9.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4545.html#L145'>session</a>           145 tests/mini-dtls0-9.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4545.html#L148'>session</a>           148 tests/mini-dtls0-9.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4545.html#L161'>session</a>           161 tests/mini-dtls0-9.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4545.html#L167'>session</a>           167 tests/mini-dtls0-9.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4545.html#L192'>session</a>           192 tests/mini-dtls0-9.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4545.html#L207'>session</a>           207 tests/mini-dtls0-9.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4545.html#L208'>session</a>           208 tests/mini-dtls0-9.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4545.html#L209'>session</a>           209 tests/mini-dtls0-9.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4545.html#L214'>session</a>           214 tests/mini-dtls0-9.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4545.html#L218'>session</a>           218 tests/mini-dtls0-9.c 	ret = gnutls_session_set_premaster(session, GNUTLS_SERVER,</span>
<span class='curline'><a href='../S/4545.html#L227'>session</a>           227 tests/mini-dtls0-9.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4545.html#L229'>session</a>           229 tests/mini-dtls0-9.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4545.html#L230'>session</a>           230 tests/mini-dtls0-9.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4545.html#L233'>session</a>           233 tests/mini-dtls0-9.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4545.html#L238'>session</a>           238 tests/mini-dtls0-9.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4545.html#L249'>session</a>           249 tests/mini-dtls0-9.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4545.html#L256'>session</a>           256 tests/mini-dtls0-9.c 		ret = gnutls_record_send(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4545.html#L261'>session</a>           261 tests/mini-dtls0-9.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4545.html#L270'>session</a>           270 tests/mini-dtls0-9.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4545.html#L273'>session</a>           273 tests/mini-dtls0-9.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5026.html#L92'>session</a>            92 tests/mini-key-material.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5026.html#L116'>session</a>           116 tests/mini-key-material.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5026.html#L119'>session</a>           119 tests/mini-key-material.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5026.html#L130'>session</a>           130 tests/mini-key-material.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5026.html#L132'>session</a>           132 tests/mini-key-material.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5026.html#L137'>session</a>           137 tests/mini-key-material.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5026.html#L152'>session</a>           152 tests/mini-key-material.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5026.html#L154'>session</a>           154 tests/mini-key-material.c 	ret = gnutls_cipher_get(session);</span>
<span class='curline'><a href='../S/5026.html#L160'>session</a>           160 tests/mini-key-material.c 	ret = gnutls_mac_get(session);</span>
<span class='curline'><a href='../S/5026.html#L171'>session</a>           171 tests/mini-key-material.c 	ret = gnutls_prf(session, 13, "key expansion", 1, 0, NULL, block_size,</span>
<span class='curline'><a href='../S/5026.html#L181'>session</a>           181 tests/mini-key-material.c 	ret = gnutls_record_get_state(session, 0, &amp;mac_key, &amp;iv, &amp;cipher_key, wseq_number);</span>
<span class='curline'><a href='../S/5026.html#L194'>session</a>           194 tests/mini-key-material.c 	ret = gnutls_record_get_state(session, 1, &amp;read_mac_key, &amp;read_iv, &amp;read_cipher_key, rseq_number);</span>
<span class='curline'><a href='../S/5026.html#L248'>session</a>           248 tests/mini-key-material.c 		ret = gnutls_record_send(session, "hello", 5);</span>
<span class='curline'><a href='../S/5026.html#L254'>session</a>           254 tests/mini-key-material.c 	ret = gnutls_record_get_state(session, 0, NULL, NULL, NULL, wseq_number);</span>
<span class='curline'><a href='../S/5026.html#L267'>session</a>           267 tests/mini-key-material.c 	ret = gnutls_record_get_state(session, 1, NULL, NULL, NULL, rseq_number);</span>
<span class='curline'><a href='../S/5026.html#L279'>session</a>           279 tests/mini-key-material.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5026.html#L283'>session</a>           283 tests/mini-key-material.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5026.html#L293'>session</a>           293 tests/mini-key-material.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5026.html#L314'>session</a>           314 tests/mini-key-material.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5026.html#L319'>session</a>           319 tests/mini-key-material.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5026.html#L327'>session</a>           327 tests/mini-key-material.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5026.html#L329'>session</a>           329 tests/mini-key-material.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5026.html#L332'>session</a>           332 tests/mini-key-material.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5026.html#L337'>session</a>           337 tests/mini-key-material.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5026.html#L348'>session</a>           348 tests/mini-key-material.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5026.html#L351'>session</a>           351 tests/mini-key-material.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5026.html#L360'>session</a>           360 tests/mini-key-material.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5026.html#L363'>session</a>           363 tests/mini-key-material.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5062.html#L121'>session</a>           121 tests/mini-loss-time.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5062.html#L135'>session</a>           135 tests/mini-loss-time.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5062.html#L136'>session</a>           136 tests/mini-loss-time.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5062.html#L137'>session</a>           137 tests/mini-loss-time.c 	gnutls_dtls_set_timeouts(session, 1 * 1000, timeout * 1000);</span>
<span class='curline'><a href='../S/5062.html#L140'>session</a>           140 tests/mini-loss-time.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5062.html#L146'>session</a>           146 tests/mini-loss-time.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5062.html#L150'>session</a>           150 tests/mini-loss-time.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5062.html#L155'>session</a>           155 tests/mini-loss-time.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5062.html#L159'>session</a>           159 tests/mini-loss-time.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5062.html#L182'>session</a>           182 tests/mini-loss-time.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5062.html#L195'>session</a>           195 tests/mini-loss-time.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5062.html#L196'>session</a>           196 tests/mini-loss-time.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5062.html#L197'>session</a>           197 tests/mini-loss-time.c 	gnutls_dtls_set_timeouts(session, 1 * 1000, timeout * 1000);</span>
<span class='curline'><a href='../S/5062.html#L202'>session</a>           202 tests/mini-loss-time.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5062.html#L206'>session</a>           206 tests/mini-loss-time.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5062.html#L211'>session</a>           211 tests/mini-loss-time.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5062.html#L212'>session</a>           212 tests/mini-loss-time.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5062.html#L215'>session</a>           215 tests/mini-loss-time.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5062.html#L219'>session</a>           219 tests/mini-loss-time.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5155.html#L121'>session</a>           121 tests/mini-overhead.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5155.html#L136'>session</a>           136 tests/mini-overhead.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5155.html#L139'>session</a>           139 tests/mini-overhead.c 	ret = gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5155.html#L147'>session</a>           147 tests/mini-overhead.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5155.html#L148'>session</a>           148 tests/mini-overhead.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5155.html#L150'>session</a>           150 tests/mini-overhead.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5155.html#L155'>session</a>           155 tests/mini-overhead.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5155.html#L171'>session</a>           171 tests/mini-overhead.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5155.html#L173'>session</a>           173 tests/mini-overhead.c 	gnutls_dtls_set_mtu(session, MTU);</span>
<span class='curline'><a href='../S/5155.html#L174'>session</a>           174 tests/mini-overhead.c 	ret = gnutls_dtls_get_data_mtu(session);</span>
<span class='curline'><a href='../S/5155.html#L184'>session</a>           184 tests/mini-overhead.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5155.html#L200'>session</a>           200 tests/mini-overhead.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5155.html#L202'>session</a>           202 tests/mini-overhead.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5155.html#L207'>session</a>           207 tests/mini-overhead.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5155.html#L209'>session</a>           209 tests/mini-overhead.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5155.html#L210'>session</a>           210 tests/mini-overhead.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5155.html#L212'>session</a>           212 tests/mini-overhead.c 	return session;</span>
<span class='curline'><a href='../S/5155.html#L225'>session</a>           225 tests/mini-overhead.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5155.html#L244'>session</a>           244 tests/mini-overhead.c 	session = initialize_tls_session(prio);</span>
<span class='curline'><a href='../S/5155.html#L246'>session</a>           246 tests/mini-overhead.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5155.html#L249'>session</a>           249 tests/mini-overhead.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5155.html#L254'>session</a>           254 tests/mini-overhead.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5155.html#L265'>session</a>           265 tests/mini-overhead.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5155.html#L267'>session</a>           267 tests/mini-overhead.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4442.html#L123'>session</a>           123 tests/mini-record-2.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4442.html#L139'>session</a>           139 tests/mini-record-2.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4442.html#L142'>session</a>           142 tests/mini-record-2.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/4442.html#L150'>session</a>           150 tests/mini-record-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4442.html#L151'>session</a>           151 tests/mini-record-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4442.html#L153'>session</a>           153 tests/mini-record-2.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4442.html#L158'>session</a>           158 tests/mini-record-2.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4442.html#L174'>session</a>           174 tests/mini-record-2.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4442.html#L179'>session</a>           179 tests/mini-record-2.c 			ret = gnutls_record_send(session, buffer, i);</span>
<span class='curline'><a href='../S/4442.html#L192'>session</a>           192 tests/mini-record-2.c 		ret = gnutls_record_send(session, buffer, i);</span>
<span class='curline'><a href='../S/4442.html#L204'>session</a>           204 tests/mini-record-2.c 	ret = gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4442.html#L211'>session</a>           211 tests/mini-record-2.c 	gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/4442.html#L216'>session</a>           216 tests/mini-record-2.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4442.html#L237'>session</a>           237 tests/mini-record-2.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4442.html#L261'>session</a>           261 tests/mini-record-2.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4442.html#L282'>session</a>           282 tests/mini-record-2.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4442.html#L287'>session</a>           287 tests/mini-record-2.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/4442.html#L293'>session</a>           293 tests/mini-record-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4442.html#L294'>session</a>           294 tests/mini-record-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4442.html#L296'>session</a>           296 tests/mini-record-2.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4442.html#L299'>session</a>           299 tests/mini-record-2.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4442.html#L304'>session</a>           304 tests/mini-record-2.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4442.html#L315'>session</a>           315 tests/mini-record-2.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4442.html#L324'>session</a>           324 tests/mini-record-2.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4442.html#L341'>session</a>           341 tests/mini-record-2.c 			ret = gnutls_record_send(session, buffer, i);</span>
<span class='curline'><a href='../S/4442.html#L354'>session</a>           354 tests/mini-record-2.c 		ret = gnutls_record_send(session, buffer, i);</span>
<span class='curline'><a href='../S/4442.html#L368'>session</a>           368 tests/mini-record-2.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4442.html#L371'>session</a>           371 tests/mini-record-2.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4908.html#L99'>session</a>            99 tests/mini-record-failure.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4908.html#L115'>session</a>           115 tests/mini-record-failure.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4908.html#L117'>session</a>           117 tests/mini-record-failure.c 	gnutls_transport_set_push_function(session, client_push);</span>
<span class='curline'><a href='../S/4908.html#L119'>session</a>           119 tests/mini-record-failure.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/4908.html#L127'>session</a>           127 tests/mini-record-failure.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4908.html#L128'>session</a>           128 tests/mini-record-failure.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4908.html#L130'>session</a>           130 tests/mini-record-failure.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4908.html#L135'>session</a>           135 tests/mini-record-failure.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4908.html#L151'>session</a>           151 tests/mini-record-failure.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4908.html#L155'>session</a>           155 tests/mini-record-failure.c 		ret = gnutls_record_send(session, buffer, 2048);</span>
<span class='curline'><a href='../S/4908.html#L164'>session</a>           164 tests/mini-record-failure.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4908.html#L168'>session</a>           168 tests/mini-record-failure.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4908.html#L191'>session</a>           191 tests/mini-record-failure.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4908.html#L212'>session</a>           212 tests/mini-record-failure.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4908.html#L217'>session</a>           217 tests/mini-record-failure.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/4908.html#L223'>session</a>           223 tests/mini-record-failure.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4908.html#L224'>session</a>           224 tests/mini-record-failure.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4908.html#L226'>session</a>           226 tests/mini-record-failure.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4908.html#L229'>session</a>           229 tests/mini-record-failure.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4908.html#L234'>session</a>           234 tests/mini-record-failure.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4908.html#L245'>session</a>           245 tests/mini-record-failure.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4908.html#L252'>session</a>           252 tests/mini-record-failure.c 	gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/4908.html#L256'>session</a>           256 tests/mini-record-failure.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4908.html#L266'>session</a>           266 tests/mini-record-failure.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5048.html#L93'>session</a>            93 tests/mini-record-range.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5048.html#L108'>session</a>           108 tests/mini-record-range.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5048.html#L111'>session</a>           111 tests/mini-record-range.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5048.html#L115'>session</a>           115 tests/mini-record-range.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5048.html#L116'>session</a>           116 tests/mini-record-range.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5048.html#L118'>session</a>           118 tests/mini-record-range.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5048.html#L123'>session</a>           123 tests/mini-record-range.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5048.html#L139'>session</a>           139 tests/mini-record-range.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5048.html#L143'>session</a>           143 tests/mini-record-range.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5048.html#L160'>session</a>           160 tests/mini-record-range.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5048.html#L166'>session</a>           166 tests/mini-record-range.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5048.html#L188'>session</a>           188 tests/mini-record-range.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5048.html#L215'>session</a>           215 tests/mini-record-range.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5048.html#L220'>session</a>           220 tests/mini-record-range.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5048.html#L222'>session</a>           222 tests/mini-record-range.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5048.html#L223'>session</a>           223 tests/mini-record-range.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5048.html#L225'>session</a>           225 tests/mini-record-range.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5048.html#L228'>session</a>           228 tests/mini-record-range.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5048.html#L233'>session</a>           233 tests/mini-record-range.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5048.html#L244'>session</a>           244 tests/mini-record-range.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5048.html#L246'>session</a>           246 tests/mini-record-range.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5048.html#L248'>session</a>           248 tests/mini-record-range.c 	if (gnutls_record_can_use_length_hiding(session) == 0) {</span>
<span class='curline'><a href='../S/5048.html#L257'>session</a>           257 tests/mini-record-range.c 			    gnutls_record_send_range(session, buffer,</span>
<span class='curline'><a href='../S/5048.html#L281'>session</a>           281 tests/mini-record-range.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5048.html#L284'>session</a>           284 tests/mini-record-range.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4954.html#L121'>session</a>           121 tests/mini-record.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4954.html#L136'>session</a>           136 tests/mini-record.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4954.html#L137'>session</a>           137 tests/mini-record.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4954.html#L140'>session</a>           140 tests/mini-record.c 	ret = gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4954.html#L148'>session</a>           148 tests/mini-record.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4954.html#L149'>session</a>           149 tests/mini-record.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4954.html#L151'>session</a>           151 tests/mini-record.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4954.html#L152'>session</a>           152 tests/mini-record.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4954.html#L157'>session</a>           157 tests/mini-record.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4954.html#L173'>session</a>           173 tests/mini-record.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4954.html#L176'>session</a>           176 tests/mini-record.c 	gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/4954.html#L180'>session</a>           180 tests/mini-record.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4954.html#L197'>session</a>           197 tests/mini-record.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4954.html#L203'>session</a>           203 tests/mini-record.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4954.html#L225'>session</a>           225 tests/mini-record.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4954.html#L246'>session</a>           246 tests/mini-record.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/4954.html#L247'>session</a>           247 tests/mini-record.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/4954.html#L252'>session</a>           252 tests/mini-record.c 	ret = gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4954.html#L258'>session</a>           258 tests/mini-record.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4954.html#L259'>session</a>           259 tests/mini-record.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4954.html#L261'>session</a>           261 tests/mini-record.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4954.html#L262'>session</a>           262 tests/mini-record.c 	gnutls_transport_set_push_function(session, push_crippled);</span>
<span class='curline'><a href='../S/4954.html#L265'>session</a>           265 tests/mini-record.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4954.html#L270'>session</a>           270 tests/mini-record.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4954.html#L281'>session</a>           281 tests/mini-record.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4954.html#L282'>session</a>           282 tests/mini-record.c 	mtu = gnutls_dtls_get_mtu(session);</span>
<span class='curline'><a href='../S/4954.html#L288'>session</a>           288 tests/mini-record.c 			    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4954.html#L306'>session</a>           306 tests/mini-record.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4954.html#L309'>session</a>           309 tests/mini-record.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4904.html#L70'>session</a>            70 tests/mini-server-name.c int _gnutls_server_name_set_raw(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4904.html#L79'>session</a>            79 tests/mini-server-name.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4904.html#L94'>session</a>            94 tests/mini-server-name.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4904.html#L97'>session</a>            97 tests/mini-server-name.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4904.html#L101'>session</a>           101 tests/mini-server-name.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4904.html#L102'>session</a>           102 tests/mini-server-name.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4904.html#L104'>session</a>           104 tests/mini-server-name.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4904.html#L106'>session</a>           106 tests/mini-server-name.c 		_gnutls_server_name_set_raw(session, GNUTLS_NAME_DNS, name, name_len);</span>
<span class='curline'><a href='../S/4904.html#L108'>session</a>           108 tests/mini-server-name.c 		gnutls_server_name_set(session, GNUTLS_NAME_DNS, name, name_len);</span>
<span class='curline'><a href='../S/4904.html#L113'>session</a>           113 tests/mini-server-name.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4904.html#L130'>session</a>           130 tests/mini-server-name.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4904.html#L132'>session</a>           132 tests/mini-server-name.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4904.html#L137'>session</a>           137 tests/mini-server-name.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4904.html#L161'>session</a>           161 tests/mini-server-name.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4904.html#L182'>session</a>           182 tests/mini-server-name.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4904.html#L187'>session</a>           187 tests/mini-server-name.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4904.html#L189'>session</a>           189 tests/mini-server-name.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4904.html#L190'>session</a>           190 tests/mini-server-name.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4904.html#L192'>session</a>           192 tests/mini-server-name.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4904.html#L195'>session</a>           195 tests/mini-server-name.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4904.html#L202'>session</a>           202 tests/mini-server-name.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4904.html#L213'>session</a>           213 tests/mini-server-name.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4904.html#L216'>session</a>           216 tests/mini-server-name.c 	ret = gnutls_server_name_get(session, buffer, &amp;buffer_size, &amp;type, 0);</span>
<span class='curline'><a href='../S/4904.html#L244'>session</a>           244 tests/mini-server-name.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4904.html#L247'>session</a>           247 tests/mini-server-name.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4931.html#L45'>session</a>            45 tests/mini-session-verify-function.c static int client_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4931.html#L51'>session</a>            51 tests/mini-session-verify-function.c static int server_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4931.html#L55'>session</a>            55 tests/mini-session-verify-function.c 	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1_2) {</span>
<span class='curline'><a href='../S/4931.html#L56'>session</a>            56 tests/mini-session-verify-function.c 		if (gnutls_handshake_get_last_in(session) !=</span>
<span class='curline'><a href='../S/4931.html#L59'>session</a>            59 tests/mini-session-verify-function.c 			     gnutls_handshake_description_get_name(gnutls_handshake_get_last_in(session)));</span>
<span class='curline'><a href='../S/4931.html#L63'>session</a>            63 tests/mini-session-verify-function.c 		if (gnutls_handshake_get_last_out(session) !=</span>
<span class='curline'><a href='../S/4931.html#L66'>session</a>            66 tests/mini-session-verify-function.c 			     gnutls_handshake_description_get_name(gnutls_handshake_get_last_out(session)));</span>
<span class='curline'><a href='../S/5206.html#L121'>session</a>           121 tests/mini-termination.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5206.html#L136'>session</a>           136 tests/mini-termination.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5206.html#L139'>session</a>           139 tests/mini-termination.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5206.html#L143'>session</a>           143 tests/mini-termination.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5206.html#L144'>session</a>           144 tests/mini-termination.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5206.html#L146'>session</a>           146 tests/mini-termination.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5206.html#L151'>session</a>           151 tests/mini-termination.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5206.html#L167'>session</a>           167 tests/mini-termination.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5206.html#L170'>session</a>           170 tests/mini-termination.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5206.html#L189'>session</a>           189 tests/mini-termination.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5206.html#L211'>session</a>           211 tests/mini-termination.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5206.html#L232'>session</a>           232 tests/mini-termination.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5206.html#L237'>session</a>           237 tests/mini-termination.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5206.html#L239'>session</a>           239 tests/mini-termination.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5206.html#L240'>session</a>           240 tests/mini-termination.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5206.html#L242'>session</a>           242 tests/mini-termination.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5206.html#L245'>session</a>           245 tests/mini-termination.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5206.html#L250'>session</a>           250 tests/mini-termination.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5206.html#L261'>session</a>           261 tests/mini-termination.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5206.html#L263'>session</a>           263 tests/mini-termination.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5182.html#L144'>session</a>           144 tests/mini-tls-nonblock.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5182.html#L164'>session</a>           164 tests/mini-tls-nonblock.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|expl);</span>
<span class='curline'><a href='../S/5182.html#L167'>session</a>           167 tests/mini-tls-nonblock.c 	ret = gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5182.html#L175'>session</a>           175 tests/mini-tls-nonblock.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5182.html#L176'>session</a>           176 tests/mini-tls-nonblock.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5182.html#L178'>session</a>           178 tests/mini-tls-nonblock.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5182.html#L179'>session</a>           179 tests/mini-tls-nonblock.c 	gnutls_transport_set_push_function(session, my_push);</span>
<span class='curline'><a href='../S/5182.html#L180'>session</a>           180 tests/mini-tls-nonblock.c 	gnutls_transport_set_pull_function(session, my_pull);</span>
<span class='curline'><a href='../S/5182.html#L181'>session</a>           181 tests/mini-tls-nonblock.c 	gnutls_transport_set_pull_timeout_function(session, my_pull_timeout);</span>
<span class='curline'><a href='../S/5182.html#L186'>session</a>           186 tests/mini-tls-nonblock.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5182.html#L202'>session</a>           202 tests/mini-tls-nonblock.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5182.html#L206'>session</a>           206 tests/mini-tls-nonblock.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5182.html#L229'>session</a>           229 tests/mini-tls-nonblock.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5182.html#L251'>session</a>           251 tests/mini-tls-nonblock.c 		gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5182.html#L253'>session</a>           253 tests/mini-tls-nonblock.c 		gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5182.html#L258'>session</a>           258 tests/mini-tls-nonblock.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5182.html#L260'>session</a>           260 tests/mini-tls-nonblock.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5182.html#L261'>session</a>           261 tests/mini-tls-nonblock.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5182.html#L263'>session</a>           263 tests/mini-tls-nonblock.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5182.html#L266'>session</a>           266 tests/mini-tls-nonblock.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5182.html#L271'>session</a>           271 tests/mini-tls-nonblock.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5182.html#L282'>session</a>           282 tests/mini-tls-nonblock.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5182.html#L284'>session</a>           284 tests/mini-tls-nonblock.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5228.html#L44'>session</a>            44 tests/mini-x509-callbacks-intr.c static int client_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5228.html#L50'>session</a>            50 tests/mini-x509-callbacks-intr.c static int post_client_hello_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5228.html#L56'>session</a>            56 tests/mini-x509-callbacks-intr.c static int server_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5228.html#L60'>session</a>            60 tests/mini-x509-callbacks-intr.c 	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1_2) {</span>
<span class='curline'><a href='../S/5228.html#L61'>session</a>            61 tests/mini-x509-callbacks-intr.c 		if (gnutls_handshake_get_last_in(session) !=</span>
<span class='curline'><a href='../S/5228.html#L67'>session</a>            67 tests/mini-x509-callbacks-intr.c 		if (gnutls_handshake_get_last_out(session) !=</span>
<span class='curline'><a href='../S/4416.html#L44'>session</a>            44 tests/mini-x509-callbacks.c static int client_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4416.html#L50'>session</a>            50 tests/mini-x509-callbacks.c static void verify_alpn(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4416.html#L58'>session</a>            58 tests/mini-x509-callbacks.c 	ret = gnutls_alpn_get_selected_protocol(session, &amp;selected);</span>
<span class='curline'><a href='../S/4416.html#L73'>session</a>            73 tests/mini-x509-callbacks.c static int post_client_hello_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4416.html#L76'>session</a>            76 tests/mini-x509-callbacks.c 	verify_alpn(session);</span>
<span class='curline'><a href='../S/4416.html#L94'>session</a>            94 tests/mini-x509-callbacks.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4416.html#L111'>session</a>           111 tests/mini-x509-callbacks.c 		msg = gnutls_handshake_get_last_in(session);</span>
<span class='curline'><a href='../S/4416.html#L117'>session</a>           117 tests/mini-x509-callbacks.c 		msg = gnutls_handshake_get_last_out(session);</span>
<span class='curline'><a href='../S/4416.html#L127'>session</a>           127 tests/mini-x509-callbacks.c static int server_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4416.html#L131'>session</a>           131 tests/mini-x509-callbacks.c 	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1_2) {</span>
<span class='curline'><a href='../S/4416.html#L132'>session</a>           132 tests/mini-x509-callbacks.c 		if (gnutls_handshake_get_last_in(session) !=</span>
<span class='curline'><a href='../S/4416.html#L138'>session</a>           138 tests/mini-x509-callbacks.c 		if (gnutls_handshake_get_last_out(session) !=</span>
<span class='curline'><a href='../S/4416.html#L194'>session</a>           194 tests/mini-x509-callbacks.c static void append_alpn(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4416.html#L205'>session</a>           205 tests/mini-x509-callbacks.c 	ret = gnutls_alpn_set_protocols(session, &amp;protocol, 1, 0);</span>
<span class='curline'><a href='../S/5231.html#L139'>session</a>           139 tests/multi-alerts.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5231.html#L162'>session</a>           162 tests/multi-alerts.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5231.html#L167'>session</a>           167 tests/multi-alerts.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5231.html#L169'>session</a>           169 tests/multi-alerts.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5231.html#L171'>session</a>           171 tests/multi-alerts.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5231.html#L174'>session</a>           174 tests/multi-alerts.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5231.html#L185'>session</a>           185 tests/multi-alerts.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4393.html#L87'>session</a>            87 tests/naked-alerts.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4393.html#L110'>session</a>           110 tests/naked-alerts.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4393.html#L115'>session</a>           115 tests/naked-alerts.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4393.html#L117'>session</a>           117 tests/naked-alerts.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4393.html#L119'>session</a>           119 tests/naked-alerts.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4393.html#L122'>session</a>           122 tests/naked-alerts.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4393.html#L133'>session</a>           133 tests/naked-alerts.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4901.html#L46'>session</a>            46 tests/no-extensions.c static int server_handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4901.html#L75'>session</a>            75 tests/no-extensions.c static int client_handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4928.html#L71'>session</a>            71 tests/no-signal.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4928.html#L86'>session</a>            86 tests/no-signal.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4928.html#L87'>session</a>            87 tests/no-signal.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4928.html#L90'>session</a>            90 tests/no-signal.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4928.html#L96'>session</a>            96 tests/no-signal.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4928.html#L98'>session</a>            98 tests/no-signal.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4928.html#L103'>session</a>           103 tests/no-signal.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4928.html#L107'>session</a>           107 tests/no-signal.c 	ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4928.html#L122'>session</a>           122 tests/no-signal.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4928.html#L141'>session</a>           141 tests/no-signal.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4928.html#L155'>session</a>           155 tests/no-signal.c 	gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_NO_SIGNAL);</span>
<span class='curline'><a href='../S/4928.html#L160'>session</a>           160 tests/no-signal.c 	gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4928.html#L164'>session</a>           164 tests/no-signal.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4928.html#L166'>session</a>           166 tests/no-signal.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4928.html#L169'>session</a>           169 tests/no-signal.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4928.html#L181'>session</a>           181 tests/no-signal.c 		ret = gnutls_record_send(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4928.html#L188'>session</a>           188 tests/no-signal.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4385.html#L38'>session</a>            38 tests/null_retrieve_function.c static int cert_cb1(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4385.html#L48'>session</a>            48 tests/null_retrieve_function.c static int cert_cb2(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4385.html#L60'>session</a>            60 tests/null_retrieve_function.c static int cert_cb3(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5239.html#L86'>session</a>            86 tests/openconnect-dtls12.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5239.html#L97'>session</a>            97 tests/openconnect-dtls12.c 	gnutls_init(&amp;session, GNUTLS_CLIENT | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5239.html#L98'>session</a>            98 tests/openconnect-dtls12.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5239.html#L99'>session</a>            99 tests/openconnect-dtls12.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5239.html#L101'>session</a>           101 tests/openconnect-dtls12.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5239.html#L105'>session</a>           105 tests/openconnect-dtls12.c 	ret = gnutls_session_set_premaster(session, GNUTLS_CLIENT,</span>
<span class='curline'><a href='../S/5239.html#L113'>session</a>           113 tests/openconnect-dtls12.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/5239.html#L115'>session</a>           115 tests/openconnect-dtls12.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5239.html#L116'>session</a>           116 tests/openconnect-dtls12.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5239.html#L121'>session</a>           121 tests/openconnect-dtls12.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5239.html#L134'>session</a>           134 tests/openconnect-dtls12.c 	desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/5239.html#L147'>session</a>           147 tests/openconnect-dtls12.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5239.html#L150'>session</a>           150 tests/openconnect-dtls12.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/5239.html#L163'>session</a>           163 tests/openconnect-dtls12.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5239.html#L169'>session</a>           169 tests/openconnect-dtls12.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5239.html#L182'>session</a>           182 tests/openconnect-dtls12.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5239.html#L195'>session</a>           195 tests/openconnect-dtls12.c 	gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5239.html#L196'>session</a>           196 tests/openconnect-dtls12.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5239.html#L197'>session</a>           197 tests/openconnect-dtls12.c 	gnutls_dtls_set_mtu(session, 1500);</span>
<span class='curline'><a href='../S/5239.html#L202'>session</a>           202 tests/openconnect-dtls12.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5239.html#L206'>session</a>           206 tests/openconnect-dtls12.c 	ret = gnutls_session_set_premaster(session, GNUTLS_SERVER,</span>
<span class='curline'><a href='../S/5239.html#L214'>session</a>           214 tests/openconnect-dtls12.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/5239.html#L216'>session</a>           216 tests/openconnect-dtls12.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5239.html#L217'>session</a>           217 tests/openconnect-dtls12.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/5239.html#L220'>session</a>           220 tests/openconnect-dtls12.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5239.html#L225'>session</a>           225 tests/openconnect-dtls12.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5239.html#L235'>session</a>           235 tests/openconnect-dtls12.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5239.html#L242'>session</a>           242 tests/openconnect-dtls12.c 		ret = gnutls_record_send(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/5239.html#L247'>session</a>           247 tests/openconnect-dtls12.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5239.html#L255'>session</a>           255 tests/openconnect-dtls12.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5239.html#L258'>session</a>           258 tests/openconnect-dtls12.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4462.html#L83'>session</a>            83 tests/pkcs11/pkcs11-obj-raw.c 	ck_session_handle_t session;</span>
<span class='curline'><a href='../S/4462.html#L130'>session</a>           130 tests/pkcs11/pkcs11-obj-raw.c 	ret = gnutls_pkcs11_obj_get_ptr(obj, (void**)&amp;mod, (void*)&amp;session,</span>
<span class='curline'><a href='../S/4462.html#L165'>session</a>           165 tests/pkcs11/pkcs11-obj-raw.c 	rv = mod-&gt;C_SignInit(session, &amp;mech, ohandle);</span>
<span class='curline'><a href='../S/4462.html#L172'>session</a>           172 tests/pkcs11/pkcs11-obj-raw.c 	rv = mod-&gt;C_Sign(session, data.data, data.size, sig, &amp;len);</span>
<span class='curline'><a href='../S/4462.html#L178'>session</a>           178 tests/pkcs11/pkcs11-obj-raw.c 	mod-&gt;C_CloseSession(session);</span>
<span class='curline'><a href='../S/4495.html#L89'>session</a>            89 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4495.html#L109'>session</a>           109 tests/pkcs11/tls-neg-pkcs11-no-key.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4495.html#L111'>session</a>           111 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4495.html#L113'>session</a>           113 tests/pkcs11/tls-neg-pkcs11-no-key.c 	ret = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4495.html#L117'>session</a>           117 tests/pkcs11/tls-neg-pkcs11-no-key.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4495.html#L122'>session</a>           122 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4495.html#L127'>session</a>           127 tests/pkcs11/tls-neg-pkcs11-no-key.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4495.html#L137'>session</a>           137 tests/pkcs11/tls-neg-pkcs11-no-key.c 	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1_2) {</span>
<span class='curline'><a href='../S/4495.html#L144'>session</a>           144 tests/pkcs11/tls-neg-pkcs11-no-key.c 		ret = gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4495.html#L149'>session</a>           149 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4495.html#L161'>session</a>           161 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4495.html#L272'>session</a>           272 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4495.html#L274'>session</a>           274 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4495.html#L284'>session</a>           284 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4495.html#L289'>session</a>           289 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4495.html#L291'>session</a>           291 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4495.html#L294'>session</a>           294 tests/pkcs11/tls-neg-pkcs11-no-key.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4495.html#L303'>session</a>           303 tests/pkcs11/tls-neg-pkcs11-no-key.c 	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1_2) {</span>
<span class='curline'><a href='../S/4495.html#L310'>session</a>           310 tests/pkcs11/tls-neg-pkcs11-no-key.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4495.html#L314'>session</a>           314 tests/pkcs11/tls-neg-pkcs11-no-key.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4345.html#L44'>session</a>            44 tests/post-client-hello-change-prio.c static int post_client_hello_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4345.html#L47'>session</a>            47 tests/post-client-hello-change-prio.c 		assert(gnutls_priority_set_direct(session, override_prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5022.html#L168'>session</a>           168 tests/prf.c    	ret = gnutls_prf_rfc5705(session, label_size, label, extra_size, extra, size, \</span>
<span class='curline'><a href='../S/5022.html#L185'>session</a>           185 tests/prf.c    	ret = gnutls_prf(session, label_size, label, 1, extra_size, extra, size, \</span>
<span class='curline'><a href='../S/5022.html#L199'>session</a>           199 tests/prf.c    static void check_prfs(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5022.html#L214'>session</a>           214 tests/prf.c    	ret = gnutls_prf(session, 4, "aaaa", 0, 0, NULL, 64,</span>
<span class='curline'><a href='../S/5022.html#L222'>session</a>           222 tests/prf.c    	ret = gnutls_prf_rfc5705(session, 4, "aaaa", 0, NULL, 64,</span>
<span class='curline'><a href='../S/5022.html#L240'>session</a>           240 tests/prf.c    	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5022.html#L257'>session</a>           257 tests/prf.c    	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5022.html#L259'>session</a>           259 tests/prf.c    	ret = gnutls_session_set_premaster(session, GNUTLS_CLIENT,</span>
<span class='curline'><a href='../S/5022.html#L269'>session</a>           269 tests/prf.c    	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5022.html#L278'>session</a>           278 tests/prf.c    	ret = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5022.html#L283'>session</a>           283 tests/prf.c    	gnutls_handshake_set_random(session, &amp;hrnd);</span>
<span class='curline'><a href='../S/5022.html#L284'>session</a>           284 tests/prf.c    	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5022.html#L286'>session</a>           286 tests/prf.c    	if (gnutls_prf(session, 4, "aaaa", 0, 0, NULL, sizeof(err), (char *)&amp;err) !=</span>
<span class='curline'><a href='../S/5022.html#L288'>session</a>           288 tests/prf.c    	    gnutls_prf_rfc5705(session, 4, "aaaa", 0, NULL, sizeof(err), (char *)&amp;err) !=</span>
<span class='curline'><a href='../S/5022.html#L297'>session</a>           297 tests/prf.c    		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5022.html#L312'>session</a>           312 tests/prf.c    			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5022.html#L314'>session</a>           314 tests/prf.c    	ret = gnutls_cipher_get(session);</span>
<span class='curline'><a href='../S/5022.html#L320'>session</a>           320 tests/prf.c    	ret = gnutls_mac_get(session);</span>
<span class='curline'><a href='../S/5022.html#L326'>session</a>           326 tests/prf.c    	ret = gnutls_prf_hash_get(session);</span>
<span class='curline'><a href='../S/5022.html#L332'>session</a>           332 tests/prf.c    	check_prfs(session);</span>
<span class='curline'><a href='../S/5022.html#L334'>session</a>           334 tests/prf.c    	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5022.html#L338'>session</a>           338 tests/prf.c    	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5022.html#L357'>session</a>           357 tests/prf.c    	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5022.html#L371'>session</a>           371 tests/prf.c    	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5022.html#L376'>session</a>           376 tests/prf.c    	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5022.html#L384'>session</a>           384 tests/prf.c    	ret = gnutls_session_set_premaster(session, GNUTLS_SERVER,</span>
<span class='curline'><a href='../S/5022.html#L396'>session</a>           396 tests/prf.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5022.html#L399'>session</a>           399 tests/prf.c    	gnutls_handshake_set_random(session, &amp;hsrnd);</span>
<span class='curline'><a href='../S/5022.html#L400'>session</a>           400 tests/prf.c    	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5022.html#L403'>session</a>           403 tests/prf.c    		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5022.html#L408'>session</a>           408 tests/prf.c    		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5022.html#L419'>session</a>           419 tests/prf.c    			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5022.html#L423'>session</a>           423 tests/prf.c    	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5022.html#L426'>session</a>           426 tests/prf.c    	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4538.html#L104'>session</a>           104 tests/psk-file.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4538.html#L125'>session</a>           125 tests/psk-file.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_KEY_SHARE_TOP)&gt;=0);</span>
<span class='curline'><a href='../S/4538.html#L127'>session</a>           127 tests/psk-file.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4538.html#L131'>session</a>           131 tests/psk-file.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/4538.html#L133'>session</a>           133 tests/psk-file.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4538.html#L137'>session</a>           137 tests/psk-file.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4538.html#L154'>session</a>           154 tests/psk-file.c 		hint = gnutls_psk_client_get_hint(session);</span>
<span class='curline'><a href='../S/4538.html#L156'>session</a>           156 tests/psk-file.c 			fail("client: hint is not the expected: %s\n", gnutls_psk_client_get_hint(session));</span>
<span class='curline'><a href='../S/4538.html#L161'>session</a>           161 tests/psk-file.c 	gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4538.html#L163'>session</a>           163 tests/psk-file.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4538.html#L174'>session</a>           174 tests/psk-file.c 	kx = gnutls_kx_get(session);</span>
<span class='curline'><a href='../S/4538.html#L184'>session</a>           184 tests/psk-file.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4538.html#L199'>session</a>           199 tests/psk-file.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4538.html#L216'>session</a>           216 tests/psk-file.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4538.html#L244'>session</a>           244 tests/psk-file.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4538.html#L246'>session</a>           246 tests/psk-file.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4538.html#L249'>session</a>           249 tests/psk-file.c 		gnutls_credentials_set(session, GNUTLS_CRD_PSK, server_pskcred);</span>
<span class='curline'><a href='../S/4538.html#L251'>session</a>           251 tests/psk-file.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4538.html#L252'>session</a>           252 tests/psk-file.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4538.html#L255'>session</a>           255 tests/psk-file.c 		gnutls_alert_send_appropriate(session, ret);</span>
<span class='curline'><a href='../S/4538.html#L260'>session</a>           260 tests/psk-file.c 		gnutls_session_force_valid(session);</span>
<span class='curline'><a href='../S/4538.html#L261'>session</a>           261 tests/psk-file.c 		while ((gnutls_record_recv_seq(session, buf, sizeof(buf), seq)) &gt;= 0)</span>
<span class='curline'><a href='../S/4538.html#L288'>session</a>           288 tests/psk-file.c 		gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/4538.html#L289'>session</a>           289 tests/psk-file.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4538.html#L302'>session</a>           302 tests/psk-file.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4538.html#L307'>session</a>           307 tests/psk-file.c 	kx = gnutls_kx_get(session);</span>
<span class='curline'><a href='../S/4538.html#L309'>session</a>           309 tests/psk-file.c 	desc = gnutls_session_get_desc(session);</span>
<span class='curline'><a href='../S/4538.html#L314'>session</a>           314 tests/psk-file.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4538.html#L323'>session</a>           323 tests/psk-file.c 			if (gnutls_psk_server_get_username2(session, &amp;pskid_binary))</span>
<span class='curline'><a href='../S/4538.html#L333'>session</a>           333 tests/psk-file.c 			pskid = gnutls_psk_server_get_username(session);</span>
<span class='curline'><a href='../S/4538.html#L349'>session</a>           349 tests/psk-file.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5162.html#L70'>session</a>            70 tests/pskself.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5162.html#L90'>session</a>            90 tests/pskself.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5162.html#L93'>session</a>            93 tests/pskself.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5162.html#L97'>session</a>            97 tests/pskself.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/5162.html#L99'>session</a>            99 tests/pskself.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5162.html#L103'>session</a>           103 tests/pskself.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5162.html#L116'>session</a>           116 tests/pskself.c 		hint = gnutls_psk_client_get_hint(session);</span>
<span class='curline'><a href='../S/5162.html#L118'>session</a>           118 tests/pskself.c 			fail("client: hint is not the expected: %s\n", gnutls_psk_client_get_hint(session));</span>
<span class='curline'><a href='../S/5162.html#L123'>session</a>           123 tests/pskself.c 	gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5162.html#L125'>session</a>           125 tests/pskself.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5162.html#L144'>session</a>           144 tests/pskself.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5162.html#L150'>session</a>           150 tests/pskself.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5162.html#L165'>session</a>           165 tests/pskself.c pskfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/5162.html#L199'>session</a>           199 tests/pskself.c gnutls_session_t session;</span>
<span class='curline'><a href='../S/5162.html#L219'>session</a>           219 tests/pskself.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5162.html#L224'>session</a>           224 tests/pskself.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5162.html#L226'>session</a>           226 tests/pskself.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, server_pskcred);</span>
<span class='curline'><a href='../S/5162.html#L228'>session</a>           228 tests/pskself.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5162.html#L229'>session</a>           229 tests/pskself.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5162.html#L232'>session</a>           232 tests/pskself.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5162.html#L245'>session</a>           245 tests/pskself.c 		gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/5162.html#L246'>session</a>           246 tests/pskself.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5162.html#L259'>session</a>           259 tests/pskself.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5162.html#L265'>session</a>           265 tests/pskself.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5162.html#L268'>session</a>           268 tests/pskself.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5166.html#L72'>session</a>            72 tests/pskself2.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5166.html#L105'>session</a>           105 tests/pskself2.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5166.html#L108'>session</a>           108 tests/pskself2.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5166.html#L112'>session</a>           112 tests/pskself2.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/5166.html#L114'>session</a>           114 tests/pskself2.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5166.html#L118'>session</a>           118 tests/pskself2.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5166.html#L131'>session</a>           131 tests/pskself2.c 		hint = gnutls_psk_client_get_hint(session);</span>
<span class='curline'><a href='../S/5166.html#L133'>session</a>           133 tests/pskself2.c 			fail("client: hint is not the expected: %s\n", gnutls_psk_client_get_hint(session));</span>
<span class='curline'><a href='../S/5166.html#L138'>session</a>           138 tests/pskself2.c 	gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5166.html#L140'>session</a>           140 tests/pskself2.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5166.html#L159'>session</a>           159 tests/pskself2.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5166.html#L165'>session</a>           165 tests/pskself2.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5166.html#L181'>session</a>           181 tests/pskself2.c pskfunc(gnutls_session_t session, const gnutls_datum_t *username,</span>
<span class='curline'><a href='../S/5166.html#L202'>session</a>           202 tests/pskself2.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5166.html#L220'>session</a>           220 tests/pskself2.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5166.html#L225'>session</a>           225 tests/pskself2.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5166.html#L227'>session</a>           227 tests/pskself2.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, server_pskcred);</span>
<span class='curline'><a href='../S/5166.html#L229'>session</a>           229 tests/pskself2.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5166.html#L230'>session</a>           230 tests/pskself2.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5166.html#L233'>session</a>           233 tests/pskself2.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5166.html#L242'>session</a>           242 tests/pskself2.c 		if (gnutls_psk_server_get_username(session))</span>
<span class='curline'><a href='../S/5166.html#L244'>session</a>           244 tests/pskself2.c 		if (gnutls_psk_server_get_username2(session, &amp;psk_username) &lt; 0)</span>
<span class='curline'><a href='../S/5166.html#L258'>session</a>           258 tests/pskself2.c 		gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/5166.html#L259'>session</a>           259 tests/pskself2.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5166.html#L271'>session</a>           271 tests/pskself2.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5166.html#L277'>session</a>           277 tests/pskself2.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5166.html#L280'>session</a>           280 tests/pskself2.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4960.html#L101'>session</a>           101 tests/record-pad.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4960.html#L114'>session</a>           114 tests/record-pad.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|test-&gt;flags)&gt;=0);</span>
<span class='curline'><a href='../S/4960.html#L115'>session</a>           115 tests/record-pad.c 	assert(gnutls_priority_set_direct(session, test-&gt;prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4960.html#L119'>session</a>           119 tests/record-pad.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4960.html#L120'>session</a>           120 tests/record-pad.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4960.html#L122'>session</a>           122 tests/record-pad.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4960.html#L127'>session</a>           127 tests/record-pad.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4960.html#L143'>session</a>           143 tests/record-pad.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4960.html#L147'>session</a>           147 tests/record-pad.c 			ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4960.html#L164'>session</a>           164 tests/record-pad.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4960.html#L170'>session</a>           170 tests/record-pad.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4960.html#L192'>session</a>           192 tests/record-pad.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4960.html#L214'>session</a>           214 tests/record-pad.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER|test-&gt;flags)&gt;=0);</span>
<span class='curline'><a href='../S/4960.html#L216'>session</a>           216 tests/record-pad.c 	assert(gnutls_priority_set_direct(session, test-&gt;prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4960.html#L218'>session</a>           218 tests/record-pad.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4960.html#L219'>session</a>           219 tests/record-pad.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4960.html#L221'>session</a>           221 tests/record-pad.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4960.html#L224'>session</a>           224 tests/record-pad.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4960.html#L229'>session</a>           229 tests/record-pad.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4960.html#L240'>session</a>           240 tests/record-pad.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4960.html#L242'>session</a>           242 tests/record-pad.c 	gnutls_transport_set_push_function(session, push);</span>
<span class='curline'><a href='../S/4960.html#L249'>session</a>           249 tests/record-pad.c 		    gnutls_record_send2(session, buffer,</span>
<span class='curline'><a href='../S/4960.html#L270'>session</a>           270 tests/record-pad.c 	expected = test-&gt;data + test-&gt;pad + gnutls_record_overhead_size(session);</span>
<span class='curline'><a href='../S/4960.html#L280'>session</a>           280 tests/record-pad.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4960.html#L283'>session</a>           283 tests/record-pad.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4899.html#L123'>session</a>           123 tests/record-retvals.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4899.html#L139'>session</a>           139 tests/record-retvals.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4899.html#L142'>session</a>           142 tests/record-retvals.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/4899.html#L150'>session</a>           150 tests/record-retvals.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4899.html#L151'>session</a>           151 tests/record-retvals.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4899.html#L153'>session</a>           153 tests/record-retvals.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4899.html#L158'>session</a>           158 tests/record-retvals.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4899.html#L174'>session</a>           174 tests/record-retvals.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4899.html#L179'>session</a>           179 tests/record-retvals.c 			ret = gnutls_record_send(session, buffer, i);</span>
<span class='curline'><a href='../S/4899.html#L197'>session</a>           197 tests/record-retvals.c 		ret = gnutls_record_send(session, buffer, i);</span>
<span class='curline'><a href='../S/4899.html#L210'>session</a>           210 tests/record-retvals.c 	ret = gnutls_record_send(session, buffer, 4);</span>
<span class='curline'><a href='../S/4899.html#L218'>session</a>           218 tests/record-retvals.c 	gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/4899.html#L223'>session</a>           223 tests/record-retvals.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4899.html#L240'>session</a>           240 tests/record-retvals.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4899.html#L246'>session</a>           246 tests/record-retvals.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4899.html#L270'>session</a>           270 tests/record-retvals.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4899.html#L291'>session</a>           291 tests/record-retvals.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4899.html#L296'>session</a>           296 tests/record-retvals.c 	ret = gnutls_priority_set_direct(session, prio, &amp;err);</span>
<span class='curline'><a href='../S/4899.html#L302'>session</a>           302 tests/record-retvals.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4899.html#L303'>session</a>           303 tests/record-retvals.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4899.html#L305'>session</a>           305 tests/record-retvals.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4899.html#L308'>session</a>           308 tests/record-retvals.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4899.html#L313'>session</a>           313 tests/record-retvals.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4899.html#L324'>session</a>           324 tests/record-retvals.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4899.html#L334'>session</a>           334 tests/record-retvals.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4899.html#L355'>session</a>           355 tests/record-retvals.c 			ret = gnutls_record_send(session, buffer, i);</span>
<span class='curline'><a href='../S/4899.html#L368'>session</a>           368 tests/record-retvals.c 		ret = gnutls_record_send(session, buffer, i);</span>
<span class='curline'><a href='../S/4899.html#L382'>session</a>           382 tests/record-retvals.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4899.html#L385'>session</a>           385 tests/record-retvals.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5160.html#L70'>session</a>            70 tests/recv-data-before-handshake.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5160.html#L79'>session</a>            79 tests/recv-data-before-handshake.c 	gnutls_record_set_timeout(session, 10*1000);</span>
<span class='curline'><a href='../S/5160.html#L82'>session</a>            82 tests/recv-data-before-handshake.c 	ret = gnutls_record_recv(session, &amp;c, 1);</span>
<span class='curline'><a href='../S/5160.html#L89'>session</a>            89 tests/recv-data-before-handshake.c 	gnutls_record_set_timeout(session, 0);</span>
<span class='curline'><a href='../S/5160.html#L102'>session</a>           102 tests/recv-data-before-handshake.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5160.html#L116'>session</a>           116 tests/recv-data-before-handshake.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/5160.html#L118'>session</a>           118 tests/recv-data-before-handshake.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5160.html#L120'>session</a>           120 tests/recv-data-before-handshake.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5160.html#L124'>session</a>           124 tests/recv-data-before-handshake.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5160.html#L126'>session</a>           126 tests/recv-data-before-handshake.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5160.html#L131'>session</a>           131 tests/recv-data-before-handshake.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5160.html#L151'>session</a>           151 tests/recv-data-before-handshake.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5160.html#L155'>session</a>           155 tests/recv-data-before-handshake.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5160.html#L170'>session</a>           170 tests/recv-data-before-handshake.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5160.html#L176'>session</a>           176 tests/recv-data-before-handshake.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5160.html#L197'>session</a>           197 tests/recv-data-before-handshake.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5160.html#L215'>session</a>           215 tests/recv-data-before-handshake.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/5160.html#L220'>session</a>           220 tests/recv-data-before-handshake.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5160.html#L222'>session</a>           222 tests/recv-data-before-handshake.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5160.html#L224'>session</a>           224 tests/recv-data-before-handshake.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5160.html#L227'>session</a>           227 tests/recv-data-before-handshake.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5160.html#L241'>session</a>           241 tests/recv-data-before-handshake.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5160.html#L245'>session</a>           245 tests/recv-data-before-handshake.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5160.html#L249'>session</a>           249 tests/recv-data-before-handshake.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4388.html#L48'>session</a>            48 tests/rehandshake-switch-psk-id.c pskfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/4450.html#L95'>session</a>            95 tests/rehandshake-switch-srp-id.c srpfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/5045.html#L99'>session</a>            99 tests/resume-dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5045.html#L122'>session</a>           122 tests/resume-dtls.c 		gnutls_init(&amp;session,</span>
<span class='curline'><a href='../S/5045.html#L127'>session</a>           127 tests/resume-dtls.c 			gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5045.html#L131'>session</a>           131 tests/resume-dtls.c 			gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5045.html#L137'>session</a>           137 tests/resume-dtls.c 		gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5045.html#L141'>session</a>           141 tests/resume-dtls.c 			gnutls_session_set_data(session, session_data.data,</span>
<span class='curline'><a href='../S/5045.html#L146'>session</a>           146 tests/resume-dtls.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5045.html#L150'>session</a>           150 tests/resume-dtls.c 		gnutls_dtls_set_timeouts(session, 3*1000, 240 * 1000);</span>
<span class='curline'><a href='../S/5045.html#L152'>session</a>           152 tests/resume-dtls.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5045.html#L168'>session</a>           168 tests/resume-dtls.c 			    gnutls_session_get_data2(session,</span>
<span class='curline'><a href='../S/5045.html#L175'>session</a>           175 tests/resume-dtls.c 			if (gnutls_session_is_resumed(session) != 0) {</span>
<span class='curline'><a href='../S/5045.html#L193'>session</a>           193 tests/resume-dtls.c 		gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5045.html#L195'>session</a>           195 tests/resume-dtls.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5045.html#L214'>session</a>           214 tests/resume-dtls.c 		gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5045.html#L218'>session</a>           218 tests/resume-dtls.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5045.html#L265'>session</a>           265 tests/resume-dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5045.html#L292'>session</a>           292 tests/resume-dtls.c 		gnutls_init(&amp;session, GNUTLS_SERVER | GNUTLS_DATAGRAM);</span>
<span class='curline'><a href='../S/5045.html#L294'>session</a>           294 tests/resume-dtls.c 		gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5045.html#L298'>session</a>           298 tests/resume-dtls.c 		gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/5045.html#L299'>session</a>           299 tests/resume-dtls.c 		gnutls_dh_set_prime_bits(session, DH_BITS);</span>
<span class='curline'><a href='../S/5045.html#L302'>session</a>           302 tests/resume-dtls.c 			gnutls_db_set_retrieve_function(session, wrap_db_fetch);</span>
<span class='curline'><a href='../S/5045.html#L303'>session</a>           303 tests/resume-dtls.c 			gnutls_db_set_remove_function(session, wrap_db_delete);</span>
<span class='curline'><a href='../S/5045.html#L304'>session</a>           304 tests/resume-dtls.c 			gnutls_db_set_store_function(session, wrap_db_store);</span>
<span class='curline'><a href='../S/5045.html#L305'>session</a>           305 tests/resume-dtls.c 			gnutls_db_set_ptr(session, NULL);</span>
<span class='curline'><a href='../S/5045.html#L309'>session</a>           309 tests/resume-dtls.c 			gnutls_session_ticket_enable_server(session,</span>
<span class='curline'><a href='../S/5045.html#L312'>session</a>           312 tests/resume-dtls.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5045.html#L313'>session</a>           313 tests/resume-dtls.c 		gnutls_dtls_set_timeouts(session, 3*1000, 240 * 1000);</span>
<span class='curline'><a href='../S/5045.html#L316'>session</a>           316 tests/resume-dtls.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5045.html#L320'>session</a>           320 tests/resume-dtls.c 			gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5045.html#L334'>session</a>           334 tests/resume-dtls.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5045.html#L348'>session</a>           348 tests/resume-dtls.c 				gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5045.html#L354'>session</a>           354 tests/resume-dtls.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5045.html#L358'>session</a>           358 tests/resume-dtls.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4947.html#L64'>session</a>            64 tests/resume-lifetime.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4947.html#L67'>session</a>            67 tests/resume-lifetime.c 	struct hsk_st *h = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5178.html#L59'>session</a>            59 tests/resume-with-previous-stek.c static int client_handshake(gnutls_session_t session, gnutls_datum_t *session_data,</span>
<span class='curline'><a href='../S/5178.html#L65'>session</a>            65 tests/resume-with-previous-stek.c 		if ((ret = gnutls_session_set_data(session,</span>
<span class='curline'><a href='../S/5178.html#L73'>session</a>            73 tests/resume-with-previous-stek.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5178.html#L82'>session</a>            82 tests/resume-with-previous-stek.c 	if (gnutls_session_is_resumed(session))</span>
<span class='curline'><a href='../S/5178.html#L88'>session</a>            88 tests/resume-with-previous-stek.c 		if ((ret = gnutls_session_get_data2(session, session_data)) &lt; 0) {</span>
<span class='curline'><a href='../S/5178.html#L94'>session</a>            94 tests/resume-with-previous-stek.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5178.html#L102'>session</a>           102 tests/resume-with-previous-stek.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5178.html#L109'>session</a>           109 tests/resume-with-previous-stek.c 		assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/5178.html#L110'>session</a>           110 tests/resume-with-previous-stek.c 		assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5178.html#L112'>session</a>           112 tests/resume-with-previous-stek.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5178.html#L115'>session</a>           115 tests/resume-with-previous-stek.c 		gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5178.html#L116'>session</a>           116 tests/resume-with-previous-stek.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5178.html#L119'>session</a>           119 tests/resume-with-previous-stek.c 		if (client_handshake(session, &amp;session_data,</span>
<span class='curline'><a href='../S/5178.html#L128'>session</a>           128 tests/resume-with-previous-stek.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5178.html#L135'>session</a>           135 tests/resume-with-previous-stek.c void _gnutls_set_session_ticket_key_rotation_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5178.html#L141'>session</a>           141 tests/resume-with-previous-stek.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5178.html#L152'>session</a>           152 tests/resume-with-previous-stek.c 		assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/5178.html#L161'>session</a>           161 tests/resume-with-previous-stek.c 		assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5178.html#L162'>session</a>           162 tests/resume-with-previous-stek.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, serverx509cred);</span>
<span class='curline'><a href='../S/5178.html#L164'>session</a>           164 tests/resume-with-previous-stek.c 		gnutls_db_set_cache_expiration(session, TICKET_EXPIRATION);</span>
<span class='curline'><a href='../S/5178.html#L165'>session</a>           165 tests/resume-with-previous-stek.c 		_gnutls_set_session_ticket_key_rotation_callback(session, stek_rotation_callback);</span>
<span class='curline'><a href='../S/5178.html#L167'>session</a>           167 tests/resume-with-previous-stek.c 		retval = gnutls_session_ticket_enable_server(session,</span>
<span class='curline'><a href='../S/5178.html#L173'>session</a>           173 tests/resume-with-previous-stek.c 		gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5178.html#L174'>session</a>           174 tests/resume-with-previous-stek.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5178.html#L179'>session</a>           179 tests/resume-with-previous-stek.c 			retval = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5178.html#L188'>session</a>           188 tests/resume-with-previous-stek.c 		if (gnutls_session_is_resumed(session))</span>
<span class='curline'><a href='../S/5178.html#L193'>session</a>           193 tests/resume-with-previous-stek.c 		gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5178.html#L194'>session</a>           194 tests/resume-with-previous-stek.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5128.html#L104'>session</a>           104 tests/resume-with-record-size-limit.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5128.html#L139'>session</a>           139 tests/resume-with-record-size-limit.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5128.html#L162'>session</a>           162 tests/resume-with-record-size-limit.c 		assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/5128.html#L164'>session</a>           164 tests/resume-with-record-size-limit.c 		ret = gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5128.html#L169'>session</a>           169 tests/resume-with-record-size-limit.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, clientx509cred);</span>
<span class='curline'><a href='../S/5128.html#L172'>session</a>           172 tests/resume-with-record-size-limit.c 			ret = gnutls_record_set_max_size(session, MAX_DATA_SIZE);</span>
<span class='curline'><a href='../S/5128.html#L179'>session</a>           179 tests/resume-with-record-size-limit.c 			gnutls_session_set_data(session, session_data.data,</span>
<span class='curline'><a href='../S/5128.html#L182'>session</a>           182 tests/resume-with-record-size-limit.c 			gnutls_handshake_set_hook_function(session,</span>
<span class='curline'><a href='../S/5128.html#L188'>session</a>           188 tests/resume-with-record-size-limit.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5128.html#L192'>session</a>           192 tests/resume-with-record-size-limit.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5128.html#L194'>session</a>           194 tests/resume-with-record-size-limit.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5128.html#L210'>session</a>           210 tests/resume-with-record-size-limit.c 			    gnutls_session_get_data2(session,</span>
<span class='curline'><a href='../S/5128.html#L217'>session</a>           217 tests/resume-with-record-size-limit.c 			if (gnutls_session_is_resumed(session) == 0) {</span>
<span class='curline'><a href='../S/5128.html#L222'>session</a>           222 tests/resume-with-record-size-limit.c 		gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5128.html#L225'>session</a>           225 tests/resume-with-record-size-limit.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5128.html#L244'>session</a>           244 tests/resume-with-record-size-limit.c 		gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5128.html#L248'>session</a>           248 tests/resume-with-record-size-limit.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5128.html#L273'>session</a>           273 tests/resume-with-record-size-limit.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5128.html#L295'>session</a>           295 tests/resume-with-record-size-limit.c 		assert(gnutls_init(&amp;session, iflags) &gt;= 0);</span>
<span class='curline'><a href='../S/5128.html#L300'>session</a>           300 tests/resume-with-record-size-limit.c 		assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5128.html#L303'>session</a>           303 tests/resume-with-record-size-limit.c 		gnutls_session_ticket_enable_server(session,</span>
<span class='curline'><a href='../S/5128.html#L306'>session</a>           306 tests/resume-with-record-size-limit.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, serverx509cred);</span>
<span class='curline'><a href='../S/5128.html#L307'>session</a>           307 tests/resume-with-record-size-limit.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5128.html#L308'>session</a>           308 tests/resume-with-record-size-limit.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5128.html#L311'>session</a>           311 tests/resume-with-record-size-limit.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5128.html#L315'>session</a>           315 tests/resume-with-record-size-limit.c 			gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5128.html#L325'>session</a>           325 tests/resume-with-record-size-limit.c 			ret = gnutls_session_is_resumed(session);</span>
<span class='curline'><a href='../S/5128.html#L336'>session</a>           336 tests/resume-with-record-size-limit.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5128.html#L350'>session</a>           350 tests/resume-with-record-size-limit.c 				gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5128.html#L356'>session</a>           356 tests/resume-with-record-size-limit.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5128.html#L360'>session</a>           360 tests/resume-with-record-size-limit.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4498.html#L67'>session</a>            67 tests/resume-with-stek-expiration.c void _gnutls_set_session_ticket_key_rotation_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4498.html#L70'>session</a>            70 tests/resume-with-stek-expiration.c static int handshake(gnutls_session_t session, gnutls_datum_t *session_data,</span>
<span class='curline'><a href='../S/4498.html#L76'>session</a>            76 tests/resume-with-stek-expiration.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4498.html#L86'>session</a>            86 tests/resume-with-stek-expiration.c 	if (gnutls_session_is_resumed(session)) {</span>
<span class='curline'><a href='../S/4498.html#L98'>session</a>            98 tests/resume-with-stek-expiration.c 	ret = gnutls_session_get_data2(session, session_data);</span>
<span class='curline'><a href='../S/4498.html#L105'>session</a>           105 tests/resume-with-stek-expiration.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4498.html#L111'>session</a>           111 tests/resume-with-stek-expiration.c static int resume_and_close(gnutls_session_t session, gnutls_datum_t *session_data,</span>
<span class='curline'><a href='../S/4498.html#L116'>session</a>           116 tests/resume-with-stek-expiration.c 	ret = gnutls_session_set_data(session, session_data-&gt;data, session_data-&gt;size);</span>
<span class='curline'><a href='../S/4498.html#L123'>session</a>           123 tests/resume-with-stek-expiration.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4498.html#L132'>session</a>           132 tests/resume-with-stek-expiration.c 	if (gnutls_session_is_resumed(session)) {</span>
<span class='curline'><a href='../S/4498.html#L145'>session</a>           145 tests/resume-with-stek-expiration.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4498.html#L153'>session</a>           153 tests/resume-with-stek-expiration.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4498.html#L160'>session</a>           160 tests/resume-with-stek-expiration.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4498.html#L161'>session</a>           161 tests/resume-with-stek-expiration.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4498.html#L164'>session</a>           164 tests/resume-with-stek-expiration.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4498.html#L167'>session</a>           167 tests/resume-with-stek-expiration.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4498.html#L168'>session</a>           168 tests/resume-with-stek-expiration.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4498.html#L170'>session</a>           170 tests/resume-with-stek-expiration.c 	if (handshake(session, &amp;session_data, resumption_should_succeed[0]) &lt; 0)</span>
<span class='curline'><a href='../S/4498.html#L175'>session</a>           175 tests/resume-with-stek-expiration.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4498.html#L181'>session</a>           181 tests/resume-with-stek-expiration.c 		assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4498.html#L182'>session</a>           182 tests/resume-with-stek-expiration.c 		assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4498.html#L185'>session</a>           185 tests/resume-with-stek-expiration.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4498.html#L188'>session</a>           188 tests/resume-with-stek-expiration.c 		gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4498.html#L190'>session</a>           190 tests/resume-with-stek-expiration.c 		if (resume_and_close(session, &amp;session_data, resumption_should_succeed[i]) &lt; 0)</span>
<span class='curline'><a href='../S/4498.html#L195'>session</a>           195 tests/resume-with-stek-expiration.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4498.html#L202'>session</a>           202 tests/resume-with-stek-expiration.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4498.html#L212'>session</a>           212 tests/resume-with-stek-expiration.c 		if ((retval = gnutls_init(&amp;session, GNUTLS_SERVER)) &lt; 0) {</span>
<span class='curline'><a href='../S/4498.html#L222'>session</a>           222 tests/resume-with-stek-expiration.c 		assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4498.html#L224'>session</a>           224 tests/resume-with-stek-expiration.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, serverx509cred);</span>
<span class='curline'><a href='../S/4498.html#L226'>session</a>           226 tests/resume-with-stek-expiration.c 		retval = gnutls_session_ticket_enable_server(session, &amp;session_ticket_key);</span>
<span class='curline'><a href='../S/4498.html#L233'>session</a>           233 tests/resume-with-stek-expiration.c 		gnutls_db_set_cache_expiration(session, TICKET_EXPIRATION);</span>
<span class='curline'><a href='../S/4498.html#L235'>session</a>           235 tests/resume-with-stek-expiration.c 		_gnutls_set_session_ticket_key_rotation_callback(session, stek_rotation_callback);</span>
<span class='curline'><a href='../S/4498.html#L237'>session</a>           237 tests/resume-with-stek-expiration.c 		gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4498.html#L238'>session</a>           238 tests/resume-with-stek-expiration.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4498.html#L241'>session</a>           241 tests/resume-with-stek-expiration.c 			retval = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4498.html#L250'>session</a>           250 tests/resume-with-stek-expiration.c 		if (gnutls_session_is_resumed(session)) {</span>
<span class='curline'><a href='../S/4498.html#L262'>session</a>           262 tests/resume-with-stek-expiration.c 		gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4498.html#L263'>session</a>           263 tests/resume-with-stek-expiration.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4448.html#L257'>session</a>           257 tests/resume.c static int post_client_hello_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/4448.html#L260'>session</a>           260 tests/resume.c 	assert(gnutls_priority_set_direct(session, gnutls_session_get_ptr(session), NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4448.html#L264'>session</a>           264 tests/resume.c static int hsk_hook_cb(gnutls_session_t session, unsigned int htype, unsigned post,</span>
<span class='curline'><a href='../S/4448.html#L295'>session</a>           295 tests/resume.c static void append_alpn(gnutls_session_t session, struct params_res *params, unsigned alpn_counter)</span>
<span class='curline'><a href='../S/4448.html#L309'>session</a>           309 tests/resume.c 	ret = gnutls_alpn_set_protocols(session, &amp;protocol, 1, 0);</span>
<span class='curline'><a href='../S/4448.html#L316'>session</a>           316 tests/resume.c static void verify_alpn(gnutls_session_t session, struct params_res *params, unsigned alpn_counter)</span>
<span class='curline'><a href='../S/4448.html#L327'>session</a>           327 tests/resume.c 	ret = gnutls_alpn_get_selected_protocol(session, &amp;selected);</span>
<span class='curline'><a href='../S/4448.html#L342'>session</a>           342 tests/resume.c static void verify_group(gnutls_session_t session, gnutls_group_t *group, unsigned counter)</span>
<span class='curline'><a href='../S/4448.html#L345'>session</a>           345 tests/resume.c 		*group = gnutls_group_get(session);</span>
<span class='curline'><a href='../S/4448.html#L349'>session</a>           349 tests/resume.c 	if (gnutls_group_get(session) != *group) {</span>
<span class='curline'><a href='../S/4448.html#L351'>session</a>           351 tests/resume.c 		     gnutls_group_get_name(gnutls_group_get(session)));</span>
<span class='curline'><a href='../S/4448.html#L355'>session</a>           355 tests/resume.c static void verify_server_params(gnutls_session_t session, unsigned counter, struct params_res *params)</span>
<span class='curline'><a href='../S/4448.html#L361'>session</a>           361 tests/resume.c 	username = gnutls_psk_server_get_username(session);</span>
<span class='curline'><a href='../S/4448.html#L372'>session</a>           372 tests/resume.c 		if (!(gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_EARLY_START)) {</span>
<span class='curline'><a href='../S/4448.html#L378'>session</a>           378 tests/resume.c 		if (gnutls_session_resumption_requested(session) == 0) {</span>
<span class='curline'><a href='../S/4448.html#L384'>session</a>           384 tests/resume.c 		if (gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_EARLY_START) {</span>
<span class='curline'><a href='../S/4448.html#L392'>session</a>           392 tests/resume.c 	if (gnutls_certificate_type_get(session) != GNUTLS_CRT_X509)</span>
<span class='curline'><a href='../S/4448.html#L393'>session</a>           393 tests/resume.c 		fail("did not find the expected X509 certificate type! (%d)\n", gnutls_certificate_type_get(session));</span>
<span class='curline'><a href='../S/4448.html#L395'>session</a>           395 tests/resume.c 	if (counter == 0 &amp;&amp; gnutls_certificate_get_ours(session) == NULL)</span>
<span class='curline'><a href='../S/4448.html#L397'>session</a>           397 tests/resume.c 	else if (counter != 0 &amp;&amp; gnutls_certificate_get_ours(session) != NULL)</span>
<span class='curline'><a href='../S/4448.html#L401'>session</a>           401 tests/resume.c 		if (gnutls_certificate_get_peers(session, &amp;l) == NULL || l &lt; 1)</span>
<span class='curline'><a href='../S/4448.html#L409'>session</a>           409 tests/resume.c 		assert(gnutls_session_get_id(session, id, &amp;id_size) &gt;= 0);</span>
<span class='curline'><a href='../S/4448.html#L417'>session</a>           417 tests/resume.c 		assert(gnutls_session_get_id(session, id2, &amp;id2_size) &gt;= 0);</span>
<span class='curline'><a href='../S/4448.html#L430'>session</a>           430 tests/resume.c static void verify_client_params(gnutls_session_t session, unsigned counter)</span>
<span class='curline'><a href='../S/4448.html#L434'>session</a>           434 tests/resume.c 	if (gnutls_certificate_get_peers(session, &amp;l) == NULL || l &lt; 1)</span>
<span class='curline'><a href='../S/4448.html#L451'>session</a>           451 tests/resume.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4448.html#L500'>session</a>           500 tests/resume.c 		assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4448.html#L526'>session</a>           526 tests/resume.c 		append_alpn(session, params, t);</span>
<span class='curline'><a href='../S/4448.html#L528'>session</a>           528 tests/resume.c 		ret = gnutls_priority_set_direct(session, prio_str, NULL);</span>
<span class='curline'><a href='../S/4448.html#L536'>session</a>           536 tests/resume.c 		gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/4448.html#L538'>session</a>           538 tests/resume.c 		gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4448.html#L540'>session</a>           540 tests/resume.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, clientx509cred);</span>
<span class='curline'><a href='../S/4448.html#L545'>session</a>           545 tests/resume.c 			gnutls_session_set_data(session, session_data.data,</span>
<span class='curline'><a href='../S/4448.html#L548'>session</a>           548 tests/resume.c 				gnutls_server_name_set(session, GNUTLS_NAME_DNS, dns_name1, strlen(dns_name1));</span>
<span class='curline'><a href='../S/4448.html#L550'>session</a>           550 tests/resume.c 				gnutls_server_name_set(session, GNUTLS_NAME_DNS, dns_name2, strlen(dns_name2));</span>
<span class='curline'><a href='../S/4448.html#L554'>session</a>           554 tests/resume.c 				gnutls_server_name_set(session, GNUTLS_NAME_DNS, dns_name2, strlen(dns_name2));</span>
<span class='curline'><a href='../S/4448.html#L558'>session</a>           558 tests/resume.c 			gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_SERVER_HELLO, GNUTLS_HOOK_PRE, hsk_hook_cb);</span>
<span class='curline'><a href='../S/4448.html#L559'>session</a>           559 tests/resume.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4448.html#L563'>session</a>           563 tests/resume.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4448.html#L565'>session</a>           565 tests/resume.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4448.html#L580'>session</a>           580 tests/resume.c 			ext_master_secret_check =  gnutls_session_ext_master_secret_status(session);</span>
<span class='curline'><a href='../S/4448.html#L584'>session</a>           584 tests/resume.c 			    gnutls_session_get_data2(session,</span>
<span class='curline'><a href='../S/4448.html#L593'>session</a>           593 tests/resume.c 				    gnutls_session_get_data2(session,</span>
<span class='curline'><a href='../S/4448.html#L600'>session</a>           600 tests/resume.c 			if (gnutls_session_is_resumed(session) != 0) {</span>
<span class='curline'><a href='../S/4448.html#L619'>session</a>           619 tests/resume.c 				if (gnutls_cipher_get(session) != GNUTLS_CIPHER_AES_128_GCM) {</span>
<span class='curline'><a href='../S/4448.html#L621'>session</a>           621 tests/resume.c 					     gnutls_cipher_get_name(gnutls_cipher_get(session)));</span>
<span class='curline'><a href='../S/4448.html#L626'>session</a>           626 tests/resume.c 		verify_alpn(session, params, t);</span>
<span class='curline'><a href='../S/4448.html#L627'>session</a>           627 tests/resume.c 		verify_group(session, &amp;pgroup, t);</span>
<span class='curline'><a href='../S/4448.html#L630'>session</a>           630 tests/resume.c 			verify_client_params(session, t);</span>
<span class='curline'><a href='../S/4448.html#L632'>session</a>           632 tests/resume.c 		gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4448.html#L635'>session</a>           635 tests/resume.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4448.html#L655'>session</a>           655 tests/resume.c 		gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4448.html#L659'>session</a>           659 tests/resume.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4448.html#L720'>session</a>           720 tests/resume.c pskfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/4448.html#L739'>session</a>           739 tests/resume.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4448.html#L786'>session</a>           786 tests/resume.c 		assert(gnutls_init(&amp;session, iflags) &gt;= 0);</span>
<span class='curline'><a href='../S/4448.html#L791'>session</a>           791 tests/resume.c 		assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4448.html#L798'>session</a>           798 tests/resume.c 			gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/4448.html#L803'>session</a>           803 tests/resume.c 		gnutls_dh_set_prime_bits(session, DH_BITS);</span>
<span class='curline'><a href='../S/4448.html#L806'>session</a>           806 tests/resume.c 			gnutls_db_set_retrieve_function(session, wrap_db_fetch);</span>
<span class='curline'><a href='../S/4448.html#L807'>session</a>           807 tests/resume.c 			gnutls_db_set_remove_function(session, wrap_db_delete);</span>
<span class='curline'><a href='../S/4448.html#L808'>session</a>           808 tests/resume.c 			gnutls_db_set_store_function(session, wrap_db_store);</span>
<span class='curline'><a href='../S/4448.html#L809'>session</a>           809 tests/resume.c 			gnutls_db_set_ptr(session, NULL);</span>
<span class='curline'><a href='../S/4448.html#L813'>session</a>           813 tests/resume.c 			gnutls_session_ticket_enable_server(session,</span>
<span class='curline'><a href='../S/4448.html#L816'>session</a>           816 tests/resume.c 		append_alpn(session, params, t);</span>
<span class='curline'><a href='../S/4448.html#L819'>session</a>           819 tests/resume.c 			gnutls_db_set_cache_expiration(session, 45);</span>
<span class='curline'><a href='../S/4448.html#L823'>session</a>           823 tests/resume.c 		gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/4448.html#L825'>session</a>           825 tests/resume.c 		gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4448.html#L827'>session</a>           827 tests/resume.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, serverx509cred);</span>
<span class='curline'><a href='../S/4448.html#L829'>session</a>           829 tests/resume.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4448.html#L830'>session</a>           830 tests/resume.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4448.html#L833'>session</a>           833 tests/resume.c 			gnutls_session_set_ptr(session, PRIO_STR);</span>
<span class='curline'><a href='../S/4448.html#L834'>session</a>           834 tests/resume.c 			gnutls_handshake_set_post_client_hello_function(session,</span>
<span class='curline'><a href='../S/4448.html#L840'>session</a>           840 tests/resume.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4448.html#L844'>session</a>           844 tests/resume.c 			gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4448.html#L854'>session</a>           854 tests/resume.c 			ret = gnutls_session_is_resumed(session);</span>
<span class='curline'><a href='../S/4448.html#L860'>session</a>           860 tests/resume.c 		verify_alpn(session, params, t);</span>
<span class='curline'><a href='../S/4448.html#L861'>session</a>           861 tests/resume.c 		verify_group(session, &amp;pgroup, t);</span>
<span class='curline'><a href='../S/4448.html#L864'>session</a>           864 tests/resume.c 			verify_server_params(session, t, params);</span>
<span class='curline'><a href='../S/4448.html#L871'>session</a>           871 tests/resume.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4448.html#L885'>session</a>           885 tests/resume.c 				gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4448.html#L891'>session</a>           891 tests/resume.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4448.html#L895'>session</a>           895 tests/resume.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5057.html#L124'>session</a>           124 tests/rfc7633-missing.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5057.html#L139'>session</a>           139 tests/rfc7633-missing.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5057.html#L154'>session</a>           154 tests/rfc7633-missing.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5057.html#L157'>session</a>           157 tests/rfc7633-missing.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5057.html#L159'>session</a>           159 tests/rfc7633-missing.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CERTIFICATE_STATUS,</span>
<span class='curline'><a href='../S/5057.html#L165'>session</a>           165 tests/rfc7633-missing.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5057.html#L167'>session</a>           167 tests/rfc7633-missing.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5057.html#L172'>session</a>           172 tests/rfc7633-missing.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5057.html#L191'>session</a>           191 tests/rfc7633-missing.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5057.html#L197'>session</a>           197 tests/rfc7633-missing.c 	ret = gnutls_certificate_verify_peers2(session, &amp;status);</span>
<span class='curline'><a href='../S/5057.html#L210'>session</a>           210 tests/rfc7633-missing.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5057.html#L216'>session</a>           216 tests/rfc7633-missing.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5057.html#L228'>session</a>           228 tests/rfc7633-missing.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5057.html#L246'>session</a>           246 tests/rfc7633-missing.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5057.html#L251'>session</a>           251 tests/rfc7633-missing.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5057.html#L253'>session</a>           253 tests/rfc7633-missing.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5057.html#L255'>session</a>           255 tests/rfc7633-missing.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5057.html#L258'>session</a>           258 tests/rfc7633-missing.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5057.html#L272'>session</a>           272 tests/rfc7633-missing.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5057.html#L276'>session</a>           276 tests/rfc7633-missing.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5057.html#L280'>session</a>           280 tests/rfc7633-missing.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5197.html#L135'>session</a>           135 tests/rfc7633-ok.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5197.html#L150'>session</a>           150 tests/rfc7633-ok.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5197.html#L163'>session</a>           163 tests/rfc7633-ok.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT) &gt;= 0);</span>
<span class='curline'><a href='../S/5197.html#L165'>session</a>           165 tests/rfc7633-ok.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5197.html#L167'>session</a>           167 tests/rfc7633-ok.c 	gnutls_handshake_set_hook_function(session,</span>
<span class='curline'><a href='../S/5197.html#L172'>session</a>           172 tests/rfc7633-ok.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5197.html#L174'>session</a>           174 tests/rfc7633-ok.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5197.html#L177'>session</a>           177 tests/rfc7633-ok.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5197.html#L190'>session</a>           190 tests/rfc7633-ok.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5197.html#L193'>session</a>           193 tests/rfc7633-ok.c 	    &amp;&amp; gnutls_protocol_get_version(session) == GNUTLS_TLS1_2) {</span>
<span class='curline'><a href='../S/5197.html#L197'>session</a>           197 tests/rfc7633-ok.c 	ret = gnutls_certificate_verify_peers2(session, &amp;status);</span>
<span class='curline'><a href='../S/5197.html#L210'>session</a>           210 tests/rfc7633-ok.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5197.html#L214'>session</a>           214 tests/rfc7633-ok.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5197.html#L221'>session</a>           221 tests/rfc7633-ok.c static int status_func(gnutls_session_t session, void *ptr, gnutls_datum_t *resp)</span>
<span class='curline'><a href='../S/5197.html#L236'>session</a>           236 tests/rfc7633-ok.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5197.html#L253'>session</a>           253 tests/rfc7633-ok.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER) &gt;= 0);</span>
<span class='curline'><a href='../S/5197.html#L255'>session</a>           255 tests/rfc7633-ok.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5197.html#L259'>session</a>           259 tests/rfc7633-ok.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5197.html#L261'>session</a>           261 tests/rfc7633-ok.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5197.html#L264'>session</a>           264 tests/rfc7633-ok.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5197.html#L278'>session</a>           278 tests/rfc7633-ok.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5197.html#L282'>session</a>           282 tests/rfc7633-ok.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5197.html#L285'>session</a>           285 tests/rfc7633-ok.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4897.html#L65'>session</a>            65 tests/rsa-psk-cb.c int psk_cli_func(gnutls_session_t session, char **username, gnutls_datum_t *key)</span>
<span class='curline'><a href='../S/4897.html#L88'>session</a>            88 tests/rsa-psk-cb.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4897.html#L108'>session</a>           108 tests/rsa-psk-cb.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4897.html#L111'>session</a>           111 tests/rsa-psk-cb.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:-KX-ALL:+RSA-PSK",</span>
<span class='curline'><a href='../S/4897.html#L116'>session</a>           116 tests/rsa-psk-cb.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/4897.html#L117'>session</a>           117 tests/rsa-psk-cb.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4897.html#L120'>session</a>           120 tests/rsa-psk-cb.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4897.html#L121'>session</a>           121 tests/rsa-psk-cb.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4897.html#L125'>session</a>           125 tests/rsa-psk-cb.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4897.html#L136'>session</a>           136 tests/rsa-psk-cb.c 	gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4897.html#L138'>session</a>           138 tests/rsa-psk-cb.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4897.html#L157'>session</a>           157 tests/rsa-psk-cb.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4897.html#L163'>session</a>           163 tests/rsa-psk-cb.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4897.html#L177'>session</a>           177 tests/rsa-psk-cb.c psk_server_func(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/4897.html#L199'>session</a>           199 tests/rsa-psk-cb.c gnutls_session_t session;</span>
<span class='curline'><a href='../S/4897.html#L226'>session</a>           226 tests/rsa-psk-cb.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4897.html#L231'>session</a>           231 tests/rsa-psk-cb.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:-KX-ALL:+RSA-PSK",</span>
<span class='curline'><a href='../S/4897.html#L235'>session</a>           235 tests/rsa-psk-cb.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, server_pskcred);</span>
<span class='curline'><a href='../S/4897.html#L236'>session</a>           236 tests/rsa-psk-cb.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4897.html#L239'>session</a>           239 tests/rsa-psk-cb.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4897.html#L240'>session</a>           240 tests/rsa-psk-cb.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4897.html#L241'>session</a>           241 tests/rsa-psk-cb.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4897.html#L244'>session</a>           244 tests/rsa-psk-cb.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4897.html#L257'>session</a>           257 tests/rsa-psk-cb.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4897.html#L270'>session</a>           270 tests/rsa-psk-cb.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4897.html#L276'>session</a>           276 tests/rsa-psk-cb.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4897.html#L279'>session</a>           279 tests/rsa-psk-cb.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4429.html#L70'>session</a>            70 tests/rsa-psk.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4429.html#L92'>session</a>            92 tests/rsa-psk.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4429.html#L95'>session</a>            95 tests/rsa-psk.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:-KX-ALL:+RSA-PSK",</span>
<span class='curline'><a href='../S/4429.html#L100'>session</a>           100 tests/rsa-psk.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/4429.html#L101'>session</a>           101 tests/rsa-psk.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4429.html#L104'>session</a>           104 tests/rsa-psk.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4429.html#L105'>session</a>           105 tests/rsa-psk.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4429.html#L109'>session</a>           109 tests/rsa-psk.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4429.html#L120'>session</a>           120 tests/rsa-psk.c 	gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4429.html#L122'>session</a>           122 tests/rsa-psk.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4429.html#L141'>session</a>           141 tests/rsa-psk.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4429.html#L147'>session</a>           147 tests/rsa-psk.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4429.html#L161'>session</a>           161 tests/rsa-psk.c psk_server_func(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/4429.html#L183'>session</a>           183 tests/rsa-psk.c gnutls_session_t session;</span>
<span class='curline'><a href='../S/4429.html#L210'>session</a>           210 tests/rsa-psk.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4429.html#L215'>session</a>           215 tests/rsa-psk.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:-KX-ALL:+RSA-PSK",</span>
<span class='curline'><a href='../S/4429.html#L219'>session</a>           219 tests/rsa-psk.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, server_pskcred);</span>
<span class='curline'><a href='../S/4429.html#L220'>session</a>           220 tests/rsa-psk.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4429.html#L223'>session</a>           223 tests/rsa-psk.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4429.html#L224'>session</a>           224 tests/rsa-psk.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4429.html#L225'>session</a>           225 tests/rsa-psk.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4429.html#L228'>session</a>           228 tests/rsa-psk.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4429.html#L241'>session</a>           241 tests/rsa-psk.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4429.html#L254'>session</a>           254 tests/rsa-psk.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4429.html#L260'>session</a>           260 tests/rsa-psk.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4429.html#L263'>session</a>           263 tests/rsa-psk.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4431.html#L70'>session</a>            70 tests/send-data-before-handshake.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4431.html#L80'>session</a>            80 tests/send-data-before-handshake.c 	ret = gnutls_record_send(session, &amp;c, 1);</span>
<span class='curline'><a href='../S/4431.html#L98'>session</a>            98 tests/send-data-before-handshake.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4431.html#L112'>session</a>           112 tests/send-data-before-handshake.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4431.html#L114'>session</a>           114 tests/send-data-before-handshake.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4431.html#L116'>session</a>           116 tests/send-data-before-handshake.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4431.html#L120'>session</a>           120 tests/send-data-before-handshake.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4431.html#L122'>session</a>           122 tests/send-data-before-handshake.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4431.html#L127'>session</a>           127 tests/send-data-before-handshake.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4431.html#L147'>session</a>           147 tests/send-data-before-handshake.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4431.html#L151'>session</a>           151 tests/send-data-before-handshake.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4431.html#L166'>session</a>           166 tests/send-data-before-handshake.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4431.html#L172'>session</a>           172 tests/send-data-before-handshake.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4431.html#L193'>session</a>           193 tests/send-data-before-handshake.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4431.html#L211'>session</a>           211 tests/send-data-before-handshake.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4431.html#L213'>session</a>           213 tests/send-data-before-handshake.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4431.html#L215'>session</a>           215 tests/send-data-before-handshake.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4431.html#L217'>session</a>           217 tests/send-data-before-handshake.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4431.html#L220'>session</a>           220 tests/send-data-before-handshake.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4431.html#L234'>session</a>           234 tests/send-data-before-handshake.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4431.html#L238'>session</a>           238 tests/send-data-before-handshake.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4431.html#L242'>session</a>           242 tests/send-data-before-handshake.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5025.html#L50'>session</a>            50 tests/server-kx-neg-common.c serv_psk_func(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/5025.html#L92'>session</a>            92 tests/server-kx-neg-common.c serv_srp_func(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/4914.html#L136'>session</a>           136 tests/server-sign-md5-rep.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4914.html#L155'>session</a>           155 tests/server-sign-md5-rep.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4914.html#L160'>session</a>           160 tests/server-sign-md5-rep.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:-RSA", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4914.html#L161'>session</a>           161 tests/server-sign-md5-rep.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4914.html#L163'>session</a>           163 tests/server-sign-md5-rep.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4914.html#L165'>session</a>           165 tests/server-sign-md5-rep.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4914.html#L167'>session</a>           167 tests/server-sign-md5-rep.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4914.html#L174'>session</a>           174 tests/server-sign-md5-rep.c 	gnutls_alert_send_appropriate(session, ret);</span>
<span class='curline'><a href='../S/4914.html#L177'>session</a>           177 tests/server-sign-md5-rep.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5147.html#L56'>session</a>            56 tests/session-rdn-read.c cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4436.html#L85'>session</a>            85 tests/session-tickets-missing.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4436.html#L101'>session</a>           101 tests/session-tickets-missing.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4436.html#L118'>session</a>           118 tests/session-tickets-missing.c 	gnutls_init(&amp;session, flags);</span>
<span class='curline'><a href='../S/4436.html#L120'>session</a>           120 tests/session-tickets-missing.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4436.html#L124'>session</a>           124 tests/session-tickets-missing.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4436.html#L126'>session</a>           126 tests/session-tickets-missing.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4436.html#L131'>session</a>           131 tests/session-tickets-missing.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4436.html#L151'>session</a>           151 tests/session-tickets-missing.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4436.html#L153'>session</a>           153 tests/session-tickets-missing.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4436.html#L159'>session</a>           159 tests/session-tickets-missing.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4436.html#L180'>session</a>           180 tests/session-tickets-missing.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4436.html#L201'>session</a>           201 tests/session-tickets-missing.c 	assert(gnutls_init(&amp;session, flags)&gt;=0);</span>
<span class='curline'><a href='../S/4436.html#L205'>session</a>           205 tests/session-tickets-missing.c 		assert(gnutls_session_ticket_enable_server(session, &amp;skey) &gt;= 0);</span>
<span class='curline'><a href='../S/4436.html#L208'>session</a>           208 tests/session-tickets-missing.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_NEW_SESSION_TICKET,</span>
<span class='curline'><a href='../S/4436.html#L215'>session</a>           215 tests/session-tickets-missing.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4436.html#L217'>session</a>           217 tests/session-tickets-missing.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4436.html#L219'>session</a>           219 tests/session-tickets-missing.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4436.html#L222'>session</a>           222 tests/session-tickets-missing.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4436.html#L236'>session</a>           236 tests/session-tickets-missing.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4436.html#L245'>session</a>           245 tests/session-tickets-missing.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4436.html#L249'>session</a>           249 tests/session-tickets-missing.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4544.html#L71'>session</a>            71 tests/session-tickets-ok.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4544.html#L89'>session</a>            89 tests/session-tickets-ok.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4544.html#L100'>session</a>           100 tests/session-tickets-ok.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4544.html#L102'>session</a>           102 tests/session-tickets-ok.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4544.html#L104'>session</a>           104 tests/session-tickets-ok.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4544.html#L106'>session</a>           106 tests/session-tickets-ok.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4544.html#L109'>session</a>           109 tests/session-tickets-ok.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4544.html#L124'>session</a>           124 tests/session-tickets-ok.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4544.html#L126'>session</a>           126 tests/session-tickets-ok.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4544.html#L130'>session</a>           130 tests/session-tickets-ok.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4544.html#L151'>session</a>           151 tests/session-tickets-ok.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4544.html#L170'>session</a>           170 tests/session-tickets-ok.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/4544.html#L173'>session</a>           173 tests/session-tickets-ok.c 	assert(gnutls_session_ticket_enable_server(session, &amp;skey) &gt;= 0);</span>
<span class='curline'><a href='../S/4544.html#L175'>session</a>           175 tests/session-tickets-ok.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_NEW_SESSION_TICKET,</span>
<span class='curline'><a href='../S/4544.html#L182'>session</a>           182 tests/session-tickets-ok.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4544.html#L184'>session</a>           184 tests/session-tickets-ok.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4544.html#L186'>session</a>           186 tests/session-tickets-ok.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4544.html#L189'>session</a>           189 tests/session-tickets-ok.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4544.html#L203'>session</a>           203 tests/session-tickets-ok.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4544.html#L212'>session</a>           212 tests/session-tickets-ok.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4544.html#L216'>session</a>           216 tests/session-tickets-ok.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4537.html#L57'>session</a>            57 tests/set_known_dh_params_psk.c pskfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/5101.html#L67'>session</a>            67 tests/set_x509_key_file-late.c int handshake_hook_func(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5101.html#L84'>session</a>            84 tests/set_x509_key_file-late.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4523.html#L257'>session</a>           257 tests/set_x509_key_file_ocsp.c static void check_response(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/4523.html#L263'>session</a>           263 tests/set_x509_key_file_ocsp.c 	ret = gnutls_ocsp_status_request_get(session, &amp;resp);</span>
<span class='curline'><a href='../S/4523.html#L279'>session</a>           279 tests/set_x509_key_file_ocsp.c 	ret = gnutls_ocsp_status_request_is_checked(session, 0);</span>
<span class='curline'><a href='../S/4523.html#L284'>session</a>           284 tests/set_x509_key_file_ocsp.c 	ret = gnutls_ocsp_status_request_is_checked(session, GNUTLS_OCSP_SR_IS_AVAIL);</span>
<span class='curline'><a href='../S/5198.html#L66'>session</a>            66 tests/set_x509_key_file_ocsp_multi2.c static void check_response(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/5198.html#L72'>session</a>            72 tests/set_x509_key_file_ocsp_multi2.c 	ret = gnutls_ocsp_status_request_get(session, &amp;resp);</span>
<span class='curline'><a href='../S/5198.html#L88'>session</a>            88 tests/set_x509_key_file_ocsp_multi2.c static int ocsp_func(gnutls_session_t session, void *ptr, gnutls_datum_t *ocsp_response)</span>
<span class='curline'><a href='../S/4920.html#L50'>session</a>            50 tests/set_x509_ocsp_multi_cli.c static void check_cli(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/4920.html#L52'>session</a>            52 tests/set_x509_ocsp_multi_cli.c 	assert((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_SERV_REQUESTED_OCSP) != 0);</span>
<span class='curline'><a href='../S/4920.html#L55'>session</a>            55 tests/set_x509_ocsp_multi_cli.c static void check_serv(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/4920.html#L62'>session</a>            62 tests/set_x509_ocsp_multi_cli.c 	assert((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_SERV_REQUESTED_OCSP) != 0);</span>
<span class='curline'><a href='../S/4920.html#L64'>session</a>            64 tests/set_x509_ocsp_multi_cli.c 	ret = gnutls_ocsp_status_request_get(session, &amp;resp);</span>
<span class='curline'><a href='../S/4920.html#L80'>session</a>            80 tests/set_x509_ocsp_multi_cli.c 	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1_3) {</span>
<span class='curline'><a href='../S/4920.html#L81'>session</a>            81 tests/set_x509_ocsp_multi_cli.c 		ret = gnutls_ocsp_status_request_get2(session, 1, &amp;resp);</span>
<span class='curline'><a href='../S/4920.html#L91'>session</a>            91 tests/set_x509_ocsp_multi_cli.c 	ret = gnutls_certificate_verify_peers2(session, &amp;status);</span>
<span class='curline'><a href='../S/4920.html#L95'>session</a>            95 tests/set_x509_ocsp_multi_cli.c 	ret = gnutls_ocsp_status_request_is_checked(session, GNUTLS_OCSP_SR_IS_AVAIL);</span>
<span class='curline'><a href='../S/4920.html#L100'>session</a>           100 tests/set_x509_ocsp_multi_cli.c 	ret = gnutls_ocsp_status_request_is_checked(session, 0);</span>
<span class='curline'><a href='../S/4982.html#L63'>session</a>            63 tests/set_x509_ocsp_multi_invalid.c static void check_response(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/4982.html#L69'>session</a>            69 tests/set_x509_ocsp_multi_invalid.c 	ret = gnutls_ocsp_status_request_get(session, &amp;resp);</span>
<span class='curline'><a href='../S/4354.html#L50'>session</a>            50 tests/set_x509_ocsp_multi_pem.c static void check_response(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/4354.html#L56'>session</a>            56 tests/set_x509_ocsp_multi_pem.c 	ret = gnutls_ocsp_status_request_get(session, &amp;resp);</span>
<span class='curline'><a href='../S/4354.html#L72'>session</a>            72 tests/set_x509_ocsp_multi_pem.c 	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1_3) {</span>
<span class='curline'><a href='../S/4354.html#L73'>session</a>            73 tests/set_x509_ocsp_multi_pem.c 		ret = gnutls_ocsp_status_request_get2(session, 1, &amp;resp);</span>
<span class='curline'><a href='../S/4354.html#L83'>session</a>            83 tests/set_x509_ocsp_multi_pem.c 	ret = gnutls_ocsp_status_request_is_checked(session, 0);</span>
<span class='curline'><a href='../S/4354.html#L88'>session</a>            88 tests/set_x509_ocsp_multi_pem.c 	ret = gnutls_ocsp_status_request_is_checked(session, GNUTLS_OCSP_SR_IS_AVAIL);</span>
<span class='curline'><a href='../S/4934.html#L50'>session</a>            50 tests/set_x509_ocsp_multi_unknown.c static void check_response(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/4934.html#L56'>session</a>            56 tests/set_x509_ocsp_multi_unknown.c 	ret = gnutls_ocsp_status_request_get(session, &amp;resp);</span>
<span class='curline'><a href='../S/4934.html#L72'>session</a>            72 tests/set_x509_ocsp_multi_unknown.c 	if (gnutls_protocol_get_version(session) == GNUTLS_TLS1_3) {</span>
<span class='curline'><a href='../S/4934.html#L73'>session</a>            73 tests/set_x509_ocsp_multi_unknown.c 		ret = gnutls_ocsp_status_request_get2(session, 1, &amp;resp);</span>
<span class='curline'><a href='../S/4507.html#L111'>session</a>           111 tests/srp.c    	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4507.html#L130'>session</a>           130 tests/srp.c    	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4507.html#L133'>session</a>           133 tests/srp.c    	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4507.html#L134'>session</a>           134 tests/srp.c    	gnutls_handshake_set_timeout(session, 100 * 1000);</span>
<span class='curline'><a href='../S/4507.html#L138'>session</a>           138 tests/srp.c    	gnutls_credentials_set(session, GNUTLS_CRD_SRP, srp_cred);</span>
<span class='curline'><a href='../S/4507.html#L139'>session</a>           139 tests/srp.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4507.html#L141'>session</a>           141 tests/srp.c    	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4507.html#L146'>session</a>           146 tests/srp.c    		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4507.html#L168'>session</a>           168 tests/srp.c    			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4507.html#L170'>session</a>           170 tests/srp.c    	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4507.html#L174'>session</a>           174 tests/srp.c    	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4507.html#L198'>session</a>           198 tests/srp.c    	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4507.html#L220'>session</a>           220 tests/srp.c    	assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/4507.html#L225'>session</a>           225 tests/srp.c    	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4507.html#L227'>session</a>           227 tests/srp.c    	gnutls_credentials_set(session, GNUTLS_CRD_SRP, s_srp_cred);</span>
<span class='curline'><a href='../S/4507.html#L228'>session</a>           228 tests/srp.c    	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4507.html#L231'>session</a>           231 tests/srp.c    	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4507.html#L232'>session</a>           232 tests/srp.c    	gnutls_handshake_set_timeout(session, 100 * 1000);</span>
<span class='curline'><a href='../S/4507.html#L235'>session</a>           235 tests/srp.c    		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4507.html#L240'>session</a>           240 tests/srp.c    		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4507.html#L251'>session</a>           251 tests/srp.c    			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4507.html#L253'>session</a>           253 tests/srp.c    	kx = gnutls_kx_get(session);</span>
<span class='curline'><a href='../S/4507.html#L260'>session</a>           260 tests/srp.c    	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4507.html#L263'>session</a>           263 tests/srp.c    	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4452.html#L107'>session</a>           107 tests/ssl2-hello.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4452.html#L129'>session</a>           129 tests/ssl2-hello.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4452.html#L134'>session</a>           134 tests/ssl2-hello.c 	gnutls_priority_set_direct(session, "NORMAL", NULL);</span>
<span class='curline'><a href='../S/4452.html#L136'>session</a>           136 tests/ssl2-hello.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4452.html#L138'>session</a>           138 tests/ssl2-hello.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4452.html#L139'>session</a>           139 tests/ssl2-hello.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4452.html#L140'>session</a>           140 tests/ssl2-hello.c 	if (ret != GNUTLS_E_FATAL_ALERT_RECEIVED || gnutls_alert_get(session) != GNUTLS_A_USER_CANCELED) {</span>
<span class='curline'><a href='../S/4452.html#L151'>session</a>           151 tests/ssl2-hello.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5196.html#L108'>session</a>           108 tests/status-request-ext.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5196.html#L162'>session</a>           162 tests/status-request-ext.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5196.html#L176'>session</a>           176 tests/status-request-ext.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5196.html#L179'>session</a>           179 tests/status-request-ext.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5196.html#L183'>session</a>           183 tests/status-request-ext.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5196.html#L185'>session</a>           185 tests/status-request-ext.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5196.html#L190'>session</a>           190 tests/status-request-ext.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5196.html#L209'>session</a>           209 tests/status-request-ext.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5196.html#L211'>session</a>           211 tests/status-request-ext.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5196.html#L217'>session</a>           217 tests/status-request-ext.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5196.html#L229'>session</a>           229 tests/status-request-ext.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5196.html#L247'>session</a>           247 tests/status-request-ext.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5196.html#L249'>session</a>           249 tests/status-request-ext.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_SERVER_HELLO,</span>
<span class='curline'><a href='../S/5196.html#L256'>session</a>           256 tests/status-request-ext.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/5196.html#L258'>session</a>           258 tests/status-request-ext.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5196.html#L260'>session</a>           260 tests/status-request-ext.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5196.html#L263'>session</a>           263 tests/status-request-ext.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5196.html#L277'>session</a>           277 tests/status-request-ext.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5196.html#L281'>session</a>           281 tests/status-request-ext.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5196.html#L285'>session</a>           285 tests/status-request-ext.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4985.html#L110'>session</a>           110 tests/status-request-ok.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4985.html#L121'>session</a>           121 tests/status-request-ok.c static int status_func(gnutls_session_t session, void *ptr, gnutls_datum_t *resp)</span>
<span class='curline'><a href='../S/4985.html#L139'>session</a>           139 tests/status-request-ok.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4985.html#L153'>session</a>           153 tests/status-request-ok.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4985.html#L156'>session</a>           156 tests/status-request-ok.c 	gnutls_priority_set_direct(session, "NORMAL:-KX-ALL:+ECDHE-RSA", NULL);</span>
<span class='curline'><a href='../S/4985.html#L158'>session</a>           158 tests/status-request-ok.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CERTIFICATE_STATUS,</span>
<span class='curline'><a href='../S/4985.html#L164'>session</a>           164 tests/status-request-ok.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4985.html#L166'>session</a>           166 tests/status-request-ok.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4985.html#L171'>session</a>           171 tests/status-request-ok.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4985.html#L190'>session</a>           190 tests/status-request-ok.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4985.html#L196'>session</a>           196 tests/status-request-ok.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4985.html#L202'>session</a>           202 tests/status-request-ok.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4985.html#L214'>session</a>           214 tests/status-request-ok.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4985.html#L234'>session</a>           234 tests/status-request-ok.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4985.html#L239'>session</a>           239 tests/status-request-ok.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4985.html#L241'>session</a>           241 tests/status-request-ok.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4985.html#L243'>session</a>           243 tests/status-request-ok.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4985.html#L246'>session</a>           246 tests/status-request-ok.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4985.html#L260'>session</a>           260 tests/status-request-ok.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4985.html#L269'>session</a>           269 tests/status-request-ok.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4985.html#L273'>session</a>           273 tests/status-request-ok.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5053.html#L235'>session</a>           235 tests/status-request-revoked.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5053.html#L246'>session</a>           246 tests/status-request-revoked.c static int status_func(gnutls_session_t session, void *ptr, gnutls_datum_t *resp)</span>
<span class='curline'><a href='../S/5053.html#L260'>session</a>           260 tests/status-request-revoked.c static int cert_verify_callback(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5053.html#L266'>session</a>           266 tests/status-request-revoked.c 	ret = gnutls_certificate_verify_peers2(session, &amp;status);</span>
<span class='curline'><a href='../S/5053.html#L282'>session</a>           282 tests/status-request-revoked.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5053.html#L295'>session</a>           295 tests/status-request-revoked.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5053.html#L297'>session</a>           297 tests/status-request-revoked.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5053.html#L299'>session</a>           299 tests/status-request-revoked.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CERTIFICATE_STATUS,</span>
<span class='curline'><a href='../S/5053.html#L305'>session</a>           305 tests/status-request-revoked.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5053.html#L312'>session</a>           312 tests/status-request-revoked.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5053.html#L317'>session</a>           317 tests/status-request-revoked.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5053.html#L331'>session</a>           331 tests/status-request-revoked.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5053.html#L337'>session</a>           337 tests/status-request-revoked.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5053.html#L341'>session</a>           341 tests/status-request-revoked.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5053.html#L353'>session</a>           353 tests/status-request-revoked.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5053.html#L373'>session</a>           373 tests/status-request-revoked.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5053.html#L375'>session</a>           375 tests/status-request-revoked.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CERTIFICATE_STATUS,</span>
<span class='curline'><a href='../S/5053.html#L379'>session</a>           379 tests/status-request-revoked.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5053.html#L381'>session</a>           381 tests/status-request-revoked.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5053.html#L383'>session</a>           383 tests/status-request-revoked.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5053.html#L386'>session</a>           386 tests/status-request-revoked.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5053.html#L400'>session</a>           400 tests/status-request-revoked.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5053.html#L409'>session</a>           409 tests/status-request-revoked.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5053.html#L413'>session</a>           413 tests/status-request-revoked.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4363.html#L68'>session</a>            68 tests/status-request.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4363.html#L79'>session</a>            79 tests/status-request.c static int status_func(gnutls_session_t session, void *ptr, gnutls_datum_t *resp)</span>
<span class='curline'><a href='../S/4363.html#L97'>session</a>            97 tests/status-request.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4363.html#L110'>session</a>           110 tests/status-request.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_NO_EXTENSIONS)&gt;=0);</span>
<span class='curline'><a href='../S/4363.html#L112'>session</a>           112 tests/status-request.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4363.html#L116'>session</a>           116 tests/status-request.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4363.html#L118'>session</a>           118 tests/status-request.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4363.html#L123'>session</a>           123 tests/status-request.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4363.html#L139'>session</a>           139 tests/status-request.c 	assert((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_CLI_REQUESTED_OCSP) == 0);</span>
<span class='curline'><a href='../S/4363.html#L144'>session</a>           144 tests/status-request.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4363.html#L148'>session</a>           148 tests/status-request.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4363.html#L162'>session</a>           162 tests/status-request.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4363.html#L168'>session</a>           168 tests/status-request.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4363.html#L180'>session</a>           180 tests/status-request.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4363.html#L200'>session</a>           200 tests/status-request.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4363.html#L202'>session</a>           202 tests/status-request.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CERTIFICATE_STATUS,</span>
<span class='curline'><a href='../S/4363.html#L206'>session</a>           206 tests/status-request.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4363.html#L208'>session</a>           208 tests/status-request.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4363.html#L210'>session</a>           210 tests/status-request.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4363.html#L213'>session</a>           213 tests/status-request.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4363.html#L220'>session</a>           220 tests/status-request.c 	assert((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_CLI_REQUESTED_OCSP) == 0);</span>
<span class='curline'><a href='../S/4363.html#L229'>session</a>           229 tests/status-request.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4363.html#L233'>session</a>           233 tests/status-request.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4363.html#L237'>session</a>           237 tests/status-request.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5169.html#L72'>session</a>            72 tests/tls-client-with-seccomp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5169.html#L91'>session</a>            91 tests/tls-client-with-seccomp.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5169.html#L92'>session</a>            92 tests/tls-client-with-seccomp.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5169.html#L95'>session</a>            95 tests/tls-client-with-seccomp.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5169.html#L99'>session</a>            99 tests/tls-client-with-seccomp.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/5169.html#L101'>session</a>           101 tests/tls-client-with-seccomp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5169.html#L106'>session</a>           106 tests/tls-client-with-seccomp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5169.html#L122'>session</a>           122 tests/tls-client-with-seccomp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5169.html#L125'>session</a>           125 tests/tls-client-with-seccomp.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/5169.html#L138'>session</a>           138 tests/tls-client-with-seccomp.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5169.html#L147'>session</a>           147 tests/tls-client-with-seccomp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5169.html#L172'>session</a>           172 tests/tls-client-with-seccomp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5169.html#L191'>session</a>           191 tests/tls-client-with-seccomp.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5169.html#L192'>session</a>           192 tests/tls-client-with-seccomp.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5169.html#L197'>session</a>           197 tests/tls-client-with-seccomp.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5169.html#L201'>session</a>           201 tests/tls-client-with-seccomp.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/5169.html#L203'>session</a>           203 tests/tls-client-with-seccomp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5169.html#L206'>session</a>           206 tests/tls-client-with-seccomp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5169.html#L211'>session</a>           211 tests/tls-client-with-seccomp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5169.html#L222'>session</a>           222 tests/tls-client-with-seccomp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5169.html#L229'>session</a>           229 tests/tls-client-with-seccomp.c 		ret = gnutls_record_send(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/5169.html#L234'>session</a>           234 tests/tls-client-with-seccomp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5169.html#L240'>session</a>           240 tests/tls-client-with-seccomp.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5169.html#L246'>session</a>           246 tests/tls-client-with-seccomp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4444.html#L80'>session</a>            80 tests/tls-etm.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4444.html#L95'>session</a>            95 tests/tls-etm.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4444.html#L98'>session</a>            98 tests/tls-etm.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4444.html#L102'>session</a>           102 tests/tls-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4444.html#L103'>session</a>           103 tests/tls-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4444.html#L105'>session</a>           105 tests/tls-etm.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4444.html#L110'>session</a>           110 tests/tls-etm.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4444.html#L126'>session</a>           126 tests/tls-etm.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4444.html#L128'>session</a>           128 tests/tls-etm.c 	if (etm != 0 &amp;&amp; gnutls_session_etm_status(session) == 0) {</span>
<span class='curline'><a href='../S/4444.html#L131'>session</a>           131 tests/tls-etm.c 	} else if (etm == 0 &amp;&amp; gnutls_session_etm_status(session) != 0) {</span>
<span class='curline'><a href='../S/4444.html#L136'>session</a>           136 tests/tls-etm.c 	if (etm != 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) == 0)) {</span>
<span class='curline'><a href='../S/4444.html#L139'>session</a>           139 tests/tls-etm.c 	} else if (etm == 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) != 0)) {</span>
<span class='curline'><a href='../S/4444.html#L146'>session</a>           146 tests/tls-etm.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4444.html#L163'>session</a>           163 tests/tls-etm.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4444.html#L169'>session</a>           169 tests/tls-etm.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4444.html#L191'>session</a>           191 tests/tls-etm.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4444.html#L213'>session</a>           213 tests/tls-etm.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4444.html#L218'>session</a>           218 tests/tls-etm.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4444.html#L220'>session</a>           220 tests/tls-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4444.html#L221'>session</a>           221 tests/tls-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4444.html#L223'>session</a>           223 tests/tls-etm.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4444.html#L226'>session</a>           226 tests/tls-etm.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4444.html#L230'>session</a>           230 tests/tls-etm.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4444.html#L236'>session</a>           236 tests/tls-etm.c 	if (etm != 0 &amp;&amp; gnutls_session_etm_status(session) == 0) {</span>
<span class='curline'><a href='../S/4444.html#L239'>session</a>           239 tests/tls-etm.c 	} else if (etm == 0 &amp;&amp; gnutls_session_etm_status(session) != 0) {</span>
<span class='curline'><a href='../S/4444.html#L244'>session</a>           244 tests/tls-etm.c 	if (etm != 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) == 0)) {</span>
<span class='curline'><a href='../S/4444.html#L247'>session</a>           247 tests/tls-etm.c 	} else if (etm == 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) != 0)) {</span>
<span class='curline'><a href='../S/4444.html#L258'>session</a>           258 tests/tls-etm.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4444.html#L263'>session</a>           263 tests/tls-etm.c 			    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4444.html#L280'>session</a>           280 tests/tls-etm.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4444.html#L283'>session</a>           283 tests/tls-etm.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5088.html#L75'>session</a>            75 tests/tls-ext-not-in-dtls.c static int ext_send(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/5088.html#L81'>session</a>            81 tests/tls-ext-not-in-dtls.c static int ext_recv(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5088.html#L93'>session</a>            93 tests/tls-ext-not-in-dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5088.html#L101'>session</a>           101 tests/tls-ext-not-in-dtls.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_DATAGRAM) &gt;= 0);</span>
<span class='curline'><a href='../S/5088.html#L104'>session</a>           104 tests/tls-ext-not-in-dtls.c 		assert(gnutls_session_ext_register(session, "implicit-dtls", TLS_EXT_IMPL_DTLS, GNUTLS_EXT_TLS, ext_recv, ext_send, NULL, NULL, NULL, GNUTLS_EXT_FLAG_CLIENT_HELLO|GNUTLS_EXT_FLAG_TLS12_SERVER_HELLO|GNUTLS_EXT_FLAG_TLS13_SERVER_HELLO)&gt;=0);</span>
<span class='curline'><a href='../S/5088.html#L105'>session</a>           105 tests/tls-ext-not-in-dtls.c 		assert(gnutls_session_ext_register(session, "explicit-tls", TLS_EXT_EXPL_TLS, GNUTLS_EXT_TLS, ext_recv, ext_send, NULL, NULL, NULL, GNUTLS_EXT_FLAG_CLIENT_HELLO|GNUTLS_EXT_FLAG_TLS12_SERVER_HELLO|GNUTLS_EXT_FLAG_TLS13_SERVER_HELLO|GNUTLS_EXT_FLAG_TLS)&gt;=0);</span>
<span class='curline'><a href='../S/5088.html#L108'>session</a>           108 tests/tls-ext-not-in-dtls.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5088.html#L110'>session</a>           110 tests/tls-ext-not-in-dtls.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5088.html#L112'>session</a>           112 tests/tls-ext-not-in-dtls.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5088.html#L114'>session</a>           114 tests/tls-ext-not-in-dtls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5088.html#L117'>session</a>           117 tests/tls-ext-not-in-dtls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5088.html#L126'>session</a>           126 tests/tls-ext-not-in-dtls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5088.html#L168'>session</a>           168 tests/tls-ext-not-in-dtls.c static int hellos_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5088.html#L176'>session</a>           176 tests/tls-ext-not-in-dtls.c 	type = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5088.html#L198'>session</a>           198 tests/tls-ext-not-in-dtls.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5088.html#L210'>session</a>           210 tests/tls-ext-not-in-dtls.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_POST_HANDSHAKE_AUTH|GNUTLS_DATAGRAM) &gt;= 0);</span>
<span class='curline'><a href='../S/5088.html#L212'>session</a>           212 tests/tls-ext-not-in-dtls.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5088.html#L213'>session</a>           213 tests/tls-ext-not-in-dtls.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5088.html#L217'>session</a>           217 tests/tls-ext-not-in-dtls.c 	gnutls_session_set_ptr(session, &amp;type);</span>
<span class='curline'><a href='../S/5088.html#L218'>session</a>           218 tests/tls-ext-not-in-dtls.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.3:+VERS-TLS1.2", NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5088.html#L220'>session</a>           220 tests/tls-ext-not-in-dtls.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5088.html#L222'>session</a>           222 tests/tls-ext-not-in-dtls.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5088.html#L225'>session</a>           225 tests/tls-ext-not-in-dtls.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5088.html#L232'>session</a>           232 tests/tls-ext-not-in-dtls.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5087.html#L78'>session</a>            78 tests/tls-ext-register.c static int ext_recv_client_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5087.html#L88'>session</a>            88 tests/tls-ext-register.c 	gnutls_ext_set_data(session, TLSEXT_TYPE_SAMPLE, session);</span>
<span class='curline'><a href='../S/5087.html#L93'>session</a>            93 tests/tls-ext-register.c static int ext_send_client_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/5087.html#L100'>session</a>           100 tests/tls-ext-register.c static int ext_recv_server_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5087.html#L113'>session</a>           113 tests/tls-ext-register.c static int ext_send_server_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/5087.html#L123'>session</a>           123 tests/tls-ext-register.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5087.html#L141'>session</a>           141 tests/tls-ext-register.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5087.html#L143'>session</a>           143 tests/tls-ext-register.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5087.html#L147'>session</a>           147 tests/tls-ext-register.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5087.html#L150'>session</a>           150 tests/tls-ext-register.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5087.html#L151'>session</a>           151 tests/tls-ext-register.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5087.html#L155'>session</a>           155 tests/tls-ext-register.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5087.html#L169'>session</a>           169 tests/tls-ext-register.c 	ret = gnutls_ext_get_data(session, TLSEXT_TYPE_SAMPLE, &amp;p);</span>
<span class='curline'><a href='../S/5087.html#L174'>session</a>           174 tests/tls-ext-register.c 	if (p != session) {</span>
<span class='curline'><a href='../S/5087.html#L178'>session</a>           178 tests/tls-ext-register.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5087.html#L183'>session</a>           183 tests/tls-ext-register.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5087.html#L237'>session</a>           237 tests/tls-ext-register.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5087.html#L252'>session</a>           252 tests/tls-ext-register.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5087.html#L254'>session</a>           254 tests/tls-ext-register.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5087.html#L256'>session</a>           256 tests/tls-ext-register.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5087.html#L261'>session</a>           261 tests/tls-ext-register.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5087.html#L262'>session</a>           262 tests/tls-ext-register.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5087.html#L264'>session</a>           264 tests/tls-ext-register.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5087.html#L267'>session</a>           267 tests/tls-ext-register.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5087.html#L280'>session</a>           280 tests/tls-ext-register.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5087.html#L283'>session</a>           283 tests/tls-ext-register.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4962.html#L74'>session</a>            74 tests/tls-force-etm.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4962.html#L87'>session</a>            87 tests/tls-force-etm.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4962.html#L88'>session</a>            88 tests/tls-force-etm.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4962.html#L91'>session</a>            91 tests/tls-force-etm.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4962.html#L95'>session</a>            95 tests/tls-force-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4962.html#L96'>session</a>            96 tests/tls-force-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4962.html#L98'>session</a>            98 tests/tls-force-etm.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4962.html#L103'>session</a>           103 tests/tls-force-etm.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4962.html#L124'>session</a>           124 tests/tls-force-etm.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4962.html#L126'>session</a>           126 tests/tls-force-etm.c 	if (etm != 0 &amp;&amp; gnutls_session_etm_status(session) == 0) {</span>
<span class='curline'><a href='../S/4962.html#L129'>session</a>           129 tests/tls-force-etm.c 	} else if (etm == 0 &amp;&amp; gnutls_session_etm_status(session) != 0) {</span>
<span class='curline'><a href='../S/4962.html#L134'>session</a>           134 tests/tls-force-etm.c 	if (etm != 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) == 0)) {</span>
<span class='curline'><a href='../S/4962.html#L137'>session</a>           137 tests/tls-force-etm.c 	} else if (etm == 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) != 0)) {</span>
<span class='curline'><a href='../S/4962.html#L144'>session</a>           144 tests/tls-force-etm.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4962.html#L161'>session</a>           161 tests/tls-force-etm.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4962.html#L167'>session</a>           167 tests/tls-force-etm.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4962.html#L180'>session</a>           180 tests/tls-force-etm.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4962.html#L202'>session</a>           202 tests/tls-force-etm.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/4962.html#L203'>session</a>           203 tests/tls-force-etm.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4962.html#L208'>session</a>           208 tests/tls-force-etm.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4962.html#L210'>session</a>           210 tests/tls-force-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4962.html#L211'>session</a>           211 tests/tls-force-etm.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4962.html#L213'>session</a>           213 tests/tls-force-etm.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4962.html#L216'>session</a>           216 tests/tls-force-etm.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4962.html#L228'>session</a>           228 tests/tls-force-etm.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4962.html#L233'>session</a>           233 tests/tls-force-etm.c 	if (etm != 0 &amp;&amp; gnutls_session_etm_status(session) == 0) {</span>
<span class='curline'><a href='../S/4962.html#L236'>session</a>           236 tests/tls-force-etm.c 	} else if (etm == 0 &amp;&amp; gnutls_session_etm_status(session) != 0) {</span>
<span class='curline'><a href='../S/4962.html#L241'>session</a>           241 tests/tls-force-etm.c 	if (etm != 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) == 0)) {</span>
<span class='curline'><a href='../S/4962.html#L244'>session</a>           244 tests/tls-force-etm.c 	} else if (etm == 0 &amp;&amp; ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_ETM) != 0)) {</span>
<span class='curline'><a href='../S/4962.html#L255'>session</a>           255 tests/tls-force-etm.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4962.html#L260'>session</a>           260 tests/tls-force-etm.c 			    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4962.html#L276'>session</a>           276 tests/tls-force-etm.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4962.html#L279'>session</a>           279 tests/tls-force-etm.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5051.html#L79'>session</a>            79 tests/tls-pthread.c 	gnutls_session_t session = arg;</span>
<span class='curline'><a href='../S/5051.html#L87'>session</a>            87 tests/tls-pthread.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5051.html#L92'>session</a>            92 tests/tls-pthread.c 			ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5051.html#L106'>session</a>           106 tests/tls-pthread.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5051.html#L116'>session</a>           116 tests/tls-pthread.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5051.html#L130'>session</a>           130 tests/tls-pthread.c void do_thread_stuff(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5051.html#L139'>session</a>           139 tests/tls-pthread.c 	ret = pthread_create(&amp;id, NULL, recv_thread, session);</span>
<span class='curline'><a href='../S/5051.html#L146'>session</a>           146 tests/tls-pthread.c 			ret = gnutls_record_send(session, MSG, sizeof(MSG)-1);</span>
<span class='curline'><a href='../S/5051.html#L154'>session</a>           154 tests/tls-pthread.c 		ret = gnutls_record_send(session, MSG2, sizeof(MSG2)-1);</span>
<span class='curline'><a href='../S/5051.html#L164'>session</a>           164 tests/tls-pthread.c 		ret = gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5051.html#L174'>session</a>           174 tests/tls-pthread.c static void do_reflect_stuff(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5051.html#L182'>session</a>           182 tests/tls-pthread.c 			ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5051.html#L198'>session</a>           198 tests/tls-pthread.c 			ret = gnutls_record_send(session, buf, buf_size);</span>
<span class='curline'><a href='../S/5051.html#L208'>session</a>           208 tests/tls-pthread.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5051.html#L216'>session</a>           216 tests/tls-pthread.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5051.html#L232'>session</a>           232 tests/tls-pthread.c 	assert(gnutls_init(&amp;session, init_flags) &gt;= 0);</span>
<span class='curline'><a href='../S/5051.html#L233'>session</a>           233 tests/tls-pthread.c 	gnutls_handshake_set_timeout(session, 60 * 1000);</span>
<span class='curline'><a href='../S/5051.html#L235'>session</a>           235 tests/tls-pthread.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5051.html#L237'>session</a>           237 tests/tls-pthread.c 	assert(gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred)&gt;=0);</span>
<span class='curline'><a href='../S/5051.html#L239'>session</a>           239 tests/tls-pthread.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5051.html#L244'>session</a>           244 tests/tls-pthread.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5051.html#L256'>session</a>           256 tests/tls-pthread.c 		do_thread_stuff(session);</span>
<span class='curline'><a href='../S/5051.html#L258'>session</a>           258 tests/tls-pthread.c 		do_reflect_stuff(session);</span>
<span class='curline'><a href='../S/5051.html#L262'>session</a>           262 tests/tls-pthread.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5051.html#L273'>session</a>           273 tests/tls-pthread.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5051.html#L296'>session</a>           296 tests/tls-pthread.c 	assert(gnutls_init(&amp;session, init_flags)&gt;=0);</span>
<span class='curline'><a href='../S/5051.html#L297'>session</a>           297 tests/tls-pthread.c 	gnutls_handshake_set_timeout(session, 60 * 1000);</span>
<span class='curline'><a href='../S/5051.html#L299'>session</a>           299 tests/tls-pthread.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5051.html#L301'>session</a>           301 tests/tls-pthread.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5051.html#L303'>session</a>           303 tests/tls-pthread.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5051.html#L306'>session</a>           306 tests/tls-pthread.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5051.html#L310'>session</a>           310 tests/tls-pthread.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5051.html#L320'>session</a>           320 tests/tls-pthread.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5051.html#L323'>session</a>           323 tests/tls-pthread.c 		do_reflect_stuff(session);</span>
<span class='curline'><a href='../S/5051.html#L325'>session</a>           325 tests/tls-pthread.c 		do_thread_stuff(session);</span>
<span class='curline'><a href='../S/5051.html#L329'>session</a>           329 tests/tls-pthread.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4521.html#L74'>session</a>            74 tests/tls-record-size-limit.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4521.html#L93'>session</a>            93 tests/tls-record-size-limit.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4521.html#L218'>session</a>           218 tests/tls-record-size-limit.c 	server_handshake_cb_data.session = server;</span>
<span class='curline'><a href='../S/4521.html#L261'>session</a>           261 tests/tls-record-size-limit.c 	client_handshake_cb_data.session = client;</span>
<span class='curline'><a href='../S/4553.html#L75'>session</a>            75 tests/tls-session-ext-override.c static int ext_recv_client_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/4553.html#L85'>session</a>            85 tests/tls-session-ext-override.c 	gnutls_ext_set_data(session, overridden_extension, session);</span>
<span class='curline'><a href='../S/4553.html#L90'>session</a>            90 tests/tls-session-ext-override.c static int ext_send_client_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/4553.html#L97'>session</a>            97 tests/tls-session-ext-override.c static int ext_recv_server_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/4553.html#L110'>session</a>           110 tests/tls-session-ext-override.c static int ext_send_server_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/4553.html#L120'>session</a>           120 tests/tls-session-ext-override.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4553.html#L135'>session</a>           135 tests/tls-session-ext-override.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4553.html#L138'>session</a>           138 tests/tls-session-ext-override.c 	gnutls_priority_set_direct(session, "PERFORMANCE:+ANON-ECDH:+ANON-DH",</span>
<span class='curline'><a href='../S/4553.html#L143'>session</a>           143 tests/tls-session-ext-override.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4553.html#L146'>session</a>           146 tests/tls-session-ext-override.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4553.html#L147'>session</a>           147 tests/tls-session-ext-override.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4553.html#L149'>session</a>           149 tests/tls-session-ext-override.c 	ret = gnutls_session_ext_register(session, "ext_client", overridden_extension, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4553.html#L153'>session</a>           153 tests/tls-session-ext-override.c 	ret = gnutls_session_ext_register(session, "ext_client", 0, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, GNUTLS_EXT_FLAG_OVERRIDE_INTERNAL);</span>
<span class='curline'><a href='../S/4553.html#L157'>session</a>           157 tests/tls-session-ext-override.c 	ret = gnutls_session_ext_register(session, "ext_client", overridden_extension, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, GNUTLS_EXT_FLAG_OVERRIDE_INTERNAL);</span>
<span class='curline'><a href='../S/4553.html#L163'>session</a>           163 tests/tls-session-ext-override.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4553.html#L177'>session</a>           177 tests/tls-session-ext-override.c 	ret = gnutls_ext_get_data(session, overridden_extension, &amp;p);</span>
<span class='curline'><a href='../S/4553.html#L182'>session</a>           182 tests/tls-session-ext-override.c 	if (p != session) {</span>
<span class='curline'><a href='../S/4553.html#L186'>session</a>           186 tests/tls-session-ext-override.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4553.html#L191'>session</a>           191 tests/tls-session-ext-override.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4553.html#L202'>session</a>           202 tests/tls-session-ext-override.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4553.html#L218'>session</a>           218 tests/tls-session-ext-override.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4553.html#L223'>session</a>           223 tests/tls-session-ext-override.c 	gnutls_priority_set_direct(session, "PERFORMANCE:+ANON-ECDH:+ANON-DH",</span>
<span class='curline'><a href='../S/4553.html#L226'>session</a>           226 tests/tls-session-ext-override.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4553.html#L229'>session</a>           229 tests/tls-session-ext-override.c 	ret = gnutls_session_ext_register(session, "ext_server", overridden_extension, GNUTLS_EXT_TLS, ext_recv_server_params, ext_send_server_params, NULL, NULL, NULL, 0);</span>
<span class='curline'><a href='../S/4553.html#L233'>session</a>           233 tests/tls-session-ext-override.c 	ret = gnutls_session_ext_register(session, "ext_server", overridden_extension, GNUTLS_EXT_TLS, ext_recv_server_params, ext_send_server_params, NULL, NULL, NULL, GNUTLS_EXT_FLAG_OVERRIDE_INTERNAL);</span>
<span class='curline'><a href='../S/4553.html#L237'>session</a>           237 tests/tls-session-ext-override.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4553.html#L238'>session</a>           238 tests/tls-session-ext-override.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4553.html#L240'>session</a>           240 tests/tls-session-ext-override.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4553.html#L243'>session</a>           243 tests/tls-session-ext-override.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4553.html#L256'>session</a>           256 tests/tls-session-ext-override.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4553.html#L259'>session</a>           259 tests/tls-session-ext-override.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5134.html#L90'>session</a>            90 tests/tls-session-ext-register.c static int ext_recv_client_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5134.html#L93'>session</a>            93 tests/tls-session-ext-register.c 	name = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5134.html#L103'>session</a>           103 tests/tls-session-ext-register.c 	gnutls_ext_set_data(session, TLSEXT_TYPE_SAMPLE, session);</span>
<span class='curline'><a href='../S/5134.html#L108'>session</a>           108 tests/tls-session-ext-register.c static int ext_send_client_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/5134.html#L115'>session</a>           115 tests/tls-session-ext-register.c static int ext_recv_client_ign_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5134.html#L120'>session</a>           120 tests/tls-session-ext-register.c static int ext_send_client_ign_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/5134.html#L126'>session</a>           126 tests/tls-session-ext-register.c static int ext_recv_server_params(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5134.html#L130'>session</a>           130 tests/tls-session-ext-register.c 	name = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5134.html#L143'>session</a>           143 tests/tls-session-ext-register.c static int ext_send_server_params(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/5134.html#L153'>session</a>           153 tests/tls-session-ext-register.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5134.html#L164'>session</a>           164 tests/tls-session-ext-register.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT) &gt;= 0);</span>
<span class='curline'><a href='../S/5134.html#L165'>session</a>           165 tests/tls-session-ext-register.c 	gnutls_session_set_ptr(session, (void*)name);</span>
<span class='curline'><a href='../S/5134.html#L168'>session</a>           168 tests/tls-session-ext-register.c 	assert(gnutls_priority_set_direct(session, prio,</span>
<span class='curline'><a href='../S/5134.html#L173'>session</a>           173 tests/tls-session-ext-register.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5134.html#L176'>session</a>           176 tests/tls-session-ext-register.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5134.html#L177'>session</a>           177 tests/tls-session-ext-register.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5134.html#L179'>session</a>           179 tests/tls-session-ext-register.c 	ret = gnutls_session_ext_register(session, "ext_ign", TLSEXT_TYPE_IGN, GNUTLS_EXT_TLS, ext_recv_client_ign_params, ext_send_client_ign_params, NULL, NULL, NULL, flags);</span>
<span class='curline'><a href='../S/5134.html#L183'>session</a>           183 tests/tls-session-ext-register.c 	ext_name = gnutls_ext_get_name2(session, TLSEXT_TYPE_IGN, GNUTLS_EXT_ANY);</span>
<span class='curline'><a href='../S/5134.html#L187'>session</a>           187 tests/tls-session-ext-register.c 	ext_name = gnutls_ext_get_name2(session, TLSEXT_TYPE_IGN, GNUTLS_EXT_APPLICATION);</span>
<span class='curline'><a href='../S/5134.html#L191'>session</a>           191 tests/tls-session-ext-register.c 	ret = gnutls_session_ext_register(session, "ext_client", TLSEXT_TYPE_SAMPLE, GNUTLS_EXT_TLS, ext_recv_client_params, ext_send_client_params, NULL, NULL, NULL, flags);</span>
<span class='curline'><a href='../S/5134.html#L197'>session</a>           197 tests/tls-session-ext-register.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5134.html#L220'>session</a>           220 tests/tls-session-ext-register.c 	ret = gnutls_ext_get_data(session, TLSEXT_TYPE_SAMPLE, &amp;p);</span>
<span class='curline'><a href='../S/5134.html#L225'>session</a>           225 tests/tls-session-ext-register.c 	if (p != session) {</span>
<span class='curline'><a href='../S/5134.html#L233'>session</a>           233 tests/tls-session-ext-register.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5134.html#L241'>session</a>           241 tests/tls-session-ext-register.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5134.html#L250'>session</a>           250 tests/tls-session-ext-register.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5134.html#L259'>session</a>           259 tests/tls-session-ext-register.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER) &gt;= 0);</span>
<span class='curline'><a href='../S/5134.html#L260'>session</a>           260 tests/tls-session-ext-register.c 	gnutls_session_set_ptr(session, (void*)name);</span>
<span class='curline'><a href='../S/5134.html#L265'>session</a>           265 tests/tls-session-ext-register.c 	assert(gnutls_priority_set_direct(session, prio,</span>
<span class='curline'><a href='../S/5134.html#L268'>session</a>           268 tests/tls-session-ext-register.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5134.html#L271'>session</a>           271 tests/tls-session-ext-register.c 	assert(gnutls_session_ext_register(session, "ext_server", TLSEXT_TYPE_SAMPLE, GNUTLS_EXT_TLS, ext_recv_server_params, ext_send_server_params, NULL, NULL, NULL, flags) &gt;= 0);</span>
<span class='curline'><a href='../S/5134.html#L273'>session</a>           273 tests/tls-session-ext-register.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5134.html#L274'>session</a>           274 tests/tls-session-ext-register.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5134.html#L276'>session</a>           276 tests/tls-session-ext-register.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5134.html#L284'>session</a>           284 tests/tls-session-ext-register.c 			gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5134.html#L303'>session</a>           303 tests/tls-session-ext-register.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5134.html#L310'>session</a>           310 tests/tls-session-ext-register.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5236.html#L75'>session</a>            75 tests/tls-session-supplemental.c int supp_client_recv_func(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5236.html#L89'>session</a>            89 tests/tls-session-supplemental.c int supp_client_send_func(gnutls_session_t session, gnutls_buffer_t buf)</span>
<span class='curline'><a href='../S/5236.html#L97'>session</a>            97 tests/tls-session-supplemental.c int supp_server_recv_func(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5236.html#L111'>session</a>           111 tests/tls-session-supplemental.c int supp_server_send_func(gnutls_session_t session, gnutls_buffer_t buf)</span>
<span class='curline'><a href='../S/5236.html#L121'>session</a>           121 tests/tls-session-supplemental.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5236.html#L135'>session</a>           135 tests/tls-session-supplemental.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5236.html#L136'>session</a>           136 tests/tls-session-supplemental.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5236.html#L138'>session</a>           138 tests/tls-session-supplemental.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5236.html#L142'>session</a>           142 tests/tls-session-supplemental.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5236.html#L145'>session</a>           145 tests/tls-session-supplemental.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5236.html#L148'>session</a>           148 tests/tls-session-supplemental.c 		gnutls_supplemental_recv(session, 1);</span>
<span class='curline'><a href='../S/5236.html#L149'>session</a>           149 tests/tls-session-supplemental.c 		gnutls_supplemental_send(session, 1);</span>
<span class='curline'><a href='../S/5236.html#L151'>session</a>           151 tests/tls-session-supplemental.c 		gnutls_session_supplemental_register(session, "supplemental_client", TLS_SUPPLEMENTALDATATYPE_SAMPLE, supp_client_recv_func, supp_client_send_func, 0);</span>
<span class='curline'><a href='../S/5236.html#L156'>session</a>           156 tests/tls-session-supplemental.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5236.html#L173'>session</a>           173 tests/tls-session-supplemental.c 		assert(gnutls_protocol_get_version(session) == GNUTLS_TLS1_2);</span>
<span class='curline'><a href='../S/5236.html#L176'>session</a>           176 tests/tls-session-supplemental.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5236.html#L181'>session</a>           181 tests/tls-session-supplemental.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5236.html#L191'>session</a>           191 tests/tls-session-supplemental.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5236.html#L208'>session</a>           208 tests/tls-session-supplemental.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5236.html#L209'>session</a>           209 tests/tls-session-supplemental.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5236.html#L211'>session</a>           211 tests/tls-session-supplemental.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5236.html#L213'>session</a>           213 tests/tls-session-supplemental.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5236.html#L217'>session</a>           217 tests/tls-session-supplemental.c 		gnutls_supplemental_recv(session, 1);</span>
<span class='curline'><a href='../S/5236.html#L218'>session</a>           218 tests/tls-session-supplemental.c 		gnutls_supplemental_send(session, 1);</span>
<span class='curline'><a href='../S/5236.html#L221'>session</a>           221 tests/tls-session-supplemental.c 	gnutls_session_supplemental_register(session, "supplemental_server", TLS_SUPPLEMENTALDATATYPE_SAMPLE, supp_server_recv_func, supp_server_send_func, 0);</span>
<span class='curline'><a href='../S/5236.html#L223'>session</a>           223 tests/tls-session-supplemental.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5236.html#L224'>session</a>           224 tests/tls-session-supplemental.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5236.html#L227'>session</a>           227 tests/tls-session-supplemental.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5236.html#L242'>session</a>           242 tests/tls-session-supplemental.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5236.html#L245'>session</a>           245 tests/tls-session-supplemental.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4555.html#L80'>session</a>            80 tests/tls-supplemental.c int supp_client_recv_func(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/4555.html#L94'>session</a>            94 tests/tls-supplemental.c int supp_client_send_func(gnutls_session_t session, gnutls_buffer_t buf)</span>
<span class='curline'><a href='../S/4555.html#L102'>session</a>           102 tests/tls-supplemental.c int supp_server_recv_func(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/4555.html#L116'>session</a>           116 tests/tls-supplemental.c int supp_server_send_func(gnutls_session_t session, gnutls_buffer_t buf)</span>
<span class='curline'><a href='../S/4555.html#L126'>session</a>           126 tests/tls-supplemental.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4555.html#L137'>session</a>           137 tests/tls-supplemental.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4555.html#L140'>session</a>           140 tests/tls-supplemental.c 	gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4555.html#L142'>session</a>           142 tests/tls-supplemental.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4555.html#L145'>session</a>           145 tests/tls-supplemental.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4555.html#L148'>session</a>           148 tests/tls-supplemental.c 		gnutls_supplemental_recv(session, 1);</span>
<span class='curline'><a href='../S/4555.html#L149'>session</a>           149 tests/tls-supplemental.c 		gnutls_supplemental_send(session, 1);</span>
<span class='curline'><a href='../S/4555.html#L154'>session</a>           154 tests/tls-supplemental.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4555.html#L172'>session</a>           172 tests/tls-supplemental.c 		assert(gnutls_protocol_get_version(session) == GNUTLS_TLS1_2);</span>
<span class='curline'><a href='../S/4555.html#L175'>session</a>           175 tests/tls-supplemental.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4555.html#L180'>session</a>           180 tests/tls-supplemental.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4555.html#L189'>session</a>           189 tests/tls-supplemental.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4555.html#L204'>session</a>           204 tests/tls-supplemental.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4555.html#L206'>session</a>           206 tests/tls-supplemental.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4555.html#L208'>session</a>           208 tests/tls-supplemental.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4555.html#L212'>session</a>           212 tests/tls-supplemental.c 		gnutls_supplemental_recv(session, 1);</span>
<span class='curline'><a href='../S/4555.html#L213'>session</a>           213 tests/tls-supplemental.c 		gnutls_supplemental_send(session, 1);</span>
<span class='curline'><a href='../S/4555.html#L216'>session</a>           216 tests/tls-supplemental.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4555.html#L217'>session</a>           217 tests/tls-supplemental.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4555.html#L220'>session</a>           220 tests/tls-supplemental.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4555.html#L235'>session</a>           235 tests/tls-supplemental.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4555.html#L238'>session</a>           238 tests/tls-supplemental.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4554.html#L73'>session</a>            73 tests/tls-with-seccomp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4554.html#L86'>session</a>            86 tests/tls-with-seccomp.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4554.html#L87'>session</a>            87 tests/tls-with-seccomp.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4554.html#L89'>session</a>            89 tests/tls-with-seccomp.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4554.html#L91'>session</a>            91 tests/tls-with-seccomp.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4554.html#L93'>session</a>            93 tests/tls-with-seccomp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4554.html#L98'>session</a>            98 tests/tls-with-seccomp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4554.html#L114'>session</a>           114 tests/tls-with-seccomp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4554.html#L117'>session</a>           117 tests/tls-with-seccomp.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4554.html#L130'>session</a>           130 tests/tls-with-seccomp.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4554.html#L139'>session</a>           139 tests/tls-with-seccomp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4554.html#L164'>session</a>           164 tests/tls-with-seccomp.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4554.html#L189'>session</a>           189 tests/tls-with-seccomp.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4554.html#L190'>session</a>           190 tests/tls-with-seccomp.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4554.html#L192'>session</a>           192 tests/tls-with-seccomp.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4554.html#L194'>session</a>           194 tests/tls-with-seccomp.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4554.html#L196'>session</a>           196 tests/tls-with-seccomp.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4554.html#L199'>session</a>           199 tests/tls-with-seccomp.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4554.html#L204'>session</a>           204 tests/tls-with-seccomp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4554.html#L215'>session</a>           215 tests/tls-with-seccomp.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4554.html#L222'>session</a>           222 tests/tls-with-seccomp.c 		ret = gnutls_record_send(session, buffer, sizeof(buffer)-1);</span>
<span class='curline'><a href='../S/4554.html#L227'>session</a>           227 tests/tls-with-seccomp.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4554.html#L233'>session</a>           233 tests/tls-with-seccomp.c 	ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4554.html#L239'>session</a>           239 tests/tls-with-seccomp.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4357.html#L58'>session</a>            58 tests/tls12-ffdhe.c serv_psk_func(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/4447.html#L78'>session</a>            78 tests/tls12-rehandshake-cert-2.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4447.html#L94'>session</a>            94 tests/tls12-rehandshake-cert-2.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4447.html#L95'>session</a>            95 tests/tls12-rehandshake-cert-2.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4447.html#L98'>session</a>            98 tests/tls12-rehandshake-cert-2.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.1:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4447.html#L102'>session</a>           102 tests/tls12-rehandshake-cert-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4447.html#L103'>session</a>           103 tests/tls12-rehandshake-cert-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4447.html#L105'>session</a>           105 tests/tls12-rehandshake-cert-2.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4447.html#L110'>session</a>           110 tests/tls12-rehandshake-cert-2.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4447.html#L126'>session</a>           126 tests/tls12-rehandshake-cert-2.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4447.html#L132'>session</a>           132 tests/tls12-rehandshake-cert-2.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4447.html#L142'>session</a>           142 tests/tls12-rehandshake-cert-2.c 				    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/4447.html#L152'>session</a>           152 tests/tls12-rehandshake-cert-2.c 				    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/4447.html#L166'>session</a>           166 tests/tls12-rehandshake-cert-2.c 			    gnutls_record_send(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4447.html#L177'>session</a>           177 tests/tls12-rehandshake-cert-2.c 			    gnutls_record_send(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4447.html#L188'>session</a>           188 tests/tls12-rehandshake-cert-2.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4447.html#L192'>session</a>           192 tests/tls12-rehandshake-cert-2.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4447.html#L213'>session</a>           213 tests/tls12-rehandshake-cert-2.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4447.html#L233'>session</a>           233 tests/tls12-rehandshake-cert-2.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4447.html#L234'>session</a>           234 tests/tls12-rehandshake-cert-2.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4447.html#L239'>session</a>           239 tests/tls12-rehandshake-cert-2.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.1:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4447.html#L241'>session</a>           241 tests/tls12-rehandshake-cert-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4447.html#L242'>session</a>           242 tests/tls12-rehandshake-cert-2.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4447.html#L244'>session</a>           244 tests/tls12-rehandshake-cert-2.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4447.html#L247'>session</a>           247 tests/tls12-rehandshake-cert-2.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4447.html#L252'>session</a>           252 tests/tls12-rehandshake-cert-2.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4447.html#L263'>session</a>           263 tests/tls12-rehandshake-cert-2.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4447.html#L273'>session</a>           273 tests/tls12-rehandshake-cert-2.c 				    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/4447.html#L286'>session</a>           286 tests/tls12-rehandshake-cert-2.c 			    gnutls_record_send(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4447.html#L299'>session</a>           299 tests/tls12-rehandshake-cert-2.c 		ret = gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/4447.html#L309'>session</a>           309 tests/tls12-rehandshake-cert-2.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4447.html#L323'>session</a>           323 tests/tls12-rehandshake-cert-2.c 				    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/4447.html#L343'>session</a>           343 tests/tls12-rehandshake-cert-2.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4447.html#L346'>session</a>           346 tests/tls12-rehandshake-cert-2.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4370.html#L79'>session</a>            79 tests/tls12-rehandshake-cert-3.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4370.html#L96'>session</a>            96 tests/tls12-rehandshake-cert-3.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4370.html#L97'>session</a>            97 tests/tls12-rehandshake-cert-3.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4370.html#L100'>session</a>           100 tests/tls12-rehandshake-cert-3.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.2:+VERS-TLS1.1", NULL);</span>
<span class='curline'><a href='../S/4370.html#L102'>session</a>           102 tests/tls12-rehandshake-cert-3.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4370.html#L104'>session</a>           104 tests/tls12-rehandshake-cert-3.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4370.html#L109'>session</a>           109 tests/tls12-rehandshake-cert-3.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4370.html#L125'>session</a>           125 tests/tls12-rehandshake-cert-3.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4370.html#L129'>session</a>           129 tests/tls12-rehandshake-cert-3.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4370.html#L142'>session</a>           142 tests/tls12-rehandshake-cert-3.c 			    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/4370.html#L154'>session</a>           154 tests/tls12-rehandshake-cert-3.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4370.html#L158'>session</a>           158 tests/tls12-rehandshake-cert-3.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4370.html#L178'>session</a>           178 tests/tls12-rehandshake-cert-3.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4370.html#L196'>session</a>           196 tests/tls12-rehandshake-cert-3.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4370.html#L197'>session</a>           197 tests/tls12-rehandshake-cert-3.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4370.html#L202'>session</a>           202 tests/tls12-rehandshake-cert-3.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.2:+VERS-TLS1.1", NULL);</span>
<span class='curline'><a href='../S/4370.html#L204'>session</a>           204 tests/tls12-rehandshake-cert-3.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4370.html#L205'>session</a>           205 tests/tls12-rehandshake-cert-3.c 	gnutls_certificate_server_set_request(session, GNUTLS_CERT_REQUIRE);</span>
<span class='curline'><a href='../S/4370.html#L207'>session</a>           207 tests/tls12-rehandshake-cert-3.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4370.html#L210'>session</a>           210 tests/tls12-rehandshake-cert-3.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4370.html#L215'>session</a>           215 tests/tls12-rehandshake-cert-3.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4370.html#L226'>session</a>           226 tests/tls12-rehandshake-cert-3.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4370.html#L228'>session</a>           228 tests/tls12-rehandshake-cert-3.c 	gnutls_certificate_server_set_request(session, GNUTLS_CERT_IGNORE);</span>
<span class='curline'><a href='../S/4370.html#L236'>session</a>           236 tests/tls12-rehandshake-cert-3.c 				    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/4370.html#L253'>session</a>           253 tests/tls12-rehandshake-cert-3.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4370.html#L266'>session</a>           266 tests/tls12-rehandshake-cert-3.c 	ret = gnutls_record_send(session, "hello", 4);</span>
<span class='curline'><a href='../S/4370.html#L275'>session</a>           275 tests/tls12-rehandshake-cert-3.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4370.html#L278'>session</a>           278 tests/tls12-rehandshake-cert-3.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4365.html#L77'>session</a>            77 tests/tls12-rehandshake-cert-auto.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4365.html#L93'>session</a>            93 tests/tls12-rehandshake-cert-auto.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_AUTO_REAUTH);</span>
<span class='curline'><a href='../S/4365.html#L94'>session</a>            94 tests/tls12-rehandshake-cert-auto.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4365.html#L97'>session</a>            97 tests/tls12-rehandshake-cert-auto.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.1:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4365.html#L101'>session</a>           101 tests/tls12-rehandshake-cert-auto.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4365.html#L102'>session</a>           102 tests/tls12-rehandshake-cert-auto.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4365.html#L104'>session</a>           104 tests/tls12-rehandshake-cert-auto.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4365.html#L109'>session</a>           109 tests/tls12-rehandshake-cert-auto.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4365.html#L125'>session</a>           125 tests/tls12-rehandshake-cert-auto.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4365.html#L129'>session</a>           129 tests/tls12-rehandshake-cert-auto.c 		    gnutls_record_recv(session, buffer,</span>
<span class='curline'><a href='../S/4365.html#L136'>session</a>           136 tests/tls12-rehandshake-cert-auto.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4365.html#L139'>session</a>           139 tests/tls12-rehandshake-cert-auto.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4365.html#L154'>session</a>           154 tests/tls12-rehandshake-cert-auto.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4365.html#L174'>session</a>           174 tests/tls12-rehandshake-cert-auto.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4365.html#L175'>session</a>           175 tests/tls12-rehandshake-cert-auto.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4365.html#L180'>session</a>           180 tests/tls12-rehandshake-cert-auto.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.1:+VERS-TLS1.2", NULL);</span>
<span class='curline'><a href='../S/4365.html#L182'>session</a>           182 tests/tls12-rehandshake-cert-auto.c 	gnutls_credentials_set(session, GNUTLS_CRD_ANON, anoncred);</span>
<span class='curline'><a href='../S/4365.html#L183'>session</a>           183 tests/tls12-rehandshake-cert-auto.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4365.html#L185'>session</a>           185 tests/tls12-rehandshake-cert-auto.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4365.html#L188'>session</a>           188 tests/tls12-rehandshake-cert-auto.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4365.html#L193'>session</a>           193 tests/tls12-rehandshake-cert-auto.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4365.html#L203'>session</a>           203 tests/tls12-rehandshake-cert-auto.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4365.html#L209'>session</a>           209 tests/tls12-rehandshake-cert-auto.c 		ret = gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/4365.html#L219'>session</a>           219 tests/tls12-rehandshake-cert-auto.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4365.html#L228'>session</a>           228 tests/tls12-rehandshake-cert-auto.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4365.html#L232'>session</a>           232 tests/tls12-rehandshake-cert-auto.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5049.html#L97'>session</a>            97 tests/tls13-early-data-neg.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5049.html#L126'>session</a>           126 tests/tls13-early-data-neg.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5049.html#L145'>session</a>           145 tests/tls13-early-data-neg.c 		assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/5049.html#L146'>session</a>           146 tests/tls13-early-data-neg.c 		assert(gnutls_priority_set_direct(session, PRIORITY, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5049.html#L148'>session</a>           148 tests/tls13-early-data-neg.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5049.html#L150'>session</a>           150 tests/tls13-early-data-neg.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5049.html#L153'>session</a>           153 tests/tls13-early-data-neg.c 			assert(gnutls_session_set_data(session, session_data.data, session_data.size) &gt;= 0);</span>
<span class='curline'><a href='../S/5049.html#L154'>session</a>           154 tests/tls13-early-data-neg.c 			assert(gnutls_record_send_early_data(session, EARLY_MSG, sizeof(EARLY_MSG)) &gt;= 0);</span>
<span class='curline'><a href='../S/5049.html#L155'>session</a>           155 tests/tls13-early-data-neg.c 			assert(gnutls_handshake_set_random(session, &amp;hrnd) &gt;= 0);</span>
<span class='curline'><a href='../S/5049.html#L157'>session</a>           157 tests/tls13-early-data-neg.c 			gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/5049.html#L164'>session</a>           164 tests/tls13-early-data-neg.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5049.html#L166'>session</a>           166 tests/tls13-early-data-neg.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5049.html#L182'>session</a>           182 tests/tls13-early-data-neg.c 			    gnutls_session_get_data2(session,</span>
<span class='curline'><a href='../S/5049.html#L189'>session</a>           189 tests/tls13-early-data-neg.c 			if (!gnutls_session_is_resumed(session)) {</span>
<span class='curline'><a href='../S/5049.html#L194'>session</a>           194 tests/tls13-early-data-neg.c 		gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5049.html#L197'>session</a>           197 tests/tls13-early-data-neg.c 			ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/5049.html#L209'>session</a>           209 tests/tls13-early-data-neg.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5049.html#L213'>session</a>           213 tests/tls13-early-data-neg.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5049.html#L283'>session</a>           283 tests/tls13-early-data-neg.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5049.html#L319'>session</a>           319 tests/tls13-early-data-neg.c 		assert(gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_ENABLE_EARLY_DATA)&gt;=0);</span>
<span class='curline'><a href='../S/5049.html#L321'>session</a>           321 tests/tls13-early-data-neg.c 		assert(gnutls_priority_set_direct(session, PRIORITY, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5049.html#L323'>session</a>           323 tests/tls13-early-data-neg.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5049.html#L325'>session</a>           325 tests/tls13-early-data-neg.c 		gnutls_session_ticket_enable_server(session,</span>
<span class='curline'><a href='../S/5049.html#L328'>session</a>           328 tests/tls13-early-data-neg.c 		gnutls_anti_replay_enable(session, anti_replay);</span>
<span class='curline'><a href='../S/5049.html#L330'>session</a>           330 tests/tls13-early-data-neg.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5049.html#L333'>session</a>           333 tests/tls13-early-data-neg.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5049.html#L338'>session</a>           338 tests/tls13-early-data-neg.c 			if (ret &lt; 0 &amp;&amp; !(gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_EARLY_DATA)) {</span>
<span class='curline'><a href='../S/5049.html#L341'>session</a>           341 tests/tls13-early-data-neg.c 				gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5049.html#L350'>session</a>           350 tests/tls13-early-data-neg.c 			gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5049.html#L359'>session</a>           359 tests/tls13-early-data-neg.c 			if (!gnutls_session_is_resumed(session)) {</span>
<span class='curline'><a href='../S/5049.html#L367'>session</a>           367 tests/tls13-early-data-neg.c 					if (!(gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_EARLY_DATA)) {</span>
<span class='curline'><a href='../S/5049.html#L374'>session</a>           374 tests/tls13-early-data-neg.c 				ret = gnutls_record_recv_early_data(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/5049.html#L384'>session</a>           384 tests/tls13-early-data-neg.c 					if (gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_EARLY_DATA) {</span>
<span class='curline'><a href='../S/5049.html#L395'>session</a>           395 tests/tls13-early-data-neg.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5049.html#L409'>session</a>           409 tests/tls13-early-data-neg.c 				gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5049.html#L415'>session</a>           415 tests/tls13-early-data-neg.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5049.html#L419'>session</a>           419 tests/tls13-early-data-neg.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4331.html#L103'>session</a>           103 tests/tls13-early-data.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4331.html#L122'>session</a>           122 tests/tls13-early-data.c 		assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4331.html#L123'>session</a>           123 tests/tls13-early-data.c 		assert(gnutls_priority_set_direct(session, PRIORITY, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4331.html#L125'>session</a>           125 tests/tls13-early-data.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4331.html#L127'>session</a>           127 tests/tls13-early-data.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4331.html#L130'>session</a>           130 tests/tls13-early-data.c 			assert(gnutls_session_set_data(session, session_data.data, session_data.size) &gt;= 0);</span>
<span class='curline'><a href='../S/4331.html#L132'>session</a>           132 tests/tls13-early-data.c 			if (gnutls_record_get_max_early_data_size(session) != maxsize)</span>
<span class='curline'><a href='../S/4331.html#L134'>session</a>           134 tests/tls13-early-data.c 				     (int) gnutls_record_get_max_early_data_size(session),</span>
<span class='curline'><a href='../S/4331.html#L136'>session</a>           136 tests/tls13-early-data.c 			assert(gnutls_record_send_early_data(session, data, MIN(size, maxsize)) &gt;= 0);</span>
<span class='curline'><a href='../S/4331.html#L137'>session</a>           137 tests/tls13-early-data.c 			assert(gnutls_handshake_set_random(session, &amp;hrnd) &gt;= 0);</span>
<span class='curline'><a href='../S/4331.html#L142'>session</a>           142 tests/tls13-early-data.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4331.html#L144'>session</a>           144 tests/tls13-early-data.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4331.html#L160'>session</a>           160 tests/tls13-early-data.c 			    gnutls_session_get_data2(session,</span>
<span class='curline'><a href='../S/4331.html#L167'>session</a>           167 tests/tls13-early-data.c 			if (!gnutls_session_is_resumed(session)) {</span>
<span class='curline'><a href='../S/4331.html#L172'>session</a>           172 tests/tls13-early-data.c 		gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4331.html#L175'>session</a>           175 tests/tls13-early-data.c 			ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4331.html#L187'>session</a>           187 tests/tls13-early-data.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4331.html#L191'>session</a>           191 tests/tls13-early-data.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4331.html#L255'>session</a>           255 tests/tls13-early-data.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4331.html#L290'>session</a>           290 tests/tls13-early-data.c 		assert(gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_ENABLE_EARLY_DATA)&gt;=0);</span>
<span class='curline'><a href='../S/4331.html#L292'>session</a>           292 tests/tls13-early-data.c 		assert(gnutls_priority_set_direct(session, PRIORITY, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4331.html#L294'>session</a>           294 tests/tls13-early-data.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4331.html#L296'>session</a>           296 tests/tls13-early-data.c 		gnutls_session_ticket_enable_server(session,</span>
<span class='curline'><a href='../S/4331.html#L299'>session</a>           299 tests/tls13-early-data.c 		gnutls_anti_replay_enable(session, anti_replay);</span>
<span class='curline'><a href='../S/4331.html#L305'>session</a>           305 tests/tls13-early-data.c 			(void) gnutls_record_set_max_early_data_size(session, maxsize);</span>
<span class='curline'><a href='../S/4331.html#L307'>session</a>           307 tests/tls13-early-data.c 		gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4331.html#L310'>session</a>           310 tests/tls13-early-data.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4331.html#L315'>session</a>           315 tests/tls13-early-data.c 			gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4331.html#L324'>session</a>           324 tests/tls13-early-data.c 			if (!gnutls_session_is_resumed(session)) {</span>
<span class='curline'><a href='../S/4331.html#L332'>session</a>           332 tests/tls13-early-data.c 					if (!(gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_EARLY_DATA)) {</span>
<span class='curline'><a href='../S/4331.html#L339'>session</a>           339 tests/tls13-early-data.c 				ret = gnutls_record_recv_early_data(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4331.html#L350'>session</a>           350 tests/tls13-early-data.c 					if (gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_EARLY_DATA) {</span>
<span class='curline'><a href='../S/4331.html#L364'>session</a>           364 tests/tls13-early-data.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4331.html#L378'>session</a>           378 tests/tls13-early-data.c 				gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4331.html#L384'>session</a>           384 tests/tls13-early-data.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4331.html#L388'>session</a>           388 tests/tls13-early-data.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5011.html#L71'>session</a>            71 tests/tls13/change_cipher_spec.c static int cli_hsk_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5011.html#L78'>session</a>            78 tests/tls13/change_cipher_spec.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5011.html#L94'>session</a>            94 tests/tls13/change_cipher_spec.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_POST_HANDSHAKE_AUTH);</span>
<span class='curline'><a href='../S/5011.html#L96'>session</a>            96 tests/tls13/change_cipher_spec.c 	gnutls_session_set_ptr(session, &amp;ccs_check);</span>
<span class='curline'><a href='../S/5011.html#L97'>session</a>            97 tests/tls13/change_cipher_spec.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5011.html#L99'>session</a>            99 tests/tls13/change_cipher_spec.c 		gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5011.html#L104'>session</a>           104 tests/tls13/change_cipher_spec.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/5011.html#L115'>session</a>           115 tests/tls13/change_cipher_spec.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5011.html#L117'>session</a>           117 tests/tls13/change_cipher_spec.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5011.html#L122'>session</a>           122 tests/tls13/change_cipher_spec.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5011.html#L131'>session</a>           131 tests/tls13/change_cipher_spec.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5011.html#L144'>session</a>           144 tests/tls13/change_cipher_spec.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5011.html#L157'>session</a>           157 tests/tls13/change_cipher_spec.c static int cli_hsk_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5011.html#L164'>session</a>           164 tests/tls13/change_cipher_spec.c 	p = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5011.html#L173'>session</a>           173 tests/tls13/change_cipher_spec.c 		gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CHANGE_CIPHER_SPEC,</span>
<span class='curline'><a href='../S/5011.html#L187'>session</a>           187 tests/tls13/change_cipher_spec.c static int hsk_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5011.html#L195'>session</a>           195 tests/tls13/change_cipher_spec.c 	p = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5011.html#L205'>session</a>           205 tests/tls13/change_cipher_spec.c 		fd = gnutls_transport_get_int(session);</span>
<span class='curline'><a href='../S/5011.html#L223'>session</a>           223 tests/tls13/change_cipher_spec.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5011.html#L244'>session</a>           244 tests/tls13/change_cipher_spec.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5011.html#L246'>session</a>           246 tests/tls13/change_cipher_spec.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5011.html#L249'>session</a>           249 tests/tls13/change_cipher_spec.c 		gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CHANGE_CIPHER_SPEC,</span>
<span class='curline'><a href='../S/5011.html#L253'>session</a>           253 tests/tls13/change_cipher_spec.c 		gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5011.html#L260'>session</a>           260 tests/tls13/change_cipher_spec.c 	assert(gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5011.html#L261'>session</a>           261 tests/tls13/change_cipher_spec.c 	gnutls_session_set_ptr(session, &amp;ccs_check);</span>
<span class='curline'><a href='../S/5011.html#L263'>session</a>           263 tests/tls13/change_cipher_spec.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5011.html#L265'>session</a>           265 tests/tls13/change_cipher_spec.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5011.html#L268'>session</a>           268 tests/tls13/change_cipher_spec.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5011.html#L276'>session</a>           276 tests/tls13/change_cipher_spec.c 	gnutls_certificate_server_set_request(session, GNUTLS_CERT_REQUIRE);</span>
<span class='curline'><a href='../S/5011.html#L279'>session</a>           279 tests/tls13/change_cipher_spec.c 		ret = gnutls_record_send(session, "\x00", 1);</span>
<span class='curline'><a href='../S/5011.html#L287'>session</a>           287 tests/tls13/change_cipher_spec.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5011.html#L295'>session</a>           295 tests/tls13/change_cipher_spec.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5000.html#L75'>session</a>            75 tests/tls13/cookie.c static int ext_recv_server_cookie(gnutls_session_t session, const unsigned char *buf, size_t buflen)</span>
<span class='curline'><a href='../S/5000.html#L88'>session</a>            88 tests/tls13/cookie.c static int ext_send_server_cookie(gnutls_session_t session, gnutls_buffer_t extdata)</span>
<span class='curline'><a href='../S/5000.html#L90'>session</a>            90 tests/tls13/cookie.c 	if (gnutls_ext_get_current_msg(session) == GNUTLS_EXT_FLAG_HRR) {</span>
<span class='curline'><a href='../S/5000.html#L102'>session</a>           102 tests/tls13/cookie.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5000.html#L116'>session</a>           116 tests/tls13/cookie.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5000.html#L119'>session</a>           119 tests/tls13/cookie.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3",</span>
<span class='curline'><a href='../S/5000.html#L124'>session</a>           124 tests/tls13/cookie.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5000.html#L127'>session</a>           127 tests/tls13/cookie.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5000.html#L128'>session</a>           128 tests/tls13/cookie.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5000.html#L132'>session</a>           132 tests/tls13/cookie.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5000.html#L142'>session</a>           142 tests/tls13/cookie.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5000.html#L147'>session</a>           147 tests/tls13/cookie.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5000.html#L158'>session</a>           158 tests/tls13/cookie.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5000.html#L174'>session</a>           174 tests/tls13/cookie.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5000.html#L179'>session</a>           179 tests/tls13/cookie.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5000.html#L184'>session</a>           184 tests/tls13/cookie.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5000.html#L187'>session</a>           187 tests/tls13/cookie.c 	ret = gnutls_session_ext_register(session, "cookie_server", 44, GNUTLS_EXT_TLS, ext_recv_server_cookie, ext_send_server_cookie,</span>
<span class='curline'><a href='../S/5000.html#L193'>session</a>           193 tests/tls13/cookie.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5000.html#L194'>session</a>           194 tests/tls13/cookie.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5000.html#L196'>session</a>           196 tests/tls13/cookie.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5000.html#L213'>session</a>           213 tests/tls13/cookie.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5000.html#L217'>session</a>           217 tests/tls13/cookie.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5004.html#L67'>session</a>            67 tests/tls13/hello_random_value.c static int client_hello_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5004.html#L76'>session</a>            76 tests/tls13/hello_random_value.c 			gnutls_session_get_random(session, &amp;tmp, NULL);</span>
<span class='curline'><a href='../S/5004.html#L94'>session</a>            94 tests/tls13/hello_random_value.c 			gnutls_session_get_random(session, &amp;tmp, NULL);</span>
<span class='curline'><a href='../S/5004.html#L110'>session</a>           110 tests/tls13/hello_random_value.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5004.html#L124'>session</a>           124 tests/tls13/hello_random_value.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_KEY_SHARE_TOP)&gt;=0);</span>
<span class='curline'><a href='../S/5004.html#L128'>session</a>           128 tests/tls13/hello_random_value.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3",</span>
<span class='curline'><a href='../S/5004.html#L131'>session</a>           131 tests/tls13/hello_random_value.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5004.html#L134'>session</a>           134 tests/tls13/hello_random_value.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5004.html#L135'>session</a>           135 tests/tls13/hello_random_value.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5004.html#L136'>session</a>           136 tests/tls13/hello_random_value.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5004.html#L141'>session</a>           141 tests/tls13/hello_random_value.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5004.html#L155'>session</a>           155 tests/tls13/hello_random_value.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5004.html#L160'>session</a>           160 tests/tls13/hello_random_value.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5004.html#L171'>session</a>           171 tests/tls13/hello_random_value.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5004.html#L187'>session</a>           187 tests/tls13/hello_random_value.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5004.html#L192'>session</a>           192 tests/tls13/hello_random_value.c 	assert(gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5004.html#L197'>session</a>           197 tests/tls13/hello_random_value.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5004.html#L200'>session</a>           200 tests/tls13/hello_random_value.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5004.html#L201'>session</a>           201 tests/tls13/hello_random_value.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5004.html#L203'>session</a>           203 tests/tls13/hello_random_value.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5004.html#L214'>session</a>           214 tests/tls13/hello_random_value.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5004.html#L218'>session</a>           218 tests/tls13/hello_random_value.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5010.html#L77'>session</a>            77 tests/tls13/hello_retry_request.c static int hello_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5010.html#L80'>session</a>            80 tests/tls13/hello_retry_request.c 	struct ctx_st *ctx = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5010.html#L104'>session</a>           104 tests/tls13/hello_retry_request.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5010.html#L116'>session</a>           116 tests/tls13/hello_retry_request.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_KEY_SHARE_TOP)&gt;=0);</span>
<span class='curline'><a href='../S/5010.html#L118'>session</a>           118 tests/tls13/hello_retry_request.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5010.html#L119'>session</a>           119 tests/tls13/hello_retry_request.c 	gnutls_session_set_ptr(session, &amp;ctx);</span>
<span class='curline'><a href='../S/5010.html#L121'>session</a>           121 tests/tls13/hello_retry_request.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:-GROUP-ALL:+GROUP-SECP256R1:+GROUP-X25519", NULL);</span>
<span class='curline'><a href='../S/5010.html#L125'>session</a>           125 tests/tls13/hello_retry_request.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5010.html#L127'>session</a>           127 tests/tls13/hello_retry_request.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5010.html#L131'>session</a>           131 tests/tls13/hello_retry_request.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5010.html#L134'>session</a>           134 tests/tls13/hello_retry_request.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5010.html#L142'>session</a>           142 tests/tls13/hello_retry_request.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5010.html#L150'>session</a>           150 tests/tls13/hello_retry_request.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5010.html#L163'>session</a>           163 tests/tls13/hello_retry_request.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5010.html#L165'>session</a>           165 tests/tls13/hello_retry_request.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5010.html#L168'>session</a>           168 tests/tls13/hello_retry_request.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:-GROUP-ALL:+GROUP-X25519", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5010.html#L170'>session</a>           170 tests/tls13/hello_retry_request.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5010.html#L172'>session</a>           172 tests/tls13/hello_retry_request.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5010.html#L175'>session</a>           175 tests/tls13/hello_retry_request.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5010.html#L184'>session</a>           184 tests/tls13/hello_retry_request.c 	if (gnutls_group_get(session) != GNUTLS_GROUP_X25519)</span>
<span class='curline'><a href='../S/5010.html#L185'>session</a>           185 tests/tls13/hello_retry_request.c 		myfail("group doesn't match the expected: %s\n", gnutls_group_get_name(gnutls_group_get(session)));</span>
<span class='curline'><a href='../S/5010.html#L188'>session</a>           188 tests/tls13/hello_retry_request.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4990.html#L77'>session</a>            77 tests/tls13/key_limits.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4990.html#L92'>session</a>            92 tests/tls13/key_limits.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4990.html#L95'>session</a>            95 tests/tls13/key_limits.c 	ret = gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4990.html#L101'>session</a>           101 tests/tls13/key_limits.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4990.html#L103'>session</a>           103 tests/tls13/key_limits.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4990.html#L108'>session</a>           108 tests/tls13/key_limits.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4990.html#L124'>session</a>           124 tests/tls13/key_limits.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4990.html#L127'>session</a>           127 tests/tls13/key_limits.c 	gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/4990.html#L129'>session</a>           129 tests/tls13/key_limits.c 	assert(gnutls_record_get_state(session, 1, NULL, NULL, NULL, seq) &gt;= 0);</span>
<span class='curline'><a href='../S/4990.html#L130'>session</a>           130 tests/tls13/key_limits.c 	assert(gnutls_record_set_state(session, 1, (void*)"\x00\x00\x00\x00\x00\xff\xff\xfa") &gt;= 0);</span>
<span class='curline'><a href='../S/4990.html#L134'>session</a>           134 tests/tls13/key_limits.c 			ret = gnutls_record_recv_seq(session, buffer, MAX_BUF, seq);</span>
<span class='curline'><a href='../S/4990.html#L155'>session</a>           155 tests/tls13/key_limits.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4990.html#L161'>session</a>           161 tests/tls13/key_limits.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4990.html#L193'>session</a>           193 tests/tls13/key_limits.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4990.html#L213'>session</a>           213 tests/tls13/key_limits.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4990.html#L218'>session</a>           218 tests/tls13/key_limits.c 	ret = gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4990.html#L224'>session</a>           224 tests/tls13/key_limits.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4990.html#L226'>session</a>           226 tests/tls13/key_limits.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4990.html#L229'>session</a>           229 tests/tls13/key_limits.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4990.html#L234'>session</a>           234 tests/tls13/key_limits.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4990.html#L245'>session</a>           245 tests/tls13/key_limits.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4990.html#L247'>session</a>           247 tests/tls13/key_limits.c 	assert(gnutls_record_get_state(session, 0, NULL, NULL, NULL, seq) &gt;= 0);</span>
<span class='curline'><a href='../S/4990.html#L248'>session</a>           248 tests/tls13/key_limits.c 	assert(gnutls_record_set_state(session, 0, (void*)"\x00\x00\x00\x00\x00\xff\xff\xfa") &gt;= 0);</span>
<span class='curline'><a href='../S/4990.html#L255'>session</a>           255 tests/tls13/key_limits.c 			    gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4990.html#L276'>session</a>           276 tests/tls13/key_limits.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4990.html#L279'>session</a>           279 tests/tls13/key_limits.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4994.html#L80'>session</a>            80 tests/tls13/key_share.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4994.html#L93'>session</a>            93 tests/tls13/key_share.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|flag);</span>
<span class='curline'><a href='../S/4994.html#L95'>session</a>            95 tests/tls13/key_share.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4994.html#L97'>session</a>            97 tests/tls13/key_share.c 	ret = gnutls_priority_set_direct(session, prio, NULL);</span>
<span class='curline'><a href='../S/4994.html#L103'>session</a>           103 tests/tls13/key_share.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4994.html#L105'>session</a>           105 tests/tls13/key_share.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4994.html#L110'>session</a>           110 tests/tls13/key_share.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4994.html#L116'>session</a>           116 tests/tls13/key_share.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4994.html#L144'>session</a>           144 tests/tls13/key_share.c 	gnutls_session_t session = priv;</span>
<span class='curline'><a href='../S/4994.html#L149'>session</a>           149 tests/tls13/key_share.c 	ctx = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/4994.html#L182'>session</a>           182 tests/tls13/key_share.c static int client_hello_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4994.html#L186'>session</a>           186 tests/tls13/key_share.c 		if (find_client_extension(msg, TLS_EXT_KEY_SHARE, session, check_ks_contents) == 0)</span>
<span class='curline'><a href='../S/4994.html#L197'>session</a>           197 tests/tls13/key_share.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4994.html#L216'>session</a>           216 tests/tls13/key_share.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4994.html#L218'>session</a>           218 tests/tls13/key_share.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4994.html#L219'>session</a>           219 tests/tls13/key_share.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4994.html#L224'>session</a>           224 tests/tls13/key_share.c 	gnutls_session_set_ptr(session, &amp;ctx);</span>
<span class='curline'><a href='../S/4994.html#L229'>session</a>           229 tests/tls13/key_share.c 	gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL);</span>
<span class='curline'><a href='../S/4994.html#L231'>session</a>           231 tests/tls13/key_share.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4994.html#L233'>session</a>           233 tests/tls13/key_share.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4994.html#L236'>session</a>           236 tests/tls13/key_share.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4994.html#L245'>session</a>           245 tests/tls13/key_share.c 	if (gnutls_group_get(session) != exp_group)</span>
<span class='curline'><a href='../S/4994.html#L246'>session</a>           246 tests/tls13/key_share.c 		myfail("group doesn't match the expected: %s\n", gnutls_group_get_name(gnutls_group_get(session)));</span>
<span class='curline'><a href='../S/4994.html#L249'>session</a>           249 tests/tls13/key_share.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5003.html#L52'>session</a>            52 tests/tls13/key_update.c static int hsk_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5006.html#L61'>session</a>            61 tests/tls13/key_update_multiple.c static int hsk_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5007.html#L72'>session</a>            72 tests/tls13/multi-ocsp.c static void check_response(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/5007.html#L82'>session</a>            82 tests/tls13/multi-ocsp.c 		ret = gnutls_ocsp_status_request_get2(session, i, &amp;resp);</span>
<span class='curline'><a href='../S/5001.html#L68'>session</a>            68 tests/tls13/no-auto-send-ticket.c static int ticket_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5001.html#L76'>session</a>            76 tests/tls13/no-auto-send-ticket.c 	d = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5001.html#L82'>session</a>            82 tests/tls13/no-auto-send-ticket.c 		ret = gnutls_session_get_data2(session, d);</span>
<span class='curline'><a href='../S/5001.html#L95'>session</a>            95 tests/tls13/no-auto-send-ticket.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5001.html#L113'>session</a>           113 tests/tls13/no-auto-send-ticket.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|flags)&gt;=0);</span>
<span class='curline'><a href='../S/5001.html#L115'>session</a>           115 tests/tls13/no-auto-send-ticket.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5001.html#L117'>session</a>           117 tests/tls13/no-auto-send-ticket.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/5001.html#L123'>session</a>           123 tests/tls13/no-auto-send-ticket.c 		gnutls_session_set_ptr(session, &amp;session_data);</span>
<span class='curline'><a href='../S/5001.html#L124'>session</a>           124 tests/tls13/no-auto-send-ticket.c 		gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_NEW_SESSION_TICKET,</span>
<span class='curline'><a href='../S/5001.html#L128'>session</a>           128 tests/tls13/no-auto-send-ticket.c 		assert(gnutls_session_set_data(session, session_data.data, session_data.size) &gt;= 0);</span>
<span class='curline'><a href='../S/5001.html#L131'>session</a>           131 tests/tls13/no-auto-send-ticket.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5001.html#L133'>session</a>           133 tests/tls13/no-auto-send-ticket.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5001.html#L138'>session</a>           138 tests/tls13/no-auto-send-ticket.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5001.html#L146'>session</a>           146 tests/tls13/no-auto-send-ticket.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5001.html#L157'>session</a>           157 tests/tls13/no-auto-send-ticket.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5001.html#L174'>session</a>           174 tests/tls13/no-auto-send-ticket.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5001.html#L194'>session</a>           194 tests/tls13/no-auto-send-ticket.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER|flags)&gt;=0);</span>
<span class='curline'><a href='../S/5001.html#L196'>session</a>           196 tests/tls13/no-auto-send-ticket.c 	assert(gnutls_session_ticket_enable_server(session, &amp;skey) &gt;= 0);</span>
<span class='curline'><a href='../S/5001.html#L197'>session</a>           197 tests/tls13/no-auto-send-ticket.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5001.html#L199'>session</a>           199 tests/tls13/no-auto-send-ticket.c 	assert(gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5001.html#L201'>session</a>           201 tests/tls13/no-auto-send-ticket.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5001.html#L203'>session</a>           203 tests/tls13/no-auto-send-ticket.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5001.html#L206'>session</a>           206 tests/tls13/no-auto-send-ticket.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5001.html#L214'>session</a>           214 tests/tls13/no-auto-send-ticket.c 			ret = gnutls_session_ticket_send(session, tickets_sent, 0);</span>
<span class='curline'><a href='../S/5001.html#L219'>session</a>           219 tests/tls13/no-auto-send-ticket.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5001.html#L221'>session</a>           221 tests/tls13/no-auto-send-ticket.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5001.html#L226'>session</a>           226 tests/tls13/no-auto-send-ticket.c 		assert(gnutls_init(&amp;session, GNUTLS_SERVER|flags)&gt;=0);</span>
<span class='curline'><a href='../S/5001.html#L228'>session</a>           228 tests/tls13/no-auto-send-ticket.c 		assert(gnutls_session_ticket_enable_server(session, &amp;skey) &gt;= 0);</span>
<span class='curline'><a href='../S/5001.html#L229'>session</a>           229 tests/tls13/no-auto-send-ticket.c 		gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5001.html#L230'>session</a>           230 tests/tls13/no-auto-send-ticket.c 		assert(gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5001.html#L232'>session</a>           232 tests/tls13/no-auto-send-ticket.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5001.html#L234'>session</a>           234 tests/tls13/no-auto-send-ticket.c 		gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5001.html#L237'>session</a>           237 tests/tls13/no-auto-send-ticket.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5001.html#L243'>session</a>           243 tests/tls13/no-auto-send-ticket.c 		assert(gnutls_session_is_resumed(session) != 0);</span>
<span class='curline'><a href='../S/5001.html#L245'>session</a>           245 tests/tls13/no-auto-send-ticket.c 		gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5001.html#L246'>session</a>           246 tests/tls13/no-auto-send-ticket.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4997.html#L73'>session</a>            73 tests/tls13/no-psk-exts.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4997.html#L87'>session</a>            87 tests/tls13/no-psk-exts.c 	gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_NO_TICKETS);</span>
<span class='curline'><a href='../S/4997.html#L89'>session</a>            89 tests/tls13/no-psk-exts.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4997.html#L91'>session</a>            91 tests/tls13/no-psk-exts.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/4997.html#L97'>session</a>            97 tests/tls13/no-psk-exts.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4997.html#L98'>session</a>            98 tests/tls13/no-psk-exts.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, psk_cred);</span>
<span class='curline'><a href='../S/4997.html#L100'>session</a>           100 tests/tls13/no-psk-exts.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4997.html#L105'>session</a>           105 tests/tls13/no-psk-exts.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4997.html#L110'>session</a>           110 tests/tls13/no-psk-exts.c 	ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/4997.html#L116'>session</a>           116 tests/tls13/no-psk-exts.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4997.html#L129'>session</a>           129 tests/tls13/no-psk-exts.c static int hellos_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4997.html#L160'>session</a>           160 tests/tls13/no-psk-exts.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4997.html#L178'>session</a>           178 tests/tls13/no-psk-exts.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4997.html#L180'>session</a>           180 tests/tls13/no-psk-exts.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4997.html#L181'>session</a>           181 tests/tls13/no-psk-exts.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4997.html#L188'>session</a>           188 tests/tls13/no-psk-exts.c 	gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL);</span>
<span class='curline'><a href='../S/4997.html#L190'>session</a>           190 tests/tls13/no-psk-exts.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4997.html#L192'>session</a>           192 tests/tls13/no-psk-exts.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4997.html#L195'>session</a>           195 tests/tls13/no-psk-exts.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4997.html#L207'>session</a>           207 tests/tls13/no-psk-exts.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5008.html#L63'>session</a>            63 tests/tls13/ocsp-client.c static void check_response(gnutls_session_t session, void *priv)</span>
<span class='curline'><a href='../S/5008.html#L73'>session</a>            73 tests/tls13/ocsp-client.c 		ret = gnutls_ocsp_status_request_get2(session, i, &amp;resp);</span>
<span class='curline'><a href='../S/5014.html#L79'>session</a>            79 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5014.html#L94'>session</a>            94 tests/tls13/post-handshake-with-cert-auto.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_POST_HANDSHAKE_AUTH|GNUTLS_AUTO_REAUTH)&gt;=0);</span>
<span class='curline'><a href='../S/5014.html#L96'>session</a>            96 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5014.html#L98'>session</a>            98 tests/tls13/post-handshake-with-cert-auto.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/5014.html#L109'>session</a>           109 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5014.html#L111'>session</a>           111 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5014.html#L116'>session</a>           116 tests/tls13/post-handshake-with-cert-auto.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5014.html#L126'>session</a>           126 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_record_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5014.html#L133'>session</a>           133 tests/tls13/post-handshake-with-cert-auto.c 			ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5014.html#L143'>session</a>           143 tests/tls13/post-handshake-with-cert-auto.c 		ret = gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5014.html#L148'>session</a>           148 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5014.html#L167'>session</a>           167 tests/tls13/post-handshake-with-cert-auto.c static int hellos_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5014.html#L194'>session</a>           194 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5014.html#L213'>session</a>           213 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_POST_HANDSHAKE_AUTH);</span>
<span class='curline'><a href='../S/5014.html#L215'>session</a>           215 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5014.html#L216'>session</a>           216 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5014.html#L223'>session</a>           223 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL);</span>
<span class='curline'><a href='../S/5014.html#L225'>session</a>           225 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5014.html#L227'>session</a>           227 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5014.html#L230'>session</a>           230 tests/tls13/post-handshake-with-cert-auto.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5014.html#L236'>session</a>           236 tests/tls13/post-handshake-with-cert-auto.c 	if (!(gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_POST_HANDSHAKE_AUTH)) {</span>
<span class='curline'><a href='../S/5014.html#L252'>session</a>           252 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_certificate_server_set_request(session, type);</span>
<span class='curline'><a href='../S/5014.html#L259'>session</a>           259 tests/tls13/post-handshake-with-cert-auto.c 			ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5014.html#L265'>session</a>           265 tests/tls13/post-handshake-with-cert-auto.c 				ret2 = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/5014.html#L290'>session</a>           290 tests/tls13/post-handshake-with-cert-auto.c 			ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5014.html#L302'>session</a>           302 tests/tls13/post-handshake-with-cert-auto.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5014.html#L306'>session</a>           306 tests/tls13/post-handshake-with-cert-auto.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4992.html#L95'>session</a>            95 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4992.html#L210'>session</a>           210 tests/tls13/post-handshake-with-cert-pkcs11.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_POST_HANDSHAKE_AUTH|GNUTLS_AUTO_REAUTH)&gt;=0);</span>
<span class='curline'><a href='../S/4992.html#L212'>session</a>           212 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4992.html#L214'>session</a>           214 tests/tls13/post-handshake-with-cert-pkcs11.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:-SIGN-RSA-SHA256", NULL);</span>
<span class='curline'><a href='../S/4992.html#L227'>session</a>           227 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4992.html#L229'>session</a>           229 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4992.html#L234'>session</a>           234 tests/tls13/post-handshake-with-cert-pkcs11.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4992.html#L244'>session</a>           244 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_record_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4992.html#L250'>session</a>           250 tests/tls13/post-handshake-with-cert-pkcs11.c 		ret = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/4992.html#L261'>session</a>           261 tests/tls13/post-handshake-with-cert-pkcs11.c 		ret = gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4992.html#L266'>session</a>           266 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4992.html#L285'>session</a>           285 tests/tls13/post-handshake-with-cert-pkcs11.c static int hellos_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4992.html#L312'>session</a>           312 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4992.html#L330'>session</a>           330 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_POST_HANDSHAKE_AUTH);</span>
<span class='curline'><a href='../S/4992.html#L332'>session</a>           332 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4992.html#L333'>session</a>           333 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4992.html#L340'>session</a>           340 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3", NULL);</span>
<span class='curline'><a href='../S/4992.html#L342'>session</a>           342 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4992.html#L344'>session</a>           344 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4992.html#L347'>session</a>           347 tests/tls13/post-handshake-with-cert-pkcs11.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4992.html#L353'>session</a>           353 tests/tls13/post-handshake-with-cert-pkcs11.c 	if (!(gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_POST_HANDSHAKE_AUTH)) {</span>
<span class='curline'><a href='../S/4992.html#L369'>session</a>           369 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_certificate_server_set_request(session, type);</span>
<span class='curline'><a href='../S/4992.html#L373'>session</a>           373 tests/tls13/post-handshake-with-cert-pkcs11.c 		ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/4992.html#L384'>session</a>           384 tests/tls13/post-handshake-with-cert-pkcs11.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4992.html#L388'>session</a>           388 tests/tls13/post-handshake-with-cert-pkcs11.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5013.html#L69'>session</a>            69 tests/tls13/post-handshake-with-cert-ticket.c static int ticket_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5013.html#L82'>session</a>            82 tests/tls13/post-handshake-with-cert-ticket.c 	d = gnutls_session_get_ptr(session);</span>
<span class='curline'><a href='../S/5013.html#L88'>session</a>            88 tests/tls13/post-handshake-with-cert-ticket.c 		ret = gnutls_session_get_data2(session, d);</span>
<span class='curline'><a href='../S/5013.html#L102'>session</a>           102 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5013.html#L120'>session</a>           120 tests/tls13/post-handshake-with-cert-ticket.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_POST_HANDSHAKE_AUTH)&gt;=0);</span>
<span class='curline'><a href='../S/5013.html#L122'>session</a>           122 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5013.html#L124'>session</a>           124 tests/tls13/post-handshake-with-cert-ticket.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/5013.html#L130'>session</a>           130 tests/tls13/post-handshake-with-cert-ticket.c 		gnutls_session_set_ptr(session, &amp;session_data);</span>
<span class='curline'><a href='../S/5013.html#L131'>session</a>           131 tests/tls13/post-handshake-with-cert-ticket.c 		gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_NEW_SESSION_TICKET,</span>
<span class='curline'><a href='../S/5013.html#L135'>session</a>           135 tests/tls13/post-handshake-with-cert-ticket.c 		assert(gnutls_session_set_data(session, session_data.data, session_data.size) &gt;= 0);</span>
<span class='curline'><a href='../S/5013.html#L138'>session</a>           138 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5013.html#L140'>session</a>           140 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5013.html#L145'>session</a>           145 tests/tls13/post-handshake-with-cert-ticket.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5013.html#L158'>session</a>           158 tests/tls13/post-handshake-with-cert-ticket.c 			ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5013.html#L168'>session</a>           168 tests/tls13/post-handshake-with-cert-ticket.c 			ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5013.html#L174'>session</a>           174 tests/tls13/post-handshake-with-cert-ticket.c 		assert(gnutls_session_is_resumed(session) != 0);</span>
<span class='curline'><a href='../S/5013.html#L178'>session</a>           178 tests/tls13/post-handshake-with-cert-ticket.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5013.html#L187'>session</a>           187 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5013.html#L224'>session</a>           224 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5013.html#L246'>session</a>           246 tests/tls13/post-handshake-with-cert-ticket.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_POST_HANDSHAKE_AUTH)&gt;=0);</span>
<span class='curline'><a href='../S/5013.html#L248'>session</a>           248 tests/tls13/post-handshake-with-cert-ticket.c 	assert(gnutls_session_ticket_enable_server(session, &amp;skey) &gt;= 0);</span>
<span class='curline'><a href='../S/5013.html#L249'>session</a>           249 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5013.html#L251'>session</a>           251 tests/tls13/post-handshake-with-cert-ticket.c 	assert(gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5013.html#L253'>session</a>           253 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5013.html#L255'>session</a>           255 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5013.html#L258'>session</a>           258 tests/tls13/post-handshake-with-cert-ticket.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5013.html#L264'>session</a>           264 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_certificate_server_set_request(session, GNUTLS_CERT_REQUIRE);</span>
<span class='curline'><a href='../S/5013.html#L268'>session</a>           268 tests/tls13/post-handshake-with-cert-ticket.c 		ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5013.html#L276'>session</a>           276 tests/tls13/post-handshake-with-cert-ticket.c 		ret = gnutls_session_ticket_send(session, 0, 0);</span>
<span class='curline'><a href='../S/5013.html#L281'>session</a>           281 tests/tls13/post-handshake-with-cert-ticket.c 			ret = gnutls_session_ticket_send(session, tickets, 0);</span>
<span class='curline'><a href='../S/5013.html#L286'>session</a>           286 tests/tls13/post-handshake-with-cert-ticket.c 		ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5013.html#L288'>session</a>           288 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5013.html#L292'>session</a>           292 tests/tls13/post-handshake-with-cert-ticket.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_POST_HANDSHAKE_AUTH)&gt;=0);</span>
<span class='curline'><a href='../S/5013.html#L294'>session</a>           294 tests/tls13/post-handshake-with-cert-ticket.c 	assert(gnutls_session_ticket_enable_server(session, &amp;skey) &gt;= 0);</span>
<span class='curline'><a href='../S/5013.html#L295'>session</a>           295 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5013.html#L296'>session</a>           296 tests/tls13/post-handshake-with-cert-ticket.c 	assert(gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5013.html#L298'>session</a>           298 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5013.html#L300'>session</a>           300 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5013.html#L303'>session</a>           303 tests/tls13/post-handshake-with-cert-ticket.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5013.html#L309'>session</a>           309 tests/tls13/post-handshake-with-cert-ticket.c 	assert(gnutls_session_is_resumed(session) != 0);</span>
<span class='curline'><a href='../S/5013.html#L313'>session</a>           313 tests/tls13/post-handshake-with-cert-ticket.c 		clist = gnutls_certificate_get_peers(session, &amp;clist_size);</span>
<span class='curline'><a href='../S/5013.html#L320'>session</a>           320 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5013.html#L321'>session</a>           321 tests/tls13/post-handshake-with-cert-ticket.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5012.html#L79'>session</a>            79 tests/tls13/post-handshake-with-cert.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5012.html#L94'>session</a>            94 tests/tls13/post-handshake-with-cert.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_POST_HANDSHAKE_AUTH)&gt;=0);</span>
<span class='curline'><a href='../S/5012.html#L96'>session</a>            96 tests/tls13/post-handshake-with-cert.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5012.html#L98'>session</a>            98 tests/tls13/post-handshake-with-cert.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/5012.html#L109'>session</a>           109 tests/tls13/post-handshake-with-cert.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5012.html#L111'>session</a>           111 tests/tls13/post-handshake-with-cert.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5012.html#L116'>session</a>           116 tests/tls13/post-handshake-with-cert.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5012.html#L126'>session</a>           126 tests/tls13/post-handshake-with-cert.c 	gnutls_record_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5012.html#L133'>session</a>           133 tests/tls13/post-handshake-with-cert.c 			ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5012.html#L145'>session</a>           145 tests/tls13/post-handshake-with-cert.c 					ret = gnutls_record_send(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5012.html#L154'>session</a>           154 tests/tls13/post-handshake-with-cert.c 			ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5012.html#L164'>session</a>           164 tests/tls13/post-handshake-with-cert.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5012.html#L183'>session</a>           183 tests/tls13/post-handshake-with-cert.c static int hellos_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5012.html#L210'>session</a>           210 tests/tls13/post-handshake-with-cert.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5012.html#L229'>session</a>           229 tests/tls13/post-handshake-with-cert.c 	gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_POST_HANDSHAKE_AUTH);</span>
<span class='curline'><a href='../S/5012.html#L231'>session</a>           231 tests/tls13/post-handshake-with-cert.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5012.html#L232'>session</a>           232 tests/tls13/post-handshake-with-cert.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5012.html#L239'>session</a>           239 tests/tls13/post-handshake-with-cert.c 	gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL);</span>
<span class='curline'><a href='../S/5012.html#L241'>session</a>           241 tests/tls13/post-handshake-with-cert.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5012.html#L243'>session</a>           243 tests/tls13/post-handshake-with-cert.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5012.html#L246'>session</a>           246 tests/tls13/post-handshake-with-cert.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5012.html#L252'>session</a>           252 tests/tls13/post-handshake-with-cert.c 	if (!(gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_POST_HANDSHAKE_AUTH)) {</span>
<span class='curline'><a href='../S/5012.html#L268'>session</a>           268 tests/tls13/post-handshake-with-cert.c 	gnutls_certificate_server_set_request(session, type);</span>
<span class='curline'><a href='../S/5012.html#L275'>session</a>           275 tests/tls13/post-handshake-with-cert.c 			ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5012.html#L281'>session</a>           281 tests/tls13/post-handshake-with-cert.c 				ret2 = gnutls_record_recv(session, buffer, sizeof(buffer));</span>
<span class='curline'><a href='../S/5012.html#L306'>session</a>           306 tests/tls13/post-handshake-with-cert.c 			ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5012.html#L318'>session</a>           318 tests/tls13/post-handshake-with-cert.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5002.html#L77'>session</a>            77 tests/tls13/post-handshake-with-psk.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5002.html#L96'>session</a>            96 tests/tls13/post-handshake-with-psk.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_POST_HANDSHAKE_AUTH)&gt;=0);</span>
<span class='curline'><a href='../S/5002.html#L98'>session</a>            98 tests/tls13/post-handshake-with-psk.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5002.html#L100'>session</a>           100 tests/tls13/post-handshake-with-psk.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0:+ECDHE-PSK:+PSK", NULL);</span>
<span class='curline'><a href='../S/5002.html#L111'>session</a>           111 tests/tls13/post-handshake-with-psk.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5002.html#L112'>session</a>           112 tests/tls13/post-handshake-with-psk.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred);</span>
<span class='curline'><a href='../S/5002.html#L114'>session</a>           114 tests/tls13/post-handshake-with-psk.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5002.html#L119'>session</a>           119 tests/tls13/post-handshake-with-psk.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5002.html#L129'>session</a>           129 tests/tls13/post-handshake-with-psk.c 	assert(gnutls_kx_get(session) == GNUTLS_KX_ECDHE_PSK);</span>
<span class='curline'><a href='../S/5002.html#L131'>session</a>           131 tests/tls13/post-handshake-with-psk.c 	gnutls_record_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5002.html#L137'>session</a>           137 tests/tls13/post-handshake-with-psk.c 			ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/5002.html#L147'>session</a>           147 tests/tls13/post-handshake-with-psk.c 			ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5002.html#L157'>session</a>           157 tests/tls13/post-handshake-with-psk.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5002.html#L177'>session</a>           177 tests/tls13/post-handshake-with-psk.c static int hellos_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/5002.html#L201'>session</a>           201 tests/tls13/post-handshake-with-psk.c pskfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/5002.html#L219'>session</a>           219 tests/tls13/post-handshake-with-psk.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5002.html#L243'>session</a>           243 tests/tls13/post-handshake-with-psk.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER|GNUTLS_POST_HANDSHAKE_AUTH)&gt;=0);</span>
<span class='curline'><a href='../S/5002.html#L245'>session</a>           245 tests/tls13/post-handshake-with-psk.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5002.html#L246'>session</a>           246 tests/tls13/post-handshake-with-psk.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/5002.html#L250'>session</a>           250 tests/tls13/post-handshake-with-psk.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+PSK:+ECDHE-PSK", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5002.html#L252'>session</a>           252 tests/tls13/post-handshake-with-psk.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, server_pskcred);</span>
<span class='curline'><a href='../S/5002.html#L254'>session</a>           254 tests/tls13/post-handshake-with-psk.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5002.html#L257'>session</a>           257 tests/tls13/post-handshake-with-psk.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5002.html#L263'>session</a>           263 tests/tls13/post-handshake-with-psk.c 	if (!(gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_POST_HANDSHAKE_AUTH)) {</span>
<span class='curline'><a href='../S/5002.html#L279'>session</a>           279 tests/tls13/post-handshake-with-psk.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5002.html#L280'>session</a>           280 tests/tls13/post-handshake-with-psk.c 	gnutls_certificate_server_set_request(session, type);</span>
<span class='curline'><a href='../S/5002.html#L285'>session</a>           285 tests/tls13/post-handshake-with-psk.c 			ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/5002.html#L301'>session</a>           301 tests/tls13/post-handshake-with-psk.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4986.html#L74'>session</a>            74 tests/tls13/post-handshake-without-cert.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4986.html#L91'>session</a>            91 tests/tls13/post-handshake-without-cert.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4986.html#L93'>session</a>            93 tests/tls13/post-handshake-without-cert.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4986.html#L95'>session</a>            95 tests/tls13/post-handshake-without-cert.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/4986.html#L101'>session</a>           101 tests/tls13/post-handshake-without-cert.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4986.html#L103'>session</a>           103 tests/tls13/post-handshake-without-cert.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4986.html#L108'>session</a>           108 tests/tls13/post-handshake-without-cert.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4986.html#L113'>session</a>           113 tests/tls13/post-handshake-without-cert.c 	ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/4986.html#L119'>session</a>           119 tests/tls13/post-handshake-without-cert.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4986.html#L130'>session</a>           130 tests/tls13/post-handshake-without-cert.c static int hellos_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4986.html#L155'>session</a>           155 tests/tls13/post-handshake-without-cert.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4986.html#L173'>session</a>           173 tests/tls13/post-handshake-without-cert.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4986.html#L175'>session</a>           175 tests/tls13/post-handshake-without-cert.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4986.html#L176'>session</a>           176 tests/tls13/post-handshake-without-cert.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4986.html#L183'>session</a>           183 tests/tls13/post-handshake-without-cert.c 	gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL);</span>
<span class='curline'><a href='../S/4986.html#L185'>session</a>           185 tests/tls13/post-handshake-without-cert.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4986.html#L187'>session</a>           187 tests/tls13/post-handshake-without-cert.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4986.html#L190'>session</a>           190 tests/tls13/post-handshake-without-cert.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4986.html#L196'>session</a>           196 tests/tls13/post-handshake-without-cert.c 	if ((gnutls_session_get_flags(session) &amp; GNUTLS_SFLAGS_POST_HANDSHAKE_AUTH)) {</span>
<span class='curline'><a href='../S/4986.html#L205'>session</a>           205 tests/tls13/post-handshake-without-cert.c 	ret = gnutls_reauth(session, 0);</span>
<span class='curline'><a href='../S/4986.html#L210'>session</a>           210 tests/tls13/post-handshake-without-cert.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4999.html#L111'>session</a>           111 tests/tls13/prf-early.c 	ret = gnutls_prf_early(session, label_size, label, extra_size, extra, size, \</span>
<span class='curline'><a href='../S/4999.html#L133'>session</a>           133 tests/tls13/prf-early.c static int handshake_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4999.html#L153'>session</a>           153 tests/tls13/prf-early.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4999.html#L175'>session</a>           175 tests/tls13/prf-early.c 		gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4999.html#L178'>session</a>           178 tests/tls13/prf-early.c 		ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4999.html#L187'>session</a>           187 tests/tls13/prf-early.c 		ret = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4999.html#L192'>session</a>           192 tests/tls13/prf-early.c 		gnutls_handshake_set_random(session, &amp;hrnd);</span>
<span class='curline'><a href='../S/4999.html#L193'>session</a>           193 tests/tls13/prf-early.c 		gnutls_transport_set_int(session, sds[t]);</span>
<span class='curline'><a href='../S/4999.html#L196'>session</a>           196 tests/tls13/prf-early.c 			gnutls_session_set_data(session, session_data.data,</span>
<span class='curline'><a href='../S/4999.html#L198'>session</a>           198 tests/tls13/prf-early.c 			gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/4999.html#L206'>session</a>           206 tests/tls13/prf-early.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4999.html#L221'>session</a>           221 tests/tls13/prf-early.c 				(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4999.html#L223'>session</a>           223 tests/tls13/prf-early.c 		ret = gnutls_cipher_get(session);</span>
<span class='curline'><a href='../S/4999.html#L229'>session</a>           229 tests/tls13/prf-early.c 		ret = gnutls_mac_get(session);</span>
<span class='curline'><a href='../S/4999.html#L238'>session</a>           238 tests/tls13/prf-early.c 			    gnutls_session_get_data2(session,</span>
<span class='curline'><a href='../S/4999.html#L250'>session</a>           250 tests/tls13/prf-early.c 		gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4999.html#L253'>session</a>           253 tests/tls13/prf-early.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4999.html#L271'>session</a>           271 tests/tls13/prf-early.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4999.html#L275'>session</a>           275 tests/tls13/prf-early.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4999.html#L296'>session</a>           296 tests/tls13/prf-early.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4999.html#L317'>session</a>           317 tests/tls13/prf-early.c 		gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4999.html#L319'>session</a>           319 tests/tls13/prf-early.c 		gnutls_session_ticket_enable_server(session,</span>
<span class='curline'><a href='../S/4999.html#L325'>session</a>           325 tests/tls13/prf-early.c 		ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/4999.html#L336'>session</a>           336 tests/tls13/prf-early.c 		gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4999.html#L339'>session</a>           339 tests/tls13/prf-early.c 		gnutls_handshake_set_random(session, &amp;hsrnd);</span>
<span class='curline'><a href='../S/4999.html#L340'>session</a>           340 tests/tls13/prf-early.c 		gnutls_transport_set_int(session, sds[t]);</span>
<span class='curline'><a href='../S/4999.html#L347'>session</a>           347 tests/tls13/prf-early.c 				gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_CLIENT_HELLO,</span>
<span class='curline'><a href='../S/4999.html#L354'>session</a>           354 tests/tls13/prf-early.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4999.html#L359'>session</a>           359 tests/tls13/prf-early.c 			gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4999.html#L370'>session</a>           370 tests/tls13/prf-early.c 				(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4999.html#L382'>session</a>           382 tests/tls13/prf-early.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4999.html#L396'>session</a>           396 tests/tls13/prf-early.c 				gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4999.html#L403'>session</a>           403 tests/tls13/prf-early.c 		gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4999.html#L406'>session</a>           406 tests/tls13/prf-early.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5005.html#L101'>session</a>           101 tests/tls13/prf.c 	ret = gnutls_prf_rfc5705(session, label_size, label, extra_size, extra, size, \</span>
<span class='curline'><a href='../S/5005.html#L118'>session</a>           118 tests/tls13/prf.c 	ret = gnutls_prf(session, label_size, label, 0, 0, NULL, size, \</span>
<span class='curline'><a href='../S/5005.html#L137'>session</a>           137 tests/tls13/prf.c static void check_prfs(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5005.html#L157'>session</a>           157 tests/tls13/prf.c 	ret = gnutls_prf(session, 3, (void*)"xxx", 0, 3, (void*)"yyy", 16, (void*)key_material);</span>
<span class='curline'><a href='../S/5005.html#L161'>session</a>           161 tests/tls13/prf.c 	ret = gnutls_prf(session, 3, (void*)"xxx", 1, 0, NULL, 16, (void*)key_material);</span>
<span class='curline'><a href='../S/5005.html#L168'>session</a>           168 tests/tls13/prf.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5005.html#L185'>session</a>           185 tests/tls13/prf.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5005.html#L188'>session</a>           188 tests/tls13/prf.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5005.html#L197'>session</a>           197 tests/tls13/prf.c 	ret = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5005.html#L202'>session</a>           202 tests/tls13/prf.c 	gnutls_handshake_set_random(session, &amp;hrnd);</span>
<span class='curline'><a href='../S/5005.html#L203'>session</a>           203 tests/tls13/prf.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5005.html#L208'>session</a>           208 tests/tls13/prf.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5005.html#L223'>session</a>           223 tests/tls13/prf.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5005.html#L225'>session</a>           225 tests/tls13/prf.c 	ret = gnutls_cipher_get(session);</span>
<span class='curline'><a href='../S/5005.html#L231'>session</a>           231 tests/tls13/prf.c 	ret = gnutls_mac_get(session);</span>
<span class='curline'><a href='../S/5005.html#L237'>session</a>           237 tests/tls13/prf.c 	ret = gnutls_prf_hash_get(session);</span>
<span class='curline'><a href='../S/5005.html#L243'>session</a>           243 tests/tls13/prf.c 	check_prfs(session);</span>
<span class='curline'><a href='../S/5005.html#L245'>session</a>           245 tests/tls13/prf.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5005.html#L249'>session</a>           249 tests/tls13/prf.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5005.html#L268'>session</a>           268 tests/tls13/prf.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5005.html#L282'>session</a>           282 tests/tls13/prf.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5005.html#L287'>session</a>           287 tests/tls13/prf.c 	ret = gnutls_priority_set_direct(session,</span>
<span class='curline'><a href='../S/5005.html#L298'>session</a>           298 tests/tls13/prf.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/5005.html#L301'>session</a>           301 tests/tls13/prf.c 	gnutls_handshake_set_random(session, &amp;hsrnd);</span>
<span class='curline'><a href='../S/5005.html#L302'>session</a>           302 tests/tls13/prf.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5005.html#L305'>session</a>           305 tests/tls13/prf.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5005.html#L310'>session</a>           310 tests/tls13/prf.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5005.html#L321'>session</a>           321 tests/tls13/prf.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5005.html#L323'>session</a>           323 tests/tls13/prf.c 	check_prfs(session);</span>
<span class='curline'><a href='../S/5005.html#L327'>session</a>           327 tests/tls13/prf.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5005.html#L330'>session</a>           330 tests/tls13/prf.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4993.html#L74'>session</a>            74 tests/tls13/psk-dumbfw.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4993.html#L91'>session</a>            91 tests/tls13/psk-dumbfw.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT|GNUTLS_KEY_SHARE_TOP)&gt;=0);</span>
<span class='curline'><a href='../S/4993.html#L93'>session</a>            93 tests/tls13/psk-dumbfw.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4993.html#L94'>session</a>            94 tests/tls13/psk-dumbfw.c 	assert(gnutls_credentials_set(session, GNUTLS_CRD_PSK, pskcred)&gt;=0);</span>
<span class='curline'><a href='../S/4993.html#L96'>session</a>            96 tests/tls13/psk-dumbfw.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4993.html#L100'>session</a>           100 tests/tls13/psk-dumbfw.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4993.html#L111'>session</a>           111 tests/tls13/psk-dumbfw.c 	assert(gnutls_record_send(session, MSG, strlen(MSG))&gt;=0);</span>
<span class='curline'><a href='../S/4993.html#L113'>session</a>           113 tests/tls13/psk-dumbfw.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4993.html#L132'>session</a>           132 tests/tls13/psk-dumbfw.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4993.html#L138'>session</a>           138 tests/tls13/psk-dumbfw.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4993.html#L146'>session</a>           146 tests/tls13/psk-dumbfw.c pskfunc(gnutls_session_t session, const char *username,</span>
<span class='curline'><a href='../S/4993.html#L176'>session</a>           176 tests/tls13/psk-dumbfw.c static int client_hello_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4993.html#L213'>session</a>           213 tests/tls13/psk-dumbfw.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4993.html#L228'>session</a>           228 tests/tls13/psk-dumbfw.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/4993.html#L230'>session</a>           230 tests/tls13/psk-dumbfw.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4993.html#L231'>session</a>           231 tests/tls13/psk-dumbfw.c 	gnutls_credentials_set(session, GNUTLS_CRD_PSK, server_pskcred);</span>
<span class='curline'><a href='../S/4993.html#L233'>session</a>           233 tests/tls13/psk-dumbfw.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4993.html#L237'>session</a>           237 tests/tls13/psk-dumbfw.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4993.html#L238'>session</a>           238 tests/tls13/psk-dumbfw.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4993.html#L241'>session</a>           241 tests/tls13/psk-dumbfw.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4993.html#L251'>session</a>           251 tests/tls13/psk-dumbfw.c 		gnutls_record_set_timeout(session, 10000);</span>
<span class='curline'><a href='../S/4993.html#L252'>session</a>           252 tests/tls13/psk-dumbfw.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4993.html#L265'>session</a>           265 tests/tls13/psk-dumbfw.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4993.html#L270'>session</a>           270 tests/tls13/psk-dumbfw.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4993.html#L273'>session</a>           273 tests/tls13/psk-dumbfw.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4995.html#L90'>session</a>            90 tests/tls13/rnd-check-rollback-val.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4995.html#L110'>session</a>           110 tests/tls13/rnd-check-rollback-val.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4995.html#L112'>session</a>           112 tests/tls13/rnd-check-rollback-val.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4995.html#L114'>session</a>           114 tests/tls13/rnd-check-rollback-val.c 	ret = gnutls_priority_set_direct(session, PRIO, NULL);</span>
<span class='curline'><a href='../S/4995.html#L119'>session</a>           119 tests/tls13/rnd-check-rollback-val.c 		gnutls_session_set_data(session, session_data.data, session_data.size);</span>
<span class='curline'><a href='../S/4995.html#L123'>session</a>           123 tests/tls13/rnd-check-rollback-val.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4995.html#L125'>session</a>           125 tests/tls13/rnd-check-rollback-val.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4995.html#L130'>session</a>           130 tests/tls13/rnd-check-rollback-val.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4995.html#L139'>session</a>           139 tests/tls13/rnd-check-rollback-val.c 		assert(gnutls_session_is_resumed(session));</span>
<span class='curline'><a href='../S/4995.html#L141'>session</a>           141 tests/tls13/rnd-check-rollback-val.c 	gnutls_session_get_random(session, NULL, &amp;srandom);</span>
<span class='curline'><a href='../S/4995.html#L160'>session</a>           160 tests/tls13/rnd-check-rollback-val.c 		ret = gnutls_record_send(session, "\x00", 1);</span>
<span class='curline'><a href='../S/4995.html#L164'>session</a>           164 tests/tls13/rnd-check-rollback-val.c 		ret = gnutls_session_get_data2(session, &amp;session_data);</span>
<span class='curline'><a href='../S/4995.html#L170'>session</a>           170 tests/tls13/rnd-check-rollback-val.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4995.html#L190'>session</a>           190 tests/tls13/rnd-check-rollback-val.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4995.html#L213'>session</a>           213 tests/tls13/rnd-check-rollback-val.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4995.html#L215'>session</a>           215 tests/tls13/rnd-check-rollback-val.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4995.html#L217'>session</a>           217 tests/tls13/rnd-check-rollback-val.c 	assert(gnutls_priority_set_direct(session, "NORMAL:-VERS-TLS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.1:+VERS-TLS1.0", NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4995.html#L219'>session</a>           219 tests/tls13/rnd-check-rollback-val.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4995.html#L221'>session</a>           221 tests/tls13/rnd-check-rollback-val.c 	assert(gnutls_session_ticket_enable_server(session, &amp;skey) &gt;= 0);</span>
<span class='curline'><a href='../S/4995.html#L223'>session</a>           223 tests/tls13/rnd-check-rollback-val.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4995.html#L226'>session</a>           226 tests/tls13/rnd-check-rollback-val.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4995.html#L236'>session</a>           236 tests/tls13/rnd-check-rollback-val.c 		assert(gnutls_session_is_resumed(session));</span>
<span class='curline'><a href='../S/4995.html#L239'>session</a>           239 tests/tls13/rnd-check-rollback-val.c 		ret = gnutls_record_recv(session, buf, sizeof(buf));</span>
<span class='curline'><a href='../S/4995.html#L245'>session</a>           245 tests/tls13/rnd-check-rollback-val.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4989.html#L73'>session</a>            73 tests/tls13/rnd-rollback-detection.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4989.html#L89'>session</a>            89 tests/tls13/rnd-rollback-detection.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4989.html#L91'>session</a>            91 tests/tls13/rnd-rollback-detection.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4989.html#L93'>session</a>            93 tests/tls13/rnd-rollback-detection.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.1:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/4989.html#L99'>session</a>            99 tests/tls13/rnd-rollback-detection.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4989.html#L101'>session</a>           101 tests/tls13/rnd-rollback-detection.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4989.html#L106'>session</a>           106 tests/tls13/rnd-rollback-detection.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4989.html#L116'>session</a>           116 tests/tls13/rnd-rollback-detection.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4989.html#L148'>session</a>           148 tests/tls13/rnd-rollback-detection.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4989.html#L165'>session</a>           165 tests/tls13/rnd-rollback-detection.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4989.html#L167'>session</a>           167 tests/tls13/rnd-rollback-detection.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4989.html#L168'>session</a>           168 tests/tls13/rnd-rollback-detection.c 	gnutls_handshake_set_random(session, &amp;RND);</span>
<span class='curline'><a href='../S/4989.html#L170'>session</a>           170 tests/tls13/rnd-rollback-detection.c 	assert(gnutls_priority_set_direct(session, PRIO, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4989.html#L172'>session</a>           172 tests/tls13/rnd-rollback-detection.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4989.html#L174'>session</a>           174 tests/tls13/rnd-rollback-detection.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4989.html#L177'>session</a>           177 tests/tls13/rnd-rollback-detection.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4989.html#L185'>session</a>           185 tests/tls13/rnd-rollback-detection.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4996.html#L75'>session</a>            75 tests/tls13/supported_versions.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4996.html#L88'>session</a>            88 tests/tls13/supported_versions.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4996.html#L90'>session</a>            90 tests/tls13/supported_versions.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4996.html#L92'>session</a>            92 tests/tls13/supported_versions.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/4996.html#L98'>session</a>            98 tests/tls13/supported_versions.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4996.html#L100'>session</a>           100 tests/tls13/supported_versions.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4996.html#L105'>session</a>           105 tests/tls13/supported_versions.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4996.html#L111'>session</a>           111 tests/tls13/supported_versions.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4996.html#L140'>session</a>           140 tests/tls13/supported_versions.c static int client_hello_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4996.html#L250'>session</a>           250 tests/tls13/supported_versions.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4996.html#L268'>session</a>           268 tests/tls13/supported_versions.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4996.html#L270'>session</a>           270 tests/tls13/supported_versions.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4996.html#L271'>session</a>           271 tests/tls13/supported_versions.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4996.html#L278'>session</a>           278 tests/tls13/supported_versions.c 	gnutls_priority_set_direct(session, "NORMAL:+VERS-TLS1.3", NULL);</span>
<span class='curline'><a href='../S/4996.html#L280'>session</a>           280 tests/tls13/supported_versions.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4996.html#L282'>session</a>           282 tests/tls13/supported_versions.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4996.html#L285'>session</a>           285 tests/tls13/supported_versions.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4996.html#L301'>session</a>           301 tests/tls13/supported_versions.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4987.html#L74'>session</a>            74 tests/tls13/tls12-no-tls13-exts.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4987.html#L90'>session</a>            90 tests/tls13/tls12-no-tls13-exts.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4987.html#L92'>session</a>            92 tests/tls13/tls12-no-tls13-exts.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4987.html#L94'>session</a>            94 tests/tls13/tls12-no-tls13-exts.c 	ret = gnutls_priority_set_direct(session, "NORMAL:-VERS-ALL:+VERS-TLS1.2:+VERS-TLS1.0", NULL);</span>
<span class='curline'><a href='../S/4987.html#L100'>session</a>           100 tests/tls13/tls12-no-tls13-exts.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4987.html#L102'>session</a>           102 tests/tls13/tls12-no-tls13-exts.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4987.html#L107'>session</a>           107 tests/tls13/tls12-no-tls13-exts.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4987.html#L113'>session</a>           113 tests/tls13/tls12-no-tls13-exts.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4987.html#L122'>session</a>           122 tests/tls13/tls12-no-tls13-exts.c static int client_hello_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4987.html#L144'>session</a>           144 tests/tls13/tls12-no-tls13-exts.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4987.html#L161'>session</a>           161 tests/tls13/tls12-no-tls13-exts.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4987.html#L163'>session</a>           163 tests/tls13/tls12-no-tls13-exts.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4987.html#L164'>session</a>           164 tests/tls13/tls12-no-tls13-exts.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4987.html#L171'>session</a>           171 tests/tls13/tls12-no-tls13-exts.c 	gnutls_priority_set_direct(session, "NORMAL", NULL);</span>
<span class='curline'><a href='../S/4987.html#L173'>session</a>           173 tests/tls13/tls12-no-tls13-exts.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4987.html#L175'>session</a>           175 tests/tls13/tls12-no-tls13-exts.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/4987.html#L178'>session</a>           178 tests/tls13/tls12-no-tls13-exts.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4987.html#L190'>session</a>           190 tests/tls13/tls12-no-tls13-exts.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4948.html#L66'>session</a>            66 tests/tls_hello_random_value.c static int hello_callback(gnutls_session_t session, unsigned int htype,</span>
<span class='curline'><a href='../S/4948.html#L75'>session</a>            75 tests/tls_hello_random_value.c 			gnutls_session_get_random(session, &amp;tmp, NULL);</span>
<span class='curline'><a href='../S/4948.html#L96'>session</a>            96 tests/tls_hello_random_value.c 		gnutls_session_get_random(session, NULL, &amp;tmp);</span>
<span class='curline'><a href='../S/4948.html#L118'>session</a>           118 tests/tls_hello_random_value.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4948.html#L129'>session</a>           129 tests/tls_hello_random_value.c 	assert(gnutls_init(&amp;session, GNUTLS_CLIENT)&gt;=0);</span>
<span class='curline'><a href='../S/4948.html#L132'>session</a>           132 tests/tls_hello_random_value.c 		assert(gnutls_set_default_priority(session) &gt;= 0);</span>
<span class='curline'><a href='../S/4948.html#L134'>session</a>           134 tests/tls_hello_random_value.c 		assert(gnutls_priority_set_direct(session, priority, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4948.html#L137'>session</a>           137 tests/tls_hello_random_value.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4948.html#L140'>session</a>           140 tests/tls_hello_random_value.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4948.html#L141'>session</a>           141 tests/tls_hello_random_value.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4948.html#L143'>session</a>           143 tests/tls_hello_random_value.c 	gnutls_handshake_set_hook_function(session, GNUTLS_HANDSHAKE_ANY,</span>
<span class='curline'><a href='../S/4948.html#L146'>session</a>           146 tests/tls_hello_random_value.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4948.html#L159'>session</a>           159 tests/tls_hello_random_value.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4948.html#L162'>session</a>           162 tests/tls_hello_random_value.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4948.html#L171'>session</a>           171 tests/tls_hello_random_value.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4948.html#L184'>session</a>           184 tests/tls_hello_random_value.c 	assert(gnutls_init(&amp;session, GNUTLS_SERVER)&gt;=0);</span>
<span class='curline'><a href='../S/4948.html#L185'>session</a>           185 tests/tls_hello_random_value.c 	assert(session != NULL);</span>
<span class='curline'><a href='../S/4948.html#L188'>session</a>           188 tests/tls_hello_random_value.c 		assert(gnutls_set_default_priority(session) &gt;= 0);</span>
<span class='curline'><a href='../S/4948.html#L190'>session</a>           190 tests/tls_hello_random_value.c 		assert(gnutls_priority_set_direct(session, priority, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/4948.html#L193'>session</a>           193 tests/tls_hello_random_value.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE,</span>
<span class='curline'><a href='../S/4948.html#L196'>session</a>           196 tests/tls_hello_random_value.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4948.html#L197'>session</a>           197 tests/tls_hello_random_value.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/4948.html#L199'>session</a>           199 tests/tls_hello_random_value.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4948.html#L209'>session</a>           209 tests/tls_hello_random_value.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4948.html#L211'>session</a>           211 tests/tls_hello_random_value.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5084.html#L120'>session</a>           120 tests/tlsext-decoding.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5084.html#L133'>session</a>           133 tests/tlsext-decoding.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5084.html#L134'>session</a>           134 tests/tlsext-decoding.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5084.html#L136'>session</a>           136 tests/tlsext-decoding.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5084.html#L138'>session</a>           138 tests/tlsext-decoding.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/5084.html#L140'>session</a>           140 tests/tlsext-decoding.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5084.html#L141'>session</a>           141 tests/tlsext-decoding.c 	gnutls_transport_set_push_function(session, odd_push);</span>
<span class='curline'><a href='../S/5084.html#L146'>session</a>           146 tests/tlsext-decoding.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5084.html#L157'>session</a>           157 tests/tlsext-decoding.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5084.html#L181'>session</a>           181 tests/tlsext-decoding.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5084.html#L200'>session</a>           200 tests/tlsext-decoding.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5084.html#L201'>session</a>           201 tests/tlsext-decoding.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5084.html#L206'>session</a>           206 tests/tlsext-decoding.c 	assert(gnutls_priority_set_direct(session, prio, NULL) &gt;= 0);</span>
<span class='curline'><a href='../S/5084.html#L208'>session</a>           208 tests/tlsext-decoding.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/5084.html#L210'>session</a>           210 tests/tlsext-decoding.c 	gnutls_transport_set_int(session, fd);</span>
<span class='curline'><a href='../S/5084.html#L213'>session</a>           213 tests/tlsext-decoding.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5084.html#L219'>session</a>           219 tests/tlsext-decoding.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5084.html#L226'>session</a>           226 tests/tlsext-decoding.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5129.html#L38'>session</a>            38 tests/utils-adv.c int _gnutls_server_name_set_raw(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5129.html#L323'>session</a>           323 tests/utils-adv.c void print_dh_params_info(gnutls_session_t session)</span>
<span class='curline'><a href='../S/5129.html#L329'>session</a>           329 tests/utils-adv.c 	ret = gnutls_dh_get_prime_bits(session);</span>
<span class='curline'><a href='../S/5129.html#L334'>session</a>           334 tests/utils-adv.c 	ret = gnutls_dh_get_secret_bits(session);</span>
<span class='curline'><a href='../S/5129.html#L339'>session</a>           339 tests/utils-adv.c 	ret = gnutls_dh_get_pubkey(session, &amp;pubkey);</span>
<span class='curline'><a href='../S/5129.html#L356'>session</a>           356 tests/utils-adv.c 	ret = gnutls_dh_get_group(session, &amp;gen, &amp;prime);</span>
<span class='curline'><a href='../S/5229.html#L49'>session</a>            49 tests/x509-cert-callback-legacy.c cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5229.html#L60'>session</a>            60 tests/x509-cert-callback-legacy.c 	if (gnutls_certificate_client_get_request_status(session) == 0) {</span>
<span class='curline'><a href='../S/5229.html#L96'>session</a>            96 tests/x509-cert-callback-legacy.c server_cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4338.html#L55'>session</a>            55 tests/x509-cert-callback-ocsp.c server_cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4919.html#L51'>session</a>            51 tests/x509-cert-callback.c cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/4919.html#L63'>session</a>            63 tests/x509-cert-callback.c 	if (gnutls_certificate_client_get_request_status(session) == 0) {</span>
<span class='curline'><a href='../S/4919.html#L105'>session</a>           105 tests/x509-cert-callback.c 		if (gnutls_certificate_client_get_request_status(session) == 0) {</span>
<span class='curline'><a href='../S/4919.html#L119'>session</a>           119 tests/x509-cert-callback.c server_cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5237.html#L75'>session</a>            75 tests/x509dn.c cert_callback(gnutls_session_t session,</span>
<span class='curline'><a href='../S/5237.html#L139'>session</a>           139 tests/x509dn.c 	gnutls_session_t session = NULL;</span>
<span class='curline'><a href='../S/5237.html#L164'>session</a>           164 tests/x509dn.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/5237.html#L166'>session</a>           166 tests/x509dn.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5237.html#L170'>session</a>           170 tests/x509dn.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/5237.html#L172'>session</a>           172 tests/x509dn.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5237.html#L176'>session</a>           176 tests/x509dn.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5237.html#L190'>session</a>           190 tests/x509dn.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5237.html#L194'>session</a>           194 tests/x509dn.c 		print_info(session);</span>
<span class='curline'><a href='../S/5237.html#L196'>session</a>           196 tests/x509dn.c 	gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/5237.html#L198'>session</a>           198 tests/x509dn.c 	ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5237.html#L217'>session</a>           217 tests/x509dn.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/5237.html#L223'>session</a>           223 tests/x509dn.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5237.html#L239'>session</a>           239 tests/x509dn.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/5237.html#L261'>session</a>           261 tests/x509dn.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/5237.html#L263'>session</a>           263 tests/x509dn.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/5237.html#L265'>session</a>           265 tests/x509dn.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/5237.html#L269'>session</a>           269 tests/x509dn.c 	gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/5237.html#L272'>session</a>           272 tests/x509dn.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/5237.html#L273'>session</a>           273 tests/x509dn.c 	gnutls_handshake_set_timeout(session, 20 * 1000);</span>
<span class='curline'><a href='../S/5237.html#L275'>session</a>           275 tests/x509dn.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/5237.html#L278'>session</a>           278 tests/x509dn.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/5237.html#L289'>session</a>           289 tests/x509dn.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/5237.html#L293'>session</a>           293 tests/x509dn.c 		print_info(session);</span>
<span class='curline'><a href='../S/5237.html#L297'>session</a>           297 tests/x509dn.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/5237.html#L310'>session</a>           310 tests/x509dn.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/5237.html#L316'>session</a>           316 tests/x509dn.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/5237.html#L319'>session</a>           319 tests/x509dn.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4377.html#L74'>session</a>            74 tests/x509self.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4377.html#L96'>session</a>            96 tests/x509self.c 	gnutls_init(&amp;session, GNUTLS_CLIENT);</span>
<span class='curline'><a href='../S/4377.html#L98'>session</a>            98 tests/x509self.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4377.html#L102'>session</a>           102 tests/x509self.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, xcred);</span>
<span class='curline'><a href='../S/4377.html#L104'>session</a>           104 tests/x509self.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4377.html#L108'>session</a>           108 tests/x509self.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4377.html#L121'>session</a>           121 tests/x509self.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4377.html#L125'>session</a>           125 tests/x509self.c 		print_info(session);</span>
<span class='curline'><a href='../S/4377.html#L127'>session</a>           127 tests/x509self.c 	ret = gnutls_credentials_get(session, GNUTLS_CRD_CERTIFICATE, (void**)&amp;tst_cred);</span>
<span class='curline'><a href='../S/4377.html#L135'>session</a>           135 tests/x509self.c 	ret = gnutls_record_send(session, MSG, strlen(MSG));</span>
<span class='curline'><a href='../S/4377.html#L147'>session</a>           147 tests/x509self.c 		ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4377.html#L156'>session</a>           156 tests/x509self.c 		ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4377.html#L161'>session</a>           161 tests/x509self.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4377.html#L185'>session</a>           185 tests/x509self.c 	gnutls_bye(session, GNUTLS_SHUT_RDWR);</span>
<span class='curline'><a href='../S/4377.html#L191'>session</a>           191 tests/x509self.c 	gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4377.html#L208'>session</a>           208 tests/x509self.c 	gnutls_session_t session;</span>
<span class='curline'><a href='../S/4377.html#L230'>session</a>           230 tests/x509self.c 	gnutls_init(&amp;session, GNUTLS_SERVER);</span>
<span class='curline'><a href='../S/4377.html#L232'>session</a>           232 tests/x509self.c 	assert(gnutls_priority_set_direct(session, prio, NULL)&gt;=0);</span>
<span class='curline'><a href='../S/4377.html#L234'>session</a>           234 tests/x509self.c 	gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, x509_cred);</span>
<span class='curline'><a href='../S/4377.html#L241'>session</a>           241 tests/x509self.c 	gnutls_dh_set_prime_bits(session, DH_BITS);</span>
<span class='curline'><a href='../S/4377.html#L244'>session</a>           244 tests/x509self.c 	gnutls_transport_set_int(session, sd);</span>
<span class='curline'><a href='../S/4377.html#L245'>session</a>           245 tests/x509self.c 	ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4377.html#L248'>session</a>           248 tests/x509self.c 		gnutls_deinit(session);</span>
<span class='curline'><a href='../S/4377.html#L257'>session</a>           257 tests/x509self.c 			(gnutls_protocol_get_version(session)));</span>
<span class='curline'><a href='../S/4377.html#L262'>session</a>           262 tests/x509self.c 		print_info(session);</span>
<span class='curline'><a href='../S/4377.html#L267'>session</a>           267 tests/x509self.c 			ret = gnutls_record_recv(session, buffer, MAX_BUF);</span>
<span class='curline'><a href='../S/4377.html#L279'>session</a>           279 tests/x509self.c 			gnutls_certificate_server_set_request(session,</span>
<span class='curline'><a href='../S/4377.html#L286'>session</a>           286 tests/x509self.c 			ret = gnutls_rehandshake(session);</span>
<span class='curline'><a href='../S/4377.html#L293'>session</a>           293 tests/x509self.c 			ret = gnutls_handshake(session);</span>
<span class='curline'><a href='../S/4377.html#L305'>session</a>           305 tests/x509self.c 			gnutls_record_send(session, buffer,</span>
<span class='curline'><a href='../S/4377.html#L311'>session</a>           311 tests/x509self.c 	gnutls_bye(session, GNUTLS_SHUT_WR);</span>
<span class='curline'><a href='../S/4377.html#L314'>session</a>           314 tests/x509self.c 	gnutls_deinit(session);</span>
</pre>
</body>
</html>
